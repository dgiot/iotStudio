/*!
 *  build: 杭州数蛙科技有限公司 
 *  copyright: dgiot-dashboard 
 *  author: h7ml(h7ml@qq.com) 
 *  Time: 2022年09月22日11时26分38秒
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-310ed3db"],{"0452":function(e,t,a){e.exports={"menu-color":"rgba(255,255,255,.95)","menu-color-active":"rgba(255,255,255,.95)","menu-background":"#282c34","column-second-menu-background":"#fff"}},"05da":function(e,t,a){"use strict";a("bff8")},"0b48":function(t,a,i){"use strict";i.r(a);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"log log-container"},[t("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{border:"",data:e.tableData5.slice((e.start-1)*e.length,e.start*e.length),height:e.height}},[t("el-table-column",{attrs:{label:e.$translateTitle("node.nodename"),prop:"name"}}),t("el-table-column",{attrs:{label:"Erlang/"+e.$translateTitle("node.OTPversion"),prop:"otp_release"}}),t("el-table-column",{scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(" "+e._s(a.process_used+"/"+a.process_available)+" ")])]}}])},[t("template",{slot:"header"},[t("span",[e._v(" "+e._s("Erlang"+e.$translateTitle("node.process"))+" ")]),t("p",[e._v("used/avaliable")])])],2),t("el-table-column",{attrs:{label:"CPU"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(" "+e._s(a.load1+"/"+a.load5+"/"+a.load15)+" ")])]}}])},[t("template",{slot:"header"},[t("span",[e._v("CPU")]),t("p",[e._v("1load/5load/15load")])])],2),t("el-table-column",{attrs:{label:e.$translateTitle("node.memory")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(" "+e._s(a.memory_used+"/"+a.memory_total)+" ")])]}}])},[t("template",{slot:"header"},[t("span",[e._v(" "+e._s(e.$translateTitle("node.memory"))+" ")]),t("p",[e._v("used/total")])])],2),t("el-table-column",{attrs:{label:e.$translateTitle("node.Maximumnumberofhandles"),prop:"max_fds"}}),t("el-table-column",{attrs:{label:e.$translateTitle("node.state"),prop:"node_status"}})],1),t("div",{staticClass:"block",staticStyle:{"margin-top":"30px"}},[t("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","page-size":e.length,"page-sizes":[10,25,50,100],total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1),t("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.handleClose,title:e.$translateTitle("node.joincluster"),visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("span",[e._v(e._s(e.$translateTitle("node.nodename")))]),t("el-input",{attrs:{type:"text"},model:{value:e.form.nodename,callback:function(t){e.$set(e.form,"nodename",t)},expression:"form.nodename"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.join.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)],1)],1)},r=[],o=i("bb22"),l=(t,a,i)=>new Promise((s,r)=>{var o=t=>{try{n(i.next(t))}catch(e){r(e)}},l=t=>{try{n(i.throw(t))}catch(e){r(e)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,l);n((i=i.apply(t,a)).next())}),n={data(){return{form:{nodename:""},height:this.$baseTableHeight(0)-25,tableData5:[],node:null,start:1,length:10,total:0,draw:1,search:"",dialogVisible:!1,installtion:[],selsectinstall:[{value:"info",label:"info"},{value:"error",label:"error"},{value:"warning",label:"warning"},{value:"debug",label:"debug"},{value:"mqtt",label:"mqtt"},{value:"kafka",label:"kafka"},{value:"alert",label:"alert"},{value:"critical",label:"critical"},{value:"emergency",label:"emergency"},{value:"notice",label:"notice"}]}},mounted(){this.Getinformation()},methods:{Getinformation(){Object(o["getNode"])(this.start,this.lengt).then(e=>{e&&(this.tableData5=e.nodes,this.total=e.nodes.length)})},handleSizeChange(e){this.length=e,this.start=1},handleCurrentChange(e){this.start=e},join(){Object(o["joinNode"])("join",this.form.nodename).then(e=>{e&&(this.$message({showClose:!0,duration:2e3,type:"success",message:"加入成功"}),this.dialogVisible=!1,this.Getinformation())}).catch(e=>{this.$message(e.error)})},removeNode(e){return l(this,null,(function*(){const t=yield Object(o["joinNode"])("leave",e.node);console.error(t,"error"),t?this.$message(t):this.$message({showClose:!0,duration:2e3,type:"success",message:"移除成功"}),this.Getinformation()}))},install(){this.dialogVisible=!0},handleClose(){this.dialogVisible=!1}}},c=n,d=i("2877"),u=Object(d["a"])(c,s,r,!1,null,null,null);a["default"]=u.exports},"0ff1":function(e,t,a){"use strict";a("3c04")},"1a2d5":function(t,a,i){"use strict";i.r(a);var s=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{ref:"custom-table",staticClass:"custom-table-container"},[t("el-drawer",{directives:[{name:"drawerDrag",rawName:"v-drawerDrag"}],attrs:{"append-to-body":"",size:"90%",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("iframe",{staticStyle:{width:"100%",height:"100%"},attrs:{src:e.officeapps}})]),t("el-drawer",{directives:[{name:"drawerDrag",rawName:"v-drawerDrag"}],attrs:{"append-to-body":"",size:"90%",visible:e.statisticsVisible},on:{"update:visible":function(t){e.statisticsVisible=t}}},[t("evidence-statistics",{ref:"statistics",attrs:{"evidence-id":e.evidenceId}})],1),t("div",{staticClass:"components"},[t("el-dialog",{attrs:{"append-to-body":"",visible:e.evidenceDialog},on:{"update:visible":function(t){e.evidenceDialog=t}}},[t("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[t("el-table",{attrs:{border:"",data:e.evidences,stripe:""}},[t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("cloudTest.number"),"show-overflow-tooltip":"",width:"100"},scopedSlots:e._u([{key:"default",fn:function({$index:t}){return[e._v(" "+e._s(t+1)+" ")]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("cloudTest.evidence"),"min-width":"180",prop:"row.original.path","show-overflow-tooltip":"",sortable:"",width:"auto"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-link",{attrs:{href:e.$FileServe+a.original.path,target:"_blank"}},[e._v(" "+e._s(a.original.path.split("/")[""+(a.original.path.split("/").length-1)])+" ")])]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("deviceLog.type"),prop:"row.original.type","show-overflow-tooltip":"",sortable:"",width:180},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-tag",{attrs:{effect:"plain"}},[e._v(" "+e._s(e.$translateTitle("cloudTest."+a.original.type))+" ")])]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("cloudTest.single audit"),"show-overflow-tooltip":"",width:120},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-tag",{attrs:{effect:"dark",type:["","success","danger"][["未审核","通过审核","不通过审核"].indexOf(a.original.status)]}},[e._v(" "+e._s(a.original.status)+" ")])]}}])}),3==Number(e.$route.query.step)?t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("cloudTest.single audit opinion"),width:"auto"},scopedSlots:e._u([{key:"default",fn:function({row:a,$index:i}){return[t("el-input",{attrs:{size:"mini"},model:{value:a.original.message,callback:function(t){e.$set(a.original,"message",t)},expression:"row.original.message"}})]}}],null,!1,847914733)}):e._e(),3==Number(e.$route.query.step)?t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("cloudTest.submit review"),width:"auto"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-button",{attrs:{plain:""},nativeOn:{click:function(t){return e.changeItem(a)}}},[e._v(" "+e._s(e.$translateTitle("cloudTest.submit review"))+" ")])]}}],null,!1,3508204407)}):e._e()],1)],1)],1),t("dgiot-dialog",{attrs:{show:e.activePopShow},on:{"update:show":function(t){e.activePopShow=t}}},[t("h2",{attrs:{slot:"title"},slot:"title"},[e._v(" "+e._s(e.$translateTitle("cloudTest.addwordtask"))+" ")]),t("div",{staticClass:"content"},[t("el-divider",[e._v(" "+e._s(e.$translateTitle("cloudTest.Basic information of inspection tasks"))+" ")]),t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{"element-loading-background":"rgba(0, 0, 0, 0.8)","element-loading-spinner":"el-icon-loading","element-loading-text":e.$translateTitle("developer.Waitingtoreturn"),"label-width":"100px",model:e.ruleForm,rules:e.rules,size:"mini"}},[t("el-form-item",{attrs:{label:e.$translateTitle("cloudTest.taskname"),prop:"name"}},[t("el-input",{model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),t("el-form-item",{attrs:{label:e.$translateTitle("cloudTest.wordtemplate"),prop:"templatename"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("task.Select"),"value-key":"objectId"},on:{change:e.categoryChange},model:{value:e.ruleForm.templatename,callback:function(t){e.$set(e.ruleForm,"templatename",t)},expression:"ruleForm.templatename"}},e._l(e.categorylist,(function(e){return t("el-option",{key:e.objectId,attrs:{label:e.name,value:e}})})),1)],1),t("el-form-item",{attrs:{label:e.$translateTitle("cloudTest.testbed"),prop:"testbed"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("task.Select"),"value-key":"objectId"},on:{change:e.testbedChange},model:{value:e.ruleForm.testbed,callback:function(t){e.$set(e.ruleForm,"testbed",t)},expression:"ruleForm.testbed"}},e._l(e.grouplist,(function(e){return t("el-option",{key:e.objectId,attrs:{label:e.name,value:e}})})),1)],1)],1),t("div",{staticStyle:{"text-align":"right"},attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.submitForm("ruleForm")}}},[t("i",{staticClass:"el-icon-finished"},[e._v(" "+e._s(e.$translateTitle("product.createnow"))+" ")])])],1)],1)])],1),t("dgiot-query-form",[t("dgiot-query-form-left-panel",[t("el-form",{ref:"form",attrs:{inline:!0,model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",[t("el-input",{attrs:{placeholder:e.$translateTitle("cloudTest.Please select review status")},model:{value:e.queryForm.name,callback:function(t){e.$set(e.queryForm,"name",t)},expression:"queryForm.name"}})],1),t("el-form-item",[t("el-button",{attrs:{icon:"el-icon-search","native-type":"submit",type:"primary"},nativeOn:{click:function(t){return e.fetchData()}}},[e._v(" "+e._s(e.$translateTitle("cloudTest.search"))+" ")])],1)],1)],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableSort",attrs:{border:e.border,data:e.list.examination,size:e.lineHeight,stripe:e.stripe},scopedSlots:e._u([{key:"empty",fn:function(){return[t("el-image",{staticClass:"dgiot-data-empty",attrs:{src:i("c2ad")}})]},proxy:!0}])},[t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("cloudTest.number"),"show-overflow-tooltip":"",width:"95"},scopedSlots:e._u([{key:"default",fn:function({$index:t}){return[e._v(" "+e._s(t+1)+" ")]}}])}),e._l(e.finallyColumns,(function(a,i){return t("el-table-column",{key:i,attrs:{align:"center",label:e.$translateTitle("cloudTest."+a.label),prop:a.prop,"show-overflow-tooltip":"",sortable:a.sortable,width:a.width}})})),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("deviceLog.status"),"show-overflow-tooltip":"",width:"120"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-tooltip",{directives:[{name:"show",rawName:"v-show",value:-1==a.profile.step,expression:"row.profile.step == -1"}],staticClass:"item",attrs:{content:a.profile.message,effect:"dark",placement:"top-start"}},[t("el-tag",{attrs:{effect:"dark",type:"warning"}},[e._v(" "+e._s(e.$translateTitle("cloudTest.notapproved"))+" ")])],1),t("el-tag",{directives:[{name:"show",rawName:"v-show",value:-1!=a.profile.step,expression:"row.profile.step != -1"}],attrs:{effect:"dark",type:["info","warning","primary","primary"][a.profile.step?a.profile.step:0]}},[e._v(" "+e._s([e.$translateTitle("product.notstarted"),e.$translateTitle("product.testing"),e.$translateTitle("product.pending review"),e.$translateTitle("product.review completed"),e.$translateTitle("product.report generated")][a.profile.step]||e.$translateTitle("product.finishtest"))+" ")])]}}])}),t("el-table-column",{attrs:{align:"center",fixed:"right",label:e.$translateTitle("cloudTest.operate"),width:"420"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-button",{directives:[{name:"show",rawName:"v-show",value:2==a.profile.step,expression:"row.profile.step == 2"}],attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.handleUnderreview(a.objectId)}}},[e._v(" "+e._s(e.$translateTitle("product.Underreview"))+" ")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:a.profile.iszjimee,expression:"row.profile.iszjimee"}],attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.handleManagement(a)}}},[e._v(" "+e._s(e.$translateTitle("task.testItemsreview"))+" ")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:3==a.profile.step,expression:"row.profile.step == 3"}],attrs:{size:"mini",type:"success"},nativeOn:{click:function(t){return e.handleReport(a)}}},[e._v(" "+e._s(e.$translateTitle("product.generate"))+" ")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:4==a.profile.step,expression:"row.profile.step == 4"}],attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.handleReport(a)}}},[e._v(" "+e._s(e.$translateTitle("application.preview report"))+" ")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:a.profile.step>=4,expression:"row.profile.step >= 4"}],attrs:{size:"mini",type:"info"},nativeOn:{click:function(t){return e.handleEvidence(a.objectId)}}},[e._v(" "+e._s(e.$translateTitle("application.List evidence"))+" ")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:a.profile.step>=4,expression:"row.profile.step >= 4"}],attrs:{size:"mini",type:"success"},nativeOn:{click:function(t){return e.handleRouter(a)}}},[e._v(" "+e._s(e.$translateTitle("application.evidence"))+" ")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:-1!=a.profile.step,expression:"row.profile.step != -1"}],attrs:{size:"mini",type:"danger"},nativeOn:{click:function(t){return e.handleHistory(a)}}},[e._v(" 历史数据 ")])]}}])})],2),t("dgiot-parser-pagination",{key:e.list.examination.length+"examination",ref:"examination",attrs:{pagination:e.paginations,"query-payload":e.queryPayload},on:{pagination:e.fetchData,paginationQuery:e.paginationQuery}}),t("lowcode-design",{ref:"lowcodeDesign",on:{objectId:e.lowcodeId}}),t("el-dialog",{attrs:{"append-to-body":"","before-close":e.handleCloseAmis,center:"",top:"5vh",visible:e.management.dialog,width:"80%"},on:{"update:visible":function(t){return e.$set(e.management,"dialog",t)}}},[t("el-tabs",{model:{value:e.managementactiveName,callback:function(t){e.managementactiveName=t},expression:"managementactiveName"}},e._l(e.management.data,(function(e,a){return t("el-tab-pane",{key:a+"i",attrs:{label:e.title,name:a+""}},[t("dgiot-amis",{attrs:{schema:e.data,"show-help":!1}})],1)})),1)],1)],1)},r=[],o=i("209d"),l=i("8387"),n=i("1285"),c=i("cdef"),d=i("5880"),u=i("7212"),m=i("8ba7"),h=i("c008"),p=Object.defineProperty,g=Object.defineProperties,f=Object.getOwnPropertyDescriptors,b=Object.getOwnPropertySymbols,y=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable,w=(e,t,a)=>t in e?p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,$=(e,t)=>{for(var a in t||(t={}))y.call(t,a)&&w(e,a,t[a]);if(b)for(var a of b(t))v.call(t,a)&&w(e,a,t[a]);return e},C=(e,t)=>g(e,f(t)),x=(t,a,i)=>new Promise((s,r)=>{var o=t=>{try{n(i.next(t))}catch(e){r(e)}},l=t=>{try{n(i.throw(t))}catch(e){r(e)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,l);n((i=i.apply(t,a)).next())});const I=window["vue-aliplayer-v2"].default;var k={name:"ReviewIndex",components:{lowcodeDesign:o["default"],evidenceStatistics:l["default"],"vue-aliplayer-v2":I},data(){var e,t;return{management:{dialog:!1,data:{}},managementactiveName:"0",statisticsVisible:!1,evidenceId:"",aliplayer:{autoplay:!1,height:"200px"},types:{video:["video","videocam_black"],audio:["audio","volume_mute"],image:["image","image"],file:["file","archive"]},evidences:[],evidenceDialog:!1,activeName:(null==(t=null==(e=null==this?void 0:this.$route)?void 0:e.query)?void 0:t.tabs)&&"examination"==this.$route.query.tabs?"examination":"forensics",officeapps:"",dialogVisible:!1,paginations:{layout:"total, sizes, prev, pager, next, jumper"},queryPayload:{excludeKeys:"data",include:"",order:"-createdAt",limit:10,skip:0,count:"objectId"},lowcodeId:"",loading:!1,options:[{value:"Underreview",label:"审核中"},{value:"finishreview",label:"审核完成"}],rules:{testbed:[{required:!0,message:"请选择测试台体",trigger:"blur"}],name:[{required:!0,message:"请输入报告名称",trigger:"blur"}],templatename:[{required:!0,message:"请选择报告模板",trigger:"change"}]},activePopShow:!1,border:!0,height:980,stripe:!0,lineHeight:"medium",checkList:["mission name","Inspection number","Inspection template","testbed","Trade Names","Creation time","Starting time","end time"],columns:[{label:"mission name",width:"auto",prop:"name",sortable:!0},{label:"Inspection template",width:"auto",prop:"profile.wordtemplatename",sortable:!0},{label:"testbed",width:"auto",prop:"profile.testbed",sortable:!0},{label:"Starting time",width:"180",prop:"starttime",sortable:!0},{label:"end time",width:"180",prop:"endtime",sortable:!0}],list:{forensics:[],examination:[]},listLoading:!0,queryForm:{pageSizes:[10,20,30,50],limit:10,order:"-createdAt",keys:"count(*)",total:0,skip:0,pageNo:1,pageSize:10,name:""},categorylist:[],wordtemplist:[],grouplist:[],ruleForm:{name:"",templatename:"",testbed:"",testbedid:"",templatenameid:""}}},computed:C($({},Object(d["mapGetters"])({currentDepartment:"user/currentDepartment"})),{dragOptions(){return{animation:600,group:"description"}},finallyColumns(){return this.columns.filter(e=>this.checkList.includes(e.label))}}),created(){this.fetchData()},methods:{handleHistory(e){return x(this,null,(function*(){try{this.evidenceId=e.objectId,this.statisticsVisible=!0,this.$nextTick(()=>{this.$refs["statistics"].evidence(e.objectId)})}catch(t){console.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}}))},paginationQuery(e){return x(this,null,(function*(){this.queryPayload=e}))},categoryChange(e){return x(this,null,(function*(){this.$set(this.ruleForm,"templatenameid",e.objectId)}))},testbedChange(e){this.$set(this.ruleForm,"testbedid",e.objectId),dgiotlog.log("src/views/CloudTest/js/task.js","this.ruleForm",this.ruleForm,e.objectId)},getwordtemp(){return x(this,null,(function*(){const e={skip:0,where:{netType:"Evidence",nodeType:1}},{results:t={}}=yield Object(u["queryProduct"])(e);this.categorylist=t}))},getgroup(){return x(this,null,(function*(){const e={where:{"detail.category":"84abda3154"}},{results:t}=yield Object(n["queryDevice"])(e);this.grouplist=t}))},submitForm(e){const t="role:"+this.currentDepartment.name,a={};a[t]={read:!0,write:!0},this.$refs[e].validate(e=>x(this,null,(function*(){if(!e)return dgiotlog.log("error submit!!"),!1;{const e={profile:{testbedid:this.ruleForm.testbedid,testbed:this.ruleForm.testbed.name,wordtemplatename:this.ruleForm.templatename.name,reportId:this.ruleForm.templatenameid,identifier:"inspectionReportTemp",step:0},parentId:this.ruleForm.testbedid,name:this.ruleForm.name,product:this.ruleForm.templatenameid},t=this.$baseColorfullLoading(1);this.activePopShow=!1,yield Object(c["postreport"])(e),this.fetchData(),t.close()}this.ruleForm={name:"",templatename:"",testbed:"",testbedid:"",templatenameid:""}})))},forensics(e){dgiotlog.warn(e),this.$router.push({path:"/cloudTest/evidence",query:{taskid:e.objectId,suite:0,state:"preview",step:1,back:e.profile.step,message:e.profile.message}})},taskEnd(e){this.$baseConfirm(this.$translateTitle("Maintenance.Are you sure you want to end the current mission"),null,()=>x(this,null,(function*(){try{const t=this.$baseColorfullLoading(),a={profile:_.merge(e.profile,{step:4,endtime:moment(new Date).format("x")})};yield Object(n["putDevice"])(e.objectId,a);this.fetchData(),t.close()}catch(t){dgiotlog.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}})))},taskStart(e){this.$baseConfirm(this.$translateTitle("Maintenance.Are you sure you want to start the current mission"),null,()=>x(this,null,(function*(){try{const t=this.$baseColorfullLoading(),a={profile:_.merge(e.profile,{step:1,starttime:moment(new Date).format("x")})};yield Object(n["putDevice"])(e.objectId,a);this.fetchData(),t.close()}catch(t){dgiotlog.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}})))},downDocx(e){return x(this,null,(function*(){try{const t=document.createElement("a");t.setAttribute("href",this.$FileServe+e),t.setAttribute("download","download"),t.click()}catch(t){dgiotlog.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}}))},handleUnderreview(e){return x(this,null,(function*(){try{this.$router.push({path:"/cloudTest/evidence",query:{taskid:e,suite:0,state:"preview",step:3}})}catch(t){dgiotlog.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}}))},handleRouter(e){return x(this,null,(function*(){try{this.$router.push({path:"/cloudTest/evidence",query:{taskid:e.objectId,suite:0,state:"preview",step:e.profile.step,back:e.profile.step,message:e.profile.message,disable:!0}})}catch(t){console.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}}))},handleEvidence(e){return x(this,null,(function*(){this.evidences=[];try{const t={order:"-createdAt",skip:0,where:{"original.taskid":e,reportId:{$ne:e}}},a=this.$baseColorfullLoading(),{results:i}=yield Object(h["queryEvidence"])(t);(null==i?void 0:i.length)&&i.forEach(e=>{e.original.path="/dgiot_file"+e.original.path.split("/dgiot_file")[1]}),this.evidenceDialog=!0,this.evidences=i,console.log(i),this.$baseMessage(this.$translateTitle("alert.Data request successfully"),"success","dgiot-hey-message-success"),a.close()}catch(t){console.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}}))},handleReport(e){return x(this,null,(function*(){if(4==e.profile.step&&e.profile.docx){const t=this.$FileServe+e.profile.docx;return this.dialogVisible=!0,this.officeapps="https://view.officeapps.live.com/op/view.aspx?src="+t,!1}try{const t=this.$baseColorfullLoading(),{code:a,msg:i,path:s}=yield Object(h["generatereport"])(e.objectId);200==a&&s?(this.$baseMessage(this.$translateTitle("alert.Data request successfully"),"success","dgiot-hey-message-success"),setTimeout(()=>{const t={profile:_.merge(e.profile,{step:4,docx:s})},a=(Object(n["putDevice"])(e.objectId,t),this.$FileServe+s);this.dialogVisible=!0,this.officeapps="https://view.officeapps.live.com/op/view.aspx?src="+a,this.fetchData()},1200)):this.$baseMessage(""+i,"error","dgiot-hey-message-error"),t.close()}catch(t){dgiotlog.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}}))},handleCloseAmis(){this.coordinate={lng:116.404,lat:39.915},this.dialog_device=!1,this.management.dialog=!1},handleManagement(e){return x(this,null,(function*(){this.$refs["lowcodeDesign"].withHeader=!0,localStorage.setItem("parse_objectid",e.objectId);const t={where:{type:"amis_view",key:e.objectId}},{results:a=[]}=yield Object(m["queryView"])(t);if(console.log(a),_.isEmpty(a))return this.$baseMessage("暂未配置检测项","info","dgiot-hey-message-error"),!1;this.management.dialog=!0,this.management.data=a}))},handleDelete(e){return x(this,null,(function*(){try{const t=this.$baseColorfullLoading();yield Object(n["delDevice"])(e);this.$baseMessage(this.$translateTitle("user.successfully deleted"),"success","dgiot-hey-message-success"),t.close(),this.fetchData()}catch(t){dgiotlog.log(t),this.$baseMessage(this.$translateTitle("user.error deleted")+""+t,"error","dgiot-hey-message-error")}}))},fetchData(){return x(this,null,(function*(){this.list={forensics:[],examination:[]},this.getwordtemp(),this.getgroup(),this.queryPayload.include="product,parentId",this.queryPayload.where={"profile.identifier":"inspectionReportTemp",name:this.queryForm.name.length?{$regex:this.queryForm.name}:{$ne:null},"profile.step":{$regex:"^(-1|[2-9]\\d*)$"}},this.listLoading=!0;const{count:e=0,results:t=[]}=yield Object(n["queryDevice"])(this.queryPayload);this.$refs["examination"].ination.total=e,t.forEach(e=>{e.endtime=e.profile.endtime?moment(Number(e.profile.endtime)).format("YYYY-MM-DD HH:mm:ss"):"",e.starttime=e.profile.starttime?moment(Number(e.profile.starttime)).format("YYYY-MM-DD HH:mm:ss"):"",e.createdAt=moment(e.createdAt).format("YYYY-MM-DD HH:mm:ss"),this.list.examination.push(e)}),this.listLoading=!1}))}}},T=k,D=(i("b755"),i("2877")),q=Object(D["a"])(T,s,r,!1,null,null,null);a["default"]=q.exports},"22a5":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"mqttws"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.msg,expression:"msg"}],attrs:{id:"msg",type:"text"},domProps:{value:e.msg},on:{input:function(t){t.target.composing||(e.msg=t.target.value)}}}),t("input",{attrs:{type:"button",value:"Send"},on:{click:e.send}}),t("input",{attrs:{type:"button",value:"Start"},on:{click:e.start}}),t("input",{attrs:{type:"button",value:"Stop"},on:{click:e.stop}})])},s=[],r={name:"Mqttws",data(){return{host:location.hostname,port:5080,clientId:"C_"+(new Date).getTime(),userName:"test",password:"test123",keepAlive:null,cleanSession:!0,useSSL:!1,client:{},options:{},msg:"order",count:0}},created(){this.client=new Paho.MQTT.Client(this.host,this.port,this.clientId),dgiotlog.log(this.client);var e=this.client,t=this.options={invocationContext:{host:this.host,port:this.port,path:e.path,clientId:this.clientId},timeout:5,keepAliveInterval:50,cleanSession:!1,useSSL:!1,userName:"test",password:"test123",onSuccess:function(){dgiotlog.log("onConnected"),e.subscribe("001/in")},onFailure:function(e){dgiotlog.log(e)}};this.client.connect(t),this.client.onConnectionLost=this.onConnectionLost,this.client.onMessageArrived=this.onMessageArrived},methods:{onConnectionLost:function(e){0!==e.errorCode&&(dgiotlog.log("onConnectionLost:"+e.errorMessage),dgiotlog.log("连接已断开"))},onMessageArrived:function(e){dgiotlog.log("收到消息:"+e.payloadString)},onConnect:function(){dgiotlog.log("onConnected"),this.client.subscribe("001/in")},send:function(){var e=this.msg;if(e){e="{Time:"+new Date+", content:"+e+", from: web console}";var t=new Paho.MQTT.Message(e);t.destinationName=this.topic,this.client.send(t),this.msg=""}},start:function(){window.tester=window.setInterval(function(){if(this.client.isConnected){var e="{Time:"+new Date+", content:"+this.count+++", from: web console}",t=new Paho.MQTT.Message(e);t.destinationName=this.topic,this.client.send(t)}}.bind(this),1e3)},stop:function(){window.clearInterval(window.tester)}}},o=r,l=a("2877"),n=Object(l["a"])(o,i,s,!1,null,null,null);t["default"]=n.exports},2993:function(e,t,a){},"2b93":function(t,a,i){"use strict";i.r(a);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"logs logs-container"},[t("a-row",{staticClass:"logs-row"},[t("a-col",{staticClass:"logs-row-tree",style:{height:Number(e.$baseTableHeight(0))+105+"px"},attrs:{lg:6,md:6,sm:24,xl:4,xs:24,xxl:4}},[e.logTree.length?t("a-tree",{staticClass:"logs-row-tree-antd",attrs:{"auto-expand-parent":!0,"block-node":!0,"default-expand-all":!0,"show-icon":!0,"show-line":!0,"tree-data":e.logTree},on:{rightClick:e.onRightClick,select:e.onSelect},scopedSlots:e._u([{key:"title",fn:function({objectId:a,name:i,objectId:s,type:r}){return[t("a-dropdown",{attrs:{disabled:!e.disableType.includes(r),trigger:["contextmenu"]},on:{click:function(t){return e.subLog()}},scopedSlots:e._u([{key:"overlay",fn:function(){return[t("a-menu",{key:s,attrs:{size:"mini"},on:{click:function(t){return t.target!==t.currentTarget?null:(({key:t})=>e.onContextMenuClick(a,t)).apply(null,arguments)}}},[t("a-menu-item",[e._v(" "+e._s(e.$translateTitle("Logs.log lever"))+" "),t("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini"},on:{change:e.handleChange},model:{value:e.defaultLever,callback:function(t){e.defaultLever=t},expression:"defaultLever"}},e._l(e.leverData,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1)]},proxy:!0}],null,!0)},[t("span",{attrs:{title:i}},[t("a-icon",{attrs:{slot:"icon",theme:"twoTone","two-tone-color":"#52c41a",type:"check-circle"},slot:"icon"}),e._v(" "+e._s(i)+" ")],1)])]}}],null,!1,740860110)}):e._e()],1),t("a-col",{staticClass:"logs-row-table",class:{"dgiot-fullscreen":e.isFullscreen},style:{height:Number(e.$baseTableHeight(0))+25+"px"},attrs:{lg:18,md:18,sm:24,xl:20,xs:24,xxl:20}},[t("a-tabs",{attrs:{"default-active-key":"editor"}},[t("a-tab-pane",{key:"editor"},[t("span",{attrs:{slot:"tab"},slot:"tab"},[t("dgiot-icon",{attrs:{icon:"aspect-ratio-fill"}}),e._v(" "+e._s(e.$translateTitle("Logs.console"))+" ")],1),t("dgiot-editor",{key:e.key,attrs:{height:e.isFullscreen?1080:1040,lang:"json","max-lines":(e.isFullscreen,1e3/12),"min-lines":(e.isFullscreen,1e3/12),theme:"gob"},model:{value:e.clickItem,callback:function(t){e.clickItem=t},expression:"clickItem"}})],1),t("a-tab-pane",{key:"table"},[t("span",{attrs:{slot:"tab"},slot:"tab"},[t("dgiot-icon",{attrs:{icon:"table-2"}}),e._v(" "+e._s(e.$translateTitle("Logs.table"))+" ")],1),t("dgiot-query-form",[t("dgiot-query-form-left-panel",[t("el-button",{staticStyle:{margin:"0 10px 10px 10px !important"},attrs:{type:"success"},on:{click:e.handleHeight}},[t("dgiot-icon",{attrs:{icon:e.isFullscreen?"fullscreen-exit-fill":"fullscreen-fill"}})],1),t("el-popover",{attrs:{trigger:"hover"},scopedSlots:e._u([{key:"reference",fn:function(){return[t("el-button",{staticStyle:{margin:"0 0 10px 0 !important"},attrs:{icon:"el-icon-setting",type:"primary"}},[e._v(" "+e._s(e.$translateTitle("Logs.Draggable column settings"))+" ")])]},proxy:!0}])},[t("el-checkbox-group",{model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},[t("dgiot-draggable",{attrs:{list:e.logcolumns}})],1)],1)],1)],1),t("el-table",{key:e.key,ref:"dragTable",attrs:{border:"",data:e.scroketMsg.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize),"default-expand-all":"",height:e.height,"highlight-current-row":"",resizable:"",size:"mini",stripe:""},scopedSlots:e._u([{key:"empty",fn:function(){return[t("dgiot-empty")]},proxy:!0}])},[t("el-table-column",{attrs:{align:"center",fixed:"left",label:e.$translateTitle("equipment.serialnumber"),"show-overflow-tooltip":"",width:"55"},scopedSlots:e._u([{key:"default",fn:function({$index:t}){return[e._v(" "+e._s(t+1)+" ")]}}])}),t("el-table-column",{attrs:{align:"center",fixed:"left",label:"time",prop:"time","show-overflow-tooltip":"",sortable:"",width:"160"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(" "+e._s(e.$moment(Number(a.time.toString().substring(0,13))).format("YYYY-MM-DD HH:mm:ss.SSS"))+" ")])]}}])}),e._l(e.finallyColumns,(function(a,i){return t("el-table-column",{directives:[{name:"show",rawName:"v-show",value:"msg"!=a,expression:"item != 'msg'"}],key:i,attrs:{align:"center",label:a,prop:a,"show-overflow-tooltip":"",sortable:"",width:e.w80.includes(a)?80:e.Wh120.includes(a)?120:180}})})),t("el-table-column",{attrs:{align:"center",fixed:"right",label:"msg",prop:"msg","show-overflow-tooltip":"",sortable:""}})],2),t("el-pagination",{attrs:{"current-page":e.currentPage,layout:"total, sizes, prev, pager, next, jumper","page-size":e.pageSize,"page-sizes":[10,20,30,50,100],total:e.scroketMsg.length},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)],1)],1)],1)],1)},r=[],o=i("d292"),l=(t,a,i)=>new Promise((s,r)=>{var o=t=>{try{n(i.next(t))}catch(e){r(e)}},l=t=>{try{n(i.throw(t))}catch(e){r(e)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,l);n((i=i.apply(t,a)).next())}),n={name:"RealLog",data(){return{logMqtt:{channeltopic:"",key:moment(new Date).valueOf()},key:moment(new Date).valueOf(),subtopic:"",topicKey:"",router:"",currentPage:1,pageSize:20,isFullscreen:!1,leverData:["debug","info","notice","warning","error","crtical","alert","emergency"],disableType:["system","app","module"],dataRef:{},defaultLever:"",queryForm:{},logTree:[],clickItem:"",height:this.$baseTableHeight(1),checkList:["pid","level","gl","mfa"],logcolumns:["topic","pid","peername","level","gl","clientid","mfa"],w80:["line","level"],Wh120:["pid","level","domain","gl"],Wh200:["time","clientid","peername"],scroketMsg:[]}},computed:{dragOptions(){return{animation:600,group:"description"}},finallyColumns(){return this.logcolumns.filter(e=>this.checkList.includes(e))},treeQueryForm:function(){return{province:"",class:"LogLevel",filter:'{"keys":["parent","name","level","name","order","type","topic"],"where":{}}',parent:"parent"}}},watch:{},mounted(){this.router=this.$dgiotBus.router(this.$route.fullPath),this.getTree(this.treeQueryForm)},methods:{handleSizeChange(e){this.pageSize=e},handleCurrentChange(e){this.currentPage=e},onSelect(e,t){dgiotlog.log("selected",e,t.node.dataRef),this.dataRef=t.node.dataRef,dgiotlog.log(t.node.dataRef),this.defaultLever=this.dataRef.level,this.subLog()},handleHeight(){this.isFullscreen=!this.isFullscreen,this.isFullscreen?this.height=this.$baseTableHeight(1)+120:this.height=this.$baseTableHeight(1)},onRightClick(e){this.clickItem="",this.dataRef=e.node.dataRef,dgiotlog.log(e.node.dataRef),this.defaultLever=this.dataRef.level},onContextMenuClick(e,t){switch(t){case"Level":break}dgiotlog.log(e,t)},getTree(e){return l(this,null,(function*(){try{const t=this.$baseColorfullLoading(),{results:a=[]}=yield Object(o["post_tree"])(e);this.logTree=a,t.close(),this.$baseMessage(this.$translateTitle("alert.Data request successfully"),"success","dgiot-hey-message-success")}catch(t){dgiotlog.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}}))},handleChange(e){return l(this,null,(function*(){try{const{type:t,name:a}=this.dataRef,i=this.$baseColorfullLoading(),s={type:t,name:a,level:e};yield Object(o["putLogLevel"])(s);this.getTree(this.treeQueryForm),i.close()}catch(t){dgiotlog.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}dgiotlog.log(e)}))},subLog(){return l(this,null,(function*(){this.clickItem="",this.scroketMsg=[],this.key=moment(new Date).valueOf(),this.dataRef.objectId&&(this.subtopic=""+this.dataRef.topic,this.topicKey=this.$dgiotBus.topicKey(this.router,this.subtopic),yield this.$subscribe(this.subtopic),console.log(this.$mqttInfo),console.warn("订阅mqtt",this.subtopic),this.$baseMessage(this.subtopic+this.$translateTitle("websocket.subscribeSuccess"),"success",!1,"dgiot-hey-message-success"),this.$baseNotify(this.subtopic,"topic:","success","",5e3),this.handleMqttMsg())}))},handleMqttMsg(){this.scroketMsg=[],this.clickItem="",this.$dgiotBus.$off(this.$mqttInfo.topicKey),this.$dgiotBus.$on(this.$mqttInfo.topicKey,e=>{dgiotlog.log("收到消息",e),e.payloadString&&(this.scroketMsg.push(JSON.parse(e.payloadString)),this.key=moment(new Date).valueOf(),this.clickItem=JSON.stringify(this.scroketMsg,null,2))})}}},c=n,d=(i("4d86"),i("2877")),u=Object(d["a"])(c,s,r,!1,null,"67a70898",null);a["default"]=u.exports},"351b":function(t,a,i){"use strict";i.r(a);var s=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{ref:"custom-table",staticClass:"custom-table-container"},[t("div",{staticClass:"components"},[t("a-drawer",{attrs:{"mask-closable":!1,placement:"right",visible:e.visible,width:"100%"},on:{close:function(t){return e.saveHistorical(e.collectionInfo,e.thingcolumns,e.thingdata,!0)}}},[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:12}},[t("el-divider",[e._v("采集数据")]),t("el-table",{key:e.thingdata.length,staticStyle:{"min-height":"280px"},attrs:{border:"",data:e.thingdata}},[t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("cloudTest.number"),"show-overflow-tooltip":"",width:"50"},scopedSlots:e._u([{key:"default",fn:function({$index:t}){return[e._v(" "+e._s(t+1)+" ")]}}])}),e._l(e.thingcolumns,(function(a,i){return t("el-table-column",{key:i,attrs:{align:"center",label:e.$translateTitle("cloudTest."+a.label),prop:a.prop,"show-overflow-tooltip":"",sortable:"",width:"auto"}})}))],2)],1),e.collectionInfo.name?t("el-col",{attrs:{span:12}},[t("el-divider",[e._v("检测信息")]),t("el-card",[t("div",{staticClass:"setting"},[t("el-button",{attrs:{type:"success"},nativeOn:{click:function(t){return e.collection(e.collectionInfo)}}},[e._v(" 采集数据 ")]),t("el-button",{attrs:{disabled:0==e.thingdata.length,type:"primary"},nativeOn:{click:function(t){return e.drawxnqx(e.collectionInfo.objectId,e.thingdata)}}},[e._v(" 存储数据 ")]),t("el-button",{attrs:{type:"info"},nativeOn:{click:function(t){return e.handleManagement(e.collectionInfo)}}},[e._v(" 任务配置 ")]),t("el-button",{nativeOn:{click:function(t){return e.startOpc(e.collectionInfo)}}},[e._v(" 任务下发 ")]),t("el-button",{attrs:{type:"warning"},nativeOn:{click:function(t){return e.saveHistorical(e.collectionInfo,e.thingcolumns,e.thingdata,!1)}}},[e._v(" 保存数据 ")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){e.visible=!1}}},[e._v(" 退出采集 ")])],1),t("a-descriptions",{attrs:{bordered:""}},[t("a-descriptions-item",{attrs:{label:"当前时间",span:12}},[e._v(" "+e._s(e.nowTime)+" ")]),t("a-descriptions-item",{attrs:{label:"检测台体",span:8}},[e._v(" "+e._s(e.collectionInfo.profile.testbed)+" ")]),t("a-descriptions-item",{attrs:{label:"检测任务",span:4}},[e._v(" "+e._s(e.collectionInfo.name)+" ")])],1)],1)],1):e._e()],1),t("el-row",{attrs:{gutter:24}},[t("el-col",{staticStyle:{"margin-top":"20px"},attrs:{span:12}},[t("el-divider",[e._v("存储的数据")]),t("el-table",{key:e.historyEvidence.length,staticStyle:{"min-height":"530px"},attrs:{border:"",data:e.historyEvidence}},[t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("cloudTest.number"),"show-overflow-tooltip":"",width:"50"},scopedSlots:e._u([{key:"default",fn:function({$index:t}){return[e._v(" "+e._s(t+1)+" ")]}}])}),e._l(e.historycolumns,(function(a,i){return t("el-table-column",{key:i,attrs:{align:"center",label:e.$translateTitle("cloudTest."+a.label),prop:a.prop,"show-overflow-tooltip":"",sortable:"",width:"auto"}})})),t("el-table-column",{attrs:{align:"center",label:"操作",width:"60"},scopedSlots:e._u([{key:"default",fn:function({row:a,$index:i}){return[t("el-button",{staticClass:"el-icon-delete",attrs:{type:"text"},nativeOn:{click:function(t){return e.deleteHistory(a,i)}}})]}}])})],2)],1),t("el-col",{staticStyle:{"margin-top":"20px"},attrs:{span:12}},[t("el-divider",[e._v("其他数据")]),t("el-tabs",{on:{"tab-click":e.tabHandleClick},model:{value:e.activeName1,callback:function(t){e.activeName1=t},expression:"activeName1"}},[t("el-tab-pane",{attrs:{label:e.$translateTitle("equipment.realTime data"),name:"first"}},[t("div",{staticClass:"thirdtb"},[t("el-row",{key:e.thirdtbKey},e._l(e.machinelist,(function(a,i,s){return t("el-descriptions",{key:s,attrs:{border:"",column:4,title:i}},e._l(a,(function(a,i){return t("el-descriptions-item",{key:i},[t("div",{staticStyle:{height:"40px"}},[t("span",{staticStyle:{"font-size":"16px"}},[e._v(" "+e._s(a.name)+" ")]),t("span",{staticStyle:{float:"right","margin-top":"10px","margin-right":"15px"}},[t("el-image",{staticStyle:{width:"60px",height:"60px"},attrs:{src:a.imgurl}},[t("div",{staticClass:"image-slot",staticStyle:{width:"60px",height:"60px"},attrs:{slot:"error"},slot:"error"},[t("i",{staticClass:"el-icon-picture-outline"})])])],1)]),t("div",{staticClass:"stla"},[t("span",{attrs:{title:e._f("filterVal")(a.number)}},[e._v(" "+e._s(e._f("filterVal")(a.number))+" ")]),a.unit?t("span",{attrs:{title:a.unit}},[e._v(" "+e._s(a.unit)+" ")]):e._e()]),t("div",{staticClass:"ta"},[t("span",{staticClass:"fontSize"},[e._v(" "+e._s(e.$translateTitle("equipment.updatetime")+":")+" ")]),t("span",{staticClass:"fontSize",on:{click:function(t){return e.print(e.machinelist)}}},[e._v(" "+e._s(a.time)+" ")])])])})),1)})),1)],1)]),t("el-tab-pane",{attrs:{label:e.$translateTitle("equipment.chart"),name:"second"}},[t("el-card",[t("el-image",{key:e.drawxnqxPath,attrs:{"preview-src-list":[e.$FileServe+e.drawxnqxPath],src:e.$FileServe+e.drawxnqxPath}},[t("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[t("el-image",{staticClass:"dgiot-data-empty",attrs:{src:i("c2ad")}})],1)])],1)],1)],1)],1)],1)],1),t("el-drawer",{directives:[{name:"drawerDrag",rawName:"v-drawerDrag"}],attrs:{"append-to-body":"",size:"80%",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("iframe",{staticStyle:{width:"100%",height:"100%"},attrs:{src:e.officeapps}})]),t("dgiot-dialog",{attrs:{show:e.activePopShow},on:{"update:show":function(t){e.activePopShow=t}}},[t("h2",{attrs:{slot:"title"},slot:"title"},[e._v(" "+e._s(e.$translateTitle("cloudTest.addwordtask"))+" ")]),t("div",{staticClass:"content"},[t("el-divider",[e._v(" "+e._s(e.$translateTitle("cloudTest.Basic information of inspection tasks"))+" ")]),t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{"element-loading-background":"rgba(0, 0, 0, 0.8)","element-loading-spinner":"el-icon-loading","element-loading-text":e.$translateTitle("developer.Waitingtoreturn"),"label-width":"100px",model:e.ruleForm,rules:e.rules,size:"mini"}},[t("el-form-item",{attrs:{label:e.$translateTitle("cloudTest.taskname"),prop:"name"}},[t("el-input",{model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),t("el-form-item",{attrs:{label:e.$translateTitle("cloudTest.wordtemplate"),prop:"templatename"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("task.Select"),"value-key":"objectId"},on:{change:e.categoryChange},model:{value:e.ruleForm.templatename,callback:function(t){e.$set(e.ruleForm,"templatename",t)},expression:"ruleForm.templatename"}},e._l(e.categorylist,(function(e){return t("el-option",{key:e.objectId,attrs:{label:e.name,value:e}})})),1)],1),t("el-form-item",{attrs:{label:e.$translateTitle("cloudTest.testbed"),prop:"testbed"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("task.Select"),"value-key":"objectId"},on:{change:e.testbedChange},model:{value:e.ruleForm.testbed,callback:function(t){e.$set(e.ruleForm,"testbed",t)},expression:"ruleForm.testbed"}},e._l(e.grouplist,(function(e){return t("el-option",{key:e.objectId,attrs:{label:e.name,value:e}})})),1)],1)],1),t("div",{staticStyle:{"text-align":"right"},attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.submitForm("ruleForm")}}},[t("i",{staticClass:"el-icon-finished"},[e._v(" "+e._s(e.$translateTitle("product.createnow"))+" ")])])],1)],1)])],1),t("dgiot-query-form",[t("dgiot-query-form-left-panel",[t("el-form",{ref:"form",attrs:{inline:!0,model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",[t("el-input",{attrs:{placeholder:e.$translateTitle("cloudTest.Please select review status")},model:{value:e.queryForm.name,callback:function(t){e.$set(e.queryForm,"name",t)},expression:"queryForm.name"}})],1),t("el-form-item",[t("el-button",{attrs:{icon:"el-icon-search","native-type":"submit",type:"primary"},nativeOn:{click:function(t){return e.fetchData()}}},[e._v(" "+e._s(e.$translateTitle("cloudTest.search"))+" ")]),t("el-button",{attrs:{icon:"el-icon-plus",type:"primary"},nativeOn:{click:function(t){e.activePopShow=!e.activePopShow}}},[e._v(" "+e._s(e.$translateTitle("cloudTest.add task"))+" ")])],1)],1)],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableSort",attrs:{border:e.border,data:e.list.forensics,size:e.lineHeight,stripe:e.stripe},scopedSlots:e._u([{key:"empty",fn:function(){return[t("el-image",{staticClass:"dgiot-data-empty",attrs:{src:i("c2ad")}})]},proxy:!0}])},[t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("cloudTest.number"),width:"50px"},scopedSlots:e._u([{key:"default",fn:function({$index:t}){return[e._v(" "+e._s(t+1)+" ")]}}])}),t("el-table-column",{attrs:{align:"center",label:"任务名称",prop:"name","show-overflow-tooltip":"",sortable:""}}),t("el-table-column",{attrs:{align:"center",label:"报告模板",prop:"profile.wordtemplatename","show-overflow-tooltip":"",sortable:""}}),t("el-table-column",{attrs:{align:"center",label:"测试台体",prop:"name","show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[a.profile.testbed?t("span",[e._v(e._s(a.profile.testbed))]):t("el-form",{attrs:{model:a}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("task.Select"),"value-key":"objectId"},on:{change:t=>{e.changetestbed(t,a)}},model:{value:a.profile.testbed,callback:function(t){e.$set(a.profile,"testbed",t)},expression:"row.profile.testbed"}},e._l(e.grouplist,(function(e){return t("el-option",{key:e.objectId,attrs:{label:e.name,value:e}})})),1)],1)]}}])}),e._l(e.finallyColumns,(function(a,i){return t("el-table-column",{key:i,attrs:{align:"center",label:e.$translateTitle("cloudTest."+a.label),prop:a.prop,"show-overflow-tooltip":"",sortable:a.sortable,width:a.width}})})),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("deviceLog.status"),width:"120"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-popover",{directives:[{name:"show",rawName:"v-show",value:-1==a.profile.step,expression:"row.profile.step == -1"}],attrs:{placement:"top-start",trigger:"hover"},scopedSlots:e._u([{key:"reference",fn:function(){return[t("el-tag",{attrs:{effect:"dark",type:"danger"}},[e._v(" "+e._s(e.$translateTitle("cloudTest.notapproved"))+" ")])]},proxy:!0}],null,!0)},[e._v(" "+e._s(a.profile.message)+" ")]),t("el-tag",{directives:[{name:"show",rawName:"v-show",value:-1!=a.profile.step,expression:"row.profile.step != -1"}],attrs:{effect:"dark",type:["info","warning","primary","primary"][a.profile.step?a.profile.step:0]}},[e._v(" "+e._s([e.$translateTitle("product.notstarted"),e.$translateTitle("product.testing"),e.$translateTitle("product.pending review"),e.$translateTitle("product.finishtest"),e.$translateTitle("product.review completed")][a.profile.step]||e.$translateTitle("product.finishtest"))+" ")])]}}])}),t("el-table-column",{attrs:{align:"center",fixed:"right",label:e.$translateTitle("cloudTest.operate"),width:"280"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-button",{directives:[{name:"show",rawName:"v-show",value:0==a.profile.step&&e.$lodash.isEmpty(a.basedata),expression:"row.profile.step == 0 && $lodash.isEmpty(row.basedata)"}],attrs:{size:"mini",type:"success"},nativeOn:{click:function(t){return e.handleManagement(a)}}},[e._v(" "+e._s(e.$translateTitle("task.Configuration"))+" ")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:0==a.profile.step&&!e.$lodash.isEmpty(a.basedata),expression:"row.profile.step == 0 && !$lodash.isEmpty(row.basedata)"}],attrs:{size:"mini",type:"info"},nativeOn:{click:function(t){return e.taskStart(a)}}},[e._v(" "+e._s(e.$translateTitle("task.start"))+" ")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:1==a.profile.step||-1==a.profile.step,expression:"row.profile.step == 1 || row.profile.step == -1"}],attrs:{size:"mini",type:"success"},nativeOn:{click:function(t){return e.visibleInfo(a)}}},[e._v(" "+e._s(e.$translateTitle("task.dataacquisition"))+" ")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:1==a.profile.step||-1==a.profile.step,expression:"row.profile.step == 1 || row.profile.step == -1"}],attrs:{size:"mini",type:"warning"},nativeOn:{click:function(t){return e.forensics(a)}}},[e._v(" "+e._s(1==a.profile.step?e.$translateTitle("cloudTest.forensics"):e.$translateTitle("cloudTest.re-review"))+" ")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:a.profile.step<=1,expression:"row.profile.step <= 1"}],attrs:{size:"mini",type:"danger"},nativeOn:{click:function(t){return e.handleDelete(a.objectId)}}},[e._v(" "+e._s(e.$translateTitle("cloudTest.delete"))+" ")])]}}])})],2),t("dgiot-parser-pagination",{key:e.list.forensics.length+"forensics",ref:"forensics",attrs:{pagination:e.paginations,"query-payload":e.queryPayload},on:{pagination:e.fetchData,paginationQuery:e.paginationQuery}}),t("lowcode-design",{ref:"lowcodeDesign",on:{objectId:e.lowcodeId}}),t("el-dialog",{attrs:{"append-to-body":"","before-close":e.handleCloseAmis,center:"",top:"5vh",visible:e.management.dialog,width:"80%"},on:{"update:visible":function(t){return e.$set(e.management,"dialog",t)}}},[t("el-tabs",{model:{value:e.managementactiveName,callback:function(t){e.managementactiveName=t},expression:"managementactiveName"}},e._l(e.management.data,(function(e,a){return t("el-tab-pane",{key:a+"i",attrs:{label:e.title,name:a+""}},[t("dgiot-amis",{attrs:{schema:e.data,"show-help":!1}})],1)})),1)],1)],1)},r=[],o=i("209d"),l=i("1285"),n=i("227e"),c=i("cdef"),d=i("5880"),u=i("7212"),m=i("8ba7"),h=i("c008"),p=i("c32d"),g=i.n(p),f=Object.defineProperty,b=Object.defineProperties,y=Object.getOwnPropertyDescriptors,v=Object.getOwnPropertySymbols,w=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable,C=(e,t,a)=>t in e?f(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,x=(e,t)=>{for(var a in t||(t={}))w.call(t,a)&&C(e,a,t[a]);if(v)for(var a of v(t))$.call(t,a)&&C(e,a,t[a]);return e},I=(e,t)=>b(e,y(t)),k=(t,a,i)=>new Promise((s,r)=>{var o=t=>{try{n(i.next(t))}catch(e){r(e)}},l=t=>{try{n(i.throw(t))}catch(e){r(e)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,l);n((i=i.apply(t,a)).next())}),T={name:"TaskIndex",filters:{filterVal(e){return e||0==e?e:"--"}},components:{lowcodeDesign:o["default"]},data(){var e,t;return{management:{dialog:!1,data:{}},managementactiveName:"0",dialog_device:!1,machinelist:{},historyEvidenceid:"",nowTime:window.datetime,historyEvidence:[],historyInfo:{},thirdtbKey:g()(new Date).valueOf(),original:{},collectionInfo:{},drawxnqxPath:"",profiledrawxnqxPath:"",thingdata:[],realtimedata:[],thingcolumns:[],historycolumns:[],historydata:[],visible:!1,router:"",topicKey:"",activeName1:"first",activeName:(null==(t=null==(e=null==this?void 0:this.$route)?void 0:e.query)?void 0:t.tabs)&&"examination"==this.$route.query.tabs?"examination":"forensics",officeapps:"",dialogVisible:!1,paginations:{layout:"total, sizes, prev, pager, next, jumper"},queryPayload:{excludeKeys:"data",include:"",order:"-createdAt",limit:10,skip:0,count:"objectId"},lowcodeId:"",loading:!1,options:[{value:"Underreview",label:"审核中"},{value:"finishreview",label:"审核完成"}],rules:{testbed:[{required:!0,message:"请选择测试台体",trigger:"blur"}],name:[{required:!0,message:"请输入报告名称",trigger:"blur"}],templatename:[{required:!0,message:"请选择报告模板",trigger:"change"}]},activePopShow:!1,border:!0,height:980,stripe:!0,lineHeight:"medium",checkList:["Inspection template","testbed","Trade Names","Creation time","Starting time","end time"],columns:[{label:"Starting time",width:"180",prop:"starttime",sortable:!0},{label:"end time",width:"180",prop:"endtime",sortable:!0}],list:{forensics:[],examination:[]},listLoading:!0,queryForm:{pageSizes:[10,20,30,50],limit:10,order:"-createdAt",keys:"count(*)",total:0,skip:0,pageNo:1,pageSize:10,name:""},categorylist:[],wordtemplist:[],grouplist:[],ruleForm:{name:"",templatename:"",testbed:"",testbedid:"",templatenameid:""}}},computed:I(x({},Object(d["mapGetters"])({currentDepartment:"user/currentDepartment"})),{dragOptions(){return{animation:600,group:"description"}},finallyColumns(){return this.columns.filter(e=>this.checkList.includes(e.label))}}),created(){this.fetchData()},mounted(){this.historyEvidence=[],this.historyInfo={},this.router=this.$dgiotBus.router(this.$route.fullPath),this.$dgiotBus.$off("lowcodeClose"),this.$dgiotBus.$on("lowcodeClose",e=>{this.fetchData()}),this.timer=setInterval(()=>{this.datetime()},1e3)},methods:{tabHandleClick(e){switch(e.name){case"first":break;case"second":break}},CardDevice(e){var t=this;Object(l["getCardDevice"])(e).then(e=>{t.machinelist={},(null==e?void 0:e.data)&&t.renderCard(e.data)}).catch(e=>{dgiotlog.log("update error 清除timer",e)})},subRealtimedata(e){return k(this,null,(function*(){this.router=this.$dgiotBus.router(location.href+this.$route.fullPath);let t=`$dg/user/realtimecard/${e.parentId.objectId}/report`;try{yield this.$subscribe(t),this.$dgiotBus.$off(this.$mqttInfo.topicKey),this.$dgiotBus.$on(this.$mqttInfo.topicKey,t=>{const{data:a=[]}=JSON.parse(Base64.decode(t.payloadString));this.renderCard(a),e.profile.istcp&&Object(l["getDevice"])(e.objectId).then(e=>{this.historyEvidence=e.profile.historicaldata,this.drawxnqxPath=e.profile.drawxnqxPath}),a?this.collectiontable(a):this.CardDevice()})}catch(a){console.log(a),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+a,"error","dgiot-hey-message-error")}}))},collectiontable(e){let t=this,a={};e.forEach(e=>{this.$set(a,e.identifier,e.number),this.$set(a,"timestamp",e.time)}),_.isEmpty(a)||0!=(null==a?void 0:a.dgiotcollectflag)?t.realtimedata.unshift(a):(t.thingdata=[],console.log(a),t.thingdata[0]=a)},renderCard(e){var t=this;let a=[];e.forEach(e=>{e.devicetype&&"dgiotcollectflag"!=e.identifier&&a.push(e.devicetype)}),a=_.uniqBy(a);let i={};a.forEach(t=>{let a=[];e.forEach(e=>{t==e.devicetype&&a.push(e)}),i[t]=a}),t.machinelist=i,t.thirdtbKey=g()(new Date).valueOf()},datetime(){this.nowTime=g()(new Date).format("YYYY-MM-DD HH:mm:ss")},paginationQuery(e){return k(this,null,(function*(){this.queryPayload=e}))},categoryChange(e){return k(this,null,(function*(){this.$set(this.ruleForm,"templatenameid",e.objectId)}))},testbedChange(e){this.$set(this.ruleForm,"testbedid",e.objectId),console.log("src/views/CloudTest/js/task.js","this.ruleForm",this.ruleForm,e.objectId)},changetestbed(e,t){return k(this,null,(function*(){let a=t.profile;a.testbed=e.name,yield Object(l["putDevice"])(t.objectId,{profile:a,parentId:{__type:"Pointer",className:"Device",objectId:e.objectId}})}))},getwordtemp(){return k(this,null,(function*(){const e={skip:0,where:{netType:"Evidence",nodeType:1}},{results:t={}}=yield Object(u["queryProduct"])(e);this.categorylist=t}))},getgroup(){return k(this,null,(function*(){const e={where:{"detail.category":"84abda3154"}},{results:t}=yield Object(l["queryDevice"])(e);this.grouplist=t}))},deleteHistory(e,t){return k(this,null,(function*(){try{yield this.historyEvidence.splice(t,1),console.log("deleteHistory",e,t,this.historyEvidence,this.historyEvidence.length),yield this.saveHistorical(this.collectionInfo,this.thingdata,this.historyEvidence,!1),yield this.saveThingdata()}catch(a){console.log(a),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+a,"error","dgiot-hey-message-error")}}))},saveThingdata(){return k(this,null,(function*(){try{const e={original:this.historyInfo.original};yield Object(h["putEvidence"])(this.historyInfo.objectId,e)}catch(e){console.log(e),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+e,"error","dgiot-hey-message-error")}}))},submitForm(e){const t="role:"+this.currentDepartment.name,a={};a[t]={read:!0,write:!0},this.$refs[e].validate(e=>k(this,null,(function*(){if(!e)return console.log("error submit!!"),!1;{const e={profile:{testbedid:this.ruleForm.teestbedid,testbed:this.ruleForm.testbed.name,wordtemplatename:this.ruleForm.templatename.name,reportId:this.ruleForm.templatenameid,identifier:"inspectionReportTemp",step:0},parentId:this.ruleForm.testbedid,name:this.ruleForm.name,product:this.ruleForm.templatenameid},t=this.$baseColorfullLoading(1);this.activePopShow=!1,yield Object(c["postreport"])(e),this.fetchData(),t.close()}this.ruleForm={name:"",templatename:"",testbed:"",testbedid:"",templatenameid:""}})))},featHistoryEvidence(e){return k(this,null,(function*(){var t,a;this.historyEvidence=[];try{const i={limit:1,where:{"original.taskid":e,"original.type":"avgs"}},s=this.$baseColorfullLoading(),{results:r=[]}=yield Object(h["queryEvidence"])(i);(null==r?void 0:r.length)?(this.historyEvidence=null!=(t=r[0].original.avgs)?t:this.historydata,this.collectionInfo.profile.historicaldata=this.historyEvidence,this.historyInfo=r[0],this.drawxnqxPath=null!=(a=r[0].original.path)?a:this.profiledrawxnqxPath):(this.historyEvidence=this.historydata,this.drawxnqxPath=this.profiledrawxnqxPath),this.$baseMessage(this.$translateTitle("alert.Data request successfully"),"success","dgiot-hey-message-success"),s.close()}catch(i){console.log(i),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+i,"error","dgiot-hey-message-error")}}))},forensics(e){return k(this,null,(function*(){try{yield this.$router.push({path:"/cloudTest/evidence",query:{taskid:e.objectId,suite:0,state:"preview",step:1,back:e.profile.step,message:e.profile.message}})}catch(t){console.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}}))},taskEnd(e){this.$baseConfirm(this.$translateTitle("Maintenance.Are you sure you want to end the current mission"),null,()=>k(this,null,(function*(){try{const t=this.$baseColorfullLoading(),a={profile:_.merge(e.profile,{step:4,endtime:g()(new Date).format("x")})};yield Object(l["putDevice"])(e.objectId,a);this.fetchData(),t.close()}catch(t){console.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}})))},taskStart(e){let t=this;e.profile.testbed?t.$baseConfirm(t.$translateTitle("Maintenance.Are you sure you want to start the current mission"),null,()=>k(this,null,(function*(){try{const a=t.$baseColorfullLoading();yield t.startOpc(e),yield Object(h["generatereport"])(e.objectId);const i={profile:_.merge(e.profile,{step:1,starttime:g()(new Date).format("x")})};yield Object(l["putDevice"])(e.objectId,i);t.fetchData(),a.close()}catch(a){console.log(a),t.$baseMessage(this.$translateTitle("alert.Data request error")+""+a,"error","dgiot-hey-message-error")}}))):t.$baseMessage("请选择测试台体","waring","dgiot-hey-message-error")},downDocx(e){return k(this,null,(function*(){try{const t=document.createElement("a");t.setAttribute("href",this.$FileServe+e),t.setAttribute("download","download"),t.click()}catch(t){console.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}}))},handleUnderreview(e){return k(this,null,(function*(){try{this.$router.push({path:"/cloudTest/evidence",query:{taskid:e,suite:0,state:"preview",step:3}})}catch(t){console.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}}))},handleReport(e){return k(this,null,(function*(){if(4==e.profile.step&&e.profile.docx){const t=this.$FileServe+e.profile.docx;return this.dialogVisible=!0,this.officeapps="https://view.officeapps.live.com/op/view.aspx?src="+t,!1}try{const t=this.$baseColorfullLoading(),{code:a,msg:i,path:s}=yield Object(h["generatereport"])(e.objectId);200==a&&s?(this.$baseMessage(this.$translateTitle("alert.Data request successfully"),"success","dgiot-hey-message-success"),setTimeout(()=>{const t={profile:_.merge(e.profile,{step:4,docx:s})},a=(Object(l["putDevice"])(e.objectId,t),this.$FileServe+s);this.dialogVisible=!0,this.officeapps="https://view.officeapps.live.com/op/view.aspx?src="+a},1200)):this.$baseMessage(""+i,"error","dgiot-hey-message-error"),t.close()}catch(t){console.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}}))},handleManagement(e){return k(this,null,(function*(){this.$refs["lowcodeDesign"].withHeader=!0,localStorage.setItem("parse_objectid",e.objectId),localStorage.setItem("product_objectid",e.product.objectId);const t={where:{type:"amis",key:e.objectId}},{results:a}=yield Object(m["queryView"])(t);if(console.log("results",a),_.isEmpty(a))return this.$baseMessage("暂未配置任务表单","info","dgiot-hey-message-error"),!1;this.management.dialog=!0,this.management.data=a}))},handleCloseAmis(){this.coordinate={lng:116.404,lat:39.915},this.dialog_device=!1,this.management.dialog=!1},handleDelete(e){return k(this,null,(function*(){try{const t=this.$baseColorfullLoading();yield Object(l["delDevice"])(e);this.$baseMessage(this.$translateTitle("user.successfully deleted"),"success","dgiot-hey-message-success"),t.close(),this.fetchData()}catch(t){console.log(t),this.$baseMessage(this.$translateTitle("user.error deleted")+""+t,"error","dgiot-hey-message-error")}}))},fetchData(){return k(this,null,(function*(){this.list={forensics:[],examination:[]},this.getwordtemp(),this.getgroup(),this.queryPayload.include="product,parentId",this.queryPayload.where={"profile.identifier":"inspectionReportTemp",name:this.queryForm.name.length?{$regex:this.queryForm.name}:{$ne:null},"profile.step":{$regex:"^(-1|[0-9]\\d*)$"}},this.listLoading=!0;const{count:e=0,results:t=[]}=yield Object(l["queryDevice"])(this.queryPayload);this.$refs["forensics"]&&(this.$refs["forensics"].ination.total=e),this.list.forensics=t,t.forEach(e=>{e.profile.step||(e.profile.step=0),e.endtime=e.profile.endtime?g()(Number(e.profile.endtime)).format("YYYY-MM-DD HH:mm:ss"):"",e.starttime=e.profile.starttime?g()(Number(e.profile.starttime)).format("YYYY-MM-DD HH:mm:ss"):"",e.createdAt=g()(e.createdAt).format("YYYY-MM-DD HH:mm:ss")}),this.listLoading=!1}))},visibleInfo(e){return k(this,null,(function*(){let t=this;t.collectionInfo=e,t.CardDevice(e.parentId.objectId),t.subRealtimedata(e);try{const a={},i=[];if(t.thingdata=[],t.realtimedata=[],t.thingcolumns=[],e.basedata)for(let t in e.basedata)if(0==t.indexOf("dgiot_testing_equipment_")){const s=t.split("dgiot_testing_equipment_")[1];a[""+s]=s,i.push(e.basedata[t])}const{table:s=[]}=yield Object(n["postHead"])({items:i,productid:e.parentId.product.objectId});t.thingcolumns=s,t.historycolumns=_.filter(s,(function(e){return"timestamp"!==e.prop})),t.historycolumns&&(t.historycolumns=e.profile.historicaldatacolumns),t.historydata=e.profile.historicaldata,t.profiledrawxnqxPath=e.profile.drawxnqxPath,t.featHistoryEvidence(this.collectionInfo.objectId),t.visible=!0}catch(a){console.log(a),t.$baseMessage(t.$translateTitle("alert.Data request error")+""+a,"error","dgiot-hey-message-error")}}))},startOpc(e){return k(this,null,(function*(){var t;try{var a=[];const{basedata:i=[]}=yield Object(l["getDevice"])(e.objectId);if(!_.isEmpty(i))for(let e in i)0==e.indexOf("dgiot_testing_equipment_")&&a.push(i[e]);const s=`$dg/thing/${e.parentId.objectId}/properties/get/request_id=opc_items`,r={cmd:"opc_items",groupid:e.objectId,opcserver:null!=(t=i.dgiot_testing_opcserver)?t:"Kepware.KEPServerEX.V6",items:a};yield this.$dgiotBus.$emit("MqttPublish",s,JSON.stringify(r),0,!1),console.groupCollapsed("%c 发送开始任务","color:#009a61; font-size: 28px; font-weight: 300"),console.log("message",r),console.log("pubTopic",s),console.groupEnd()}catch(i){console.log(i),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+i,"error","dgiot-hey-message-error")}}))},collection(e){return k(this,null,(function*(){var t;let a=this;a.collectionInfo=e,a.featHistoryEvidence(this.collectionInfo.objectId);try{const{basedata:i=[]}=yield Object(l["getDevice"])(e.objectId),s=`$dg/thing/${e.parentId.objectId}/properties/get/request_id=opc_report`,r={cmd:"opc_report",duration:null!=(t=Number(i.dgiot_sampling_parametric_frequency))?t:5,groupid:e.objectId};console.groupCollapsed("%c 发送采集消息","color:#009a61; font-size: 28px; font-weight: 300"),console.log("message",r),console.log("pubTopic",s),console.groupEnd(),a.$dgiotBus.$emit("MqttPublish",s,JSON.stringify(r),0,!1)}catch(i){console.log(i),a.$baseMessage(a.$translateTitle("alert.Data request error")+""+i,"error","dgiot-hey-message-error")}}))},saveHistorical(e,t,a,i){return k(this,null,(function*(){const s={profile:_.merge(e.profile,{historicaldatacolumns:_.filter(t,(function(e){return"timestamp"!==e.prop})),historicaldata:a,drawxnqxPath:this.drawxnqxPath})};i&&(this.visible=!1);try{const t=this.$baseColorfullLoading();e.profile.istcp||(yield Object(l["putDevice"])(e.objectId,s)),this.$baseMessage(this.$translateTitle("alert.Data request successfully"),"success","dgiot-hey-message-success"),t.close()}catch(r){console.log(r),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+r,"error","dgiot-hey-message-error")}}))},drawxnqx(e,t){return k(this,null,(function*(){var a;this.drawxnqxPath="";try{const i=t,s={data:i,taskid:e},{code:r,error:o="",original:l={},evidenceid:n=""}=yield Object(h["postDrawxnqx"])(s);200==Number(r)?(this.historyEvidenceid=null!=n?n:"",this.historyEvidence=null!=(a=l.avgs)?a:[],this.drawxnqxPath=`${l.path}?t=${g()(new Date).format("x")}`,this.original=null!=l?l:{},this.historycolumns=_.filter(this.thingcolumns,(function(e){return"timestamp"!==e.prop}))):this.$baseMessage(this.$translateTitle("alert.Data request error")+""+o,"error","dgiot-hey-message-error")}catch(i){console.log(i),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+i,"error","dgiot-hey-message-error")}}))},getSummaries(e){const{columns:t,data:a}=e,i=[];return t.forEach((e,t)=>{if(0===t)return void(i[t]="平均值");const s=a.map(t=>Number(t[e.property]));if(s.every(e=>isNaN(e)))i[t]=0;else{let e=0;i[t]=s.reduce((t,a)=>{const i=Number(a);return isNaN(i)?t:(e++,t+a)},0),i[t]=i[t]/e}}),console.log(i),i}},beforeDestroy(){clearInterval(this.timer)}},D=T,q=(i("ae0b"),i("2877")),F=Object(q["a"])(D,s,r,!1,null,null,null);a["default"]=F.exports},3757:function(e,t,a){},"3c04":function(e,t,a){},"3e53":function(e,t,a){},4479:function(e,t,a){e.exports={"menu-color":"rgba(255,255,255,.95)","menu-color-active":"rgba(255,255,255,.95)","menu-background":"#282c34","column-second-menu-background":"#fff"}},4579:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"nodelist"},[t("div",{staticClass:"operation"},[t("el-button",{attrs:{icon:"el-icon-search",type:"primary"}}),t("el-button",{attrs:{icon:"el-icon-delete",type:"danger"}}),t("el-button",{attrs:{icon:"el-icon-date",type:"danger"}})],1)])},s=[],r={data(){return{}},mounted(){},methods:{}},o=r,l=(a("6f31"),a("2877")),n=Object(l["a"])(o,i,s,!1,null,"045c1d7b",null);t["default"]=n.exports},"4d86":function(e,t,a){"use strict";a("3757")},"58bc":function(e,t,a){"use strict";a("2993")},"58bd":function(e,t,a){"use strict";a("4479")},"5e0d":function(e,t,a){},"623f":function(t,a,i){"use strict";i.r(a);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"resourcechannel resourcechannel-container"},[t("div",{staticClass:"filetree"},[t("el-tree",{staticClass:"treelist",attrs:{data:e.productList},on:{"node-click":e.handleNodeClick}})],1),t("div",{staticClass:"firsttable"},[t("dgiot-input",{ref:"uploadFinish",attrs:{params:e.inputParams},on:{fileInfo:e.fileInfo,files:e.files}}),t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.fileParams,size:"small"}},[t("el-form-item",{attrs:{label:e.$translateTitle("application.scene")}},[t("el-input",{attrs:{disabled:""},model:{value:e.fileParams.scene,callback:function(t){e.$set(e.fileParams,"scene",t)},expression:"fileParams.scene"}})],1),t("el-form-item",{attrs:{label:e.$translateTitle("developer.path")}},[t("el-input",{attrs:{disabled:"",placeholder:e.$translateTitle("application.pathdescription")},model:{value:e.fileParams.path,callback:function(t){e.$set(e.fileParams,"path",t)},expression:"fileParams.path"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.uploadCkick()}}},[e._v(" "+e._s(e.$translateTitle("application.uploadfile"))+" ")])],1)],1),t("el-breadcrumb",{attrs:{separator:"/"}},[e._l(e.filebreadcrumb,(function(a,i){return[t("el-breadcrumb-item",{key:i,nativeOn:{click:function(t){return e.breadcrumbClick(a)}}},[e._v(" "+e._s(a.name)+" ")])]}))],2),t("h5"),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableRef",staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e.filelist,"header-cell-style":{"text-align":"center"}},on:{"row-click":e.fileclick}},[t("el-table-column",{attrs:{label:e.$translateTitle("developer.filename"),prop:"name","show-overflow-tooltip":"",sortable:""}}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.filesize"),prop:"name","show-overflow-tooltip":"",sortable:"",width:"200"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[a.is_dir?t("span",[e._v(e._s("-"))]):t("span",[e._v(e._s(Math.round(a.size/1024)+"kb"))])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.filemtime"),prop:"name","show-overflow-tooltip":"",sortable:"",width:"260"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(" "+e._s(e.$moment(1e3*a.mtime).format("YYYY-MM-DD HH:mm:ss"))+" ")])]}}])}),t("el-table-column",{attrs:{fixed:"right",label:e.$translateTitle("developer.operation"),width:"300"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[a.is_dir?e._e():t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return t.stopPropagation(),e.get_fileinfo(a)}}},[e._v(" "+e._s(e.$translateTitle("application.detail"))+" ")]),a.is_dir?e._e():t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return t.stopPropagation(),e.download_file(a)}}},[e._v(" "+e._s(e.$translateTitle("application.preview"))+" ")]),a.is_dir?e._e():t("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},nativeOn:{click:function(t){return t.stopPropagation(),e.delete_file(a)}},slot:"reference"},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])]}}])})],1),t("el-dialog",{attrs:{"append-to-body":"",model:e.detailinfo,title:"文件信息",visible:e.detailView,width:"30%"},on:{"update:visible":function(t){e.detailView=t}}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.ViewLoading,expression:"ViewLoading"}]},[t("el-form-item",{attrs:{label:"名称","label-width":"200"}},[t("span",[e._v(e._s(e.detailinfo.rename))])]),t("el-form-item",{attrs:{label:"路径","label-width":"200"}},[t("span",[e._v(e._s(e.detailinfo.path))])]),t("el-form-item",{attrs:{label:"url","label-width":"200"}},[t("span",[e._v(e._s(e.detailinfo.url))])]),t("el-form-item",{attrs:{label:"MD5","label-width":"200"}},[t("span",[e._v(e._s(e.detailinfo.md5))])]),t("el-form-item",{attrs:{label:"场景","label-width":"200"}},[t("span",[e._v(e._s(e.detailinfo.scene))])]),t("el-form-item",{attrs:{label:"大小","label-width":"200"}},[t("span",[e._v(e._s(Math.round(e.detailinfo.size/1024)+"kb"))])]),t("el-form-item",{attrs:{label:"日期","label-width":"200"}},[t("span",[e._v(" "+e._s(e.$moment(1e3*e.detailinfo.timeStamp).format("YYYY-MM-DD HH:mm:ss"))+" ")])])],1)],1)],1)])},r=[],o=i("1ae2"),l=(t,a,i)=>new Promise((s,r)=>{var o=t=>{try{n(i.next(t))}catch(e){r(e)}},l=t=>{try{n(i.throw(t))}catch(e){r(e)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,l);n((i=i.apply(t,a)).next())}),n={data(){return{filelist:[],filebreadcrumb:[{name:"全部文件",path:"dgiot_file",is_dir:!0}],fileParams:{scene:"app"},inputParams:{},parentfile:"dgiot_file",listLoading:!1,ViewLoading:!1,detailView:!1,detailinfo:{},productList:[]}},watch:{},mounted(){this.getproductTree()},methods:{handleNodeClick(e){console.log(e),e.value&&(console.log(e.value),this.$set(this.fileParams,"path","product/"+e.value),this.get_filelist("dgiot_file/product/"+e.value))},getproductTree(){return l(this,null,(function*(){const e=yield Object(o["getproductTree"])();console.log("产品树",e),this.productList=e.producttree}))},breadcrumbClick(e){if("全部文件"==e.name)this.filebreadcrumb=[{name:"全部文件",path:"dgiot_file"}],this.get_filelist(e.path);else{if(e.child)for(var t=0;t<this.filebreadcrumb.length;t++)this.filebreadcrumb[t].path==e.child.path&&this.filebreadcrumb.splice(t,1);this.get_filelist(e.path+"/"+e.name)}},fileclick(e){if(dgiotlog.log(e),e.is_dir){this.get_filelist(e.path+"/"+e.name);const a=this.filebreadcrumb.length-1;var t="child";this.filebreadcrumb[a][t]=e,this.filebreadcrumb.push(e)}else window.open(this.$FileServe+"/"+e.path+"/"+e.name)},uploadCkick(){this.fileParams.path?(this.loading=!0,this.$refs["uploadFinish"].$refs.uploader.dispatchEvent(new MouseEvent("click")),this.inputParams={file:"",scene:this.fileParams.scene?this.fileParams.scene:"default",path:this.fileParams.path?this.fileParams.path:"default",filename:moment(new Date).valueOf().toString()}):this.$message({showClose:!0,duration:2e3,type:"error",message:"未选择产品"})},fileInfo(e){this.listLoading=!0,e.url?(this.$message({showClose:!0,duration:2e3,type:"success",message:"上传成功"}),this.get_filelist("dgiot_file/"+this.fileParams.path)):this.$message({showClose:!0,duration:2e3,type:"error",message:"上传失败"}),this.listLoading=!1},files(e){this.inputParams.filename=e.name,this.inputParams.file=e},get_filelist(e){this.listLoading=!0,Object(o["list_dir"])(e).then(e=>{"ok"==e.status?this.filelist=e.data:this.filelist=[],this.listLoading=!1})},get_fileinfo(e){this.detailView=!0,this.ViewLoading=!0,Object(o["file_info"])("files/"+e.path+"/"+e.name).then(t=>{this.detailinfo={},t.data&&(this.detailinfo=t.data,this.detailinfo.url=this.$FileServe+"/"+e.path+"/"+e.name),this.ViewLoading=!1})},delete_file(e){this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Object(o["delete_file"])("files/"+e.path+"/"+e.name).then(t=>{"ok"==t.status?(this.$message({showClose:!0,duration:2e3,type:"success",message:"删除成功"}),this.get_filelist(e.path)):this.$message({showClose:!0,duration:2e3,type:"error",message:t.message})}).catch(()=>{this.$message({showClose:!0,duration:2e3,type:"error",message:"删除失败"})})}).catch(()=>{this.$message({showClose:!0,duration:2e3,type:"info",message:"已取消删除"})})},download_file(e){window.open(this.$FileServe+"/"+e.path+"/"+e.name)}}},c=n,d=(i("58bd"),i("c832"),i("2877")),u=Object(d["a"])(c,s,r,!1,null,"f758971c",null);a["default"]=u.exports},6805:function(t,a,i){"use strict";i.r(a);var s=i("209d"),r=i("8387"),o=i("1285"),l=i("cdef"),n=i("5880"),c=i("7212"),d=i("8ba7"),u=i("c008"),m=Object.defineProperty,h=Object.defineProperties,p=Object.getOwnPropertyDescriptors,g=Object.getOwnPropertySymbols,f=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable,y=(e,t,a)=>t in e?m(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,v=(e,t)=>{for(var a in t||(t={}))f.call(t,a)&&y(e,a,t[a]);if(g)for(var a of g(t))b.call(t,a)&&y(e,a,t[a]);return e},w=(e,t)=>h(e,p(t)),$=(t,a,i)=>new Promise((s,r)=>{var o=t=>{try{n(i.next(t))}catch(e){r(e)}},l=t=>{try{n(i.throw(t))}catch(e){r(e)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,l);n((i=i.apply(t,a)).next())});const C=window["vue-aliplayer-v2"].default;a["default"]={name:"ReviewIndex",components:{lowcodeDesign:s["default"],evidenceStatistics:r["default"],"vue-aliplayer-v2":C},data(){var e,t;return{management:{dialog:!1,data:{}},managementactiveName:"0",statisticsVisible:!1,evidenceId:"",aliplayer:{autoplay:!1,height:"200px"},types:{video:["video","videocam_black"],audio:["audio","volume_mute"],image:["image","image"],file:["file","archive"]},evidences:[],evidenceDialog:!1,activeName:(null==(t=null==(e=null==this?void 0:this.$route)?void 0:e.query)?void 0:t.tabs)&&"examination"==this.$route.query.tabs?"examination":"forensics",officeapps:"",dialogVisible:!1,paginations:{layout:"total, sizes, prev, pager, next, jumper"},queryPayload:{excludeKeys:"data",include:"",order:"-createdAt",limit:10,skip:0,count:"objectId"},lowcodeId:"",loading:!1,options:[{value:"Underreview",label:"审核中"},{value:"finishreview",label:"审核完成"}],rules:{testbed:[{required:!0,message:"请选择测试台体",trigger:"blur"}],name:[{required:!0,message:"请输入报告名称",trigger:"blur"}],templatename:[{required:!0,message:"请选择报告模板",trigger:"change"}]},activePopShow:!1,border:!0,height:980,stripe:!0,lineHeight:"medium",checkList:["mission name","Inspection number","Inspection template","testbed","Trade Names","Creation time","Starting time","end time"],columns:[{label:"mission name",width:"auto",prop:"name",sortable:!0},{label:"Inspection template",width:"auto",prop:"profile.wordtemplatename",sortable:!0},{label:"testbed",width:"auto",prop:"profile.testbed",sortable:!0},{label:"Starting time",width:"180",prop:"starttime",sortable:!0},{label:"end time",width:"180",prop:"endtime",sortable:!0}],list:{forensics:[],examination:[]},listLoading:!0,queryForm:{pageSizes:[10,20,30,50],limit:10,order:"-createdAt",keys:"count(*)",total:0,skip:0,pageNo:1,pageSize:10,name:""},categorylist:[],wordtemplist:[],grouplist:[],ruleForm:{name:"",templatename:"",testbed:"",testbedid:"",templatenameid:""}}},computed:w(v({},Object(n["mapGetters"])({currentDepartment:"user/currentDepartment"})),{dragOptions(){return{animation:600,group:"description"}},finallyColumns(){return this.columns.filter(e=>this.checkList.includes(e.label))}}),created(){this.fetchData()},methods:{handleHistory(e){return $(this,null,(function*(){try{this.evidenceId=e.objectId,this.statisticsVisible=!0,this.$nextTick(()=>{this.$refs["statistics"].evidence(e.objectId)})}catch(t){console.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}}))},paginationQuery(e){return $(this,null,(function*(){this.queryPayload=e}))},categoryChange(e){return $(this,null,(function*(){this.$set(this.ruleForm,"templatenameid",e.objectId)}))},testbedChange(e){this.$set(this.ruleForm,"testbedid",e.objectId),dgiotlog.log("src/views/CloudTest/js/task.js","this.ruleForm",this.ruleForm,e.objectId)},getwordtemp(){return $(this,null,(function*(){const e={skip:0,where:{netType:"Evidence",nodeType:1}},{results:t={}}=yield Object(c["queryProduct"])(e);this.categorylist=t}))},getgroup(){return $(this,null,(function*(){const e={where:{"detail.category":"84abda3154"}},{results:t}=yield Object(o["queryDevice"])(e);this.grouplist=t}))},submitForm(e){const t="role:"+this.currentDepartment.name,a={};a[t]={read:!0,write:!0},this.$refs[e].validate(e=>$(this,null,(function*(){if(!e)return dgiotlog.log("error submit!!"),!1;{const e={profile:{testbedid:this.ruleForm.testbedid,testbed:this.ruleForm.testbed.name,wordtemplatename:this.ruleForm.templatename.name,reportId:this.ruleForm.templatenameid,identifier:"inspectionReportTemp",step:0},parentId:this.ruleForm.testbedid,name:this.ruleForm.name,product:this.ruleForm.templatenameid},t=this.$baseColorfullLoading(1);this.activePopShow=!1,yield Object(l["postreport"])(e),this.fetchData(),t.close()}this.ruleForm={name:"",templatename:"",testbed:"",testbedid:"",templatenameid:""}})))},forensics(e){dgiotlog.warn(e),this.$router.push({path:"/cloudTest/evidence",query:{taskid:e.objectId,suite:0,state:"preview",step:1,back:e.profile.step,message:e.profile.message}})},taskEnd(e){this.$baseConfirm(this.$translateTitle("Maintenance.Are you sure you want to end the current mission"),null,()=>$(this,null,(function*(){try{const t=this.$baseColorfullLoading(),a={profile:_.merge(e.profile,{step:4,endtime:moment(new Date).format("x")})};yield Object(o["putDevice"])(e.objectId,a);this.fetchData(),t.close()}catch(t){dgiotlog.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}})))},taskStart(e){this.$baseConfirm(this.$translateTitle("Maintenance.Are you sure you want to start the current mission"),null,()=>$(this,null,(function*(){try{const t=this.$baseColorfullLoading(),a={profile:_.merge(e.profile,{step:1,starttime:moment(new Date).format("x")})};yield Object(o["putDevice"])(e.objectId,a);this.fetchData(),t.close()}catch(t){dgiotlog.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}})))},downDocx(e){return $(this,null,(function*(){try{const t=document.createElement("a");t.setAttribute("href",this.$FileServe+e),t.setAttribute("download","download"),t.click()}catch(t){dgiotlog.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}}))},handleUnderreview(e){return $(this,null,(function*(){try{this.$router.push({path:"/cloudTest/evidence",query:{taskid:e,suite:0,state:"preview",step:3}})}catch(t){dgiotlog.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}}))},handleRouter(e){return $(this,null,(function*(){try{this.$router.push({path:"/cloudTest/evidence",query:{taskid:e.objectId,suite:0,state:"preview",step:e.profile.step,back:e.profile.step,message:e.profile.message,disable:!0}})}catch(t){console.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}}))},handleEvidence(e){return $(this,null,(function*(){this.evidences=[];try{const t={order:"-createdAt",skip:0,where:{"original.taskid":e,reportId:{$ne:e}}},a=this.$baseColorfullLoading(),{results:i}=yield Object(u["queryEvidence"])(t);(null==i?void 0:i.length)&&i.forEach(e=>{e.original.path="/dgiot_file"+e.original.path.split("/dgiot_file")[1]}),this.evidenceDialog=!0,this.evidences=i,console.log(i),this.$baseMessage(this.$translateTitle("alert.Data request successfully"),"success","dgiot-hey-message-success"),a.close()}catch(t){console.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}}))},handleReport(e){return $(this,null,(function*(){if(4==e.profile.step&&e.profile.docx){const t=this.$FileServe+e.profile.docx;return this.dialogVisible=!0,this.officeapps="https://view.officeapps.live.com/op/view.aspx?src="+t,!1}try{const t=this.$baseColorfullLoading(),{code:a,msg:i,path:s}=yield Object(u["generatereport"])(e.objectId);200==a&&s?(this.$baseMessage(this.$translateTitle("alert.Data request successfully"),"success","dgiot-hey-message-success"),setTimeout(()=>{const t={profile:_.merge(e.profile,{step:4,docx:s})},a=(Object(o["putDevice"])(e.objectId,t),this.$FileServe+s);this.dialogVisible=!0,this.officeapps="https://view.officeapps.live.com/op/view.aspx?src="+a,this.fetchData()},1200)):this.$baseMessage(""+i,"error","dgiot-hey-message-error"),t.close()}catch(t){dgiotlog.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}}))},handleCloseAmis(){this.coordinate={lng:116.404,lat:39.915},this.dialog_device=!1,this.management.dialog=!1},handleManagement(e){return $(this,null,(function*(){this.$refs["lowcodeDesign"].withHeader=!0,localStorage.setItem("parse_objectid",e.objectId);const t={where:{type:"amis_view",key:e.objectId}},{results:a=[]}=yield Object(d["queryView"])(t);if(console.log(a),_.isEmpty(a))return this.$baseMessage("暂未配置检测项","info","dgiot-hey-message-error"),!1;this.management.dialog=!0,this.management.data=a}))},handleDelete(e){return $(this,null,(function*(){try{const t=this.$baseColorfullLoading();yield Object(o["delDevice"])(e);this.$baseMessage(this.$translateTitle("user.successfully deleted"),"success","dgiot-hey-message-success"),t.close(),this.fetchData()}catch(t){dgiotlog.log(t),this.$baseMessage(this.$translateTitle("user.error deleted")+""+t,"error","dgiot-hey-message-error")}}))},fetchData(){return $(this,null,(function*(){this.list={forensics:[],examination:[]},this.getwordtemp(),this.getgroup(),this.queryPayload.include="product,parentId",this.queryPayload.where={"profile.identifier":"inspectionReportTemp",name:this.queryForm.name.length?{$regex:this.queryForm.name}:{$ne:null},"profile.step":{$regex:"^(-1|[2-9]\\d*)$"}},this.listLoading=!0;const{count:e=0,results:t=[]}=yield Object(o["queryDevice"])(this.queryPayload);this.$refs["examination"].ination.total=e,t.forEach(e=>{e.endtime=e.profile.endtime?moment(Number(e.profile.endtime)).format("YYYY-MM-DD HH:mm:ss"):"",e.starttime=e.profile.starttime?moment(Number(e.profile.starttime)).format("YYYY-MM-DD HH:mm:ss"):"",e.createdAt=moment(e.createdAt).format("YYYY-MM-DD HH:mm:ss"),this.list.examination.push(e)}),this.listLoading=!1}))}}}},"6f23":function(t,a,i){"use strict";i.r(a);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"logs logs-container",class:{"dgiot-fullscreen":e.isFullscreen}},[t("dgiot-query-form",[t("dgiot-query-form-top-panel",[t("el-form",{ref:"form",attrs:{inline:!0,"label-width":"auto",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{staticClass:"item-time",attrs:{label:e.$translateTitle("Maintenance.times")}},[t("el-date-picker",{staticClass:"item-time-picker",attrs:{"end-placeholder":e.$translateTitle("Maintenance.end time"),format:"yyyy-MM-dd","start-placeholder":e.$translateTitle("Maintenance.start time"),type:"daterange","value-format":"yyyy-MM-dd"},model:{value:e.queryForm.searchDate,callback:function(t){e.$set(e.queryForm,"searchDate",t)},expression:"queryForm.searchDate"}})],1),t("el-form-item",[t("el-button",{attrs:{icon:"el-icon-search","native-type":"submit",type:"primary"},on:{click:function(t){return e.queryTable({})}}}),t("el-button",{staticStyle:{margin:"0 10px 10px 10px !important"},attrs:{type:"success"},on:{click:e.handleHeight}},[t("dgiot-icon",{attrs:{icon:e.isFullscreen?"fullscreen-exit-fill":"fullscreen-fill"}})],1),t("el-popover",{attrs:{trigger:"hover"},scopedSlots:e._u([{key:"reference",fn:function(){return[t("el-button",{staticStyle:{margin:"0 0 10px 0 !important"},attrs:{icon:"el-icon-setting",type:"primary"}},[e._v(" "+e._s(e.$translateTitle("Logs.Draggable column settings"))+" ")])]},proxy:!0}])},[t("el-checkbox-group",{model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},[t("dgiot-draggable",{attrs:{list:e.logcolumns}})],1)],1)],1)],1)],1)],1),t("el-table",{key:e.finallyColumns.length+e.momentKey,ref:"dragTable",staticClass:"logs-table",attrs:{border:"",data:e.logdata,height:e.height,"highlight-current-row":"",resizable:"","row-class-name":e.tableRowClassName,size:e.size,stripe:""},scopedSlots:e._u([{key:"empty",fn:function(){return[t("dgiot-empty")]},proxy:!0}])},[t("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-descriptions",{staticClass:"margin-top",attrs:{border:"",column:2,size:e.size}},e._l(a.row.body,(function(a,i,s){return t("el-descriptions-item",{directives:[{name:"show",rawName:"v-show",value:"elm"!=i,expression:"key != 'elm'"}],key:s,attrs:{label:i,"label-class-name":"my-label"}},[e._v(" "+e._s(a)+" ")])})),1)]}}])}),e._l(e.finallyColumns,(function(e,a){return t("el-table-column",{key:a,attrs:{align:"center",label:e,prop:e,"show-overflow-tooltip":"",sortable:""}})})),t("el-table-column",{attrs:{align:"center",fixed:"right",label:"msg",prop:"msg.body","show-overflow-tooltip":"",sortable:""}})],2),t("dgiot-Pagination",{directives:[{name:"show",rawName:"v-show",value:e.queryForm.total>0,expression:"queryForm.total > 0"}],attrs:{limit:e.queryForm.pageSize,page:e.queryForm.pageNo,total:e.queryForm.total},on:{"update:limit":function(t){return e.$set(e.queryForm,"pageSize",t)},"update:page":function(t){return e.$set(e.queryForm,"pageNo",t)},pagination:e.queryTable}})],1)},r=[],o=i("d292"),l=(t,a,i)=>new Promise((s,r)=>{var o=t=>{try{n(i.next(t))}catch(e){r(e)}},l=t=>{try{n(i.throw(t))}catch(e){r(e)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,l);n((i=i.apply(t,a)).next())}),n={name:"AccessLog",data(){return{size:"",isFullscreen:!1,height:this.$baseTableHeight(0),logdata:[],momentKey:moment(new Date).valueOf(),checkList:["time","username","ip","method","path","code","reason","elapsedtime"],logcolumns:["time","username","ip","method","path","code","reason","elapsedtime"],queryForm:{total:0,count:"objectId",limit:20,pageNo:1,pageSize:20,skip:0,level:"",peername:"",pid:"",mfa:"",topic:"",domain:"parse_api",searchDate:[moment().subtract("days",7).format("YYYY-MM-DD"),moment(new Date).format("YYYY-MM-DD")],order:"-createdAt",keys:"count(*)"}}},computed:{dragOptions(){return{animation:600,group:"description"}},finallyColumns(){return this.logcolumns.filter(e=>this.checkList.includes(e))}},created(){},mounted(){this.queryTable({}),this.rowDrop(),this.columnDrop()},methods:{handleHeight(){this.isFullscreen=!this.isFullscreen,this.isFullscreen?this.height=this.$baseTableHeight(0)+120:this.height=this.$baseTableHeight(0),this.momentKey=moment(new Date).valueOf()},tableRowClassName({row:e}){return e.disabled?"disabled":""},rowDrop(){const e=this.$refs.dragTable.$el.querySelector(".el-table__body-wrapper tbody"),t=this;Sortable.create(e,{draggable:".el-table__row",onEnd({newIndex:e,oldIndex:a}){const i=t.logdata.splice(a,1)[0];t.logdata.splice(e,0,i)}})},columnDrop(){const e=this,t=this.$refs.dragTable.$el.querySelector(".el-table__header-wrapper tr");e.sortable=Sortable.create(t,{animation:180,delay:0,onEnd:t=>{const a=e.finallyColumns[t.oldIndex];e.finallyColumns.splice(t.oldIndex,1),e.finallyColumns.splice(t.newIndex,0,a),e.momentKey=moment(new Date).valueOf(),setTimeout(()=>{e.rowDrop(),e.columnDrop()},1500)}})},queryTable(){return l(this,arguments,(function*(e={}){e.limit||(e=this.queryForm);const t=this.$baseColorfullLoading();try{t.close();const a={limit:e.limit,skip:e.skip,order:e.order,count:this.queryForm.count,keys:"time,msg",include:"",where:{domain:this.queryForm.domain?{$all:this.queryForm.domain.split(/,(?=(?:[^']*(?:'[^']*')?[^']*)*$)/)}:{$ne:""},createdAt:{$gte:{__type:"Date",iso:this.queryForm.searchDate[0]+"T00:00:00.000Z"},$lte:{__type:"Date",iso:this.queryForm.searchDate[1]+"T23:59:59.000Z"}}}},{results:i=[],count:s=0}=yield Object(o["queryLog"])(a);i.forEach((e,t)=>{e.time=this.$moment(Number(e.time.toString().substring(0,13))).format("YYYY-MM-DD HH:mm:ss.SSS");const a=JSON.parse(e.msg);for(let i in a)"body"==i?e["body"]=a["body"]:e[i]=a[i];0==t&&(dgiotlog.log(e),dgiotlog.log(e.body))}),this.logdata=i,this.queryForm.total=s,this.$baseMessage(this.$translateTitle("alert.Data request successfully"),"success","dgiot-hey-message-success"),t.close()}catch(a){t.close(),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+a,"error","dgiot-hey-message-error")}this.momentKey=moment(new Date).valueOf()}))}}},c=n,d=(i("c3f8"),i("d4a9"),i("2877")),u=Object(d["a"])(c,s,r,!1,null,"6412bb04",null);a["default"]=u.exports},"6f31":function(e,t,a){"use strict";a("f1eb")},"7e644":function(t,a,i){"use strict";i.r(a);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"system-log-container"},[t("dgiot-query-form",[t("dgiot-query-form-top-panel",[t("el-form",{attrs:{inline:!0,"label-width":"60px",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{attrs:{label:"账号"}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入账号"},model:{value:e.queryForm.account,callback:function(t){e.$set(e.queryForm,"account","string"===typeof t?t.trim():t)},expression:"queryForm.account"}})],1),t("el-form-item",{attrs:{label:"周期"}},[t("el-date-picker",{attrs:{"end-placeholder":"结束日期",format:"yyyy-MM-dd","start-placeholder":"开始日期",type:"daterange","value-format":"yyyy-MM-dd"},model:{value:e.queryForm.searchDate,callback:function(t){e.$set(e.queryForm,"searchDate",t)},expression:"queryForm.searchDate"}})],1),t("el-form-item",[t("el-button",{attrs:{icon:"el-icon-search",type:"primary"},nativeOn:{click:function(t){return e.queryData.apply(null,arguments)}}},[e._v(" 查询 ")])],1)],1)],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list},scopedSlots:e._u([{key:"empty",fn:function(){},proxy:!0}])},[t("el-table-column",{attrs:{align:"center",label:"日志类型",prop:"type","show-overflow-tooltip":"",width:"230px"}}),t("el-table-column",{attrs:{align:"center",label:"账号",prop:"account","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{align:"center",label:"执行结果",prop:"executeResult","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function({row:a}){return["登录成功"===a.executeResult?t("span",[t("span",{staticClass:"dgiot-dot dgiot-dot-success"},[t("span")]),e._v(" "+e._s(a.executeResult)+" ")]):t("span",[t("span",{staticClass:"dgiot-dot dgiot-dot-error"},[t("span")]),e._v(" "+e._s(a.executeResult)+" ")])]}}])}),t("el-table-column",{attrs:{align:"center",label:"登录IP",prop:"ip"}}),t("el-table-column",{attrs:{align:"center",label:"访问时间",prop:"datetime","show-overflow-tooltip":""}})],1),t("el-pagination",{attrs:{background:"","current-page":e.queryForm.pageNo,layout:e.layout,"page-size":e.queryForm.pageSize,total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)},r=[],o=i("8781"),l=(t,a,i)=>new Promise((s,r)=>{var o=t=>{try{n(i.next(t))}catch(e){r(e)}},l=t=>{try{n(i.throw(t))}catch(e){r(e)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,l);n((i=i.apply(t,a)).next())}),n={name:"SystemLog",data(){return{list:[],listLoading:!0,layout:"total, sizes, prev, pager, next, jumper",total:0,queryForm:{account:"",searchDate:"",pageNo:1,pageSize:20}}},created(){this.fetchData()},methods:{handleSizeChange(e){this.queryForm.pageSize=e,this.fetchData()},handleCurrentChange(e){this.queryForm.pageNo=e,this.fetchData()},queryData(){this.queryForm.pageNo=1,this.fetchData()},fetchData(){return l(this,null,(function*(){this.listLoading=!0;const{data:{list:e,total:t}}=yield Object(o["getList"])(this.queryForm);this.list=e,this.total=t,this.listLoading=!1}))}}},c=n,d=i("2877"),u=Object(d["a"])(c,s,r,!1,null,null,null);a["default"]=u.exports},8387:function(t,a,i){"use strict";i.r(a);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"statistics-content"},[t("div",{staticClass:"statistics-content-chart"},[t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{span:12}},[t("el-divider",[e._v("历史数据")]),t("dgiot-chart",{ref:"charts",attrs:{"after-config":e.afterConfig,data:e.chartData,"data-empty":e.dataEmpty,"data-zoom":e.chartDataZoom,extend:e.chartExtend,loading:e.loading,"set-option-opts":!1,settings:e.chartSettings,toolbox:e.toolbox,type:e.params.style}})],1),t("el-col",{attrs:{span:12}},[t("el-divider",[e._v("存储的数据")]),t("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"存储的数据",name:"first"}},[t("el-table",{key:e.historyEvidence.length,staticStyle:{"min-height":"530px"},attrs:{border:"",data:e.historyEvidence}},e._l(e.historycolumns,(function(a,i){return t("el-table-column",{key:i,attrs:{align:"center",label:e.$translateTitle("cloudTest."+a.label),prop:a.prop,"show-overflow-tooltip":"",sortable:"",width:"auto"}})})),1)],1),t("el-tab-pane",{attrs:{label:e.$translateTitle("equipment.chart"),name:"second"}},[t("el-card",[t("el-image",{key:e.drawxnqxPath,attrs:{"preview-src-list":[e.$FileServe+e.drawxnqxPath],src:e.$FileServe+e.drawxnqxPath}},[t("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[t("el-image",{staticClass:"dgiot-data-empty",attrs:{src:i("c2ad")}})],1)])],1)],1)],1)],1)],1),t("div",{staticClass:"chartOther"},[t("el-row",{attrs:{gutter:20}},[e._l(e.chartData.child,(function(a,i){return t("el-col",{directives:[{name:"show",rawName:"v-show",value:"日期"!=a.columns[1],expression:"item.columns[1] != '日期'"}],key:i,attrs:{md:e.md,sm:e.sm,xl:e.xl,xs:e.xs}},[t("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v(e._s(a.columns[1])+" : "+e._s(a.unit))]),t("el-button-group",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"}},[t("el-button",{attrs:{icon:"el-icon-full-screen"},nativeOn:{click:function(t){return e.toggleCardRow(i,e.xs,e.sm,e.md,e.xl)}}})],1)],1),t("dgiot-chart",{ref:"charts",refInFor:!0,attrs:{"after-config":e.afterConfig,data:e.chartData.child[i],"data-empty":e.dataEmpty,"data-zoom":e.chartDataZoom,extend:e.chartExtend,height:"300px","legend-visible":!1,loading:e.loading,"set-option-opts":!1,settings:e.chartSettings,toolbox:e.toolbox,type:e.params.style}})],1)],1)})),t("el-col",{directives:[{name:"show",rawName:"v-show",value:!e.chartData.child,expression:"!chartData.child"}],attrs:{span:24}},[t("dgiot-empty")],1)],2)],1)],1)])},r=[],o=i("5880"),l=i("1285"),n=Object.defineProperty,c=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,m=(e,t,a)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,h=(e,t)=>{for(var a in t||(t={}))d.call(t,a)&&m(e,a,t[a]);if(c)for(var a of c(t))u.call(t,a)&&m(e,a,t[a]);return e},p=(t,a,i)=>new Promise((s,r)=>{var o=t=>{try{n(i.next(t))}catch(e){r(e)}},l=t=>{try{n(i.throw(t))}catch(e){r(e)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,l);n((i=i.apply(t,a)).next())}),g={name:"Statistics",components:{},props:{evidenceId:{type:String,default:"",require:!0}},data(){return this.toolbox={orient:"vertical",right:-5,feature:{dataZoom:{yAxisIndex:"none"},magicType:{type:["line","bar","histogram","pie","ring","waterfall","funnel","radar","heatmap","scatter","candle","stack"]},dataView:{show:!0,readOnly:!1},saveAsImage:{show:!0},restore:{show:!0}}},this.chartExtend={series:{barMaxWidth:35},dataZoom:[{type:"slider",show:!0,xAxisIndex:[0],left:"9%",bottom:-5,start:10,end:90}],grid:{right:40}},{activeName:"first",drawxnqxPath:"",xl:6,xs:24,sm:24,md:12,historyEvidence:[],historycolumns:[],params:{_function:"last",style:"",number:1,interval:"m",datetimerange:"",keys:"*",limit:100,endTime:new Date,startTime:(new Date).getTime()-6048e5},chartSettings:{},chartDataZoom:[{type:"slider"}],dataEmpty:!0,chartData:{identifier:[],columns:[],rows:[]},loading:!0,infoData:{}}},computed:h({},Object(o["mapGetters"])({Device:"settings/device",chartType:"product/chartType"})),mounted(){this.params.style=chartType[0].type},methods:{resizeTheChart(){let e=this.$refs["charts"];e instanceof Array?e.forEach(e=>{e.$children[0].resize()}):e.$children[0].resize()},afterConfig(e){return e.tooltip.showDelay=500,e},toggleCardRow(e,t,a,i,s){return p(this,null,(function*(){try{this.sm=24==a?12:24,this.md=12==i?24:12,this.xl=6==s?12:6,this.xs=24==t?12:24,this.$nextTick(e=>{this.resizeTheChart()})}catch(e){console.log(e),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+e,"error","dgiot-hey-message-error")}}))},evidence(e){return p(this,null,(function*(){var t,a;try{const i=yield Object(l["getDevice"])(e);this.infoData=i;const{profile:s={endtime:moment(Number(endTime)).valueOf(),drawxnqxPath:""},parentId:r={}}=i;this.params.startTime=s.starttime,this.params.endTime=s.endtime,this.historycolumns=null!=(t=s.historicaldatacolumns)?t:[],this.historyEvidence=null!=(a=s.historicaldata)?a:[],this.drawxnqxPath=s.drawxnqxPath,yield this.queryStatistics(r.objectId)}catch(i){console.log(i),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+i,"error","dgiot-hey-message-error")}}))},queryStatistics(e){return p(this,null,(function*(){const{interval:t,keys:a,limit:i,number:s,style:r,_function:o,startTime:n,endTime:c=moment(new Date).format("x")}=this.params;let d={starttime:moment(Number(n)).valueOf(),endtime:moment(Number(c)).valueOf(),interval:s+t,keys:a,limit:i,function:o,style:r};try{const t=this.$baseColorfullLoading(),{chartData:a={}}=yield Object(l["getDabDevice"])(e,d);this.$baseMessage(this.$translateTitle("alert.Data request successfully"),"success","dgiot-hey-message-success"),t.close(),this.chartData=a,this.loading=!1,_.isEmpty(a)||(this.dataEmpty=!1)}catch(u){console.log(u),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+u,"error","dgiot-hey-message-error")}}))}}},f=g,b=(i("05da"),i("2877")),y=Object(b["a"])(f,s,r,!1,null,"7d369075",null);a["default"]=y.exports},"87d35":function(e,t,a){"use strict";a("a336")},"95f7":function(t,a,i){"use strict";i.r(a);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"appmarage appmarage-container"},[t("div",{staticClass:"header"},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.checkupdateall}},[e._v(" 插件升级 ")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.updateallFiled}},[e._v(" 数据库升级 ")])],1),t("div",{staticClass:"block",staticStyle:{"margin-top":"10px"}},[t("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.tableData.filter(t=>!e.search||t.app.toLowerCase().includes(e.search.toLowerCase())),height:e.height}},[t("el-table-column",{attrs:{align:"center",label:"App"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",{style:{color:1==a.active?"green":"red"}},[e._v(" "+e._s(a.app)+" ")])]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("plugins.version"),prop:"version",sortable:""}}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.describe"),prop:"desc",sortable:""}}),t("el-table-column",{attrs:{align:"right",label:e.$translateTitle("developer.operation")},scopedSlots:e._u([{key:"header",fn:function(a){return[t("el-input",{attrs:{placeholder:e.$translateTitle("plugins.enterappsearch"),size:"mini"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function({row:a}){return[0==a.active?t("el-button",{attrs:{plain:"",size:"small",type:"info"},on:{click:function(t){return e.startup(a.app)}}},[t("div",{staticStyle:{display:"inline-block",width:"10px",height:"10px","margin-right":"10px",background:"#00cc33","border-radius":"50%"}}),e._v(" "+e._s(e.$translateTitle("plugins.start"))+" ")]):e._e(),1==a.active?t("el-button",{attrs:{plain:"",size:"small",type:"info"},on:{click:function(t){return e.stopup(a.app)}}},[t("div",{staticStyle:{display:"inline-block",width:"10px",height:"10px","margin-right":"10px",background:"#a94442","border-radius":"50%"}}),e._v(" "+e._s(e.$translateTitle("plugins.stop"))+" ")]):e._e(),t("el-button",{attrs:{plain:"",size:"small",type:"info"},on:{click:function(t){return e.checkupdate(a.app)}}},[e._v(" "+e._s(e.$translateTitle("plugins.checkupdate"))+" ")])]}}])})],1)],1),t("div",{staticClass:"block"},[t("el-pagination",{staticStyle:{"margin-top":"30px"},attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","page-size":e.length,"page-sizes":[10,25,50,100],total:e.search.length?e.tableData.filter(t=>!e.search||t.app.toLowerCase().includes(e.search.toLowerCase())).length:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1),t("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.handleClose,title:e.$translateTitle("plugins.modulelist"),visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",[t("el-table",{staticStyle:{width:"100%","margin-top":"20px","text-align":"center"},attrs:{data:e.tableData1.slice((e.start1-1)*e.length1,e.start1*e.length1),height:"300"}},[t("el-table-column",{attrs:{align:"center",label:"插件名称",prop:"app",sortable:""}}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("plugins.modulename"),prop:"path",sortable:""}}),t("el-table-column",{attrs:{align:"center",label:"插件版本",prop:"version",sortable:""}}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("plugins.modulename"),prop:"path",sortable:""}}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("plugins.ischange"),prop:"is_changed","show-overflow-tooltip":"",sortable:"",width:"auto"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-tag",{attrs:{effect:a.is_changed?"plain":"dark",type:a.is_changed?"":"info"}},[e._v(" "+e._s(a.is_changed)+" ")])]}}])})],1),t("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","page-size":e.length1,"page-sizes":[10,25,50,100],total:e.total1},on:{"current-change":e.handleCurrentChange1,"size-change":e.handleSizeChange1}})],1),t("span",{staticStyle:{display:"block",padding:"0 0 20px 0"},attrs:{slot:"footer"},slot:"footer"},[t("el-button",{staticStyle:{float:"left"},attrs:{size:"mini"},on:{click:function(t){e.dialogVisible=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),t("el-button",{staticStyle:{float:"right"},attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.reupload.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)])],1)},r=[],o=i("bb22"),l=(t,a,i)=>new Promise((s,r)=>{var o=t=>{try{n(i.next(t))}catch(e){r(e)}},l=t=>{try{n(i.throw(t))}catch(e){r(e)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,l);n((i=i.apply(t,a)).next())}),n=[],c={data(){return{height:this.$baseTableHeight(0)-15,tableData:[],total:0,start:1,length:10,node:null,dialogVisible:!1,start1:1,length1:10,total1:0,tableData1:[],app:"",version:"",searchvalue:"",search:""}},computed:{},mounted(){this.getInformation()},methods:{handleSizeChange(e){this.start=1,this.length=e},handleCurrentChange(e){this.start=e},handleSizeChange1(e){this.start1=1,this.length1=e},handleCurrentChange1(e){this.start1=e},getInformation(){Object(o["Getapp"])(this.node,this.start,this.length).then(e=>{e&&(this.tableData=e.apps,e.apps,this.total=e.recordsTotal)}).catch(e=>{this.$message({showClose:!0,duration:2e3,type:"error",message:e.error})})},handleClose(){this.dialogVisible=!1},changedialog(){""==this.searchvalue&&(this.tableData1=n),this.tableData1=tableData1.filter(e=>!this.searchvalue||e.path.toLowerCase().includes(searchvalue.toLowerCase()))},checkupdate(e){this.tableData1=[],this.searchvalue="",this.dialogVisible=!0,this.app=e,this.total1=0,Object(o["Getmodule"])(e).then(e=>{e&&(e.map(e=>{0==e.is_changed?e.is_changed="false":e.is_changed="true"}),this.tableData1=e,n=e,this.total1=e.length)})},checkupdateall(){this.searchvalue="",this.dialogVisible=!0,this.tableData1=[],this.total1=0,this.app="",Object(o["Getmodule"])("changed").then(e=>{e&&(e.map(e=>{0==e.is_changed?e.is_changed="false":e.is_changed="true"}),this.tableData1=e,n=e,this.total1=e.length)})},startup(e){Object(o["Getstart"])(e).then(e=>{e&&(this.$message({showClose:!0,duration:2e3,message:"启动成功",type:"success"}),this.getInformation())}).catch(e=>{dgiotlog.log(e)})},stopup(e){Object(o["Getstop"])(e).then(e=>{e&&(this.$message({showClose:!0,duration:2e3,message:"停止成功",type:"success"}),this.getInformation())}).catch(e=>{dgiotlog.log(e)})},updateallFiled(){return l(this,null,(function*(){const{msg:e="数据库升级成功"}=yield Object(o["updateall"])();this.$message({showClose:!0,duration:2e3,message:e,type:"success"})}))},reupload(){""==this.app?Object(o["GetReload"])("all").then(e=>{console.log("module",e),e&&(0==e.length?this.$message({showClose:!0,duration:2e3,message:"当前无更新",type:"warning"}):this.$message({showClose:!0,duration:2e3,message:"已更新模块",type:"success"}))}):Object(o["GetReload"])(this.app).then(e=>{e&&(0==e.length?this.$message({showClose:!0,duration:2e3,message:"当前无更新",type:"warning"}):this.$message({showClose:!0,duration:2e3,message:"已更新模块",type:"success"}),this.app)}),setTimeout(()=>{this.dialogVisible=!1},3e3)}}},d=c,u=i("2877"),m=Object(u["a"])(d,s,r,!1,null,null,null);a["default"]=m.exports},9643:function(t,a,i){"use strict";i.r(a);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"logs logs-container",class:{"dgiot-fullscreen":e.isFullscreen}},[t("dgiot-query-form",[t("dgiot-query-form-top-panel",[t("el-form",{ref:"form",attrs:{inline:!0,"label-width":"auto",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{staticClass:"item-time",attrs:{label:e.$translateTitle("Maintenance.times")}},[t("el-date-picker",{staticClass:"item-time-picker",attrs:{"end-placeholder":e.$translateTitle("Maintenance.end time"),format:"yyyy-MM-DD HH:mm:ss.SSSSSS","start-placeholder":e.$translateTitle("Maintenance.start time"),type:"datetimerange","value-format":"yyyy-MM-DD HH:mm:ss.SSSSSS"},model:{value:e.queryForm.searchDate,callback:function(t){e.$set(e.queryForm,"searchDate",t)},expression:"queryForm.searchDate"}})],1),t("el-form-item",{attrs:{label:"level"}},[t("el-select",{attrs:{clearable:""},model:{value:e.queryForm.level,callback:function(t){e.$set(e.queryForm,"level",t)},expression:"queryForm.level"}},e._l(e.leverData,(function(a){return t("el-option",{key:a,attrs:{label:a,value:a}},[e._v(" "+e._s(a)+" ")])})),1)],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.fold,expression:"!fold"}],attrs:{label:"pid"}},[t("el-input",{attrs:{clearable:""},model:{value:e.queryForm.pid,callback:function(t){e.$set(e.queryForm,"pid",t)},expression:"queryForm.pid"}})],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.fold,expression:"!fold"}],attrs:{label:"domain"}},[t("el-input",{attrs:{clearable:""},model:{value:e.queryForm.domain,callback:function(t){e.$set(e.queryForm,"domain",t)},expression:"queryForm.domain"}})],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.fold,expression:"!fold"}],attrs:{label:"mfa"}},[t("el-input",{attrs:{clearable:""},model:{value:e.queryForm.mfa,callback:function(t){e.$set(e.queryForm,"mfa",t)},expression:"queryForm.mfa"}})],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.fold,expression:"!fold"}],attrs:{label:"clientid"}},[t("el-input",{attrs:{clearable:""},model:{value:e.queryForm.clientid,callback:function(t){e.$set(e.queryForm,"clientid",t)},expression:"queryForm.clientid"}})],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.fold,expression:"!fold"}],attrs:{label:"topic"}},[t("el-input",{attrs:{clearable:""},model:{value:e.queryForm.topic,callback:function(t){e.$set(e.queryForm,"topic",t)},expression:"queryForm.topic"}})],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.fold,expression:"!fold"}],attrs:{label:"peername","label-width":"80px"}},[t("el-input",{attrs:{clearable:""},model:{value:e.queryForm.peername,callback:function(t){e.$set(e.queryForm,"peername",t)},expression:"queryForm.peername"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"text"},on:{click:function(t){e.fold=!e.fold}}},[e.fold?t("span",[e._v(" "+e._s(e.$translateTitle("Maintenance.Unfold"))+" ")]):t("span",[e._v(e._s(e.$translateTitle("Maintenance.merge")))]),t("dgiot-icon",{staticClass:"dgiot-dropdown",class:{"dgiot-dropdown-active":e.fold},attrs:{icon:"arrow-up-s-line"}})],1),t("el-button",{attrs:{icon:"el-icon-search","native-type":"submit",type:"primary"},on:{click:function(t){return e.queryTable({})}}}),t("el-button",{staticStyle:{margin:"0 10px 10px 10px !important"},attrs:{type:"success"},on:{click:e.handleHeight}},[t("dgiot-icon",{attrs:{icon:e.isFullscreen?"fullscreen-exit-fill":"fullscreen-fill"}})],1),t("el-popover",{attrs:{trigger:"hover"},scopedSlots:e._u([{key:"reference",fn:function(){return[t("el-button",{staticStyle:{margin:"0 0 10px 0 !important"},attrs:{icon:"el-icon-setting",type:"primary"}},[e._v(" "+e._s(e.$translateTitle("Logs.Draggable column settings"))+" ")])]},proxy:!0}])},[t("el-checkbox-group",{model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},[t("dgiot-draggable",{attrs:{list:e.logcolumns}})],1)],1)],1)],1)],1)],1),t("el-table",{key:e.finallyColumns.length+e.momentKey,ref:"dragTable",staticClass:"logs-table",attrs:{border:"",data:e.logdata,"default-expand-all":"",height:e.height,"highlight-current-row":"",resizable:"","row-class-name":e.tableRowClassName,stripe:""},scopedSlots:e._u([{key:"empty",fn:function(){return[t("dgiot-empty")]},proxy:!0}])},[t("el-table-column",{attrs:{align:"center",fixed:"left",label:"time",prop:"time","show-overflow-tooltip":"",sortable:"",width:"160"}}),e._l(e.finallyColumns,(function(a,i){return t("el-table-column",{key:i,attrs:{align:"center",label:a,prop:a,"show-overflow-tooltip":"",sortable:"",width:e.w80.includes(a)?80:e.Wh120.includes(a)?120:"auto"}})})),t("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-descriptions",{staticClass:"margin-top",attrs:{border:"",column:2}},[t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{directives:[{name:"copy",rawName:"v-copy",value:a.row.msg,expression:"props.row.msg"}],staticClass:"el-icon-copy-document"})]),e._v(" "+e._s(a.row.msg)+" ")],2)],1)]}}])})],2),t("dgiot-Pagination",{directives:[{name:"show",rawName:"v-show",value:e.queryForm.total>0,expression:"queryForm.total > 0"}],attrs:{limit:e.queryForm.pageSize,page:e.queryForm.pageNo,total:e.queryForm.total},on:{"update:limit":function(t){return e.$set(e.queryForm,"pageSize",t)},"update:page":function(t){return e.$set(e.queryForm,"pageNo",t)},pagination:e.queryTable}})],1)},r=[],o=i("d292"),l=(t,a,i)=>new Promise((s,r)=>{var o=t=>{try{n(i.next(t))}catch(e){r(e)}},l=t=>{try{n(i.throw(t))}catch(e){r(e)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,l);n((i=i.apply(t,a)).next())}),n={name:"HistoryLog",data(){return{isFullscreen:!1,height:this.$baseTableHeight(0),logdata:[],momentKey:moment(new Date).valueOf(),checkList:["pid","level","mfa","line"],logcolumns:["pid","level","domain","mfa","line","clientid","topic","peername"],fold:!0,w80:["line","level"],Wh120:["pid","domain","gl"],Wh200:["time","clientid","peername"],leverData:["debug","info","notice","warning","error","crtical","alert","emergency"],queryForm:{total:0,count:"objectId",limit:20,pageNo:1,pageSize:20,skip:0,level:"",peername:"",pid:"",mfa:"",topic:"",domain:"",searchDate:[moment().subtract("days",7).format("yyyy-MM-DD HH:mm:ss.SSSSSS"),moment(new Date).format("yyyy-MM-DD HH:mm:ss.SSSSSS")],order:"-createdAt",keys:"count(*)"}}},computed:{dragOptions(){return{animation:600,group:"description"}},finallyColumns(){return this.logcolumns.filter(e=>this.checkList.includes(e))}},created(){},mounted(){this.queryTable({}),this.rowDrop(),this.columnDrop()},methods:{handleHeight(){this.isFullscreen=!this.isFullscreen,this.isFullscreen?this.height=this.$baseTableHeight(0)+120:this.height=this.$baseTableHeight(0),this.momentKey=moment(new Date).valueOf()},tableRowClassName({row:e}){return e.disabled?"disabled":""},rowDrop(){const e=this.$refs.dragTable.$el.querySelector(".el-table__body-wrapper tbody"),t=this;Sortable.create(e,{draggable:".el-table__row",onEnd({newIndex:e,oldIndex:a}){const i=t.logdata.splice(a,1)[0];t.logdata.splice(e,0,i)}})},columnDrop(){const e=this,t=this.$refs.dragTable.$el.querySelector(".el-table__header-wrapper tr");e.sortable=Sortable.create(t,{animation:180,delay:0,onEnd:t=>{const a=e.finallyColumns[t.oldIndex];e.finallyColumns.splice(t.oldIndex,1),e.finallyColumns.splice(t.newIndex,0,a),e.momentKey=moment(new Date).valueOf(),setTimeout(()=>{e.rowDrop(),e.columnDrop()},1500)}})},queryTable(){return l(this,arguments,(function*(e={}){e.limit||(e=this.queryForm);const t=this.$baseColorfullLoading();dgiotlog.log(this.queryForm,"queryForm",e);try{t.close();const a={limit:e.limit,skip:e.skip,order:e.order,count:this.queryForm.count,include:"",where:{level:this.queryForm.level?this.queryForm.level:{$ne:"3333"},pid:this.queryForm.pid?{$regex:this.queryForm.pid,$options:"i"}:{$ne:"3333"},mfa:this.queryForm.mfa?{$regex:this.queryForm.mfa,$options:"i"}:{$ne:"3333"},domain:this.queryForm.domain?{$all:this.queryForm.domain.split(/,(?=(?:[^']*(?:'[^']*')?[^']*)*$)/)}:{$ne:""},topic:this.queryForm.topic?{$regex:this.queryForm.topic,$options:"i"}:{$ne:"3333"},peername:this.queryForm.peername?{$regex:this.queryForm.peername,$options:"i"}:{$ne:"3333"},clientid:this.queryForm.clientid?{$regex:this.queryForm.clientid,$options:"i"}:{$ne:"3333"}}},{results:i=[],count:s=0}=yield Object(o["queryLog"])(a);i.forEach(e=>{e.time=this.$moment(Number(e.time.toString().substring(0,13))).format("YYYY-MM-DD HH:mm:ss.SSS")}),this.logdata=i,this.queryForm.total=s,this.$baseMessage(this.$translateTitle("alert.Data request successfully"),"success","dgiot-hey-message-success"),t.close()}catch(a){t.close(),dgiotlog.log(a),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+a,"error","dgiot-hey-message-error")}this.momentKey=moment(new Date).valueOf()}))}}},c=n,d=(i("c077"),i("2877")),u=Object(d["a"])(c,s,r,!1,null,"04ec04ce",null);a["default"]=u.exports},"9ecf":function(e,t,a){"use strict";a("0452")},a0e3:function(t,a,i){"use strict";i.r(a);var s=i("7212"),r=i("8ba7"),o=i("58dd"),l=i("5880"),n=i("bb22"),c=i("03b1"),d=i("ef68"),u=Object.defineProperty,m=Object.defineProperties,h=Object.getOwnPropertyDescriptors,p=Object.getOwnPropertySymbols,g=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable,b=(e,t,a)=>t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,y=(e,t)=>{for(var a in t||(t={}))g.call(t,a)&&b(e,a,t[a]);if(p)for(var a of p(t))f.call(t,a)&&b(e,a,t[a]);return e},v=(e,t)=>m(e,h(t)),w=(t,a,i)=>new Promise((s,r)=>{var o=t=>{try{n(i.next(t))}catch(e){r(e)}},l=t=>{try{n(i.throw(t))}catch(e){r(e)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,l);n((i=i.apply(t,a)).next())});a["default"]={name:"ReportIndex",components:{},data(){const e=(e,t,a)=>{""===t?a(new Error("请上传文件")):a()};return{queryForm:{name:"",category:""},paginations:{},queryPayload:{include:"category",order:"-updatedAt",limit:10,skip:0,keys:"count(*)"},tableData:[],categoryTreeData:[],fileList:[],momentKey:moment(new Date).valueOf(),ruleForm:{file:null,name:"",category:"",factory:"",date2:""},rules:{name:[{required:!0,message:"请输入模板名称",trigger:"blur"}],categoryname:[{required:!0,message:"请选择所属品类",trigger:"blur"}],factory:[{required:!0,message:"请输入厂商名称",trigger:"blur"}],file:[{validator:e,trigger:"blur"}]},activePopShow:!1,tempPopShow:!1,isFullscreen:!1,border:!0,height:this.$baseTableHeight(0)-20,stripe:!0,lineHeight:"medium",checkList:["objectId","Template name","category","Trade Names","Creation time"],columns:[{label:"objectId",width:120,prop:"objectId",sortable:!0,disableCheck:!0},{label:"Template name",width:"auto",prop:"name",sortable:!0},{label:"category",width:"auto",prop:"category.name",sortable:!0},{label:"Trade Names",width:"auto",prop:"devType",sortable:!0},{label:"Creation time",width:"auto",prop:"createdAt",sortable:!0}],list:[],tempList:[],views:[],listLoading:!0,layout:"total, sizes, prev, pager, next, jumper",temprow:{},cascaderDrawer:!1}},computed:v(y({},Object(l["mapGetters"])({language:"settings/language",collapse:"settings/collapse"})),{dragOptions(){return{animation:600,group:"description"}},finallyColumns(){return this.columns.filter(e=>this.checkList.includes(e.label))}}),watch:{language:{deep:!0,limit:!0,handler(e){dgiotlog.warn(e)}}},created(){},mounted(){this.categorytree(),this.fetchData()},methods:{paginationQuery(e){return w(this,null,(function*(){this.queryPayload=e}))},handlecateClick(){this.categorytree(),this.cascaderDrawer=!0},queryProdut(e){return w(this,null,(function*(){const t=e.categorys,a=this.$baseColorfullLoading();e.limit||(e=this.queryForm);let i={limit:e.limit,order:e.order,skip:e.skip,keys:e.keys,include:"category",where:{category:t?{$in:t}:{$ne:null},name:e.name?{$regex:e.name,$options:"i"}:{$ne:null}}};try{const{results:e=[],count:t=0}=yield Object(d["queryProductTemplet"])(i);a.close(),this.tableData=e,this.queryForm.total=t}catch(s){a.close(),dgiotlog.log(s),this.$baseMessage(s,"error","dgiot-hey-message-error")}}))},handleCateSearch(e){if(this.queryForm.category=e,this.showcateTree=!this.showcateTree,"a60a85475a"==e)this.queryProdut({});else{let t={keys:"objectId",where:{parent:{className:"Category",objectId:e,__type:"Pointer"}}};Object(c["queryCategory"])(t).then(t=>{const a=[];a.push(e),t.results.forEach(e=>{a.push(e.objectId)}),this.queryProdut({categorys:a})})}},referenceHandle(e){dgiotlog.log("prodtemp",e)},chooseTemplate(e){return w(this,null,(function*(){this.$set(this.ruleForm,"categoryname",e.category.name),this.$set(this.ruleForm,"categoryid",e.category.objectId),this.$set(this.ruleForm,"producttempid",e.objectId),this.cascaderDrawer=!this.cascaderDrawer}))},categorytree(){return w(this,null,(function*(){let t={class:"Category",filter:'{"order": "createdAt","keys":["parent","name","level"],"where":{"parent": "d6ad425529"}}',parent:"parent"};dgiotlog.log(t);try{const{results:e=[]}=yield Object(n["post_tree"])(t);this.categoryTreeData=e}catch(e){dgiotlog.log("categorytree error",e)}}))},onBeforeUploadImage(e){const t=["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword"];dgiotlog.warn(e,e.size,e.size/1024/1024<30,t.includes(e.type),e.type);const a=t.includes(e.type),i=e.size/1024/1024<30;return a||this.$baseMessage("上传文件只能是doc/docx格式!","error","dgiot-hey-message-error"),i||this.$baseMessage("上传文件大小不能超过 30MB!","error","dgiot-hey-message-error"),this.momentKey=moment(new Date).valueOf(),a&&i},UploadImage(e){dgiotlog.warn(e,"param"),this.ruleForm.file=e.file},fileChange(e){this.$refs.upload.clearFiles(),this.logo=e.raw,this.fileList=[{name:e.name,url:e.url}]},submitUpload(){this.$refs.upload.submit()},handlePreview(e){dgiotlog.log(e)},submitForm(t){this.$refs[t].validate(t=>w(this,null,(function*(){if(!t)return dgiotlog.log("error submit!!"),!1;{const t=new FormData,a={identifier:"inspectionReportTemp",client:this.ruleForm.factory,category:this.ruleForm.categoryid,producttemplet:this.ruleForm.producttempid};t.append("devType",this.ruleForm.factory),t.append("name",this.ruleForm.name),t.append("config",JSON.stringify(a)),t.append("file",this.ruleForm.file);const i=this.$baseColorfullLoading(1);try{const{result:e}=yield Object(o["postReportFile"])(t);dgiotlog.log(e),this.$baseMessage(this.$translateTitle("cloudTest.Template created successfully"),"success","dgiot-hey-message-success"),this.activePopShow=!1,this.fetchData()}catch(e){this.$baseMessage(this.$translateTitle("cloudTest.Template creation failed"),"error","dgiot-hey-message-error")}i.close()}})))},resetForm(e){this.ruleForm.file=null,this.fileList=[],this.$refs[e].resetFields()},clickFullScreen(){this.isFullscreen=!this.isFullscreen,this.handleHeight()},handleHeight(){this.isFullscreen?this.height=this.$baseTableHeight(1)+210:this.height=this.$baseTableHeight(1)},handleAdd(){this.activePopShow=!0},handlekonva(e,t){this.$router.push({path:"/Topo",query:{viewid:e.objectId,guide:!0,page:t,productid:e.key,type:"Evidence",noTools:!0,isDirver:!0,list:JSON.stringify(this.views),length:this.views.length-1}})},handleManagement(t){return w(this,null,(function*(){this.temprow=t;const a={limit:50,skip:0,keys:"count(*)",where:{type:"topo",class:"Product",key:t.objectId},order:"createdAt,title"},i=this.$baseColorfullLoading(1);try{const{count:e=0,results:t}=yield Object(r["queryView"])(a);this.tempList=t,this.views=[],this.tempList.forEach((e,t)=>{this.views.push({page:t,viewid:e.objectId})})}catch(e){}this.tempPopShow=!0,i.close()}))},handleDelete(e,t){this.$baseConfirm(this.$translateTitle("Maintenance.Are you sure you want to delete the current item"),null,()=>w(this,null,(function*(){yield Object(s["delProduct"])(e.objectId);this.$baseMessage(this.$translateTitle("Maintenance.successfully deleted"),"success","dgiot-hey-message-success"),0==t?yield this.fetchData():yield this.handleManagement(this.temprow)})))},fetchData(){return w(this,null,(function*(){this.queryPayload.where={name:this.queryForm.name?{$regex:this.queryForm.name}:{$ne:null},netType:"Evidence",nodeType:1},dgiotlog.log(this.queryPayload),this.listLoading=!0;const{count:e=0,results:t=[]}=yield Object(s["queryProduct"])(this.queryPayload);this.$refs["paginations"].ination.total=e,t.forEach(e=>{e.createdAt=moment(e.createdAt).format("YYYY-MM-DD HH:mm:ss")}),this.list=t,this.listLoading=!1}))}}}},a336:function(e,t,a){},a7cf:function(t,a,i){"use strict";i.r(a);var s,r,o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"things-parse"},[t("el-dialog",{attrs:{"append-to-body":!0,title:e.$translateTitle("product.newapi"),visible:e.apiDialog,width:"30%"},on:{"update:visible":function(t){e.apiDialog=t}}},[t("el-form",{ref:"formLabelAlign",attrs:{"label-position":"left","label-width":"170px",model:e.formLabelAlign,rules:e.rules,size:"mini"}},[t("el-form-item",{attrs:{label:e.$translateTitle("plugins.modulename"),prop:"name"}},[t("el-input",{model:{value:e.formLabelAlign.name,callback:function(t){e.$set(e.formLabelAlign,"name",t)},expression:"formLabelAlign.name"}})],1),t("el-form-item",{attrs:{label:e.$translateTitle("plugins.programinglanguage"),prop:"language"}},[t("el-select",{attrs:{placeholder:e.$translateTitle("resource.zoneofaction")},model:{value:e.formLabelAlign.language,callback:function(t){e.$set(e.formLabelAlign,"language",t)},expression:"formLabelAlign.language"}},e._l(e.formLabelAlign.languageList,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.submitFormApi("formLabelAlign")}}},[e._v(" "+e._s(e.$translateTitle("developer.create"))+" ")]),t("el-button",{attrs:{size:"mini"},on:{click:function(t){e.apiDialog=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")])],1)],1),t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:7}},[t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.addApi.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.newapi"))+" ")]),t("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:e.AllDict,"highlight-current-row":""},on:{"current-change":e.handleCurrentChange}},[t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("rule.Type"),width:"100"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(a.type))])]}}])}),t("el-table-column",{attrs:{align:"center",label:"mod","show-overflow-tooltip":!0,width:"120"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(a.mod))])]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("task.Operation")},scopedSlots:e._u([{key:"default",fn:function({row:a,$index:i}){return[t("el-button",{attrs:{size:"mini",title:e.$translateTitle("rule.testnewequipment")},on:{click:function(t){return e.handleTest(i,a.type,a.mod)}}},[t("dgiot-icon",{attrs:{icon:"bug-line"}})],1),t("el-button",{attrs:{size:"mini",title:e.$translateTitle("product.pub"),type:"primary"},on:{click:function(t){return e.handleRelease(i,a.type,a.mod)}}},[t("dgiot-icon",{attrs:{icon:"run-line"}})],1),t("el-button",{attrs:{size:"mini",title:e.$translateTitle("equipment.Offtheshelf"),type:"danger"},on:{click:function(t){return e.handleDelete(i,a.type,a.mod)}}},[t("dgiot-icon",{attrs:{icon:"delete-bin-2-fill"}})],1)]}}])})],1)],1),t("el-col",{attrs:{span:17}},[t("div",{staticClass:"protolheader"},[t("el-tabs",{attrs:{size:"mini"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$translateTitle("product.Design"),name:"design"}},[t("DgiotJsonEditor",{ref:"jsonEdit",model:{value:e.itemSwagger,callback:function(t){e.itemSwagger=t},expression:"itemSwagger"}})],1),t("el-tab-pane",{attrs:{label:e.$translateTitle("product.code"),name:"code"}},[t("el-form",{ref:"thingsParseModel",attrs:{inline:!0,model:e.thingsParseModel,rules:e.thingsParseRules}}),t("div",[t("div",{staticStyle:{background:"#ffffff"}},[t("label",{attrs:{id:"plug-name"}})]),t("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"480px","margin-bottom":"0"},attrs:{id:"editor"}},[t("textarea",{staticClass:"ace_text-input"})]),t("div",{staticStyle:{background:"#ffffff"}},[t("label",{attrs:{id:"plug-name"}})]),t("div",{staticStyle:{padding:"5px","margin-right":"80px",color:"#c2be9e",background:"#272822","border-top":"1px solid #dddddd"}},[t("span",[e._v(e._s(e.$translateTitle("product.controloutput")))])]),t("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"200px","margin-top":"0","margin-bottom":"0"},attrs:{id:"editor2"}},[t("textarea",{staticClass:"ace_text-input"})])])],1),t("el-tab-pane",{attrs:{label:e.$translateTitle("rule.Test"),name:"swagger"}},[t("iframe",{attrs:{height:"700vh",src:e.swaggerPath,width:"100%"}})])],1)],1)])],1)],1)},l=[],n=i("e0e9"),c=i("1285"),d=i("89e8"),u=i("4d2d"),m=i("bb22"),h=(e,t,a)=>new Promise((i,s)=>{var r=e=>{try{l(a.next(e))}catch(t){s(t)}},o=e=>{try{l(a.throw(e))}catch(t){s(t)}},l=e=>e.done?i(e.value):Promise.resolve(e.value).then(r,o);l((a=a.apply(e,t)).next())}),p="",g="",f={name:"ThingsParse",components:{},props:{},data(){var e=(e,t,a)=>{const i=/[0-9a-zA-Z]/;i.test(t)?a():a(new Error("协议名称由数字和字母组合"))};return{fullscreenLoading:!1,rules:{name:[{required:!0,validator:e,trigger:"blur"}],language:[{required:!0,message:"请选择编程语言",trigger:"change"}]},labelPosition:"right",formLabelAlign:{languageList:["python","java","ruby"],language:"python",name:"",region:"",type:""},apiDialog:!1,activeName:"design",itemSwagger:{},currentRow:null,AllDict:[],productName:"",form:{Productname:"",ProductKey:"",ProductAll:0},swaggerPath:"http://127.0.0.1:5080/swagger/#/",decoderstart:0,decodertotal:0,decoderlength:10,protolchannel:[],productdetail:{},thingsParseModel:{name:"",version:"",desc:"",resource:!1},thingsParseRules:{name:[{required:!0,message:"请输入协议名称",trigger:"blur"},{validator:e,trigger:"blur"}]},dialogTableVisible:!1,gridData:[],protoldialog:!1}},computed:{tableFilterData(){return null}},mounted(){r=ace.edit("editor2"),r.session.setMode("ace/mode/python"),r.setTheme("ace/theme/monokai"),r.setReadOnly(!0),r.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}),this.getAllDict(),this.setPath(),this.$route.query.activeName&&(this.activeName=this.$route.query.activeName)},methods:{setPath(){dgiotlog.log("production"),this.swaggerPath=location.origin+"/swagger/#/"},handleDelete(e,t,a){this.$confirm("确认要下架该api吗？").then(i=>h(this,null,(function*(){const i=yield Object(u["delExproto"])({type:t,mod:a,version:"debug"});i&&this.AllDict.splice(e,1)}))).catch(e=>{})},handleTest(t,a,i){return h(this,null,(function*(){const t={code:Base64.encode(s.getValue()),mod:i,swagger:JSON.parse(this.itemSwagger),type:a},{results:o}=yield Object(u["putExproto"])(t);o?(r.setValue(Base64.decode(o)),this.$message({showClose:!0,duration:2e3,message:"调测api成功",type:"success"})):(dgiotlog.log(e),this.$baseMessage("api有错误,请检查","error","dgiot-hey-message-error"))}))},handleRelease(e,t,a){return h(this,null,(function*(){const e={code:Base64.encode(s.getValue()),mod:a,swagger:JSON.parse(this.itemSwagger),type:t},i=yield Object(u["postExproto"])(e);i?this.$message({showClose:!0,duration:2e3,message:"发布api成功",type:"success"}):this.$baseMessage("api有错误,请检查","error","dgiot-hey-message-error")}))},addApi(){this.apiDialog=!0},submitFormApi(t){this.$refs[t].validate(t=>h(this,null,(function*(){const a={python:"IyBjb2Rpbmc9dXRmOAppbXBvcnQgb3MKCmRlZiBwb3N0KGFyZ3Msc2Vzc2lvbixlbnYpOgogICAgI2JvZHkgPSBqc29uLmxvYWRzKGJhc2U2NC5iNjRkZWNvZGUoYXJncykuZGVjb2RlKCJ1dGYtOCIpKQogICAgI3ByaW50KGJvZHkpCiAgICAjc3RyYm9keSA9ICd7fScuZm9ybWF0KGJvZHkpCiAgICAjZW5ib2R5ID0gIGJhc2U2NC5iNjRlbmNvZGUoc3RyYm9keS5lbmNvZGUoJ3V0Zi04JykpCiAgICAjcHJpbnQoZW5ib2R5KQogICAgI3N0YXRlID0ganNvbi5sb2FkcyhiYXNlNjQuYjY0ZGVjb2RlKGVudikuZGVjb2RlKCJ1dGYtOCIpKQogICAgI3ByaW50KHN0YXRlKQogICAgIyByZXN0dXJsID0gc3RhdGVbJ3JvbGVzJ11bMF1bJ3RhZyddWydhcHBjb25maWcnXVsncmVzdCddCiAgICAjIHByaW50KHJlc3R1cmwpCiAgICAjIHMuaGVhZGVycy51cGRhdGUoeyJzZXNzaW9uVG9rZW4iOiBzZXNzaW9uLCAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfSkKICAgICMgcnQgPSBzLmdldCgne30vY2xhc3Nlcy9EZXZpY2U/b3JkZXI9Y3JlYXRlZEF0JmxpbWl0PTEwJnNraXA9MCcuZm9ybWF0KHJlc3R1cmwpLAogICAgIyAgICAgICAgICAgICAgcGFyYW1zPXsnb3JkZXInOiAnY3JlYXRlZEF0JywgfSkKICAgICMgZm9yIHJvdyBpbiAocnQuanNvbigpWydyZXN1bHRzJ10pOgogICAgIyAgICAgcHJpbnQocm93KQogICAgcHJpbnQoYXJncykKICAgIHByaW50KHNlc3Npb24pCiAgICBwcmludChlbnYpCiAgICByZXR1cm4gYXJncwoKZGVmIG1haW4oKToKICAgICN7Im5hbWUiOiJzaHV3YSJ9CiAgICBhcmd2cyA9ICdleUp1WVcxbElqb2ljMmgxZDJFaWZRPT0nCiAgICByZXR1cm4gIHBvc3QoYXJndnMsICdzZXNzaW9uJywnZW52JykKCmRlZiBleGl0KCk6CiAgICBvcy5fZXhpdCgwKQoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIG1haW4oKQ==",java:"",ruby:""},i=(this.formLabelAlign.name,{code:a[this.formLabelAlign.language],mod:this.formLabelAlign.name,swagger:{definitions:{},paths:{"/python_hello":{post:{description:"Python测试API",parameters:[{description:"生成报告",in:"body",name:"data",required:!0,schema:{properties:{name:{description:"姓名",example:"shuwa",required:!0,type:"string"}},type:"object"}}],responses:{200:{description:"Returns operation status"},400:{description:"Bad Request"},401:{description:"Unauthorized"},403:{description:"Forbidden"},500:{description:"Server Internal error"}},summary:"Python测试API",tags:["EXPROTO"]}}},tags:[{description:"扩展编程",name:"EXPROTO"}]},type:this.formLabelAlign.language});if(t){const t=yield Object(u["getExproto"])(i);t?(this.apiDialog=!1,this.$message({showClose:!0,duration:2e3,type:"success",message:"新增api成功"}),this.getAllDict()):this.$message({showClose:!0,duration:2e3,type:"error",message:"新增api失败"+e})}})))},handleCurrentChange(e){dgiotlog.log(e,"val");const{swagger:t={}}=e;this.itemSwagger=t,s=ace.edit("editor"),s.session.setMode("ace/mode/python"),s.setTheme("ace/theme/monokai"),s.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}),s.setValue(Base64.decode(e.code)),s.gotoLine(s.session.getLength())},toggle(e){dgiotlog.log(e)},getAllDict(){return h(this,null,(function*(){const{results:e}=yield Object(u["getExproto"])({type:"python",mod:"all",version:"debug"});e&&(this.AllDict=e,dgiotlog.log(this.AllDict),this.AllDict.length&&this.handleCurrentChange(e[0]))}))},Industry(){return h(this,null,(function*(){this.option=[];const e={limit:1e3,where:{"data.key":"category"}},{results:t}=yield Object(n["queryDict"])(e);t.map(e=>{var t={};t.value=e.type,t.label=e.data.CategoryName,t.id=e.data.Id,t.parentid=e.data.SuperId,this.option.push(t)})}))},getProDetail(e){this.productId=e,s=ace.edit("editor"),s.session.setMode("ace/mode/erlang"),s.setTheme("ace/theme/monokai"),s.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}),this.$get_object("Product",e).then(e=>{if(e){for(var t in this.productName=e.name,e)this.productdetail[t]=e[t];this.option.map(e=>{this.productdetail.category==e.value&&(this.productdetail.category=e.label)}),this.productdetail.createdAt=this.utc2beijing(e.createdAt),this.productdetail.id=e.id,this.dynamicReg=e.dynamicReg,this.productdetail.isshow=0,this.form.Productname=e.name,this.ProductSecret=e.productSecret,this.form.Productkey=this.productId,this.productimg=e.icon,e.decoder?(g=e.decoder.code,this.thingsParseModel.name=e.decoder.name,this.thingsParseModel.version=e.decoder.version,this.thingsParseModel.desc=e.decoder.desc):g="JSUlLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQolJSUgQGNvcHlyaWdodCAoQykgMjAxOCwgPHNodXdhPgolJSUgQGRvYwolJSUg5Y2P6K6u6Kej5p6QRGVtbwolJSUgQGVuZAolJSUgQ3JlYXRlZCA6IDA4LiDljYHkuIDmnIggMjAxOCAxNDo0OQolJSUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi1tb2R1bGUoc2h1d2FfZGVtb19kZWNvZGVyKS4KLWF1dGhvcigic2h1d2EiKS4KLWRlZmluZShNU0dfVFlQRSwgPDwiREVNTyI+PikuCi1wcm90b2NvbChbPDwiREVNTyI+Pl0pLgoKLWV4cG9ydChbcGFyc2VfZnJhbWUvMiwgdG9fZnJhbWUvMV0pLgoKCnBhcnNlX2ZyYW1lKEJ1ZmYsIE9wdHMpIC0+CiAgICBwYXJzZV9mcmFtZShCdWZmLCBbXSwgT3B0cykuCgoKcGFyc2VfZnJhbWUoPDw+PiwgQWNjLCBfT3B0cykgLT4KICAgIHs8PD4+LCBBY2N9OwpwYXJzZV9mcmFtZSg8PDE2IzY4LCBSZXN0L2JpbmFyeT4+ID0gQmluLCBBY2MsIF9PcHRzKSB3aGVuIGJ5dGVfc2l6ZShSZXN0KSA9PCA2IC0+CiAgICB7QmluLCBBY2N9OwpwYXJzZV9mcmFtZSg8PDE2IzY4LCBMZW46MTYvbGl0dGxlLWludGVnZXIsIExlbjoxNi9saXR0bGUtaW50ZWdlciwgMTYjNjgsIFJlc3QvYmluYXJ5Pj4gPSBCaW4sIEFjYywgT3B0cykgLT4KICAgIGNhc2UgYnl0ZV9zaXplKFJlc3QpIC0gMiA+PSBMZW4gb2YKICAgICAgICB0cnVlIC0+CiAgICAgICAgICAgIGNhc2UgUmVzdCBvZgogICAgICAgICAgICAgICAgPDxVc2VyWm9uZTpMZW4vYnl0ZXMsIENyYzo4LCAxNiMxNiwgUmVzdDEvYmluYXJ5Pj4gLT4KICAgICAgICAgICAgICAgICAgICBBY2MxID0KICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBzaHV3YV91dGlsczpnZXRfcGFyaXR5KFVzZXJab25lKSA9Oj0gQ3JjIG9mCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnVlIC0+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRnJhbWUgPSAjewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8PCJtc2d0eXBlIj4+ID0+ID9NU0dfVFlQRSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPDwiZGF0YSI+PiA9PiBVc2VyWm9uZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQWNjICsrIFtGcmFtZV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWxzZSAtPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFjYwogICAgICAgICAgICAgICAgICAgICAgICBlbmQsCiAgICAgICAgICAgICAgICAgICAgcGFyc2VfZnJhbWUoUmVzdDEsIEFjYzEsIE9wdHMpOwogICAgICAgICAgICAgICAgXyAtPgogICAgICAgICAgICAgICAgICAgIHBhcnNlX2ZyYW1lKFJlc3QsIEFjYywgT3B0cykKICAgICAgICAgICAgZW5kOwogICAgICAgIGZhbHNlIC0+CiAgICAgICAgICAgIHtCaW4sIEFjY30KICAgIGVuZDsKcGFyc2VfZnJhbWUoPDxfOjgsIFJlc3QvYmluYXJ5Pj4sIEFjYywgT3B0cykgLT4KICAgIHBhcnNlX2ZyYW1lKFJlc3QsIEFjYywgT3B0cykuCgoKJSUg57uE6KOF5oiQ5bCB5YyFLCDlj4LmlbDkuLpNYXDlvaLlvI8KdG9fZnJhbWUoI3s8PCJtc2d0eXBlIj4+IDo9ID9NU0dfVFlQRX0gPSBGcmFtZSkgLT4KICAgIFBheWxvYWQgPSB0ZXJtX3RvX2JpbmFyeShGcmFtZSksCiAgICA8PDE2IzAzLCBQYXlsb2FkL2JpbmFyeSwgMTYjMjM+Pi4=",this.productdetail.thing||(this.productdetail.thing={properties:[]}),this.wmxData=this.productdetail.thing.properties.filter(e=>e.name&&e.dataType),s.setValue(Base64.decode(g)),s.gotoLine(s.session.getLength()),this.queryDeviceCount(this.productId)}})},queryDeviceCount(e){return h(this,null,(function*(){this.form.ProductAll=yield Object(c["getDeviceCountByProduct"])(e)}))},editordata(e){this.thingsParseModel.name=e.attributes.data.name,this.thingsParseModel.version=e.attributes.data.version,this.thingsParseModel.desc=e.attributes.data.desc,this.thingsParseModel.resource=e.attributes.data.enable,s.setValue(Base64.decode(e.attributes.data.code)),this.dialogTableVisible=!1},getAllunit(){return h(this,null,(function*(){this.allunit=[];const{results:e}=yield Object(n["getAllunit"])("unit",100);this.allunit=e.concat([]),this.allunit.unshift({data:{Name:"无",Symbol:""}})}))},subAce(e,t){this.$refs[e].validate(a=>{if(a){var i={name:e.name,version:e.version,code:Base64.encode(s.getValue()),desc:e.desc};const a={decoder:i};this.$update_object("Product",this.productId,a).then(e=>{0==this.issub&&(this.$message({showClose:!0,duration:2e3,type:"success",message:"保存成功"}),1==t&&(p+="保存成功",r.setValue(p))),this.issub=!0}).catch(e=>{dgiotlog.log(e)})}else this.$message({showClose:!0,duration:2e3,type:"warning",message:"输入格式有误"})})},subAce1(e){this.$refs[e].validate(e=>{if(e){const e={where:{"data.name":this.formInline.name,"data.version":this.formInline.version}};this.$query_object("Dict",e).then(e=>{e.results&&e.results.length>=1?this.$message("此协议版本已存在"):this.$get_object("Product",this.productId).then(e=>{if(e){var t={name:this.formInline.name,version:this.formInline.version,code:Base64.encode(s.getValue()),desc:this.formInline.desc};const a={key:this.formInline.name+":"+this.formInline.version,type:"decoder",data:t,ACL:e.ACL};this.$create_object("Dict",a).then(e=>{e.error?this.$message({showClose:!0,duration:2e3,type:"error",message:e.error}):this.$message({showClose:!0,duration:2e3,type:"success",message:"保存到公共协议库成功"})}).catch(e=>{dgiotlog.log(e)})}})}).catch(e=>{dgiotlog.log(e)})}else this.$message({showClose:!0,duration:2e3,type:"warning",message:"输入格式有误"})})},decoderSizeChange(e){this.decoder.length=e,this.chaxun()},devicerCurrentChange(e){this.decoderstart=(e-1)*this.decoderlength,this.chaxun()},updateAllChannel(){if(0==this.multipleSelection.length)this.protoldialog=!1;else{var e=[];this.multipleSelection.map(t=>{e.push(new Promise((e,a)=>Object(m["subupadte"])(t.id,"update").then(t=>{t&&e(t)}).catch(e=>{a(e)})))}),Promise.all(e).then(e=>{this.$message({showClose:!0,duration:2e3,message:"热加载成功",type:"success"}),e.length==this.multipleSelection.length&&(this.protoldialog=!1)}).catch(e=>{this.$message({showClose:!0,duration:2e3,message:e,type:"error"})})}},handleSelectionChange(e){this.multipleSelection=e},utc2beijing(e){var t=new Date(+new Date(e)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"");return t},getChannelEnable(e,t){return 1==e.row.attributes.isEnable?"green_active":"red_active"},deletedata(e){this.$del_object("Dict",e).then(e=>{e&&(this.$message("成功删除"),this.chaxun())}).catch(e=>{dgiotlog.log(e)})},updatesubdialog(){return h(this,null,(function*(){this.protoldialog=!0;const e="1",t={__type:"Pointer",className:"Product",objectId:this.productId};Object(d["getChannelCountByProduct"])(this.channellength,this.channelstart,t,e).then(e=>{this.protolchannel=e.results,this.$refs.multipleTable.toggleAllSelection()}).catch(e=>{dgiotlog.log(e),this.$baseMessage("请求出错",e.error,3e3)})}))},chaxun(){const e={count:"objectId",skip:this.decoderstart,limit:this.decoderlength,where:{type:"decoder"}};this.dialogTableVisible=!0,this.$query_object("Dict",e).then(e=>{e&&(this.decodertotal=e.count,this.gridData=e.results)}).catch(e=>{dgiotlog.log(e)})},protol(){var e="";Object(m["Compile"])(Base64.encode(s.getValue())).then(t=>{t&&(this.$message({showClose:!0,duration:2e3,type:"success",message:"编译成功"}),e="编译成功"+t.mod+"\r\n",this.warningeditror=t.warnings,this.warningeditror.map(t=>{e+=t+"\r\n"}),p+=e,r.setValue(p))}).catch(t=>{this.warningeditror=t.error,this.warningeditror.map(t=>{e+=t+"\r\n"}),p+=e,r.setValue(p)})}}},b=f,y=(i("9ecf"),i("2877")),v=Object(y["a"])(b,o,l,!1,null,null,null);a["default"]=v.exports},a82f:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"CloudSystem-container"},[t("el-tabs",{ref:"_tabs",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$translateTitle("system.smsconfiguration"),name:"first"}},[t("div",{staticStyle:{"text-align":"center"}},[t("el-form",{ref:"form",staticClass:"demo-form",attrs:{"label-width":"100px"}},[t("el-form-item",{attrs:{label:"AppID"}},[t("el-input",{attrs:{placeholder:"请输入AppID"},model:{value:e.configurationInfo.sms.appid,callback:function(t){e.$set(e.configurationInfo.sms,"appid",t)},expression:"configurationInfo.sms.appid"}})],1),t("el-form-item",{attrs:{label:"AppKey"}},[t("el-input",{attrs:{placeholder:"请输入AppKey"},model:{value:e.configurationInfo.sms.appkey,callback:function(t){e.$set(e.configurationInfo.sms,"appkey",t)},expression:"configurationInfo.sms.appkey"}})],1),t("el-form-item",{attrs:{label:"签名"}},[t("el-input",{attrs:{placeholder:"请输入签名"},model:{value:e.configurationInfo.sms.sign,callback:function(t){e.$set(e.configurationInfo.sms,"sign",t)},expression:"configurationInfo.sms.sign"}})],1),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.save(e.configurationInfo)}}},[e._v(" 保存 ")])],1)],1)]),t("el-tab-pane",{attrs:{label:e.$translateTitle("system.mailconfiguration"),name:"second"}},[t("div",{staticStyle:{"text-align":"center"}},[t("el-form",{ref:"form",staticClass:"demo-form",attrs:{"label-width":"100px"}},[t("el-form-item",{attrs:{label:"邮箱账号"}},[t("el-input",{attrs:{placeholder:"请输入邮箱账号"},model:{value:e.configurationInfo.mail.username,callback:function(t){e.$set(e.configurationInfo.mail,"username",t)},expression:"configurationInfo.mail.username"}})],1),t("el-form-item",{attrs:{label:"邮箱授权码"}},[t("el-input",{attrs:{placeholder:"请输入邮箱授权码"},model:{value:e.configurationInfo.mail.password,callback:function(t){e.$set(e.configurationInfo.mail,"password",t)},expression:"configurationInfo.mail.password"}})],1),t("el-form-item",{attrs:{label:"SMTP"}},[t("el-input",{attrs:{placeholder:"请输入SMTP"},model:{value:e.configurationInfo.mail.smtp,callback:function(t){e.$set(e.configurationInfo.mail,"smtp",t)},expression:"configurationInfo.mail.smtp"}})],1),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.save(e.configurationInfo)}}},[e._v(" 保存 ")])],1)],1)])],1)],1)},s=[],r=a("4569"),o={name:"CloudSystem",components:{},data(){return{activeName:"first",configurationInfo:{},infoData:"CloudSystem"}},computed:{},mounted(){this.smsconfiguration()},beforeCreate(){},beforeMount(){},beforeUpdate(){},updated(){},beforeDestroy(){},destroyed(){},activated(){},methods:{smsconfiguration(){Object(r["getconfiguration"])().then(e=>{this.configurationInfo=e.data})},save(e){Object(r["postconfiguration"])({data:e})}}},l=o,n=(a("b5bb"),a("2877")),c=Object(n["a"])(l,i,s,!1,null,"af59d43e",null);t["default"]=c.exports},ae0b:function(e,t,a){"use strict";a("f106")},b5bb:function(e,t,a){"use strict";a("5e0d")},b755:function(e,t,a){"use strict";a("e252")},bff8:function(e,t,a){},c077:function(e,t,a){"use strict";a("f3d6")},c26a:function(t,a,i){"use strict";i.r(a);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"logs logs-container",class:{"dgiot-fullscreen":e.isFullscreen}},[t("dgiot-query-form",[t("dgiot-query-form-top-panel",[t("el-form",{ref:"form",attrs:{inline:!0,"label-width":"100px",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{staticClass:"item-time",attrs:{label:e.$translateTitle("device.Log type")}},[t("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:e.queryForm.domain,callback:function(t){e.$set(e.queryForm,"domain",t)},expression:"queryForm.domain"}},e._l(e.domainOptions,(function(a){return t("el-option",{key:a,attrs:{label:e.$translateTitle("deviceLog."+a),value:a}})})),1)],1),t("el-form-item",{staticClass:"item-time",attrs:{label:e.$translateTitle("Maintenance.times")}},[t("el-date-picker",{staticClass:"item-time-picker",attrs:{"end-placeholder":e.$translateTitle("Maintenance.end time"),format:"yyyy-MM-dd","start-placeholder":e.$translateTitle("Maintenance.start time"),type:"daterange","value-format":"yyyy-MM-dd"},model:{value:e.queryForm.searchDate,callback:function(t){e.$set(e.queryForm,"searchDate",t)},expression:"queryForm.searchDate"}})],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.isDeviceInfo,expression:"!isDeviceInfo"}],attrs:{label:e.$translateTitle("equipment.Products")}},[t("el-select",{attrs:{clearable:""},model:{value:e.queryForm.productid,callback:function(t){e.$set(e.queryForm,"productid",t)},expression:"queryForm.productid"}},e._l(e.proTableData,(function(a,i){return t("el-option",{directives:[{name:"show",rawName:"v-show",value:0!=a.objectId,expression:"item.objectId != 0"}],key:i,attrs:{label:e.$translateTitle("deviceLog."+a.name),value:a.objectId}})})),1)],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.isDeviceInfo,expression:"!isDeviceInfo"}],attrs:{label:e.$translateTitle("equipment.devicenumber")}},[t("el-input",{attrs:{clearable:"",placeholder:e.$translateTitle("equipment.enterdevicenumber")},model:{value:e.queryForm.devaddr,callback:function(t){e.$set(e.queryForm,"devaddr",t)},expression:"queryForm.devaddr"}})],1),t("el-form-item",[t("el-button",{attrs:{icon:"el-icon-search","native-type":"submit",type:"primary"},on:{click:function(t){return e.queryTable({})}}}),t("el-button",{staticStyle:{margin:"0 10px 10px 10px !important"},attrs:{type:"success"},on:{click:e.handleHeight}},[t("dgiot-icon",{attrs:{icon:e.isFullscreen?"fullscreen-exit-fill":"fullscreen-fill"}})],1),t("el-popover",{attrs:{trigger:"hover"},scopedSlots:e._u([{key:"reference",fn:function(){return[t("el-button",{staticStyle:{margin:"0 0 10px 0 !important"},attrs:{icon:"el-icon-setting",type:"primary"}},[e._v(" "+e._s(e.$translateTitle("Logs.Draggable column settings"))+" ")])]},proxy:!0}])},[t("el-checkbox-group",{model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},[t("dgiot-draggable",{attrs:{list:e.logcolumns}})],1)],1)],1)],1)],1)],1),t("el-dialog",{attrs:{"append-to-body":"",visible:e.preDialog},on:{"update:visible":function(t){e.preDialog=t}}},[t("dgiot-editor",{key:e.refreshFlag,attrs:{height:e.isFullscreen?380:340,lang:"json","max-lines":e.isFullscreen?50:1e3/12,"min-lines":e.isFullscreen?50:1e3/12,theme:"gob"},model:{value:e.msg,callback:function(t){e.msg=t},expression:"msg"}})],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.finallyColumns.length+e.momentKey,ref:"dragTable",staticClass:"block",attrs:{border:"",data:e.logdata,"element-loading-background":"rgba(0, 0, 0, 0.8)","element-loading-spinner":"el-icon-loading","element-loading-text":e.$translateTitle("developer.Waitingtoreturn"),height:e.height,"highlight-current-row":"",resizable:"","row-class-name":e.tableRowClassName,size:"mini",stripe:""},scopedSlots:e._u([{key:"empty",fn:function(){return[t("dgiot-empty")]},proxy:!0}])},[t("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-descriptions",{staticClass:"margin-top",attrs:{border:"",column:2,size:e.size}},e._l(a.row,(function(a,i,s){return t("el-descriptions-item",{key:s,attrs:{label:e.$translateTitle("deviceLog."+i),"label-class-name":"my-label"}},[e._v(" "+e._s(a)+" ")])})),1)]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("device.Log type")},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v(" "+e._s(e.$translateTitle("deviceLog."+t.domain))+" ")]}}])}),e._l(e.finallyColumns,(function(a,i){return t("el-table-column",{key:i,attrs:{align:"center",label:e.$translateTitle("deviceLog."+a),prop:a,"show-overflow-tooltip":"",sortable:""}})})),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("concentrator.operation")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.showDetail(a)}}},[e._v(" "+e._s(e.$translateTitle("concentrator.detail"))+" ")])]}}])})],2),t("dgiot-Pagination",{directives:[{name:"show",rawName:"v-show",value:e.queryForm.total>0,expression:"queryForm.total > 0"}],attrs:{limit:e.queryForm.pageSize,page:e.queryForm.pageNo,total:e.queryForm.total},on:{"update:limit":function(t){return e.$set(e.queryForm,"pageSize",t)},"update:page":function(t){return e.$set(e.queryForm,"pageNo",t)},pagination:e.queryTable}})],1)},r=[],o=i("d292"),l=i("7212"),n=(t,a,i)=>new Promise((s,r)=>{var o=t=>{try{n(i.next(t))}catch(e){r(e)}},l=t=>{try{n(i.throw(t))}catch(e){r(e)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,l);n((i=i.apply(t,a)).next())}),c={name:"AccessLog",props:{productid:{type:String,default:""},devaddr:{type:String,default:""},deviceid:{type:String,default:""},isDeviceInfo:{type:Boolean,default:!0}},data(){return{preDialog:!1,msg:"",loading:!1,size:"",domainOptions:["device_statuslog","device_operationlog","transparent","event","tcp_send","tcp_receive","readProperty","writeProperty","reportProperty","child","childReply","functionInvoke","readPropertyReply","writePropertyReply","functionReply","register","unregister","offline","online","other","parse_api"],isFullscreen:!1,height:this.$baseTableHeight(0),logdata:[],refreshFlag:moment(new Date).valueOf(),momentKey:moment(new Date).valueOf(),checkList:["time","msg"],logcolumns:["devaddr","time","msg","username","productname","devicename","status","protocol","thingname","identifier","value"],proTableData:[],activeName:"second",queryForm:{total:0,count:"objectId",limit:20,pageNo:1,pageSize:20,skip:0,level:"",peername:"",pid:"",mfa:"",topic:"",domain:[],searchDate:[moment().subtract("days",7).format("YYYY-MM-DD"),moment(new Date).format("YYYY-MM-DD")],order:"-createdAt",keys:"count(*)",productid:"",devaddr:""}}},computed:{dragOptions(){return{animation:600,group:"description"}},finallyColumns(){return this.logcolumns.filter(e=>this.checkList.includes(e))}},created(){},mounted(){this.productid&&(this.queryForm.productid=this.productid),this.deviceid&&(this.queryForm.deviceid=this.deviceid),this.$route.query.deviceid&&(this.queryForm.deviceid=this.$route.query.deviceid),this.queryTable({}),this.rowDrop(),this.queryProduct(),this.columnDrop()},methods:{queryProduct(){return n(this,null,(function*(){this.proTableData=[];const{results:e=[]}=yield Object(l["queryProduct"])({count:"objectId",order:"-updatedAt",where:{category:"IotHub"}});this.proTableData=e}))},handleHeight(){this.isFullscreen=!this.isFullscreen,this.isFullscreen?this.height=this.$baseTableHeight(0)+120:this.height=this.$baseTableHeight(0),this.momentKey=moment(new Date).valueOf()},tableRowClassName({row:e}){return e.disabled?"disabled":""},rowDrop(){const e=this.$refs.dragTable.$el.querySelector(".el-table__body-wrapper tbody"),t=this;Sortable.create(e,{draggable:".el-table__row",onEnd({newIndex:e,oldIndex:a}){const i=t.logdata.splice(a,1)[0];t.logdata.splice(e,0,i)}})},columnDrop(){const e=this,t=this.$refs.dragTable.$el.querySelector(".el-table__header-wrapper tr");e.sortable=Sortable.create(t,{animation:180,delay:0,onEnd:t=>{const a=e.finallyColumns[t.oldIndex];e.finallyColumns.splice(t.oldIndex,1),e.finallyColumns.splice(t.newIndex,0,a),e.momentKey=moment(new Date).valueOf(),setTimeout(()=>{e.rowDrop(),e.columnDrop()},1500)}})},showDetail(e){this.preDialog=!0,this.msg=JSON.stringify(e,null,2),this.refreshFlag=moment(new Date).valueOf()},queryTable(){return n(this,arguments,(function*(e={}){this.loading=!0,dgiotlog.log(this.queryForm.domain),e.limit||(e=this.queryForm);const t=this.$baseColorfullLoading();try{t.close();const a={limit:e.limit,skip:e.skip,order:e.order,count:this.queryForm.count,include:"",where:{deviceid:this.deviceid?this.deviceid:"",domain:this.queryForm.domain.length?{$in:this.queryForm.domain}:{$ne:""},createdAt:{$gte:{__type:"Date",iso:this.queryForm.searchDate[0]+"T00:00:00.000Z"},$lte:{__type:"Date",iso:this.queryForm.searchDate[1]+"T23:59:59.000Z"}}}},{results:i=[],count:s=0}=yield Object(o["queryLog"])(a);i.forEach(e=>{if(e.time=this.$moment(Number(e.time.toString().substring(0,13))).format("YYYY-MM-DD HH:mm:ss"),"text"!=e.type){const t=JSON.parse(e.msg);for(let a in t)e[a]=t[a]}}),this.logdata=i,this.queryForm.total=s,t.close()}catch(a){t.close(),this.isDeviceInfo&&this.$baseMessage(this.$translateTitle("alert.Data request error")+""+a,"error","dgiot-hey-message-error")}this.loading=!1}))}}},d=c,u=(i("0ff1"),i("2877")),m=Object(u["a"])(d,s,r,!1,null,"2fd2c5dc",null);a["default"]=m.exports},c3f8:function(e,t,a){"use strict";a("e50d")},c832:function(e,t,a){"use strict";a("3e53")},cb5aa:function(t,a,i){"use strict";i.r(a);var s=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{ref:"custom-table",staticClass:"custom-table-container",class:{"dgiot-fullscreen":e.isFullscreen}},[t("div",[t("el-dialog",{attrs:{"append-to-body":"",visible:e.activePopShow},on:{"update:visible":function(t){e.activePopShow=t}}},[t("h3",{attrs:{slot:"title"},slot:"title"},[e._v(" "+e._s(e.$translateTitle("cloudTest.add"))+e._s(e.$translateTitle("cloudTest.report template"))+" ")]),t("div",{staticClass:"content"},[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{"label-width":"100px",model:e.ruleForm,rules:e.rules}},[t("el-form-item",{attrs:{label:e.$translateTitle("cloudTest.Template name"),prop:"name"}},[t("el-input",{model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),t("el-form-item",{attrs:{label:e.$translateTitle("cloudTest.category"),prop:"categoryname"}},[t("el-input",{attrs:{readonly:""},model:{value:e.ruleForm.categoryname,callback:function(t){e.$set(e.ruleForm,"categoryname",t)},expression:"ruleForm.categoryname"}},[t("el-icon",{staticClass:"el-icon-edit el-input__icon",attrs:{slot:"append",size:"mini"},nativeOn:{click:function(t){return e.handlecateClick.apply(null,arguments)}},slot:"append"})],1)],1),t("el-form-item",{attrs:{label:e.$translateTitle("cloudTest.Trade Names"),prop:"factory",required:""}},[t("el-input",{model:{value:e.ruleForm.factory,callback:function(t){e.$set(e.ruleForm,"factory",t)},expression:"ruleForm.factory"}})],1),t("el-form-item",{attrs:{label:e.$translateTitle("cloudTest.Template file"),prop:"file",required:""}},[t("el-upload",{key:e.momentKey,ref:"upload",staticClass:"upload-demo",attrs:{accept:".doc,.docx",action:"string","before-upload":e.onBeforeUploadImage,"file-list":e.fileList,"http-request":e.UploadImage,limit:1,"list-type":"text","on-change":e.fileChange},model:{value:e.ruleForm.file,callback:function(t){e.$set(e.ruleForm,"file",t)},expression:"ruleForm.file"}},[t("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v(" "+e._s(e.$translateTitle("application.selectfile"))+" ")])],1)],1)],1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v(" "+e._s(e.$translateTitle("product.createnow"))+" ")]),t("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v(" "+e._s(e.$translateTitle("zetadevices.reset"))+" ")])],1),t("el-drawer",{attrs:{"append-to-body":"",size:"40%",visible:e.cascaderDrawer},on:{"update:visible":function(t){e.cascaderDrawer=t}}},[t("div",[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:24}},[t("dgiot-query-form",[t("dgiot-query-form-top-panel",[t("el-form",{attrs:{inline:!0,"label-width":"100px"},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{attrs:{label:e.$translateTitle("product.classification")}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("task.Select")},on:{change:e.handleCateSearch},model:{value:e.queryForm.category,callback:function(t){e.$set(e.queryForm,"category",t)},expression:"queryForm.category"}},e._l(e.categoryTreeData,(function(e,a){return t("el-option",{key:a,attrs:{label:e.name,value:e.objectId}})})),1)],1),t("el-form-item",{attrs:{label:e.$translateTitle("developer.Templatename")}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入模板名称"},model:{value:e.queryForm.name,callback:function(t){e.$set(e.queryForm,"name",t)},expression:"queryForm.name"}})],1),t("el-form-item",{attrs:{"label-width":"0"}},[t("el-button",{staticClass:"el-icon-search",attrs:{"native-type":"submit",type:"primary"},on:{click:function(t){return e.queryProdut({})}}})],1)],1)],1)],1)],1)],1),t("el-table",{staticStyle:{width:"100%"},attrs:{border:"","cell-style":{"text-align":"center"},data:e.tableData,"header-cell-style":{"text-align":"center"},size:"mini"}},[t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.Templatename")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[e._v(" "+e._s(a.name)+" "),t("el-popover",{attrs:{placement:"left",trigger:"click",width:"800"}},[t("i",{staticClass:"el-icon-info",attrs:{slot:"reference"},on:{click:function(t){return e.referenceHandle(a)}},slot:"reference"})])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("department.category"),prop:"categoryname"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v(" "+e._s(t.category.name)+" ")]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.operation")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.chooseTemplate(a)}}},[e._v(" "+e._s(e.$translateTitle("product.choose"))+" ")])]}}])})],1)],1)])],1),t("dgiot-dialog",{attrs:{show:e.tempPopShow},on:{"update:show":function(t){e.tempPopShow=t}}},[t("h3",{attrs:{slot:"title"},slot:"title"},[e._v(" "+e._s(e.$translateTitle("cloudTest.report template"))+" ")]),t("div",{staticClass:"content"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableSort",attrs:{border:e.border,data:e.tempList,size:e.lineHeight,stripe:e.stripe},scopedSlots:e._u([{key:"empty",fn:function(){return[t("el-image",{staticClass:"dgiot-data-empty",attrs:{src:i("c2ad")}})]},proxy:!0}])},[t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("cloudTest.number"),prop:"title","show-overflow-tooltip":"",width:"80"}}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("cloudTest.Template content"),width:"auto"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-image",{staticStyle:{width:"40px",height:"40px"},attrs:{"preview-src-list":[e.$FileServe+a.data.icon],src:e.$FileServe+a.data.icon}})]}}])}),t("el-table-column",{attrs:{align:"center",flex:"right",label:e.$translateTitle("product.Template management"),"show-overflow-tooltip":"",width:"auto"},scopedSlots:e._u([{key:"default",fn:function({row:a,$index:i}){return[t("el-button",{attrs:{type:"success"},on:{click:function(t){return e.handlekonva(a,i)}}},[e._v(" "+e._s(e.$translateTitle("developer.task mapping"))+" ")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.handleDelete(a,1)}}},[e._v(" "+e._s(e.$translateTitle("cloudTest.delete"))+" ")])]}}])})],1)],1)])],1),t("dgiot-query-form",[t("dgiot-query-form-left-panel",[t("el-form",{ref:"form",attrs:{inline:!0,"label-width":"0",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",[t("el-input",{attrs:{placeholder:e.$translateTitle("cloudTest.Please enter the query content")},model:{value:e.queryForm.name,callback:function(t){e.$set(e.queryForm,"name",t)},expression:"queryForm.name"}})],1),t("el-form-item",[t("el-button",{attrs:{icon:"el-icon-search","native-type":"submit",type:"primary"},on:{click:e.fetchData}},[e._v(" "+e._s(e.$translateTitle("cloudTest.search"))+" ")]),t("el-button",{attrs:{icon:"el-icon-plus",type:"primary"},on:{click:e.handleAdd}},[e._v(" "+e._s(e.$translateTitle("cloudTest.template"))+" ")])],1)],1)],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableSort",attrs:{border:e.border,data:e.list,size:e.lineHeight,stripe:e.stripe},scopedSlots:e._u([{key:"empty",fn:function(){return[t("el-image",{staticClass:"dgiot-data-empty",attrs:{src:i("c2ad")}})]},proxy:!0}])},[t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("cloudTest.number"),"show-overflow-tooltip":"",width:"60"},scopedSlots:e._u([{key:"default",fn:function({$index:t}){return[e._v(" "+e._s(t+1)+" ")]}}])}),e._l(e.finallyColumns,(function(a,i){return t("el-table-column",{key:i,attrs:{align:"center",label:e.$translateTitle("cloudTest."+a.label),prop:a.prop,"show-overflow-tooltip":"",sortable:a.sortable,width:a.width}})})),t("el-table-column",{attrs:{align:"center",fixed:"right",label:e.$translateTitle("cloudTest.operate"),"show-overflow-tooltip":"",width:"auto"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.handleManagement(a)}}},[e._v(" "+e._s(e.$translateTitle("product.task management"))+" ")]),t("el-button",{staticStyle:{color:"red"},attrs:{size:"mini",type:"text"},on:{click:function(t){return e.handleDelete(a,0)}}},[e._v(" "+e._s(e.$translateTitle("cloudTest.delete"))+" ")])]}}])})],2),t("dgiot-parser-pagination",{ref:"paginations",attrs:{pagination:e.paginations,"query-payload":e.queryPayload},on:{pagination:e.fetchData,paginationQuery:e.paginationQuery}})],1)},r=[],o=i("7212"),l=i("8ba7"),n=i("58dd"),c=i("5880"),d=i("bb22"),u=i("03b1"),m=i("ef68"),h=Object.defineProperty,p=Object.defineProperties,g=Object.getOwnPropertyDescriptors,f=Object.getOwnPropertySymbols,b=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable,v=(e,t,a)=>t in e?h(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,w=(e,t)=>{for(var a in t||(t={}))b.call(t,a)&&v(e,a,t[a]);if(f)for(var a of f(t))y.call(t,a)&&v(e,a,t[a]);return e},$=(e,t)=>p(e,g(t)),C=(t,a,i)=>new Promise((s,r)=>{var o=t=>{try{n(i.next(t))}catch(e){r(e)}},l=t=>{try{n(i.throw(t))}catch(e){r(e)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,l);n((i=i.apply(t,a)).next())}),x={name:"ReportIndex",components:{},data(){const e=(e,t,a)=>{""===t?a(new Error("请上传文件")):a()};return{queryForm:{name:"",category:""},paginations:{},queryPayload:{include:"category",order:"-updatedAt",limit:10,skip:0,keys:"count(*)"},tableData:[],categoryTreeData:[],fileList:[],momentKey:moment(new Date).valueOf(),ruleForm:{file:null,name:"",category:"",factory:"",date2:""},rules:{name:[{required:!0,message:"请输入模板名称",trigger:"blur"}],categoryname:[{required:!0,message:"请选择所属品类",trigger:"blur"}],factory:[{required:!0,message:"请输入厂商名称",trigger:"blur"}],file:[{validator:e,trigger:"blur"}]},activePopShow:!1,tempPopShow:!1,isFullscreen:!1,border:!0,height:this.$baseTableHeight(0)-20,stripe:!0,lineHeight:"medium",checkList:["objectId","Template name","category","Trade Names","Creation time"],columns:[{label:"objectId",width:120,prop:"objectId",sortable:!0,disableCheck:!0},{label:"Template name",width:"auto",prop:"name",sortable:!0},{label:"category",width:"auto",prop:"category.name",sortable:!0},{label:"Trade Names",width:"auto",prop:"devType",sortable:!0},{label:"Creation time",width:"auto",prop:"createdAt",sortable:!0}],list:[],tempList:[],views:[],listLoading:!0,layout:"total, sizes, prev, pager, next, jumper",temprow:{},cascaderDrawer:!1}},computed:$(w({},Object(c["mapGetters"])({language:"settings/language",collapse:"settings/collapse"})),{dragOptions(){return{animation:600,group:"description"}},finallyColumns(){return this.columns.filter(e=>this.checkList.includes(e.label))}}),watch:{language:{deep:!0,limit:!0,handler(e){dgiotlog.warn(e)}}},created(){},mounted(){this.categorytree(),this.fetchData()},methods:{paginationQuery(e){return C(this,null,(function*(){this.queryPayload=e}))},handlecateClick(){this.categorytree(),this.cascaderDrawer=!0},queryProdut(e){return C(this,null,(function*(){const t=e.categorys,a=this.$baseColorfullLoading();e.limit||(e=this.queryForm);let i={limit:e.limit,order:e.order,skip:e.skip,keys:e.keys,include:"category",where:{category:t?{$in:t}:{$ne:null},name:e.name?{$regex:e.name,$options:"i"}:{$ne:null}}};try{const{results:e=[],count:t=0}=yield Object(m["queryProductTemplet"])(i);a.close(),this.tableData=e,this.queryForm.total=t}catch(s){a.close(),dgiotlog.log(s),this.$baseMessage(s,"error","dgiot-hey-message-error")}}))},handleCateSearch(e){if(this.queryForm.category=e,this.showcateTree=!this.showcateTree,"a60a85475a"==e)this.queryProdut({});else{let t={keys:"objectId",where:{parent:{className:"Category",objectId:e,__type:"Pointer"}}};Object(u["queryCategory"])(t).then(t=>{const a=[];a.push(e),t.results.forEach(e=>{a.push(e.objectId)}),this.queryProdut({categorys:a})})}},referenceHandle(e){dgiotlog.log("prodtemp",e)},chooseTemplate(e){return C(this,null,(function*(){this.$set(this.ruleForm,"categoryname",e.category.name),this.$set(this.ruleForm,"categoryid",e.category.objectId),this.$set(this.ruleForm,"producttempid",e.objectId),this.cascaderDrawer=!this.cascaderDrawer}))},categorytree(){return C(this,null,(function*(){let t={class:"Category",filter:'{"order": "createdAt","keys":["parent","name","level"],"where":{"parent": "d6ad425529"}}',parent:"parent"};dgiotlog.log(t);try{const{results:e=[]}=yield Object(d["post_tree"])(t);this.categoryTreeData=e}catch(e){dgiotlog.log("categorytree error",e)}}))},onBeforeUploadImage(e){const t=["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword"];dgiotlog.warn(e,e.size,e.size/1024/1024<30,t.includes(e.type),e.type);const a=t.includes(e.type),i=e.size/1024/1024<30;return a||this.$baseMessage("上传文件只能是doc/docx格式!","error","dgiot-hey-message-error"),i||this.$baseMessage("上传文件大小不能超过 30MB!","error","dgiot-hey-message-error"),this.momentKey=moment(new Date).valueOf(),a&&i},UploadImage(e){dgiotlog.warn(e,"param"),this.ruleForm.file=e.file},fileChange(e){this.$refs.upload.clearFiles(),this.logo=e.raw,this.fileList=[{name:e.name,url:e.url}]},submitUpload(){this.$refs.upload.submit()},handlePreview(e){dgiotlog.log(e)},submitForm(t){this.$refs[t].validate(t=>C(this,null,(function*(){if(!t)return dgiotlog.log("error submit!!"),!1;{const t=new FormData,a={identifier:"inspectionReportTemp",client:this.ruleForm.factory,category:this.ruleForm.categoryid,producttemplet:this.ruleForm.producttempid};t.append("devType",this.ruleForm.factory),t.append("name",this.ruleForm.name),t.append("config",JSON.stringify(a)),t.append("file",this.ruleForm.file);const i=this.$baseColorfullLoading(1);try{const{result:e}=yield Object(n["postReportFile"])(t);dgiotlog.log(e),this.$baseMessage(this.$translateTitle("cloudTest.Template created successfully"),"success","dgiot-hey-message-success"),this.activePopShow=!1,this.fetchData()}catch(e){this.$baseMessage(this.$translateTitle("cloudTest.Template creation failed"),"error","dgiot-hey-message-error")}i.close()}})))},resetForm(e){this.ruleForm.file=null,this.fileList=[],this.$refs[e].resetFields()},clickFullScreen(){this.isFullscreen=!this.isFullscreen,this.handleHeight()},handleHeight(){this.isFullscreen?this.height=this.$baseTableHeight(1)+210:this.height=this.$baseTableHeight(1)},handleAdd(){this.activePopShow=!0},handlekonva(e,t){this.$router.push({path:"/Topo",query:{viewid:e.objectId,guide:!0,page:t,productid:e.key,type:"Evidence",noTools:!0,isDirver:!0,list:JSON.stringify(this.views),length:this.views.length-1}})},handleManagement(t){return C(this,null,(function*(){this.temprow=t;const a={limit:50,skip:0,keys:"count(*)",where:{type:"topo",class:"Product",key:t.objectId},order:"createdAt,title"},i=this.$baseColorfullLoading(1);try{const{count:e=0,results:t}=yield Object(l["queryView"])(a);this.tempList=t,this.views=[],this.tempList.forEach((e,t)=>{this.views.push({page:t,viewid:e.objectId})})}catch(e){}this.tempPopShow=!0,i.close()}))},handleDelete(e,t){this.$baseConfirm(this.$translateTitle("Maintenance.Are you sure you want to delete the current item"),null,()=>C(this,null,(function*(){yield Object(o["delProduct"])(e.objectId);this.$baseMessage(this.$translateTitle("Maintenance.successfully deleted"),"success","dgiot-hey-message-success"),0==t?yield this.fetchData():yield this.handleManagement(this.temprow)})))},fetchData(){return C(this,null,(function*(){this.queryPayload.where={name:this.queryForm.name?{$regex:this.queryForm.name}:{$ne:null},netType:"Evidence",nodeType:1},dgiotlog.log(this.queryPayload),this.listLoading=!0;const{count:e=0,results:t=[]}=yield Object(o["queryProduct"])(this.queryPayload);this.$refs["paginations"].ination.total=e,t.forEach(e=>{e.createdAt=moment(e.createdAt).format("YYYY-MM-DD HH:mm:ss")}),this.list=t,this.listLoading=!1}))}}},_=x,I=(i("58bc"),i("2877")),k=Object(I["a"])(_,s,r,!1,null,null,null);a["default"]=k.exports},cccf:function(e,t,a){"use strict";a("ff25")},cee2:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"CloudTest-container"},[t("div",{staticClass:"CloudTest-content"},[e._v(" "+e._s(e.infoData)+" ")])])},s=[],r={name:"CloudTest",components:{},data(){return{infoData:"CloudTest"}},computed:{},mounted(){},beforeCreate(){},beforeMount(){},beforeUpdate(){},updated(){},beforeDestroy(){},destroyed(){},activated(){},methods:{}},o=r,l=(a("87d35"),a("2877")),n=Object(l["a"])(o,i,s,!1,null,"eb51b004",null);t["default"]=n.exports},d334:function(e,t,a){},d381:function(e,t,a){},d4a9:function(e,t,a){"use strict";a("d381")},d915:function(e,t,a){"use strict";a("d334")},e185:function(t,a,i){"use strict";i.r(a);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"modules"},[t("el-dialog",{attrs:{"append-to-body":!0,title:"修改物模型",visible:e.edit_module,width:"17%"},on:{"update:visible":function(t){e.edit_module=t}}},[t("el-form",{ref:"editForm",staticClass:"demo-editForm",attrs:{"label-width":"100px",model:e.editForm,rules:e.rules}},[t("el-form-item",{attrs:{label:"产品名称",prop:"name"}},[t("el-input",{model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),t("el-form-item",{attrs:{label:"产品类型",prop:"devType"}},[t("el-input",{model:{value:e.editForm.devType,callback:function(t){e.$set(e.editForm,"devType",t)},expression:"editForm.devType"}})],1),t("el-form-item",{attrs:{label:"所属分类",prop:"category"}},[t("el-cascader",{attrs:{options:e.categoryListOptions},model:{value:e.editForm.category,callback:function(t){e.$set(e.editForm,"category",t)},expression:"editForm.category"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.editPostForm("editForm")}}},[e._v(" 修改 ")]),t("el-button",{on:{click:function(t){return e.resetForm("editForm")}}},[e._v("重置")])],1)],1),t("el-dialog",{attrs:{"append-to-body":!0,title:"新增物模型",visible:e.add_module,width:"17%"},on:{"update:visible":function(t){e.add_module=t}}},[t("el-form",{ref:"moduleForm",staticClass:"demo-moduleForm",attrs:{"label-width":"100px",model:e.moduleForm,rules:e.rules}},[t("el-form-item",{attrs:{label:"产品名称",prop:"name"}},[t("el-input",{model:{value:e.moduleForm.name,callback:function(t){e.$set(e.moduleForm,"name",t)},expression:"moduleForm.name"}})],1),t("el-form-item",{attrs:{label:"产品类型",prop:"devType"}},[t("el-input",{model:{value:e.moduleForm.devType,callback:function(t){e.$set(e.moduleForm,"devType",t)},expression:"moduleForm.devType"}})],1),t("el-form-item",{attrs:{label:"所属分类",prop:"category"}},[t("el-cascader",{attrs:{options:e.categoryListOptions},model:{value:e.moduleForm.category,callback:function(t){e.$set(e.moduleForm,"category",t)},expression:"moduleForm.category"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitForm("moduleForm")}}},[e._v(" 立即创建 ")]),t("el-button",{on:{click:function(t){return e.resetForm("moduleForm")}}},[e._v("重置")])],1)],1),t("header",[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:20}},[t("el-button",{attrs:{icon:"el-icon-plus",size:"mini",type:"primary"},on:{click:function(t){e.add_module=!0}}},[e._v(" 新增 ")])],1),t("el-col",{attrs:{span:4}},[t("el-input",{attrs:{placeholder:"请输入产品名称",size:"mini"},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search",size:"mini",type:"primary"},on:{click:function(t){return e.searchModule(e.searchText)}},slot:"append"},[e._v(" 搜索 ")])],1)],1)],1)],1),t("center",[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.pictLoading,expression:"pictLoading"}],staticStyle:{width:"100%","min-height":"583px"},attrs:{data:e.tableData.filter(t=>!e.search||t.name.toLowerCase().includes(e.search.toLowerCase())),"element-loading-background":"rgba(0, 0, 0, 0.5)","element-loading-spinner":"el-icon-loading","element-loading-text":"数据正在加载中","max-height":"583"}},[t("el-table-column",{attrs:{label:"objectId",prop:"objectId"}}),t("el-table-column",{attrs:{label:"产品名称"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v(" "+e._s(t.data.name)+" ")]}}])}),t("el-table-column",{attrs:{label:"产品类型"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v(" "+e._s(t.data.devType)+" ")]}}])}),t("el-table-column",{attrs:{label:"key",prop:"key"}}),t("el-table-column",{attrs:{label:"所属分类"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v(" "+e._s(t.data.category)+" ")]}}])}),t("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"default",fn:function({row:a,$index:i}){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleEdit(i,a)}}},[e._v(" 修改 ")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(i,a.tableData)}}},[e._v(" 删除 ")])]}}])},[t("template",{slot:"header"},[t("el-input",{attrs:{placeholder:"输入关键字搜索",size:"mini"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1)],1),t("footer",[t("el-pagination",{attrs:{"current-page":e.currentPage,layout:"total, sizes, prev, pager, next, jumper","page-size":10,"page-sizes":[10,20,50,100],total:e.pageTotal},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1),e._v(" Parse ")],1)},r=[],o=i("e0e9"),l=i("7212"),n=i("7497"),c=(t,a,i)=>new Promise((s,r)=>{var o=t=>{try{n(i.next(t))}catch(e){r(e)}},l=t=>{try{n(i.throw(t))}catch(e){r(e)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,l);n((i=i.apply(t,a)).next())}),d={name:"Modules",components:{},data(){return{productObj:[],pictLoading:!1,categoryListOptions:[],limit:10,skip:0,add_module:!1,edit_module:!1,searchText:"",hashkey:"",categoryList:[],infoData:"物模型管理",currentPage:1,pageTotal:0,tableData:[],search:"",editForm:{name:"物模型管理",devType:"物模型管理",category:"",type:"Product"},moduleForm:{name:"物模型管理",devType:"物模型管理",category:"",type:"Product"},rules:{name:[{required:!0,message:"请输入产品名称",trigger:"blur"}],devType:[{required:!0,message:"请输入产品类型",trigger:"blur"}],category:[{required:!0,message:"请选择模型所属分类",trigger:"blur"}]}}},computed:{},mounted(){this.searchModule(""),this.Industry()},beforeCreate(){},beforeMount(){},beforeUpdate(){},updated(){},beforeDestroy(){},destroyed(){},activated(){},methods:{getProduct(){return c(this,null,(function*(){const{results:e}=yield Object(l["queryProduct"])();e&&(this.productObj=e)}))},treeData(e){const t=JSON.parse(JSON.stringify(e));return t.filter(e=>{const a=t.filter(t=>e.id==t.parentid);return a.length>0&&(e.children=a),0==e.parentid})},Industry(){this.categoryList=[],this.getProduct();const e={limit:10,where:{"data.key":"category"}};this.$query_object("Dict",e).then(e=>{e.results&&(e.results.map(e=>{var t={};t.value=e.type,t.label=e.data.CategoryName,t.id=e.data.Id,t.parentid=e.data.SuperId,this.categoryList.push(t)}),this.categoryListOptions=this.treeData(this.categoryList))}).catch(e=>{dgiotlog.log(e,"error")})},blackDict(e,t,a){return c(this,null,(function*(){const i={data:t,key:e,type:a},s=yield Object(o["postDict"])(i);s?(this.$message({showClose:!0,duration:2e3,type:"success",message:"新建物模型成功"}),this.add_module=!1,this.searchModule("")):this.$message({type:"error",showClose:!0,duration:2e3,message:"新建物模型失败"})}))},submitForm(e){this.$refs[e].validate(e=>c(this,null,(function*(){if(e){const e={category:this.moduleForm.category[0],devType:this.moduleForm.devType,name:this.moduleForm.name},{objectId:t,code:a}=yield Object(n["getHashClass"])("Product",e);200==a&&this.blackDict(t,e,this.moduleForm.type)}})))},resetForm(e){this.$refs[e].resetFields()},searchModule(e){return c(this,null,(function*(){let t;this.pictLoading=!0,t=e.length?{order:"-createdAt",count:"objectId",limit:this.limit,skip:this.skip,where:{type:"Module",key:{$regex:""+e}}}:{order:"-createdAt",count:"objectId",limit:this.limit,skip:this.skip,where:{type:"Product"}};const{results:a,count:i=0}=yield Object(o["getDictCount"])(t);this.pictLoading=!1,a&&(this.tableData=a,this.pageTotal=i)}))},handleSizeChange(e){dgiotlog.log(`每页 ${e} 条`),this.limit=e,this.searchModule(this.searchText)},handleCurrentChange(e){dgiotlog.log("当前页: "+e),this.skip=this.limit*(e-1),this.searchModule(this.searchText)},handleEdit(e,t){this.edit_module=!0,this.editForm=t.data,dgiotlog.log(e,t)},editPostForm(e){dgiotlog.log(e)},handleDelete(e,t,a){return c(this,null,(function*(){const i=yield Object(o["delDict"])(t.objectId);i?(a.splice(e,1),this.$message({showClose:!0,duration:2e3,type:"success",message:"删除成功"})):this.$message({showClose:!0,duration:2e3,type:"error",message:"删除失败"})}))}}},u=d,m=(i("d915"),i("2877")),h=Object(m["a"])(u,s,r,!1,null,"5997e3b6",null);a["default"]=h.exports},e252:function(e,t,a){},e50d:function(e,t,a){},e5e0:function(t,a,i){"use strict";i.r(a);var s=i("209d"),r=i("1285"),o=i("227e"),l=i("cdef"),n=i("5880"),c=i("7212"),d=i("8ba7"),u=i("c008"),m=i("c32d"),h=i.n(m),p=Object.defineProperty,g=Object.defineProperties,f=Object.getOwnPropertyDescriptors,b=Object.getOwnPropertySymbols,y=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable,w=(e,t,a)=>t in e?p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,$=(e,t)=>{for(var a in t||(t={}))y.call(t,a)&&w(e,a,t[a]);if(b)for(var a of b(t))v.call(t,a)&&w(e,a,t[a]);return e},C=(e,t)=>g(e,f(t)),x=(t,a,i)=>new Promise((s,r)=>{var o=t=>{try{n(i.next(t))}catch(e){r(e)}},l=t=>{try{n(i.throw(t))}catch(e){r(e)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,l);n((i=i.apply(t,a)).next())});a["default"]={name:"TaskIndex",filters:{filterVal(e){return e||0==e?e:"--"}},components:{lowcodeDesign:s["default"]},data(){var e,t;return{management:{dialog:!1,data:{}},managementactiveName:"0",dialog_device:!1,machinelist:{},historyEvidenceid:"",nowTime:window.datetime,historyEvidence:[],historyInfo:{},thirdtbKey:h()(new Date).valueOf(),original:{},collectionInfo:{},drawxnqxPath:"",profiledrawxnqxPath:"",thingdata:[],realtimedata:[],thingcolumns:[],historycolumns:[],historydata:[],visible:!1,router:"",topicKey:"",activeName1:"first",activeName:(null==(t=null==(e=null==this?void 0:this.$route)?void 0:e.query)?void 0:t.tabs)&&"examination"==this.$route.query.tabs?"examination":"forensics",officeapps:"",dialogVisible:!1,paginations:{layout:"total, sizes, prev, pager, next, jumper"},queryPayload:{excludeKeys:"data",include:"",order:"-createdAt",limit:10,skip:0,count:"objectId"},lowcodeId:"",loading:!1,options:[{value:"Underreview",label:"审核中"},{value:"finishreview",label:"审核完成"}],rules:{testbed:[{required:!0,message:"请选择测试台体",trigger:"blur"}],name:[{required:!0,message:"请输入报告名称",trigger:"blur"}],templatename:[{required:!0,message:"请选择报告模板",trigger:"change"}]},activePopShow:!1,border:!0,height:980,stripe:!0,lineHeight:"medium",checkList:["Inspection template","testbed","Trade Names","Creation time","Starting time","end time"],columns:[{label:"Starting time",width:"180",prop:"starttime",sortable:!0},{label:"end time",width:"180",prop:"endtime",sortable:!0}],list:{forensics:[],examination:[]},listLoading:!0,queryForm:{pageSizes:[10,20,30,50],limit:10,order:"-createdAt",keys:"count(*)",total:0,skip:0,pageNo:1,pageSize:10,name:""},categorylist:[],wordtemplist:[],grouplist:[],ruleForm:{name:"",templatename:"",testbed:"",testbedid:"",templatenameid:""}}},computed:C($({},Object(n["mapGetters"])({currentDepartment:"user/currentDepartment"})),{dragOptions(){return{animation:600,group:"description"}},finallyColumns(){return this.columns.filter(e=>this.checkList.includes(e.label))}}),created(){this.fetchData()},mounted(){this.historyEvidence=[],this.historyInfo={},this.router=this.$dgiotBus.router(this.$route.fullPath),this.$dgiotBus.$off("lowcodeClose"),this.$dgiotBus.$on("lowcodeClose",e=>{this.fetchData()}),this.timer=setInterval(()=>{this.datetime()},1e3)},methods:{tabHandleClick(e){switch(e.name){case"first":break;case"second":break}},CardDevice(e){var t=this;Object(r["getCardDevice"])(e).then(e=>{t.machinelist={},(null==e?void 0:e.data)&&t.renderCard(e.data)}).catch(e=>{dgiotlog.log("update error 清除timer",e)})},subRealtimedata(e){return x(this,null,(function*(){this.router=this.$dgiotBus.router(location.href+this.$route.fullPath);let t=`$dg/user/realtimecard/${e.parentId.objectId}/report`;try{yield this.$subscribe(t),this.$dgiotBus.$off(this.$mqttInfo.topicKey),this.$dgiotBus.$on(this.$mqttInfo.topicKey,t=>{const{data:a=[]}=JSON.parse(Base64.decode(t.payloadString));this.renderCard(a),e.profile.istcp&&Object(r["getDevice"])(e.objectId).then(e=>{this.historyEvidence=e.profile.historicaldata,this.drawxnqxPath=e.profile.drawxnqxPath}),a?this.collectiontable(a):this.CardDevice()})}catch(a){console.log(a),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+a,"error","dgiot-hey-message-error")}}))},collectiontable(e){let t=this,a={};e.forEach(e=>{this.$set(a,e.identifier,e.number),this.$set(a,"timestamp",e.time)}),_.isEmpty(a)||0!=(null==a?void 0:a.dgiotcollectflag)?t.realtimedata.unshift(a):(t.thingdata=[],console.log(a),t.thingdata[0]=a)},renderCard(e){var t=this;let a=[];e.forEach(e=>{e.devicetype&&"dgiotcollectflag"!=e.identifier&&a.push(e.devicetype)}),a=_.uniqBy(a);let i={};a.forEach(t=>{let a=[];e.forEach(e=>{t==e.devicetype&&a.push(e)}),i[t]=a}),t.machinelist=i,t.thirdtbKey=h()(new Date).valueOf()},datetime(){this.nowTime=h()(new Date).format("YYYY-MM-DD HH:mm:ss")},paginationQuery(e){return x(this,null,(function*(){this.queryPayload=e}))},categoryChange(e){return x(this,null,(function*(){this.$set(this.ruleForm,"templatenameid",e.objectId)}))},testbedChange(e){this.$set(this.ruleForm,"testbedid",e.objectId),console.log("src/views/CloudTest/js/task.js","this.ruleForm",this.ruleForm,e.objectId)},changetestbed(e,t){return x(this,null,(function*(){let a=t.profile;a.testbed=e.name,yield Object(r["putDevice"])(t.objectId,{profile:a,parentId:{__type:"Pointer",className:"Device",objectId:e.objectId}})}))},getwordtemp(){return x(this,null,(function*(){const e={skip:0,where:{netType:"Evidence",nodeType:1}},{results:t={}}=yield Object(c["queryProduct"])(e);this.categorylist=t}))},getgroup(){return x(this,null,(function*(){const e={where:{"detail.category":"84abda3154"}},{results:t}=yield Object(r["queryDevice"])(e);this.grouplist=t}))},deleteHistory(e,t){return x(this,null,(function*(){try{yield this.historyEvidence.splice(t,1),console.log("deleteHistory",e,t,this.historyEvidence,this.historyEvidence.length),yield this.saveHistorical(this.collectionInfo,this.thingdata,this.historyEvidence,!1),yield this.saveThingdata()}catch(a){console.log(a),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+a,"error","dgiot-hey-message-error")}}))},saveThingdata(){return x(this,null,(function*(){try{const e={original:this.historyInfo.original};yield Object(u["putEvidence"])(this.historyInfo.objectId,e)}catch(e){console.log(e),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+e,"error","dgiot-hey-message-error")}}))},submitForm(e){const t="role:"+this.currentDepartment.name,a={};a[t]={read:!0,write:!0},this.$refs[e].validate(e=>x(this,null,(function*(){if(!e)return console.log("error submit!!"),!1;{const e={profile:{testbedid:this.ruleForm.teestbedid,testbed:this.ruleForm.testbed.name,wordtemplatename:this.ruleForm.templatename.name,reportId:this.ruleForm.templatenameid,identifier:"inspectionReportTemp",step:0},parentId:this.ruleForm.testbedid,name:this.ruleForm.name,product:this.ruleForm.templatenameid},t=this.$baseColorfullLoading(1);this.activePopShow=!1,yield Object(l["postreport"])(e),this.fetchData(),t.close()}this.ruleForm={name:"",templatename:"",testbed:"",testbedid:"",templatenameid:""}})))},featHistoryEvidence(e){return x(this,null,(function*(){var t,a;this.historyEvidence=[];try{const i={limit:1,where:{"original.taskid":e,"original.type":"avgs"}},s=this.$baseColorfullLoading(),{results:r=[]}=yield Object(u["queryEvidence"])(i);(null==r?void 0:r.length)?(this.historyEvidence=null!=(t=r[0].original.avgs)?t:this.historydata,this.collectionInfo.profile.historicaldata=this.historyEvidence,this.historyInfo=r[0],this.drawxnqxPath=null!=(a=r[0].original.path)?a:this.profiledrawxnqxPath):(this.historyEvidence=this.historydata,this.drawxnqxPath=this.profiledrawxnqxPath),this.$baseMessage(this.$translateTitle("alert.Data request successfully"),"success","dgiot-hey-message-success"),s.close()}catch(i){console.log(i),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+i,"error","dgiot-hey-message-error")}}))},forensics(e){return x(this,null,(function*(){try{yield this.$router.push({path:"/cloudTest/evidence",query:{taskid:e.objectId,suite:0,state:"preview",step:1,back:e.profile.step,message:e.profile.message}})}catch(t){console.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}}))},taskEnd(e){this.$baseConfirm(this.$translateTitle("Maintenance.Are you sure you want to end the current mission"),null,()=>x(this,null,(function*(){try{const t=this.$baseColorfullLoading(),a={profile:_.merge(e.profile,{step:4,endtime:h()(new Date).format("x")})};yield Object(r["putDevice"])(e.objectId,a);this.fetchData(),t.close()}catch(t){console.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}})))},taskStart(e){let t=this;e.profile.testbed?t.$baseConfirm(t.$translateTitle("Maintenance.Are you sure you want to start the current mission"),null,()=>x(this,null,(function*(){try{const a=t.$baseColorfullLoading();yield t.startOpc(e),yield Object(u["generatereport"])(e.objectId);const i={profile:_.merge(e.profile,{step:1,starttime:h()(new Date).format("x")})};yield Object(r["putDevice"])(e.objectId,i);t.fetchData(),a.close()}catch(a){console.log(a),t.$baseMessage(this.$translateTitle("alert.Data request error")+""+a,"error","dgiot-hey-message-error")}}))):t.$baseMessage("请选择测试台体","waring","dgiot-hey-message-error")},downDocx(e){return x(this,null,(function*(){try{const t=document.createElement("a");t.setAttribute("href",this.$FileServe+e),t.setAttribute("download","download"),t.click()}catch(t){console.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}}))},handleUnderreview(e){return x(this,null,(function*(){try{this.$router.push({path:"/cloudTest/evidence",query:{taskid:e,suite:0,state:"preview",step:3}})}catch(t){console.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}}))},handleReport(e){return x(this,null,(function*(){if(4==e.profile.step&&e.profile.docx){const t=this.$FileServe+e.profile.docx;return this.dialogVisible=!0,this.officeapps="https://view.officeapps.live.com/op/view.aspx?src="+t,!1}try{const t=this.$baseColorfullLoading(),{code:a,msg:i,path:s}=yield Object(u["generatereport"])(e.objectId);200==a&&s?(this.$baseMessage(this.$translateTitle("alert.Data request successfully"),"success","dgiot-hey-message-success"),setTimeout(()=>{const t={profile:_.merge(e.profile,{step:4,docx:s})},a=(Object(r["putDevice"])(e.objectId,t),this.$FileServe+s);this.dialogVisible=!0,this.officeapps="https://view.officeapps.live.com/op/view.aspx?src="+a},1200)):this.$baseMessage(""+i,"error","dgiot-hey-message-error"),t.close()}catch(t){console.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}}))},handleManagement(e){return x(this,null,(function*(){this.$refs["lowcodeDesign"].withHeader=!0,localStorage.setItem("parse_objectid",e.objectId),localStorage.setItem("product_objectid",e.product.objectId);const t={where:{type:"amis",key:e.objectId}},{results:a}=yield Object(d["queryView"])(t);if(console.log("results",a),_.isEmpty(a))return this.$baseMessage("暂未配置任务表单","info","dgiot-hey-message-error"),!1;this.management.dialog=!0,this.management.data=a}))},handleCloseAmis(){this.coordinate={lng:116.404,lat:39.915},this.dialog_device=!1,this.management.dialog=!1},handleDelete(e){return x(this,null,(function*(){try{const t=this.$baseColorfullLoading();yield Object(r["delDevice"])(e);this.$baseMessage(this.$translateTitle("user.successfully deleted"),"success","dgiot-hey-message-success"),t.close(),this.fetchData()}catch(t){console.log(t),this.$baseMessage(this.$translateTitle("user.error deleted")+""+t,"error","dgiot-hey-message-error")}}))},fetchData(){return x(this,null,(function*(){this.list={forensics:[],examination:[]},this.getwordtemp(),this.getgroup(),this.queryPayload.include="product,parentId",this.queryPayload.where={"profile.identifier":"inspectionReportTemp",name:this.queryForm.name.length?{$regex:this.queryForm.name}:{$ne:null},"profile.step":{$regex:"^(-1|[0-9]\\d*)$"}},this.listLoading=!0;const{count:e=0,results:t=[]}=yield Object(r["queryDevice"])(this.queryPayload);this.$refs["forensics"]&&(this.$refs["forensics"].ination.total=e),this.list.forensics=t,t.forEach(e=>{e.profile.step||(e.profile.step=0),e.endtime=e.profile.endtime?h()(Number(e.profile.endtime)).format("YYYY-MM-DD HH:mm:ss"):"",e.starttime=e.profile.starttime?h()(Number(e.profile.starttime)).format("YYYY-MM-DD HH:mm:ss"):"",e.createdAt=h()(e.createdAt).format("YYYY-MM-DD HH:mm:ss")}),this.listLoading=!1}))},visibleInfo(e){return x(this,null,(function*(){let t=this;t.collectionInfo=e,t.CardDevice(e.parentId.objectId),t.subRealtimedata(e);try{const a={},i=[];if(t.thingdata=[],t.realtimedata=[],t.thingcolumns=[],e.basedata)for(let t in e.basedata)if(0==t.indexOf("dgiot_testing_equipment_")){const s=t.split("dgiot_testing_equipment_")[1];a[""+s]=s,i.push(e.basedata[t])}const{table:s=[]}=yield Object(o["postHead"])({items:i,productid:e.parentId.product.objectId});t.thingcolumns=s,t.historycolumns=_.filter(s,(function(e){return"timestamp"!==e.prop})),t.historycolumns&&(t.historycolumns=e.profile.historicaldatacolumns),t.historydata=e.profile.historicaldata,t.profiledrawxnqxPath=e.profile.drawxnqxPath,t.featHistoryEvidence(this.collectionInfo.objectId),t.visible=!0}catch(a){console.log(a),t.$baseMessage(t.$translateTitle("alert.Data request error")+""+a,"error","dgiot-hey-message-error")}}))},startOpc(e){return x(this,null,(function*(){var t;try{var a=[];const{basedata:i=[]}=yield Object(r["getDevice"])(e.objectId);if(!_.isEmpty(i))for(let e in i)0==e.indexOf("dgiot_testing_equipment_")&&a.push(i[e]);const s=`$dg/thing/${e.parentId.objectId}/properties/get/request_id=opc_items`,o={cmd:"opc_items",groupid:e.objectId,opcserver:null!=(t=i.dgiot_testing_opcserver)?t:"Kepware.KEPServerEX.V6",items:a};yield this.$dgiotBus.$emit("MqttPublish",s,JSON.stringify(o),0,!1),console.groupCollapsed("%c 发送开始任务","color:#009a61; font-size: 28px; font-weight: 300"),console.log("message",o),console.log("pubTopic",s),console.groupEnd()}catch(i){console.log(i),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+i,"error","dgiot-hey-message-error")}}))},collection(e){return x(this,null,(function*(){var t;let a=this;a.collectionInfo=e,a.featHistoryEvidence(this.collectionInfo.objectId);try{const{basedata:i=[]}=yield Object(r["getDevice"])(e.objectId),s=`$dg/thing/${e.parentId.objectId}/properties/get/request_id=opc_report`,o={cmd:"opc_report",duration:null!=(t=Number(i.dgiot_sampling_parametric_frequency))?t:5,groupid:e.objectId};console.groupCollapsed("%c 发送采集消息","color:#009a61; font-size: 28px; font-weight: 300"),console.log("message",o),console.log("pubTopic",s),console.groupEnd(),a.$dgiotBus.$emit("MqttPublish",s,JSON.stringify(o),0,!1)}catch(i){console.log(i),a.$baseMessage(a.$translateTitle("alert.Data request error")+""+i,"error","dgiot-hey-message-error")}}))},saveHistorical(e,t,a,i){return x(this,null,(function*(){const s={profile:_.merge(e.profile,{historicaldatacolumns:_.filter(t,(function(e){return"timestamp"!==e.prop})),historicaldata:a,drawxnqxPath:this.drawxnqxPath})};i&&(this.visible=!1);try{const t=this.$baseColorfullLoading();e.profile.istcp||(yield Object(r["putDevice"])(e.objectId,s)),this.$baseMessage(this.$translateTitle("alert.Data request successfully"),"success","dgiot-hey-message-success"),t.close()}catch(o){console.log(o),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+o,"error","dgiot-hey-message-error")}}))},drawxnqx(e,t){return x(this,null,(function*(){var a;this.drawxnqxPath="";try{const i=t,s={data:i,taskid:e},{code:r,error:o="",original:l={},evidenceid:n=""}=yield Object(u["postDrawxnqx"])(s);200==Number(r)?(this.historyEvidenceid=null!=n?n:"",this.historyEvidence=null!=(a=l.avgs)?a:[],this.drawxnqxPath=`${l.path}?t=${h()(new Date).format("x")}`,this.original=null!=l?l:{},this.historycolumns=_.filter(this.thingcolumns,(function(e){return"timestamp"!==e.prop}))):this.$baseMessage(this.$translateTitle("alert.Data request error")+""+o,"error","dgiot-hey-message-error")}catch(i){console.log(i),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+i,"error","dgiot-hey-message-error")}}))},getSummaries(e){const{columns:t,data:a}=e,i=[];return t.forEach((e,t)=>{if(0===t)return void(i[t]="平均值");const s=a.map(t=>Number(t[e.property]));if(s.every(e=>isNaN(e)))i[t]=0;else{let e=0;i[t]=s.reduce((t,a)=>{const i=Number(a);return isNaN(i)?t:(e++,t+a)},0),i[t]=i[t]/e}}),console.log(i),i}},beforeDestroy(){clearInterval(this.timer)}}},f106:function(e,t,a){},f1eb:function(e,t,a){},f3d6:function(e,t,a){},f5a9c:function(t,a,i){"use strict";i.r(a);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"system-log-container"},[t("dgiot-query-form",[t("dgiot-query-form-top-panel",[t("el-form",{attrs:{inline:!0,"label-width":"60px",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{attrs:{label:"账号"}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入账号"},model:{value:e.queryForm.account,callback:function(t){e.$set(e.queryForm,"account","string"===typeof t?t.trim():t)},expression:"queryForm.account"}})],1),t("el-form-item",{attrs:{label:"周期"}},[t("el-date-picker",{attrs:{"end-placeholder":"结束日期",format:"yyyy-MM-dd","start-placeholder":"开始日期",type:"daterange","value-format":"yyyy-MM-dd"},model:{value:e.queryForm.searchDate,callback:function(t){e.$set(e.queryForm,"searchDate",t)},expression:"queryForm.searchDate"}})],1),t("el-form-item",[t("el-button",{attrs:{icon:"el-icon-search",type:"primary"},nativeOn:{click:function(t){return e.queryData.apply(null,arguments)}}},[e._v(" 查询 ")])],1)],1)],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list},scopedSlots:e._u([{key:"empty",fn:function(){},proxy:!0}])},[t("el-table-column",{attrs:{align:"center",label:"日志类型",prop:"type","show-overflow-tooltip":"",width:"230px"}}),t("el-table-column",{attrs:{align:"center",label:"账号",prop:"account","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{align:"center",label:"执行结果",prop:"executeResult","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function({row:a}){return["登录成功"===a.executeResult?t("span",[t("span",{staticClass:"dgiot-dot dgiot-dot-success"},[t("span")]),e._v(" "+e._s(a.executeResult)+" ")]):t("span",[t("span",{staticClass:"dgiot-dot dgiot-dot-error"},[t("span")]),e._v(" "+e._s(a.executeResult)+" ")])]}}])}),t("el-table-column",{attrs:{align:"center",label:"登录IP",prop:"ip"}}),t("el-table-column",{attrs:{align:"center",label:"访问时间",prop:"datetime","show-overflow-tooltip":""}})],1),t("el-pagination",{attrs:{background:"","current-page":e.queryForm.pageNo,layout:e.layout,"page-size":e.queryForm.pageSize,total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)},r=[],o=i("8781"),l=(t,a,i)=>new Promise((s,r)=>{var o=t=>{try{n(i.next(t))}catch(e){r(e)}},l=t=>{try{n(i.throw(t))}catch(e){r(e)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,l);n((i=i.apply(t,a)).next())}),n={name:"SystemLog",data(){return{list:[],listLoading:!0,layout:"total, sizes, prev, pager, next, jumper",total:0,queryForm:{account:"",searchDate:"",pageNo:1,pageSize:20}}},created(){this.fetchData()},methods:{handleSizeChange(e){this.queryForm.pageSize=e,this.fetchData()},handleCurrentChange(e){this.queryForm.pageNo=e,this.fetchData()},queryData(){this.queryForm.pageNo=1,this.fetchData()},fetchData(){return l(this,null,(function*(){this.listLoading=!0;const{data:{list:e,total:t}}=yield Object(o["getList"])(this.queryForm);this.list=e,this.total=t,this.listLoading=!1}))}}},c=n,d=i("2877"),u=Object(d["a"])(c,s,r,!1,null,null,null);a["default"]=u.exports},fe50:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"CloudSystem-container"},[t("div",{staticClass:"CloudSystem-content"},[e._v(" "+e._s(e.infoData)+" ")])])},s=[],r={name:"CloudSystem",components:{},data(){return{infoData:"CloudSystem"}},computed:{},mounted(){},beforeCreate(){},beforeMount(){},beforeUpdate(){},updated(){},beforeDestroy(){},destroyed(){},activated(){},methods:{}},o=r,l=(a("cccf"),a("2877")),n=Object(l["a"])(o,i,s,!1,null,"6af26652",null);t["default"]=n.exports},ff25:function(e,t,a){}}]);