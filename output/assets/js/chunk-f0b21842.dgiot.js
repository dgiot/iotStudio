/*!
 *  build: 杭州数蛙科技有限公司 
 *  copyright: dgiot-dashboard 
 *  author: h7ml(h7ml@qq.com) 
 *  Time: 2023年01月29日11时07分47秒
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f0b21842"],{"04c1":function(e,t,a){"use strict";a("cb83")},"16c0":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",[t("div",{ref:"platform",staticClass:"platform"},[t("div",{staticClass:"home_dialog"},[t("el-dialog",{attrs:{"append-to-body":!0,title:e.deviceInfo.name,visible:e.deviceFlag,width:"100vh"},on:{"update:visible":function(t){e.deviceFlag=t}}},[t("info",{attrs:{devicedetail:e.deviceInfo}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.deviceFlag=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){e.deviceFlag=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)],1)],1),t("div",{staticClass:"map_header",style:{height:e.queryForm.workGroupTreeShow?"160px":"auto"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:"0px"!=e.cardHeight,expression:"cardHeight != '0px'"}],staticClass:"map_card"},[t("el-row",[t("el-col",{staticClass:"card-panel-col",attrs:{lg:6,md:6,sm:12,xl:6,xs:24}},[t("el-card",{directives:[{name:"loading",rawName:"v-loading",value:0==e.loadingConfig["product_count"],expression:"loadingConfig['product_count'] == false"}],staticClass:"box-card",attrs:{"element-loading-background":"rgba(0, 0, 0, 0.8)","element-loading-spinner":"el-icon-loading","element-loading-text":e.$translateTitle("developer.Waitingtoreturn")}},[t("el-col",{attrs:{span:12}},[t("dgiot-icon",{attrs:{icon:"projector-fill"}})],1),t("el-col",{staticClass:"card-right",attrs:{span:12}},[t("router-link",{attrs:{to:"/dashboard/productlist"}},[t("p",[e._v(e._s(e.$translateTitle("home.pro_count")))]),t("p",[e._v(e._s(e._product_count))])])],1)],1)],1),t("el-col",{staticClass:"card-panel-col",attrs:{lg:6,md:6,sm:12,xl:6,xs:24}},[t("el-card",{directives:[{name:"loading",rawName:"v-loading",value:0==e.loadingConfig["app_count"],expression:"loadingConfig['app_count'] == false"}],staticClass:"box-card",attrs:{"element-loading-text":e.$translateTitle("developer.Waitingtoreturn")}},[t("el-col",{attrs:{span:12}},[t("dgiot-icon",{attrs:{icon:"apps-fill"}})],1),t("el-col",{staticClass:"card-right",attrs:{span:12}},[t("router-link",{attrs:{to:"/roles/applicationManagement"}},[t("p",[e._v(e._s(e.$translateTitle("home.app_count")))]),t("p",[e._v(e._s(e._app_count))])])],1)],1)],1),t("el-col",{staticClass:"card-panel-col",attrs:{lg:6,md:6,sm:12,xl:6,xs:24}},[t("el-card",{directives:[{name:"loading",rawName:"v-loading",value:0==e.loadingConfig["device_count"],expression:"loadingConfig['device_count'] == false"}],staticClass:"box-card",attrs:{"element-loading-text":e.$translateTitle("developer.Waitingtoreturn")}},[t("el-col",{attrs:{span:12}},[t("dgiot-icon",{attrs:{icon:"device-recover-fill"}})],1),t("el-col",{staticClass:"card-right",staticStyle:{cursor:"pointer"},attrs:{span:12},nativeOn:{click:function(t){return e.goDevice()}}},[t("p",[e._v(e._s(e.$translateTitle("home.dev_count")))]),t("p",[e._v(e._s(e._dev_count))])])],1)],1),t("el-col",{staticClass:"card-panel-col",attrs:{lg:6,md:6,sm:12,xl:6,xs:24}},[t("el-card",{directives:[{name:"loading",rawName:"v-loading",value:0==e.loadingConfig["warn_count"],expression:"loadingConfig['warn_count'] == false"}],staticClass:"box-card",attrs:{"element-loading-text":e.$translateTitle("developer.Waitingtoreturn")}},[t("el-col",{staticClass:"card-left",attrs:{span:12}},[t("dgiot-icon",{attrs:{icon:"projector-2-fill"}})],1),t("el-col",{staticClass:"card-right",attrs:{span:12}},[t("router-link",{attrs:{to:"/CloudOt/alarm"}},[t("p",[e._v(" "+e._s(e.$translateTitle("equipment.Total number of alarms"))+" ")]),t("p",[e._v(e._s(e.warnCount))])])],1)],1)],1)],1)],1)]),t("el-card",{attrs:{shadow:"hover"}},[t("el-row",{directives:[{name:"show",rawName:"v-show",value:"baidu"==e.mapType,expression:"mapType == 'baidu'"}],attrs:{row:24}},[t("el-col",{attrs:{span:e.leftRow,xs:24}},[t("el-row",{attrs:{span:24}},[t("div",{staticClass:"chart_map",staticStyle:{position:"relative"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"card_left"},[t("el-row",{staticClass:"card_left-row",attrs:{gutter:24}},[t("el-col",{staticClass:"card_left-row-col",attrs:{span:6}},[t("Card",{staticClass:"card_left-row-col-card",staticStyle:{"background-color":"#ffad33","border-color":"#ffad33"}},[t("div",{staticStyle:{"text-align":"center"}},[t("Tag",{staticStyle:{background:"rgb(255, 173, 51)"},attrs:{checkable:"",color:"warning"}},[e._v(" "+e._s(e.offlineData.length||0)+" ")]),t("p",[e._v(e._s(e.$translateTitle("zetadevices.offline")))])],1)])],1),t("el-col",{staticClass:"card_left-row-col",attrs:{offset:2,span:6}},[t("Card",{staticClass:"card_left-row-col-card",staticStyle:{"background-color":"#19be6b","border-color":"#19be6b"}},[t("div",{staticStyle:{"text-align":"center"}},[t("Tag",{staticStyle:{background:"rgb(25, 190, 107)"},attrs:{checkable:"",color:"success"}},[e._v(" "+e._s(e.dev_online_count||0)+" ")]),t("p",[e._v(e._s(e.$translateTitle("zetadevices.online")))])],1)])],1),t("el-col",{staticClass:"card_left-row-col",attrs:{offset:2,span:6}},[t("Card",{staticClass:"card_left-row-col-card",staticStyle:{"background-color":"#f16643","border-color":"#f16643"}},[t("div",{staticStyle:{"text-align":"center"}},[t("Tag",{staticStyle:{background:"rgb(241, 102, 67)"},attrs:{checkable:"",color:"error"}},[e._v(" "+e._s(e.warnCount)+" ")])],1),t("p",[e._v(" "+e._s(e.$translateTitle("leftbar.alarms"))+" ")])])],1)],1)],1),t("div",{staticClass:"card",staticStyle:{position:"absolute",right:"100px","z-index":"1000"}},[t("p",{staticStyle:{margin:"0","font-size":"18px",color:"#f16643","text-align":"center"}},[e._v(" "+e._s(e.$translateTitle("zetadevices.offline"))+" ")]),t("Card",{staticStyle:{width:"80px",height:"80px",color:"#fff","background-color":"#ffad33","border-color":"#ffad33","border-radius":"50%",opacity:"0.89"}},[t("div",{staticStyle:{"text-align":"center"}},[t("p",[e._v(e._s(e.offlineData.length||0))])])]),t("p",{staticStyle:{margin:"0","font-size":"18px",color:"rgb(25, 190, 107)","text-align":"center"}},[e._v(" "+e._s(e.$translateTitle("zetadevices.online"))+" ")]),t("Card",{staticStyle:{width:"80px",height:"80px",margin:"5px 0",color:"#fff","background-color":"#19be6b","border-color":"#19be6b","border-radius":"50%",opacity:"0.89"}},[t("div",{staticStyle:{"text-align":"center"}},[t("p",[e._v(e._s(e.dev_online_count||0))])])]),t("p",{staticStyle:{margin:"0","font-size":"18px",color:"rgb(241, 102, 67)","text-align":"center"}},[e._v(" "+e._s(e.$translateTitle("leftbar.alarms"))+" ")]),t("Card",{staticStyle:{width:"80px",height:"80px",color:"#fff","background-color":"#f16643","border-color":"#f16643","border-radius":"50%",opacity:"0.89"}},[t("div",{staticStyle:{"text-align":"center"}},[t("p",[e._v(e._s(e.warnCount))])])])],1),t("baidu-map",{staticClass:"baidu_map",style:{height:e.mapHeight,width:e.mapWidth},attrs:{id:"baidu_map",ak:e.ak,center:e.center,"scroll-wheel-zoom":!0,zoom:e.sizeZoom}},[t("bm-control",[t("el-button",{attrs:{size:"mini"},on:{click:function(t){e.sizeZoom=19}}},[e._v(" "+e._s(e.$translateTitle("home.max"))+" ")]),t("el-button",{attrs:{size:"mini"},on:{click:function(t){e.sizeZoom=10}}},[e._v(" "+e._s(e.$translateTitle("home.restore"))+" ")]),t("el-button",{attrs:{size:"mini"},on:{click:function(t){e.sizeZoom=3}}},[e._v(" "+e._s(e.$translateTitle("home.min"))+" ")]),t("el-button",{staticClass:"ri-fullscreen-fill",attrs:{size:"mini"},on:{click:function(t){return e.toggleFull()}}}),t("bm-overview-map",{attrs:{"is-open":!0}}),t("bm-scale",{attrs:{offset:{width:260,height:0}}}),t("bm-city-list",{attrs:{offset:{width:330,height:0}}})],1),t("bml-marker-clusterer",{attrs:{"average-center":!0}},e._l(e._tableData,(function(a,i){return t("div",{key:i},[t("bm-marker",{attrs:{animation:"BMAP_ANIMATION_BOUNCE",dragging:!0,icon:{url:1==a.icon?e.icoPath.icoPath1:e.icoPath.icoPath2,size:{width:70,height:70}},position:{lng:a.location.longitude,lat:a.location.latitude}}},[t("bm-label",{attrs:{content:a.name,"label-style":{color:"red",fontSize:"12px"},offset:{width:15,height:6}},on:{click:function(t){return e._goDevice(a,i)}}})],1)],1)})),0),t("bm-navigation",{attrs:{anchor:"BMAP_ANCHOR_TOP_RIGHT"}}),t("bm-geolocation",{attrs:{anchor:"BMAP_ANCHOR_BOTTOM_RIGHT","auto-location":!0,"show-address-bar":!0,"show-zoom-info":!0}})],1)],1)])],1),t("el-col",{attrs:{span:24-e.leftRow,xs:24}},[t("div",{staticClass:"home_card"},[t("el-tabs",{on:{"tab-click":e.resizeTheChart},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$translateTitle("home.info"),name:"first"}},[t("div",{staticClass:"box-card"},[t("el-card",[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("el-button",[e._v(" "+e._s(e.$translateTitle("home.info"))+" ")])],1),t("div",[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:24}},[t("div",{staticClass:"grid-content bg-purple"},[e.Product?t("el-table",{staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e.Product,"header-cell-style":{"text-align":"center"},"row-class-name":e.tableRowClassName}},[t("el-table-column",{attrs:{label:e.$translateTitle("menu.icon"),width:"60"},scopedSlots:e._u([{key:"default",fn:function({row:e}){return[t("el-image",{staticStyle:{width:"26px",height:"26px"},attrs:{"preview-src-list":[""+e.icon],src:e.icon}},[t("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[t("i",{staticClass:"el-icon-picture-outline"})])])]}}],null,!1,3281234111)}),t("el-table-column",{attrs:{label:e.$translateTitle("task.productname"),prop:"name","show-overflow-tooltip":!0,width:"120"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",{on:{click:function(t){return e.goDevice(a.name)}}},[e._v(" "+e._s(a.name)+" ")])]}}],null,!1,699248853)}),t("el-table-column",{attrs:{label:e.$translateTitle("home.dev_count")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",{on:{click:function(t){return e.goDevice(a.name)}}},[e._v(" "+e._s(a.deviceChild.length)+" ")])]}}],null,!1,100581394)})],1):e._e()],1)])],1)],1)])],1),t("el-col",{attrs:{md:24,sm:24,xl:24,xs:24}},[t("el-card",{staticClass:"box-card"},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v(" "+e._s(e.$translateTitle("equipment.Equipment Overview"))+" ")]),t("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{icon:"el-icon-refresh",type:"text"},on:{click:function(t){return e.resizeTheChart()}}})],1),t("div",{staticClass:"text item"},[t("dgiot-chart",{ref:"charts",attrs:{data:e._ChartStatus,"data-empty":!e.ChartStatus.rows,extend:e.chartExtend,height:"160px",loading:e.loading,settings:e.chartSettings,type:"ring"}})],1)])],1)],1),t("el-tab-pane",{attrs:{label:e.$translateTitle("home.dev_unline"),name:"second"}},[t("div",{staticClass:"box-card"},[t("el-card",[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("el-badge",{staticClass:"item",attrs:{value:e._dev_off_count}},[t("el-button",{attrs:{size:"small"},on:{click:function(t){return e._goDevice("dev_unline")}}},[e._v(" "+e._s(e.$translateTitle("home.dev_unline"))+" ")])],1)],1),t("div",[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:24}},[t("div",{staticClass:"grid-content bg-purple"},[t("el-table",{staticClass:"_el-table",staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e._offlineData,"header-cell-style":{"text-align":"center"},"row-class-name":e.tableRowClassName}},[t("el-table-column",{attrs:{label:e.$translateTitle("equipment.devicename"),prop:"name"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",{attrs:{title:a.name+e.$translateTitle("home.Last online Time")+a.updatedAt},on:{click:function(t){return e.showInfo(a.objectId)}}},[e._v(" "+e._s(a.name)+" ")])]}}])})],1)],1)])],1)],1)])],1)]),t("el-tab-pane",{attrs:{label:e.$translateTitle("home.dev_online"),name:"third"}},[t("div",{staticClass:"box-card"},[t("el-card",[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("el-badge",{staticClass:"item",attrs:{value:e._dev_online_count}},[t("el-button",{attrs:{size:"small"},on:{click:function(t){return e._goDevice("dev_online")}}},[e._v(" "+e._s(e.$translateTitle("home.dev_online"))+" ")])],1)],1),t("div",[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:24}},[t("div",{staticClass:"grid-content bg-purple"},[t("el-table",{staticClass:"_el-table",staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e._onlineData,"header-cell-style":{"text-align":"center"},"row-class-name":e.tableRowClassName}},[t("el-table-column",{attrs:{label:e.$translateTitle("equipment.devicename"),prop:"name"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",{attrs:{title:a.name+e.$translateTitle("home.Last online Time")+a.updatedAt},on:{click:function(t){return e.showInfo(a.objectId)}}},[e._v(" "+e._s(a.name)+" ")])]}}])})],1)],1)])],1)],1)])],1)])],1)],1)])],1)],1)],1)])},o=[],r=a("fdeb"),s=a.n(r),l=a("327b"),n=a.n(l),c=a("1285"),d=a("5880"),p=a("bc35"),u=a("bb22"),m=a("ed08"),h=a("c4e6"),g=a("22f9"),b=a("cb88"),f=Object.defineProperty,v=Object.defineProperties,y=Object.getOwnPropertyDescriptors,_=Object.getOwnPropertySymbols,w=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable,k=(e,t,a)=>t in e?f(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,C=(e,t)=>{for(var a in t||(t={}))w.call(t,a)&&k(e,a,t[a]);if(_)for(var a of _(t))T.call(t,a)&&k(e,a,t[a]);return e},x=(e,t)=>v(e,y(t)),S=(e,t,a)=>new Promise((i,o)=>{var r=e=>{try{l(a.next(e))}catch(t){o(t)}},s=e=>{try{l(a.throw(e))}catch(t){o(t)}},l=e=>e.done?i(e.value):Promise.resolve(e.value).then(r,s);l((a=a.apply(e,t)).next())});window.dgiot.dgiotEnv=Object({NODE_ENV:"production",VUE_APP_TITLE:"物联网开发平台",VUE_APP_AUTHOR:"xxb",VUE_APP_UPDATE_TIME:"2023年01月29日11时07分47秒",VUE_APP_VERSION:"4.7.4",VUE_APP_Keywords:"一站式物联网PaaS平台|物联网应用服务",VUE_APP_Description:"提供物联网垂直领域应用使能平台及解决方案",VUE_APP_URL:"http://1.117.219.8",VUE_APP_CDN_URL:"/dgiot_dashboard/public",BASE_URL:""});var I={name:"Home",components:{BmPointCollection:b["BmPointCollection"],BmInfoWindow:b["BmInfoWindow"],info:h["default"],BmScale:b["BmScale"],BmMapType:b["BmMapType"],BmOverviewMap:b["BmOverviewMap"],BmPanorama:b["BmPanorama"],BmControl:b["BmControl"],BmLabel:b["BmLabel"],BaiduMap:b["BaiduMap"],BmNavigation:b["BmNavigation"],BmGeolocation:b["BmGeolocation"],BmCityList:b["BmCityList"],BmMarker:b["BmMarker"],BmlMarkerClusterer:b["BmlMarkerClusterer"]},data(){return this.chartSettings={radius:[5,40],offsetY:100},this.chartExtend={yAxisType:["percent"],tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"}},{queryParams:{},mapHeight:"800px",mapWidth:"800px",polyline:{editing:!1,paths:[]},list:{toolbar:!1,latitude:"31.551162",longitude:"120.260545",zoom:15},mapType:"baidu",isShow:!0,ak:this.$dgiot.secret.baidu.map,center:{lng:120.260545,lat:31.551162},icoPath:{icoPath1:s.a,icoPath2:n.a},router:"",loadingConfig:{product_count:!1,app_count:!1,device_count:!1,warn_count:!1},warnCount:0,count:0,productIco:"",ChartStatus:{columns:["状态","数量"],rows:[{"状态":"在线","数量":0},{"状态":"离线","数量":0}]},clientId:"dgiot_clientId_",infoWindow:{show:!0,contents:"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."},loading:!0,marker:{},deviceFlag:!1,deviceInfo:{detail:{}},Product:[],imgurl:"https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg",subtopic:"",isConnect:!1,queryForm:{account:"",searchDate:"",pageNo:1,pageSize:20,workGroupName:"",workGroupTreeShow:!1,access_token:""},roleProps:{children:"children",label:"name"},leftWidth:"",cardHeight:"",fixedPaddingTop:"",curDepartmentId:"",leftRow:24,treeDataValue:"",deptTreeData:[],show:!1,sizeZoom:5,tableData:[],offlineData:[],onlineData:[],chartSetting:{yAxis:{type:"value",minInterval:1}},msgtopic:"",NODE_ENV:"production",category:[],activeName:"second",filterBox:"filterBox-first",project_count:0,app_count:0,product_count:0,dev_count:0,active:!1,dev_active_count:0,dev_online_count:0,dev_off_count:0,projectList:[],formInline:{starttime:"",project:""}}},computed:C({},Object(d["mapGetters"])({objectId:"user/objectId",roleTree:"user/roleTree",collapse:"settings/collapse",_Product:"user/_Product",language:"settings/language",_dev_count:"dashboard/_dev_count",_project_count:"dashboard/_project_count",_app_count:"dashboard/_app_count",_product_count:"dashboard/_product_count",token:"user/token",_dev_online_count:"dashboard/_dev_online_count",_onlineData:"dashboard/_onlineData",_dev_off_count:"dashboard/_dev_off_count",_offlineData:"dashboard/_offlineData",_ChartStatus:"dashboard/_ChartStatus",_tableData:"dashboard/_tableData",_pcimg:"dashboard/_pcimg",_role:"acl/role",_mimg:"dashboard/_mimg",mqttInfo:"mqttDB/mqttInfo",treeFlag:"settings/treeFlag"})),watch:{treeFlag:{handler:function(e){this.mapWidth=e?.77*window.innerWidth+"px":.98*window.innerWidth+"px"},deep:!0,limit:!0},sizeZoom:{handler:function(e){console.log("当前sizeZoom 为 "+e)},deep:!0,limit:!0}},mounted(){window.bh="",window.kd="",this.initMapHeight(),this.router=this.$dgiotBus.router(this.$route.fullPath),this.$dgiotBus.$off("qqMapClcik"),this.$dgiotBus.$on("qqMapClcik",e=>{console.log(e)}),this.queryForm.account="zh"==this.language?"全部产品":"All Products",this.initDgiotMqtt(),window.onresize=()=>(()=>{this.mapHeight=.8*window.innerHeight+"px",this.mapWidth=.98*window.innerWidth+"px"})()},beforeDestroy(){return S(this,null,(function*(){}))},activated(){this.resizeTheChart()},destroyed(){this.resizeTheChart()},methods:x(C({initMapHeight(){return S(this,null,(function*(){this.mapHeight=.7*window.innerHeight+"px",this.mapWidth=.98*window.innerWidth+"px"}))},handler({BMap:e,map:t}){console.log(e,t)},getPosition(e){return e.forEach(e=>{e.lng=e.location.longitude,e.lat=e.location.latitude}),console.log(e),e},initDgiotMqtt(){this.$nextTick(()=>S(this,null,(function*(){yield this.queryData(),yield this.setTreeFlag(!0)})))},getWarnCount(){return S(this,arguments,(function*(e={count:"objectId",where:{}}){e.where["createdAt"]={$gt:{__type:"Date",iso:moment().subtract(1,"days").format("YYYY-MM-DD")}},e.where["updatedAt"]={$lt:{__type:"Date",iso:moment(new Date).format("YYYY-MM-DD")}};try{const{count:t=0}=yield this.$query_object("Maintenance",e);this.warnCount=t}catch(t){this.$baseMessage(""+t,"error","dgiot-hey-message-error")}}))},toggleFull(e){this.count++,this.count%2==0?this.$exitFull("baidu_map"):this.$beFull("baidu_map")},resizeTheChart(){this.loading=!0;let e=this.$refs["charts"];e&&(e.$children[0].resize(),setTimeout(()=>{this.loading=!1},2e3))},tableRowClassName({row:e,rowIndex:t}){return 1===t?"warning-row":2===t?"success-row":""}},Object(d["mapMutations"])({setTreeFlag:"settings/setTreeFlag",resaveMqttInfo:"mqttDB/resaveMqttInfo",set_Product:"user/set_Product",set_dev_count:"dashboard/set_dev_count",set_project_count:"dashboard/set_project_count",set_app_count:"dashboard/set_app_count",set_product_count:"dashboard/set_product_count",set_dev_online_count:"dashboard/set_dev_online_count",set_onlineData:"dashboard/set_onlineData",set_dev_off_count:"dashboard/set_dev_off_count",set_offlineData:"dashboard/set_offlineData",set_ChartStatus:"dashboard/set_ChartStatus",set_tableData:"dashboard/set_tableData"})),{deviceToDetail(e){this.$router.push({path:"/roles/editdevices",query:{deviceid:e.objectId,nodeType:"2",ischildren:"false"}})},getCategory(e){let t="";return this.category.filter(a=>{a.type==e&&(t=a.data.CategoryName)}),t},closeInfo(e,t){},showDeatils(e,t){return S(this,null,(function*(){}))},showInfo(e){return S(this,null,(function*(){this.deviceInfo=yield Object(c["getDevice"])(e);let t=this.deviceInfo.product.objectId||"undefined",a=this.deviceInfo.devaddr||"undefined",i=[{topic:`thing/${t}/${a}/post`,type:"pub",desc:"设备上报",isdef:!0},{topic:`thing/${t}/${a}`,type:"sub",desc:"消息下发",isdef:!0}];this.deviceInfo.product.topics?this.deviceInfo.topicData=this.deviceInfo.product.topics.concat(i):this.deviceInfo.topicData=i,this.deviceFlag=!0}))},mqttMsg(e){let t=Object(m["isBase64"])(e)?Base64.decode(e):e;console.log(t,"收到消息");let a=JSON.parse(t).value,i=JSON.parse(t).vuekey;switch(i){case"app_count":this.app_count=a.count,this.set_app_count(this.app_count);break;case"project_count":this.project_count=a.count,this.set_project_count(this.project_count);break;case"product_count":this.product_count=a.count,this.set_product_count(this.product_count),this.Product=a.results;break;case"dev_online_count":this.dev_online_count=a.count,this.set_dev_online_count(this.dev_online_count),this.onlineData=a.results,this.set_onlineData(this.onlineData);break;case"dev_off_count":console.error(a,"mqttMsgValue"),this.dev_off_count=a.count,this.offlineData=a.results,this.set_dev_off_count(this.dev_off_count),this.set_offlineData(this.offlineData);break;case"warn_count":this.warnCount=a.count;break;case"ChartStatus":this.ChartStatus=a.chartData,this.set_ChartStatus(this.ChartStatus),this.resizeTheChart(),this.$forceUpdate();break;case"baiduMap":this.tableData=a,this.tableData.forEach(e=>{e.show=!1,e.color="0"===e.icon?"yellow":"1"===e.icon?"blue":"red"}),this.set_tableData(this.tableData),this.$forceUpdate();break;case"device_count":this.dev_count=a.count,this.set_dev_count(this.dev_count);break;default:break}this.$forceUpdate()},toggleCard(e){"0px"!=e?($(".map_card").css({height:"0px"}),this.cardHeight="0px"):($(".map_card").css({height:"98px"}),this.cardHeight="98px")},toggleLeftWidth(e){"0px"!=e?($(".dgiot-side-bar").css({width:"0px"}),$(".dgiot-main").css({"margin-left":"0px"}),this.leftWidth="0px"):($(".dgiot-side-bar").css({width:"200px"}),$(".dgiot-main").css({"margin-left":"200px"}),this.leftWidth="200px")},selectProdChange(e){},queryData(){return S(this,null,(function*(){const{dashboard:e={}}=yield Object(g["getDlinkJson"])("Dashboard");this.queryParams=e,setTimeout(()=>{this.queryParams.forEach(e=>{let t=e.vuekey;this.loadingConfig[""+t]=!0})},1240);const t="32511dbfe5";yield Object(u["Startdashboard"])(this.queryParams,t),this.$dgiotBus.$on(this.$dgiotBus.getTopicKeyBypage("dashboard"),e=>{const{payloadString:t}=e;console.log("home page topic data",t),console.log(e),this.mqttMsg(t)}),this.$nextTick(()=>{if("tencent"==this.mapType&&(this.setTreeFlag(!1),this.$refs.qqmap.$children[0].qqmap)){console.clear(),console.error(this.$refs.qqmap.$children[0]," this.$refs.qqmap.$children[0].qqmap"),document.querySelector(".lngTips").style.display="none",window.qq.maps.event.addListener(this.$refs.qqmap.$children[0].qqmap,"mousemove",(function(e){document.querySelector(".lngTips").style.display="none"}));var e=new window.qq.maps.LatLng(28.475997,121.331121),t=new qq.maps.InfoWindow({map:this.$refs.qqmap.$children[0].qqmap,position:e,content:'<div><h3>国家水泵产品质量检验中心(浙江)\n</h3><p>浙江省台州市温岭市迎宾大道温岭市泵业创新服务综合体\n</p><img class="pic" style="width:320px" src="https://sv6.map.qq.com/mmthumb?svid=18091033131005101120600&amp;from=web"></div>'});t.open(),this.$refs.qqmap.$children[0].qqmap.setZoom(18)}})}))},getProduct(){return S(this,null,(function*(){const{results:e}=yield queryProduct({count:"objectId",order:"-updatedAt",keys:"name,icon",where:{}});e.unshift({name:"zh"==this.language?"全部产品":"All Products",objectId:"0"}),this.set_Product(e)}))},change(e){e&&$(".el-tree").css({height:"100px",display:"block","overflow-x":"auto"})},handleNodeClick(e,t){return S(this,null,(function*(){const a=this._role.map(e=>e.name);if($(".el-tree").css({height:"0px",display:"none","overflow-x":"auto"}),$(".el-select-dropdown").css({display:"none"}),this.queryForm.workGroupName=e.label,this.treeDataValue=e.label,a.includes(e.name))this.queryForm.access_token=this.token;else if(1!=t.level){const{access_token:t=""}=yield Object(p["getToken"])(e.name);this.queryForm.access_token=t}else this.queryForm.access_token=this.token;this.queryForm.workGroupTreeShow=!this.queryForm.workGroupTreeShow;const{name:i,objectId:o}=e;this.curDepartmentId=o}))},handleChange(){},handleClickVisit(e){this.$router.push({path:"/Topo",query:{productid:e.objectId}})},goDevice(e){var t;this.$router.push({path:"/dashboard/device",query:{product:e}}),console.log(window.errRoute),(null==(t=null==window?void 0:window.errRoute)?void 0:t.name)&&this.$router.push({path:"/dashboard/devicelist",query:{product:e}})},_goDevice(e){var t;this.$router.push({path:"dashboard/device",query:{devicename:e.name}}),console.log(window.errRoute),(null==(t=null==window?void 0:window.errRoute)?void 0:t.name)&&this.$router.push({path:"/dashboard/devicelist",query:{devicename:e.name}})},goLink(e,t){var a;switch(e){case"real-time":this.$router.push({path:"/roles/editdevices",query:{deviceid:this.deviceInfo.objectId,nodeType:2,ischildren:"false"}});break;case"konva":this.$router.push({path:"/Topo",query:{productid:this.deviceInfo.product.objectId,devaddr:this.deviceInfo.devaddr,deviceid:this.deviceInfo.objectId,type:"device"}});break;case"video":const{basedata:e}=this.deviceInfo;if(!(null==(a=null==e?void 0:e.videoSrc)?void 0:a.length))return this.$baseMessage(this.$translateTitle("equipment.The device is not bound to the video address yet"),"info","dgiot-hey-message-error"),!1;this.$router.push({path:"/Tools/player",query:{type:e.videoType||"m3u8",url:e.videoSrc}});break}},Gotoproduct(e){this.$router.push({path:"/dashboard/productlist",query:{project:e}})}})},P=I,j=(a("93f5"),a("2877")),D=Object(j["a"])(P,i,o,!1,null,"29cfecba",null);t["default"]=D.exports},"2b72":function(e,t,a){"use strict";a("3d98")},"2b83a":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"devproduct devproduct-container"},[t("input",{ref:"uploader",staticStyle:{display:"none"},attrs:{accept:"zip",type:"file"},on:{change:function(t){return e.doUpload(t)}}}),t("el-dialog",{staticStyle:{margin:"0 auto"},attrs:{"append-to-body":!0,visible:e.dialogVisible,top:"1vh",width:"90%"},on:{"update:visible":function(t){e.dialogVisible=t}}}),t("el-dialog",{attrs:{"append-to-body":!0,visible:e.parserView},on:{"update:visible":function(t){e.parserView=t}}},[t("f-render",{attrs:{config:e.formConfig,pure:""},model:{value:e.formConfig,callback:function(t){e.formConfig=t},expression:"formConfig"}})],1),t("el-dialog",{staticClass:"parserTable",attrs:{"append-to-body":!0,visible:e.parserTable},on:{"update:visible":function(t){e.parserTable=t}}},[t("div",{staticClass:"header-title parserTable",attrs:{slot:"title"},slot:"title"},[t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.addParse(e.parserTableList)}}},[e._v(" "+e._s(e.$translateTitle("product.newlyadded"))+" ")]),t("el-button",{attrs:{type:"success"},nativeOn:{click:function(t){return t.preventDefault(),e.saveParse(e.parserTableList)}}},[e._v(" "+e._s(e.$translateTitle("product.preservation"))+" ")])],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.parserTableList.parser,height:e.height}},[t("el-table-column",{attrs:{label:e.$translateTitle("product.chinesetitle"),align:"center",prop:"name",sortable:""}}),t("el-table-column",{attrs:{label:e.$translateTitle("product.englishtitle"),align:"center",prop:"enname",sortable:""}}),t("el-table-column",{attrs:{label:e.$translateTitle("leftbar.settings"),align:"center","show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function({row:a,$index:i}){return[t("el-button",{attrs:{plain:"",type:"primary"},on:{click:function(t){return e.editParse(i,a)}}},[e._v(" "+e._s(e.$translateTitle("concentrator.edit"))+" ")]),t("el-button",{attrs:{plain:"",type:"success"},on:{click:function(t){return e.previewParse(a.config)}}},[e._v(" "+e._s(e.$translateTitle("application.preview"))+" ")]),t("el-button",{attrs:{plain:"",size:"small",type:"danger"},nativeOn:{click:function(t){return t.preventDefault(),e.deleteParse(i,e.parserTableList.parser)}}},[e._v(" "+e._s(e.$translateTitle("task.Delete"))+" ")])]}}])})],1)],1),t("dgiot-input",{ref:"uploadFinish",attrs:{params:e.inputParams},on:{fileInfo:e.fileInfo,files:e.files}}),t("div",{staticClass:"prosecond"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline,size:"small"}},[t("el-form-item",[t("el-input",{attrs:{placeholder:e.$translateTitle("product.searchproductname"),clearable:""},model:{value:e.formInline.productname,callback:function(t){e.$set(e.formInline,"productname",t)},expression:"formInline.productname"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.searchProduct(0)}}},[e._v(" "+e._s(e.$translateTitle("developer.search"))+" ")])],1),t("el-form-item",{staticStyle:{"text-align":"right"}},[t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.addproduct.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.createproduct"))+" ")])],1),t("el-form-item",{staticStyle:{"text-align":"right"}},[t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.exportpro.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.exportpro"))+" ")])],1),t("el-form-item",{staticStyle:{"text-align":"right"}},[t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.handleImport()}}},[e._v(" "+e._s(e.$translateTitle("product.importpro"))+" ")])],1)],1),t("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticClass:"box-card",attrs:{"element-loading-background":"rgba(0, 0, 0, 0.8)","element-loading-spinner":"el-icon-loading","element-loading-text":e.$translateTitle("developer.Waitingtoreturn"),gutter:20}},e._l(e.proTableData,(function(a,i){return t("el-col",{key:i,attrs:{lg:6,md:8,sm:12,xl:6,xs:24}},[t("a-card",{staticStyle:{"margin-bottom":"24px"},attrs:{hoverable:""},scopedSlots:e._u([{key:"actions",fn:function(){return[t("el-row",{attrs:{gutter:24}},[t("el-col",{staticStyle:{margin:"0 auto","text-align":"center"},attrs:{offset:2,span:2}},[t("a-icon",{staticStyle:{"font-size":"28px"},attrs:{type:"eye",title:"产品详情"},nativeOn:{click:function(t){return e.deviceToDetail(a)}}})],1),t("el-col",{staticStyle:{margin:"0 auto","text-align":"center"},attrs:{span:2}},[t("a-icon",{staticStyle:{"font-size":"24px"},attrs:{type:"book",title:e.$translateTitle("product.dict")},nativeOn:{click:function(t){return e.editorDict(a.objectId)}}})],1),t("el-col",{staticStyle:{margin:"0 auto","text-align":"center"},attrs:{span:2}},[t("a-icon",{staticStyle:{"font-size":"24px"},attrs:{type:"video-camera",title:e.$translateTitle("concentrator.konva")},nativeOn:{click:function(t){return e.goKonva(a.objectId)}}})],1),t("el-col",{staticStyle:{margin:"0 auto","text-align":"center"},attrs:{offset:1,span:1}},[t("a-icon",{staticStyle:{"font-size":"24px"},attrs:{type:"edit",title:e.$translateTitle("button.edit")},nativeOn:{click:function(t){return e.editorProduct(a.objectId)}}})],1),t("el-col",{staticStyle:{margin:"0 auto","text-align":"center"},attrs:{span:3}},[t("a-icon",{staticStyle:{"font-size":"24px"},attrs:{type:"delete",title:e.$translateTitle("button.Delete")},nativeOn:{click:function(t){return e.makeSure(a,i)}}})],1)],1)]},proxy:!0}],null,!0)},[t("a-card-meta",{attrs:{title:a.name,description:a.devType},scopedSlots:e._u([{key:"avatar",fn:function(){return[t("el-image",{key:a.icon+a.objectId,staticStyle:{height:"40px"},attrs:{src:e.$FileServe+a.icon,"preview-src-list":[e.$FileServe+a.icon]}},[t("div",{staticClass:"image-slot",staticStyle:{"text-align":"center"},attrs:{slot:"error"},slot:"error"},[t("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"40px","text-align":"center"}})])]),t("br"),e._v(" "+e._s(a.objectId)+" ")]},proxy:!0}],null,!0)}),t("el-descriptions",{attrs:{column:4,size:"medium",direction:"vertical",border:""}},[t("el-descriptions-item",{attrs:{contentStyle:{"text-align":"center"},label:e.$translateTitle("home.dev_online"),title:a.objectId}},[t("el-link",{attrs:{type:"success"},nativeOn:{click:function(t){return e.goLink(a,"online")}}},[e._v(" "+e._s(a.online_counts||0)+" ")])],1),t("el-descriptions-item",{attrs:{contentStyle:{"text-align":"center"},label:e.$translateTitle("home.dev_unline"),title:a.objectId}},[t("el-link",{attrs:{type:"warning"},nativeOn:{click:function(t){return e.goLink(a,"offline")}}},[e._v(" "+e._s(a.offline_counts||0)+" ")])],1),t("el-descriptions-item",{attrs:{contentStyle:{"text-align":"center"},label:e.$translateTitle("device.poweron"),title:a.objectId}},[t("el-link",{attrs:{type:"success"},nativeOn:{click:function(t){return e.goLink(a,"poweron")}}},[e._v(" "+e._s(a.poweron_counts||0)+" ")])],1),t("el-descriptions-item",{attrs:{contentStyle:{"text-align":"center"},label:e.$translateTitle("device.poweroff"),title:a.objectId}},[t("el-link",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.goLink(a,"poweroff")}}},[e._v(" "+e._s(a.poweroff_counts||0)+" ")])],1)],1)],1)],1)})),1),t("el-pagination",{key:e.paginationKey+"forensics",attrs:{background:"","current-page":e.queryForm.pageSize,layout:"total, sizes, prev, pager, next, jumper","page-size":e.queryForm.limit,"page-sizes":[8,16,32,64],total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1),t("div",{staticClass:"devproduct-prodialog"},[t("el-drawer",{directives:[{name:"drawerDrag",rawName:"v-drawerDrag"}],attrs:{"before-close":e.handleClose,"close-on-click-modal":!1,title:e.moduleTitle,visible:e.dialogFormVisible,"append-to-body":"",size:"50%",top:"5vh"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-alert",{directives:[{name:"show",rawName:"v-show",value:!e.currentDepartment.name,expression:"!currentDepartment.name"}],attrs:{closable:!1,description:"请先选择部门后,再来新增产品",title:"温馨提示",type:"success"}}),t("div",{staticClass:"devproduct-prodialog-content"},[t("div",{staticClass:"contentone"},[t("div",{staticStyle:{display:"flex"}},[t("span",[e._v(" "+e._s(e.$translateTitle("product.productinformation"))+" ")]),t("p",{staticStyle:{"flex-grow":"2",width:"auto",height:"1px",margin:"10px","border-top":"1px dashed #dddddd"}})]),t("el-form",{key:e.form.type,ref:"form",attrs:{"label-width":"产品名称"==e.$translateTitle("product.productname")?"120px":"160px",model:e.form,rules:e.rules}},[t("el-form-item",{attrs:{label:e.$translateTitle("product.productname"),prop:"name"}},[t("el-input",{attrs:{disabled:"edit"==e.custom_status,autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:e.$translateTitle("product.device manufacturer"),prop:"devType"}},[t("el-input",{attrs:{disabled:"edit"==e.custom_status,autocomplete:"off"},model:{value:e.form.devType,callback:function(t){e.$set(e.form,"devType",t)},expression:"form.devType"}})],1),t("el-form-item",{attrs:{label:e.$translateTitle("product.classification"),prop:0==e.form.type?"":"categoryname"}},["edit"!=e.custom_status?t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:10}},[t("el-radio-group",{attrs:{disabled:"edit"==e.custom_status},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[t("el-radio",{attrs:{label:1}},[e._v(" "+e._s(e.$translateTitle("product.Standard category"))+" ")]),t("el-radio",{attrs:{label:0}},[e._v(" "+e._s(e.$translateTitle("product.Custom category"))+" ")])],1)],1),1==e.form.type?t("el-col",{staticStyle:{padding:"0"},attrs:{span:13}},[t("el-input",{attrs:{readonly:""},model:{value:e.form.categoryname,callback:function(t){e.$set(e.form,"categoryname",t)},expression:"form.categoryname"}},[t("el-icon",{staticClass:"el-icon-edit el-input__icon",attrs:{slot:"append",size:"mini"},nativeOn:{click:function(t){return e.handlecateClick.apply(null,arguments)}},slot:"append"})],1)],1):e._e()],1):t("span",[e._v(e._s(e.form.categoryname))])],1),t("el-form-item",{attrs:{label:e.$translateTitle("product.dynamicregistration"),prop:"netType"}},[t("el-tooltip",{attrs:{content:e.$translateTitle("product.text1"),placement:"top"}},[t("el-switch",{attrs:{"active-text":"开启动态注册","inactive-text":"关闭动态注册","active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.form.dynamicReg,callback:function(t){e.$set(e.form,"dynamicReg",t)},expression:"form.dynamicReg"}})],1)],1),t("el-form-item",{attrs:{label:e.$translateTitle("product.Storage channel"),prop:"tdchannel"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("task.Select")},model:{value:e.form.tdchannel,callback:function(t){e.$set(e.form,"tdchannel",t)},expression:"form.tdchannel"}},e._l(e.tdchannelList,(function(e){return t("el-option",{key:e.objectId,attrs:{label:e.name,value:e.objectId}})})),1)],1),t("el-form-item",{attrs:{label:e.$translateTitle("product.taskchannel"),prop:"taskchannel"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("task.Select")},model:{value:e.form.taskchannel,callback:function(t){e.$set(e.form,"taskchannel",t)},expression:"form.taskchannel"}},e._l(e.taskchannelList,(function(e){return t("el-option",{key:e.objectId,attrs:{label:e.name,value:e.objectId}})})),1)],1),t("el-form-item",{attrs:{label:e.$translateTitle("product.Acquisition channel"),prop:"otherchannel"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("task.Select"),"value-key":"objectId"},model:{value:e.form.otherchannel,callback:function(t){e.$set(e.form,"otherchannel",t)},expression:"form.otherchannel"}},e._l(e.otherchannelList,(function(e){return t("el-option",{key:e.objectId,attrs:{label:e.name,value:e.objectId}})})),1)],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"edit"!=e.custom_status,expression:"custom_status != 'edit'"}],attrs:{label:e.$translateTitle("product.Current department"),prop:"edit"!=e.custom_status?"relationApp":""}},[t("el-input",{attrs:{placeholder:e.$translateTitle("product.Current department"),readonly:""},model:{value:e.form.relationApp,callback:function(t){e.$set(e.form,"relationApp",t)},expression:"form.relationApp"}})],1),t("el-form-item",{attrs:{label:e.$translateTitle("product.nodetype"),prop:"nodeType"}},[t("el-radio-group",{model:{value:e.form.nodeType,callback:function(t){e.$set(e.form,"nodeType",t)},expression:"form.nodeType"}},[t("el-radio",{attrs:{label:3}},[e._v(" "+e._s(e.$translateTitle("product.direct"))+" ")]),t("el-radio",{attrs:{label:1}},[e._v(" "+e._s(e.$translateTitle("product.gateway"))+" ")]),t("el-radio",{attrs:{label:2}},[e._v(" "+e._s(e.$translateTitle("product.groupgateway"))+" ")]),t("el-radio",{attrs:{label:0}},[e._v(" "+e._s(e.$translateTitle("product.equipment"))+" ")])],1)],1),t("el-form-item",{attrs:{label:e.$translateTitle("product.networking"),prop:"netType"}},[t("el-select",{attrs:{placeholder:e.$translateTitle("product.selectgateway")},model:{value:e.form.netType,callback:function(t){e.$set(e.form,"netType",t)},expression:"form.netType"}},e._l(e.channel,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:e.$translateTitle("menu.icon"),prop:"icon"}},[e.imageUrl?t("div",[t("img",{staticClass:"avatar",attrs:{src:e.$FileServe+e.imageUrl}}),t("el-button",{staticStyle:{"vertical-align":"text-bottom"},attrs:{size:"mini",type:"danger"},on:{click:function(t){return t.stopPropagation(),e.deleteImgsrc.apply(null,arguments)}}},[e._v(" 删除 ")])],1):t("i",{staticClass:"el-icon-plus avatar-uploader-icon",on:{click:function(t){return e.uploadCkick("product_ico")}}}),t("form",{ref:"uploadform",staticStyle:{position:"absolute",visibility:"hidden"},attrs:{enctype:"multipart/form-data",method:"POST"}},[t("input",{staticStyle:{position:"relative","z-index":"5",width:"100px",height:"100px",cursor:"pointer",opacity:"0"},attrs:{type:"file"},on:{change:function(t){return e.upload(t)}}})]),t("br")]),t("el-form-item",{attrs:{label:e.$translateTitle("developer.describe"),prop:"desc"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1)],1)],1)]),t("div",{staticClass:"devproduct-prodialog-footer"},[t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitForm()}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")]),t("el-button",{on:{click:function(t){return e.handleCloseDialogForm()}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")])],1),t("el-drawer",{directives:[{name:"drawerDrag",rawName:"v-drawerDrag"}],attrs:{"append-to-body":!0,visible:e.cascaderDrawer,size:"40%"},on:{"update:visible":function(t){e.cascaderDrawer=t}}},[t("div",[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:24}},[t("dgiot-query-form",[t("dgiot-query-form-top-panel",[t("el-form",{attrs:{inline:!0,"label-width":"100px"},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{attrs:{label:e.$translateTitle("product.classification")}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("task.Select")},on:{change:e.handleCateSearch},model:{value:e.queryForm.category,callback:function(t){e.$set(e.queryForm,"category",t)},expression:"queryForm.category"}},e._l(e.categoryList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.name,value:e.objectId}})})),1)],1),t("el-form-item",{attrs:{label:e.$translateTitle("developer.Templatename")}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入模板名称"},model:{value:e.v.name,callback:function(t){e.$set(e.v,"name",t)},expression:"v.name"}})],1),t("el-form-item",{attrs:{"label-width":"0"}},[t("el-button",{staticClass:"el-icon-search",attrs:{"native-type":"submit",type:"primary"},on:{click:function(t){return e.queryprodut({})}}})],1)],1)],1)],1),t("el-table",{attrs:{data:e.tableData}},[t("el-table-column",{attrs:{align:"center",label:"序号","show-overflow-tooltip":"",sortable:"",width:"95"},scopedSlots:e._u([{key:"default",fn:function({$index:t}){return[e._v(" "+e._s(t+1)+" ")]}}])}),t("el-table-column",{attrs:{align:"center",label:"名称","show-overflow-tooltip":"",sortable:"",prop:"name",width:"auto"}}),t("el-table-column",{attrs:{align:"center",label:"id","show-overflow-tooltip":"",sortable:"",width:"auto",prop:"objectId"}}),t("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作","show-overflow-tooltip":"",width:"100px"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-button",{attrs:{plain:"",size:"mini",type:"info"},on:{click:function(t){return e.chooseTemplate(a)}}},[e._v(" 选择 ")])]}}])})],1)],1)],1),t("el-pagination",{attrs:{background:"","current-page":e.v.size,layout:e.v.layout,"page-size":e.v.limit,total:e.v.total},on:{"current-change":e.vhandleCurrentChange,"size-change":e.vhandleSizeChange}})],1)])],1),t("el-dialog",{attrs:{"append-to-body":!0,visible:e.dialogProfile,top:"1vh"},on:{"update:visible":function(t){e.dialogProfile=t}}},[t("dgiot-profile",{ref:"dialogProfile",attrs:{"is-product":!0}})],1),e.dictVisible?t("a-drawer",{staticStyle:{"z-index":"999"},attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.title_temp_dialog,visible:e.dictVisible,width:"60%"},on:{close:function(t){e.dictVisible=!e.dictVisible}}},[t("el-form",{ref:"dictTempForm",attrs:{model:e.dictTempForm,rules:e.rule,size:"mini"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"字典模板名称",prop:"name"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.dictTempForm.name,callback:function(t){e.$set(e.dictTempForm,"name",t)},expression:"dictTempForm.name"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"字典模板状态",prop:"enable"}},[t("el-radio",{attrs:{border:"",label:"1"},model:{value:e.dictTempForm.enable,callback:function(t){e.$set(e.dictTempForm,"enable",t)},expression:"dictTempForm.enable"}},[e._v(" 启用 ")]),t("el-radio",{attrs:{border:"",label:"0"},model:{value:e.dictTempForm.enable,callback:function(t){e.$set(e.dictTempForm,"enable",t)},expression:"dictTempForm.enable"}},[e._v(" 禁用 ")])],1)],1)],1),t("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"字典模板数据"}},[t("el-tabs",{model:{value:e.elactiveName,callback:function(t){e.elactiveName=t},expression:"elactiveName"}},[t("el-tab-pane",{attrs:{label:"Table",name:"Table"}},[t("el-button",{staticClass:"mt-3",attrs:{icon:"el-icon-plus",size:"small",type:"primary"},nativeOn:{click:function(t){return e.addRow(e.dictTempForm.params)}}},[e._v(" 新 增 ")]),t("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.dictTempForm.params}},[t("el-table-column",{attrs:{label:"序号",prop:"order"}}),t("el-table-column",{attrs:{label:"标识符",prop:"identifier"}}),t("el-table-column",{attrs:{label:"功能名称",prop:"name"}}),t("el-table-column",{attrs:{label:"数据类型",prop:"type"}}),t("el-table-column",{attrs:{label:"数据地址",prop:"address"}}),t("el-table-column",{attrs:{label:"数据长度",prop:"bytes"}}),t("el-table-column",{attrs:{label:"是否必填",prop:"required"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[a.required?t("span",[e._v("是")]):t("span",[e._v("否")])]}}],null,!1,2053984958)}),t("el-table-column",{attrs:{align:"center",label:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function({row:a,$index:i}){return[t("el-button",{attrs:{plain:"",size:"mini",title:"删除",type:"danger"},nativeOn:{click:function(t){return e.delRow(i,a)}}},[e._v(" 删除 ")]),t("el-button",{attrs:{plain:"",size:"mini",title:"编辑",type:"info"},nativeOn:{click:function(t){return e.editRow(i,a)}}},[e._v(" 编辑 ")])]}}],null,!1,3125019904)})],1)],1)],1)],1),t("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"描述"}},[t("el-input",{attrs:{autosize:{minRows:2,maxRows:4},placeholder:"请输入描述",type:"textarea"},model:{value:e.dictTempForm.description,callback:function(t){e.$set(e.dictTempForm,"description",t)},expression:"dictTempForm.description"}})],1),t("el-form-item",{staticStyle:{"text-align":"center"},attrs:{size:"mini"}},[t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.onJsonSave("dictTempForm")}}},[e._v(" 提交 ")]),t("el-button",{on:{click:function(t){e.dictVisible=!1}}},[e._v("取消")])],1)],1)],1):e._e(),t("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.closeDict,"close-on-click-modal":!1,title:e.title_dict_edit_dialog,visible:e.edit_dict_temp_dialog,top:"5vh",width:"60%"},on:{"update:visible":function(t){e.edit_dict_temp_dialog=t},open:function(t){return e.opendialog("tempparams")}}},[t("el-form",{ref:"tempparams",attrs:{model:e.tempparams,"label-position":"left","label-width":"100px",size:"mini"}},[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"序号",prop:"order"}},[t("el-input",{model:{value:e.tempparams.order,callback:function(t){e.$set(e.tempparams,"order",e._n(t))},expression:"tempparams.order"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$translateTitle("product.identifier"),prop:"identifier"}},[t("el-input",{model:{value:e.tempparams.identifier,callback:function(t){e.$set(e.tempparams,"identifier",t)},expression:"tempparams.identifier"}})],1)],1)],1),t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$translateTitle("product.functionname"),prop:"name"}},[t("el-input",{model:{value:e.tempparams.name,callback:function(t){e.$set(e.tempparams,"name",t)},expression:"tempparams.name"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$translateTitle("product.datatype"),prop:"type"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:e.tempTypeChange},model:{value:e.tempparams.type,callback:function(t){e.$set(e.tempparams,"type",t)},expression:"tempparams.type"}},[t("el-option",{attrs:{label:e.$translateTitle("product.init"),value:"int"}}),t("el-option",{attrs:{label:e.$translateTitle("product.float"),value:"float"}}),t("el-option",{attrs:{label:e.$translateTitle("product.double"),value:"double"}}),t("el-option",{attrs:{label:e.$translateTitle("product.bool"),value:"bool"}}),t("el-option",{attrs:{label:e.$translateTitle("product.enum"),value:"enum"}}),t("el-option",{attrs:{label:e.$translateTitle("product.string"),value:"string"}}),t("el-option",{attrs:{label:"switch",value:"switch"}})],1)],1)],1)],1),t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$translateTitle("product.unit")}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("product.unit"),filterable:""},model:{value:e.tempparams.unit,callback:function(t){e.$set(e.tempparams,"unit",t)},expression:"tempparams.unit"}},e._l(e.allunit,(function(e,a){return t("el-option",{key:a,attrs:{label:e.Name+"/"+e.Symbol,value:e.Symbol}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"协议类型"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.tempparams.protocol,callback:function(t){e.$set(e.tempparams,"protocol",t)},expression:"tempparams.protocol"}},e._l(["normal","modbus","GW376","hex"],(function(e,a){return t("el-option",{key:a,attrs:{label:e,value:e}})})),1)],1)],1)],1),t("el-row",{directives:[{name:"show",rawName:"v-show",value:"modbus"==e.tempparams.protocol,expression:"tempparams.protocol == 'modbus'"}],attrs:{gutter:24}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"数据格式"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.tempparams.originaltype,callback:function(t){e.$set(e.tempparams,"originaltype",t)},expression:"tempparams.originaltype"}},e._l([{value:"bit",label:"位"},{value:"short16_AB",label:"16位 有符号(AB)"},{value:"short16_BA",label:"16位 有符号(BA)"},{value:"ushort16_AB",label:"16位 无符号(AB)"},{value:"ushort16_BA",label:"16位 无符号(BA)"},{value:"long32_ABCD",label:"32位 有符号(ABCD)"},{value:"long32_CDAB",label:"32位 有符号(CDAB)"},{value:"ulong32_ABCD",label:"32位 无符号(ABCD)"},{value:"ulong32_CDAB",label:"32位 无符号(CDAB)"},{value:"float32_ABCD",label:"32位 浮点数(ABCD)"},{value:"float32_CDAB",label:"32位 浮点数(CDAB)"}],(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),t("el-table",{directives:[{name:"show",rawName:"v-show",value:"modbus"==e.tempparams.protocol,expression:"tempparams.protocol == 'modbus'"}],staticStyle:{width:"100%"},attrs:{data:e.dataList,border:"",size:"small"}},[t("el-table-column",{attrs:{align:"center",label:"从机地址(16进制加0X,例:0X10,否则是十进制)","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-input",{model:{value:e.tempparams.slaveid,callback:function(t){e.$set(e.tempparams,"slaveid",t)},expression:"tempparams.slaveid"}}),t("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(a))])]}}])}),t("el-table-column",{attrs:{align:"center",label:"寄存器状态","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.tempparams.operatetype,callback:function(t){e.$set(e.tempparams,"operatetype",t)},expression:"tempparams.operatetype"}},e._l([{value:"writeCoil",label:"0X05:写单个线圈寄存器"},{value:"writeHreg",label:"0X06:写单个保持寄存器"},{value:"writeCoils",label:"0X0f:写多个线圈寄存器"},{value:"writeHregs",label:"0X10:写多个保持寄存器"}],(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(a.slaveid))])]}}])}),t("el-table-column",{attrs:{align:"center",label:"数据地址(16进制加0X,例:0X10,否则是十进制)","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-input",{model:{value:e.tempparams.address,callback:function(t){e.$set(e.tempparams,"address",t)},expression:"tempparams.address"}}),t("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(a.slaveid))])]}}])}),"writeCoils"==e.tempparams.operatetype||"writeHregs"==e.tempparams.operatetype?t("el-table-column",{attrs:{align:"center",label:"寄存器个数","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-input",{model:{value:e.tempparams.registersnumber,callback:function(t){e.$set(e.tempparams,"registersnumber",t)},expression:"tempparams.registersnumber"}}),t("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(a.slaveid))])]}}],null,!1,713879905)}):e._e(),t("el-table-column",{attrs:{align:"center",label:"写入字节数","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-input",{model:{value:e.tempparams.bytes,callback:function(t){e.$set(e.tempparams,"bytes",t)},expression:"tempparams.bytes"}}),t("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(a.slaveid))])]}}])})],1),t("el-table",{directives:[{name:"show",rawName:"v-show",value:"GW376"==e.tempparams.protocol,expression:"tempparams.protocol == 'GW376'"}],staticStyle:{width:"100%"},attrs:{data:e.dataList,border:"",size:"small"}},[t("el-table-column",{attrs:{align:"center",label:"应用层功能码","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-input",{model:{value:e.tempparams.afn,callback:function(t){e.$set(e.tempparams,"afn",t)},expression:"tempparams.afn"}}),t("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(a))])]}}])}),t("el-table-column",{attrs:{align:"center",label:"信息点","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-input",{model:{value:e.tempparams.da,callback:function(t){e.$set(e.tempparams,"da",t)},expression:"tempparams.da"}}),t("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(a))])]}}])}),t("el-table-column",{attrs:{align:"center",label:"信息类","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-input",{model:{value:e.tempparams.dt,callback:function(t){e.$set(e.tempparams,"dt",t)},expression:"tempparams.dt"}}),t("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(a.slaveid))])]}}])}),t("el-table-column",{attrs:{align:"center",label:"字节类型","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.tempparams.byteType,callback:function(t){e.$set(e.tempparams,"byteType",t)},expression:"tempparams.byteType"}},e._l(["little","bytes","bit"],(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1),t("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(a.slaveid))])]}}])}),t("el-table-column",{attrs:{align:"center",label:"字节长度","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-input",{model:{value:e.tempparams.bytes,callback:function(t){e.$set(e.tempparams,"bytes",t)},expression:"tempparams.bytes"}}),t("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(a.slaveid))])]}}])})],1),t("el-row",{directives:[{name:"show",rawName:"v-show",value:"modbus"!=e.tempparams.protocol&&"GW376"!=e.tempparams.protocol,expression:"\n            tempparams.protocol != 'modbus' && tempparams.protocol != 'GW376'\n          "}],attrs:{gutter:24}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"数据地址"}},[t("el-input",{attrs:{placeholder:"数据地址"},model:{value:e.tempparams.address,callback:function(t){e.$set(e.tempparams,"address",t)},expression:"tempparams.address"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"数据长度"}},[t("el-input",{attrs:{placeholder:"数据长度（字节）"},model:{value:e.tempparams.bytes,callback:function(t){e.$set(e.tempparams,"bytes",e._n(t))},expression:"tempparams.bytes"}})],1)],1)],1),t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:12}},[t("el-tooltip",{staticStyle:{float:"left"},attrs:{effect:"dark",placement:"right-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 1. 采集值 设备上行数据经采集公式计算后显示 。 "),t("br"),e._v(" 公式中的%s为占位符，是固定字段。 "),t("br"),e._v(" 如： "),t("br"),e._v(" 加：%s+10 "),t("br"),e._v(" 减：%s-10 "),t("br"),e._v(" 乘：%s*10 "),t("br"),e._v(" 除：%s/10 "),t("br"),e._v(" 余数：%s%10 "),t("br")]),t("i",{staticClass:"el-icon-question"})]),t("el-form-item",{attrs:{label:"采集公式"}},[t("el-input",{staticStyle:{width:"100%"},attrs:{rows:1,type:"textarea"},model:{value:e.tempparams.collection,callback:function(t){e.$set(e.tempparams,"collection",t)},expression:"tempparams.collection"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-tooltip",{staticStyle:{float:"left"},attrs:{effect:"dark",placement:"right-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 1. 设置值 平台下行数据经设置公式计算后设置 。 "),t("br"),e._v(" 公式中的%s为占位符，是固定字段。 "),t("br"),e._v(" 如： "),t("br"),e._v(" 加：%s+10 "),t("br"),e._v(" 减：%s-10 "),t("br"),e._v(" 乘：%s*10 "),t("br"),e._v(" 除：%s/10 "),t("br"),e._v(" 余数：%s%10 "),t("br")]),t("i",{staticClass:"el-icon-question"})]),t("el-form-item",{attrs:{label:"设置公式"}},[t("el-input",{attrs:{rows:1,type:"textarea"},model:{value:e.tempparams.setting,callback:function(t){e.$set(e.tempparams,"setting",t)},expression:"tempparams.setting"}})],1)],1)],1),t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"必填"}},[t("el-radio",{attrs:{label:!0,border:""},model:{value:e.tempparams.required,callback:function(t){e.$set(e.tempparams,"required",t)},expression:"tempparams.required"}},[e._v(" 是 ")]),t("el-radio",{attrs:{label:!1,border:""},model:{value:e.tempparams.required,callback:function(t){e.$set(e.tempparams,"required",t)},expression:"tempparams.required"}},[e._v(" 否 ")])],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"只读"}},[t("el-radio",{attrs:{label:!0,border:""},model:{value:e.tempparams.readonly,callback:function(t){e.$set(e.tempparams,"readonly",t)},expression:"tempparams.readonly"}},[e._v(" 是 ")]),t("el-radio",{attrs:{label:!1,border:""},model:{value:e.tempparams.readonly,callback:function(t){e.$set(e.tempparams,"readonly",t)},expression:"tempparams.readonly"}},[e._v(" 否 ")])],1)],1)],1),t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"列表显示"}},[t("el-radio",{attrs:{label:!0,border:""},model:{value:e.tempparams.isshow,callback:function(t){e.$set(e.tempparams,"isshow",t)},expression:"tempparams.isshow"}},[e._v(" 是 ")]),t("el-radio",{attrs:{label:!1,border:""},model:{value:e.tempparams.isshow,callback:function(t){e.$set(e.tempparams,"isshow",t)},expression:"tempparams.isshow"}},[e._v(" 否 ")])],1)],1)],1),t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:12}},["switch"==e.tempparams.type?t("el-form-item",{attrs:{label:"开"}},[t("el-input",{model:{value:e.tempparams.activevalue,callback:function(t){e.$set(e.tempparams,"activevalue",t)},expression:"tempparams.activevalue"}})],1):e._e()],1),t("el-col",{attrs:{span:12}},["switch"==e.tempparams.type?t("el-form-item",{attrs:{label:"关"}},[t("el-input",{model:{value:e.tempparams.inactivevalue,callback:function(t){e.$set(e.tempparams,"inactivevalue",t)},expression:"tempparams.inactivevalue"}})],1):e._e()],1)],1),"enum"!=e.tempparams.type&&"switch"!=e.tempparams.type?t("el-form-item",{attrs:{label:"默认值",prop:"default"}},["bool"==e.tempparams.type?t("el-select",{staticClass:"notauto",attrs:{readonly:""},model:{value:e.tempparams.default,callback:function(t){e.$set(e.tempparams,"default",t)},expression:"tempparams.default"}},[t("el-option",{attrs:{value:!0,label:"是"}}),t("el-option",{attrs:{value:!1,label:"否"}})],1):"int"==e.tempparams.type?t("el-input",{model:{value:e.tempparams.default,callback:function(t){e.$set(e.tempparams,"default",e._n(t))},expression:"tempparams.default"}}):t("el-input",{model:{value:e.tempparams.default,callback:function(t){e.$set(e.tempparams,"default",t)},expression:"tempparams.default"}})],1):e._e(),"enum"==e.tempparams.type?t("el-form-item",{attrs:{label:"Enum数据"}},[t("el-tabs",{model:{value:e.elactiveName1,callback:function(t){e.elactiveName1=t},expression:"elactiveName1"}},[t("el-tab-pane",{attrs:{label:"Table",name:"Table1"}},[t("el-button",{staticClass:"mt-3",attrs:{icon:"el-icon-plus",size:"mini",type:"primary"},nativeOn:{click:function(t){return e.addDomain.apply(null,arguments)}}},[e._v(" 新 增 ")]),t("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.tempparams.specs,height:e.height}},[t("el-table-column",{attrs:{align:"center",label:"属性"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-input",{model:{value:a.attribute,callback:function(t){e.$set(a,"attribute",t)},expression:"row.attribute"}})]}}],null,!1,145805847)}),t("el-table-column",{attrs:{align:"center",label:"属性值"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-input",{model:{value:a.attributevalue,callback:function(t){e.$set(a,"attributevalue",t)},expression:"row.attributevalue"}})]}}],null,!1,2139517436)}),t("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-button",{attrs:{plain:"",size:"mini",title:"删除",type:"danger"},nativeOn:{click:function(t){return e.removeDomain(a)}}},[e._v(" 删除 ")])]}}],null,!1,1667144408)})],1)],1)],1)],1):e._e(),t("el-form-item",[t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitFormTempDict()}}},[e._v(" 提交 ")])],1)],1)],1)],1),t("div",{staticClass:"import-dialog"},[t("el-dialog",{attrs:{"append-to-body":!0,visible:e.importDialogShow,title:"导入产品",width:"25%"},on:{"update:visible":function(t){e.importDialogShow=t}}},[t("el-form",{ref:"uploadProForm",attrs:{model:e.formPro}},[t("el-upload",{ref:"fileUpload",staticClass:"upload-demo",attrs:{action:e.uploadAction,"auto-upload":!1,data:e.uploadData,"file-list":e.fileList,headers:e.uploadHeaders,"on-change":e.handleChange,"on-error":e.handleUploadError,"on-success":e.handleUploadSuccess,"with-credentials":!0,accept:".xls, .xlsx, .zip"}},[t("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v(" 选泽文件 ")])],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{staticClass:"btn-left",attrs:{size:"small",type:"primary"},on:{click:e.submitUpload}},[e._v(" 上 传 ")]),t("el-button",{staticClass:"btn-right",attrs:{size:"small"},on:{click:function(t){e.importDialogShow=!1}}},[e._v(" 取 消 ")])],1)],1)],1)],1)},o=[],r=a("30b0"),s=a("ed08"),l=a("89e8"),n=a("5880"),c=a("7212"),d=a("1285"),p=a("5da9"),u=a("e0e9"),m=a("7497"),h=a("0af3"),g=a("ef68"),b=a("03b1"),f=a("22f9"),v=Object.defineProperty,y=Object.getOwnPropertySymbols,w=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable,k=(e,t,a)=>t in e?v(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,C=(e,t)=>{for(var a in t||(t={}))w.call(t,a)&&k(e,a,t[a]);if(y)for(var a of y(t))T.call(t,a)&&k(e,a,t[a]);return e},x=(e,t,a)=>new Promise((i,o)=>{var r=e=>{try{l(a.next(e))}catch(t){o(t)}},s=e=>{try{l(a.throw(e))}catch(t){o(t)}},l=e=>e.done?i(e.value):Promise.resolve(e.value).then(r,s);l((a=a.apply(e,t)).next())});const S=a("6818");let I={};S.keys().forEach(e=>{let t=S(e);I[e.replace(/^\.\/(.*)\.\w+$/,"$1")]=t.default});var P={components:C({"dgiot-profile":r["default"]},I),data(){return{v:{skip:0,layout:"total, sizes, prev, pager, next, jumper",limit:10,name:"",search:"",type:"name"},inputParams:{},storageArr:["默认-行式存储","默认-列式存储","InfluxDB-行式存储","InfluxDB-列式存储","TDEngine-列式存储"],channeltype:"2",channeldialog:!1,channelResource:[],selectedRow:{},tableData:[],product:{},allTemp:[],category:[],descriptions:{tableType:"things",things:[],productId:"",dictTableList:[],decoderTableList:{},productDetail:{decoder:{code:""},thing:{properties:[]},config:{parser:[],profile:[],basedate:{params:[]}}},parserTableList:[],tableLoading:!1},paginationKey:moment(new Date).valueOf()+"",queryForm:{name:"",category:"",productId:"",productFlag:!1,pageNo:1,pageSize:1,searchDate:[],limit:8,skip:0,total:0,order:"-createdAt",keys:"count(*)"},cascaderDrawer:!1,drawerWidth:Number($(window).width())-240,height:this.$baseTableHeight(0),config:{},dataList:[{}],parserView:!1,parserTable:!1,parserTableList:{parser:[]},parserFromId:"",dialogVisible:!1,moduleTitle:this.$translateTitle("product.createproduct"),allunit:[],productInfo:{},edit_dict_temp_dialog:!1,title_dict_edit_dialog:"新增字典数据",tempparams:{name:"",identifier:"",type:"",order:0,address:"",bytes:"",registersnumber:"",default:0,required:!1,isshow:!1,readonly:!0,specs:[{attribute:"",attributevalue:""}],struct:{},unit:"",inactivevalue:"",activevalue:"",da:"",dt:"",afn:""},tabs:"card",elactiveName:"Table",elactiveName1:"Table1",editDictTempId:"",title_temp_dialog:"",dictTempForm:"",rule:[],dictVisible:!1,listLoading:!1,custom_row:{},custom_status:"add",hashkey:"",length:10,total:0,start:0,activeName:"first",formInline:{productname:""},uploadHeaders:{sessionToken:Cookies.get("access_token")},uploadAction:"",uploadData:{},fileList:[],productIdentifier:"",proTableData:[],formLabelWidth:"120px",dialogFormVisible:!1,importDialogShow:!1,cType:"",form:{dynamicReg:!0,config:{checkList:["konva","amis"]},type:1,storageStrategy:"",name:"",tdchannel:"7b290e5a0a",category:"",taskchannel:"6c48effac2",otherchannel:"",nodeType:3,desc:"",netType:"",devType:"",categoryid:"",producttempid:"",productSecret:"",roles:[],relationApp:""},taskchannelList:[],tdchannelList:[],otherchannelList:[],formPro:{name:"",url:""},rules:{name:[{required:!0,message:"请输入产品",trigger:"blur"}],tdchannel:[{required:!0,message:"请选择存储通道",trigger:"blur"}],storageStrategy:[{required:!0,message:"请选择存储策略",trigger:"blur"}],taskchannel:[{required:!0,message:"请选择任务通道",trigger:"blur"}],otherchannel:[{required:!0,message:"请选择采集通道",trigger:"blur"}],devType:[{required:!0,message:"请输入设备厂家",trigger:"blur"}],categoryname:[{required:!0,message:"请选择所属分类",trigger:"change"}],nodeType:[{required:!0,message:"请选择节点类型",trigger:"change"}],netType:[{required:!0,message:"请选择联网方式",trigger:"change"}],relationApp:[{required:!0,message:"请选择产品可见角色",trigger:"change"}]},option:[],ruleoptions:[],channel:[{label:"蜂窝(2G/3G/4G)",value:"CELLULAR"},{label:"NB-IOT通道",value:"NB-IOT"},{label:"BLE(低功耗蓝牙)",value:"Bluetooth"},{label:"5G通道(直连)",value:"5G"},{label:"WIFI通道(直连)",value:"WIFI"},{label:"ZigBee通道",value:"ZigBee"},{label:"Modbus",value:"Modbus"},{label:"LoRa(WAN)(直连)",value:"LoRaWAN"},{label:"OPC UA",value:" OPC UA"},{label:"ZETA通道",value:"ZETA"},{label:"网线连接(直连)",value:"网线连接"},{label:"自定义",value:"OTHER"}],dialogProfile:!1,imageUrl:"",selectfromtype:"",productid:"",parserDict:[],formConfig:{},editIndex:0,Parserzh:"",parseren:"",loading:!1,categoryList:[],fileServer:"",access_token:"",projectid:"",projectName:"",allTableDate:[],showTree:!1,showcateTree:!1,multipleSelection:[]}},computed:C({},Object(n["mapGetters"])({defaultKonva:"topo/defaultKonva",token:"user/token",currentDepartment:"user/currentDepartment"})),mounted(){this.categorytree(),this.getAllunit();const{project:e=""}=this.$route.query;this.formInline.productname=e,this.searchProduct(0),this.paginationKey=moment(new Date).valueOf()+""},beforeDestroy(){this.projectName=""},methods:{vhandleSizeChange(e){this.v.limit=e,this.queryprodut()},vhandleCurrentChange(e){this.v.skip=Number(e-1)*Number(this.queryForm.limit),this.queryprodut()},handleQuery(){this.v.limit=20,this.queryprodut()},goLink(e,t){switch(t){case"online":this.$router.push({path:"/dashboard/devicelist",query:{product:e.objectId,status:"ONLINE"}});break;case"offline":this.$router.push({path:"/dashboard/devicelist",query:{product:e.objectId,status:"OFFLINE"}});break;case"poweron":this.$router.push({path:"/dashboard/devicelist",query:{product:e.objectId,isEnable:!0}});break;case"poweroff":this.$router.push({path:"/dashboard/devicelist",query:{product:e.objectId,isEnable:!1}});break;case"device":this.$router.push({path:"/dashboard/devicelist",query:{product:e.objectId}});break}},handleSizeChange(e){this.queryForm.limit=e,this.searchProduct()},handleCurrentChange(e){this.queryForm.skip=Number(e-1)*Number(this.queryForm.limit),this.searchProduct()},handleIconClick(e){return x(this,null,(function*(){this.dialogProfile=!this.dialogProfile,yield this.$refs.dialogProfile.StepsListRowClick(this.selectedRow)}))},handlecateClick(){this.categorytree(),this.cascaderDrawer=!0},handleSelectionChange(e){this.multipleSelection=e;let t=[];dgiotlog.log("multipleSelection",this.multipleSelection,this.selectfromtype),_.isObject(e)||e.forEach(e=>{t.push(e.objectId)}),"otherchannel"==this.selectfromtype?this.form[this.selectfromtype]=t:(dgiotlog.log(this.cType),this.form[this.selectfromtype]=e.objectId),dgiotlog.log("multipleSelection",this.form)},getResource(e,t,a){return x(this,null,(function*(){this.cType=a,this.selectfromtype=e,this.channeltype=t}))},getChannel(e,t,a){let i={};return i=""==a?e.filter((function(e){return e.type==t})):e.filter((function(e){return e.type==t&&e.cType==a})),i},Get_Re_Channel(){return x(this,null,(function*(){const e={count:"objectId",order:"-createdAt",keys:"count(*)",where:{}},{results:t}=yield Object(l["queryChannel"])(e);this.channelResource=t,this.taskchannelList=this.getChannel(t,"2","INSTRUCT"),this.tdchannelList=this.getChannel(t,"2","TD"),this.otherchannelList=this.getChannel(t,"1","")}))},referenceHandle(e){return x(this,null,(function*(){yield this.$refs.profile.StepsListRowClick(e)}))},queryprodut(e){return x(this,null,(function*(){let t={skip:this.v.skip,limit:this.v.limit,include:"category",count:"objectId",where:{}};this.v.name&&(t.where.name={$regex:this.v.name}),(null==e?void 0:e.categorys)&&(t.where.category={$in:e.categorys});try{const{results:e=[],count:a=0}=yield Object(g["queryProductTemplet"])(t);this.tableData=e,this.v.total=a}catch(a){dgiotlog.log(a),this.$baseMessage(a,"error","dgiot-hey-message-error")}}))},goKonva(e){this.$router.push({path:"/Topo?productid",query:{productid:e}})},uploadCkick(e){this.loading=!0,this.$refs["uploadFinish"].$refs.uploader.dispatchEvent(new MouseEvent("click")),this.inputParams={file:"",scene:"app",path:"product/ico/",filename:`${this.productid}.${e}`}},fileInfo(e){dgiotlog.log("info",e),this.imageUrl=e.path,this.loading=!1},files(e,t){this.inputParams.filename=`${this.productid}.${t}`,this.inputParams.file=e},getAllunit(){return x(this,null,(function*(){this.allunit=[];const{UnifyUnitSpecsDTO:e=[]}=yield Object(f["getDlinkJson"])("Unit");this.allunit=e}))},submitEnum(){"Enum"==this.tempparams.type&&this.tempparams.specs.map(e=>{var t=e["attribute"];this.tempparams.struct[t]=e["attributevalue"]})},addDomain(){this.tempparams.specs.push({attribute:"",attributevalue:""})},removeDomain(e){var t=this.tempparams.specs.indexOf(e);-1!==t&&this.tempparams.specs.splice(t,1)},delRow(e,t){this.dictTempForm.params.splice(e,1)},editRow(e,t){this.editIndexId=e,this.title_dict_edit_dialog="修改字典数据",this.edit_dict_temp_dialog=!0,this.tempparams=t},closeDict(){this.edit_dict_temp_dialog=!this.edit_dict_temp_dialog},onJsonSave(e){this.$refs[e].validate(e=>{dgiotlog.log(this.editDictTempId),e&&this.put_Dict_temp(this.editDictTempId,this.dictTempForm)})},put_Dict_temp(e,t){return x(this,null,(function*(){dgiotlog.log(t);const{config:a={basedate:{}}}=this.productInfo;a.basedate=t;const i={config:a},{updatedAt:o}=yield Object(c["putProduct"])(e,i);void 0!=o?(this.dictVisible=!1,this.$message({type:"success",showClose:!0,duration:2e3,message:"字典数据更新成功"})):this.$message({type:"error",showClose:!0,duration:2e3,message:"字典数据更新失败"})}))},submitFormTempDict(){this.submitEnum(),this.edit_dict_temp_dialog=!1,void 0!=this.editIndexId?(this.dictTempForm.params[this.editIndexId]=this.tempparams,this.$message({type:"success",message:"编辑成功",showClose:!0,duration:2e3})):(this.dictTempForm.params.push(this.tempparams),this.$message({type:"success",message:"新增成功",showClose:!0,duration:2e3}))},opendialog(e){this.$nextTick(()=>{this.$refs[e].clearValidate()})},tempTypeChange(e){"bool"==e?(this.tempparams.default=!0,this.tempparams.default=!0):this.tempparams.default="int"==e?0:void 0},addRow(e){this.editIndexId=void 0,this.title_dict_edit_dialog="新增字典数据",this.edit_dict_temp_dialog=!0,this.tempparams={name:"",identifier:"",type:"",order:0,address:"",bytes:"",registersnumber:"",default:0,required:!1,isshow:!1,readonly:!0,specs:[{attribute:"",attributevalue:""}],struct:{},collection:"%s",setting:"%s",unit:""}},onError(){this.$message("非Json数据类型")},selectApp(e){e&&Object(p["getServer"])(e).then(e=>{e&&(this.fileServer=e.file,this.access_token=e.access_token)})},treeData(e){const t=JSON.parse(JSON.stringify(e));return t.filter(e=>{const a=t.filter(t=>e.objectId==t.parent.objectId);return a.length>0&&(e.children=a),0==e.parent.objectId})},deleteImgsrc(){this.imageUrl=""},dataURItoBlob(e){for(var t=atob(e.split(",")[1]),a=e.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(t.length),o=new Uint8Array(i),r=0;r<t.length;r++)o[r]=t.charCodeAt(r);return new Blob([i],{type:a})},submitUpload(){this.uploadAction="/product",this.$nextTick(()=>{this.uploadData.appid=Cookies.get("appids"),this.$refs.fileUpload.submit()})},handleUploadSuccess(e,t,a){this.$message({type:"success",message:"产品导入成功",showClose:!0,duration:2e3}),this.importDialogShow=!1,this.$refs["uploadProForm"].resetFields(),this.searchProduct()},handleUploadError(e,t,a){this.$message({message:e,showClose:!0,duration:2e3})},handleChange(e,t){t.length>0&&(this.fileList=[t[t.length-1]])},utc2beijing(e){var t=new Date(+new Date(e)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"");return t},searchProduct(e){return x(this,null,(function*(){try{this.listLoading=!0,0==e&&(this.start=0);var t=[];this.formInline.productname&&(this.queryForm.limit=8,this.queryForm.skip=0);let a={count:"objectId",order:"-updatedAt",skip:this.queryForm.skip,limit:this.queryForm.limit,where:{},excludeKeys:"children,thing,decoder,topics,productSecret,view,category,producttemplet"};this.formInline.productname&&(a.where.name={$regex:this.formInline.productname});const{results:i=[],count:o=0}=yield this.$query_object("Product",a);i&&(i.map(e=>{""!=e.category&&e.category&&"report"!=e.devType&&t.push(e.category)}),this.listLoading=!1,this.proTableData=i,this.total=o)}catch(a){this.listLoading=!1,dgiotlog.log(a),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+a,"error","dgiot-hey-message-error")}}))},handleClose(){this.dialogFormVisible=!1},chooseTemplate(e){return x(this,null,(function*(){var t,a;this.selectedRow=e,this.$set(this.form,"categoryid",(null==(t=null==e?void 0:e.category)?void 0:t.objectId)?e.category.objectId:"0"),this.$set(this.form,"categoryname",(null==(a=null==e?void 0:e.category)?void 0:a.name)?e.category.name+"/"+e.name:e.name),this.$set(this.form,"producttempid",e.objectId),this.form.thing=e.thing?e.thing:{},this.cascaderDrawer=!this.cascaderDrawer}))},getcategoryname(e){return x(this,null,(function*(){const{name:t}=yield Object(b["getCategory"])(e.parent.objectId),a="所有领域"==t?e.name:t+"/"+e.name;return a}))},handleCloseDialogForm(){this.dialogFormVisible=!1,this.$nextTick(()=>{this.$refs["form"].resetFields()})},properties(e,t="things"){this.descriptions.tableLoading=!0,dgiotlog.log(e),this.descriptions.things=e,this.descriptions.tableType=t,setTimeout(()=>this.descriptions.tableLoading=!1,1200)},addproduct(){this.Get_Re_Channel(),this.queryprodut({}),this.custom_status="add",this.moduleTitle=this.$translateTitle("product.createproduct"),this.imageUrl="",this.form={dynamicReg:!0,name:"",type:1,category:"",nodeType:3,desc:"",netType:" ",devType:"",productSecret:"",relationApp:this.currentDepartment.name,roles:[],categoryname:"",config:{checkList:["konva","amis"],address:"余杭区良渚平高创业城c1座",location:{latitude:"120.161324",longitude:"30.262441",__type:"GeoPoint"}}},this.productid=moment(new Date).valueOf().toString(),this.dialogFormVisible=!0},getParent(e,t,a){return t.map(i=>{e==i.id?(a.unshift(i.value),this.getParent(i.parentid,t,a)):0==i.parentid&&i.id==e&&a.unshift(i.value)}),this.form.category=a[0],a},getIndustryParent(e,t){t.map(a=>{a.value==e&&this.getParent(a.id,t,[])})},editorParser(e){return x(this,null,(function*(){this.parserFromId=e;try{const{config:t={parser:[]},thing:a={}}=yield Object(c["getProduct"])(e);this.parserTableList=t,dgiotlog.log(this.parserTableList),this.parserDict=_.merge(a,t)}catch(t){this.parserTableList={parser:[]},dgiotlog.log("eeeeeeeeeeeee",t)}this.parserTable=!0}))},editParse(e,t){this.formConfig=t,this.editIndex=e,this.dialogVisible=!0},saveParse(e,t=-1){return x(this,null,(function*(){t+2>0&&(this.parserTableList.parser[t]=_.merge({},e));try{yield Object(c["putProduct"])(this.parserFromId,{config:t+2>0?this.parserTableList:e});this.$message({showClose:!0,message:this.$translateTitle("user.Save the template successfully"),duration:2e3,type:"success"}),this.dialogVisible=!1,this.parserTable=!1}catch(a){this.$baseMessage(this.$translateTitle("user.Save the template error")+""+a,"error","dgiot-hey-message-error"),dgiotlog.log(a,"eeee")}dgiotlog.log(e)}))},previewParse(e){this.parserView=!0,this.formConfig=e,dgiotlog.log("previewParse",e)},addParse(e){e["parser"].push({name:Object(s["uuid"])(6),enname:Object(s["uuid"])(6),config:{}})},deleteParse(e,t){t.splice(e,1)},editorDict(e){return x(this,null,(function*(){this.getAllunit();const t=yield Object(c["getProduct"])(e),{config:a={basedate:{}}}=t;this.productInfo=t,dgiotlog.log(" this.parserDict",this.parserDict),this.editDictTempId=e,this.dictTempForm={name:"",cType:"",enable:"1",description:"",params:[]},this.title_temp_dialog="创建字典模板",dgiotlog.log(a),a.basedate&&a.basedate.name&&(this.title_temp_dialog="修改字典模板",this.dictTempForm=a.basedate),this.rule={name:[{required:!0,message:"请输入字典模板名称",trigger:"blur"}],cType:[{required:!0,message:"请输入字典模板类型",trigger:"blur"}],enable:[{required:!0,message:"请选择状态",trigger:"change"}]},dgiotlog.log(this.dictTempForm,"config"),this.dictVisible=!0}))},editorProduct(e){return x(this,null,(function*(){this.Get_Re_Channel();const t=this.$baseColorfullLoading(),a=yield Object(c["getProduct"])(e);this.form=a,t.close(),this.product=a,this.imageUrl="",this.moduleTitle=this.$translateTitle("product.editproduct"),this.custom_status="edit",this.custom_row=a,this.dialogFormVisible=!0,this.productid=a.objectId,this.form.desc=a.desc,this.form.category=a.category,this.form.producttemplet=a.producttemplet,this.form.config=_.merge(a.config,{checkList:[]}),this.form.name=a.name,this.form.nodeType=a.nodeType,this.form.dynamicReg=a.dynamicReg,this.$set(this.form,"type",a.channel?a.channel.type:""),this.$set(this.form,"tdchannel",a.channel?a.channel.tdchannel:""),this.$set(this.form,"taskchannel",a.channel?a.channel.taskchannel:""),this.$set(this.form,"otherchannel",a.channel?a.channel.otherchannel:""),this.$set(this.form,"storageStrategy",a.channel?a.channel.storageStrategy:""),this.form.netType=a.netType,this.form.devType=a.devType;const{name:i}=yield Object(b["getCategory"])(a.category.objectId);this.$set(this.form,"categoryname",i),this.form.productSecret=a.productSecret,this.form.nodeType=a.nodeType,a.icon&&(this.imageUrl=a.icon),dgiotlog.log("form",this.form)}))},categorytree(){return x(this,null,(function*(){const e={order:"createdAt",keys:"count(*)",where:{level:{$in:[0,1]}}},{results:t}=yield Object(b["queryCategory"])(e);this.queryprodut({}),this.categoryList=t,dgiotlog.log("this",this.categoryList)}))},handleCateSearch(e){if(this.queryForm.category=e,this.showcateTree=!this.showcateTree,"a60a85475a"==e)this.queryprodut({});else{let t={keys:"objectId",where:{parent:{className:"Category",objectId:e,__type:"Pointer"}}};Object(b["queryCategory"])(t).then(t=>{const a=[];a.push(e),t.results.forEach(e=>{a.push(e.objectId)}),dgiotlog.log("ids",a),this.queryprodut({categorys:a})})}},submitForm(){var e={content:{},profile:{},dynamicReg:this.form.dynamicReg,name:this.form.name,nodeType:this.form.nodeType,netType:this.form.netType,icon:this.imageUrl,devType:this.form.devType,desc:this.form.desc,thing:this.form.thing?this.form.thing:{},category:{objectId:0==Number(this.form.type)?"5ca6049839":this.form.categoryid,__type:"Pointer",className:"Category"},producttemplet:{objectId:0==Number(this.form.type)?"0":this.form.producttempid,__type:"Pointer",className:"ProductTemplet"},channel:{type:this.form.type,tdchannel:this.form.tdchannel,taskchannel:this.form.taskchannel,otherchannel:this.form.otherchannel,storageStrategy:this.form.storageStrategy}};this.$refs.form.validate(t=>{if(t)if("add"===this.custom_status){var a=Math.ceil(25*Math.random()),i=Base64.encode(String.fromCharCode(65+a)+Math.ceil(1e7*Math.random())+Number(new Date));const t="role:"+this.form.relationApp,o={};o[t]={read:!0,write:!0};const r={productSecret:i,ACL:o,topics:{},decoder:{},config:{checkList:this.form.config.checkList}},s=_.merge(e,r);dgiotlog.log("createProduct",s),this.createProduct(s)}else delete e.category,delete e.producttemplet,delete e.thing,this.editProduct(e);else this.$message("必填项未填")})},doUpload(e){return x(this,null,(function*(){const t=e.target.files[0],a=this.$baseColorfullLoading(3);try{const e=yield Object(h["ImportParse"])("Product",t);a.close(),dgiotlog.log("eresresrror",e),this.$message({showClose:!0,message:this.$translateTitle("user.Save the template successfully"),duration:2e3,type:"success"})}catch(i){a.close(),dgiotlog.log("error",i),this.$baseMessage(i,"error","dgiot-hey-message-error")}this.$dgiotBus.$emit("reload-router-view")}))},createProduct(e){return x(this,null,(function*(){const t=yield Object(c["postProduct"])(e);dgiotlogger.info("postProduct：",t),t.objectId?(this.initQuery("产品创建成功","success"),this.dialogFormVisible=!1,setTimeout(()=>{this.queryForm.skip=0,this.searchProduct()},1200)):this.$message({type:"error",message:t.error||t,showClose:!0,duration:2e3})}))},editProduct(e){return x(this,null,(function*(){const t=yield this.$update_object("Product",this.custom_row.objectId,e);t.updatedAt?this.initQuery("产品修改成功","success"):this.$message({showClose:!0,duration:2e3,type:"error",message:t.error})}))},initQuery(e,t){this.$message({type:t||"info",message:e,showClose:!0,duration:2e3}),this.dialogFormVisible=!1,this.resetProductForm(),this.$refs["form"].resetFields(),this.searchProduct(),this.paginationKey=moment(new Date).valueOf()+""},resetProductForm(){this.form={dynamicReg:!0,name:"",category:"",nodeType:3,desc:"",netType:"",devType:"",productSecret:"",roles:[],relationApp:"",config:{checkList:[]}},this.imageUrl=""},deviceToDetail(e){this.$router.push({path:"/roles/detailproduct",query:{id:e.objectId}})},GoTodevices(e){this.$router.push({path:"/roles/thing",query:{productid:e.objectId}})},makeSure(e,t){const a={count:"objectId",skip:0,limit:1,where:{product:e.objectId}};this.$baseConfirm("你确定要删除当前项吗",null,()=>x(this,null,(function*(){yield Object(d["queryDevice"])(a).then(t=>{t.count>0?this.$message("请先删除该产品下设备"):Object(c["delProduct"])(e.objectId).then(e=>{e&&(this.$message({showClose:!0,duration:2e3,type:"success",message:"删除成功"}),setTimeout(()=>{this.searchProduct(),this.paginationKey=moment(new Date).valueOf()+""},1e3))})}),setTimeout(()=>{this.searchProduct(),this.paginationKey=moment(new Date).valueOf()+""},1e3)})))},blackDict(e,t){return x(this,null,(function*(){const a={data:t,key:e,type:"Product"},i=yield Object(u["postDict"])(a);i?this.$message({showClose:!0,duration:2e3,type:"success",message:"备份成功"}):this.$message({showClose:!0,duration:2e3,type:"error",message:"备份失败"})}))},CloneData(e){return x(this,null,(function*(){const t={category:e.attributes.category,devType:e.attributes.devType,name:e.attributes.name,thing:e.attributes.thing},{objectId:a,code:i}=yield Object(m["getHashClass"])("Product",t);200==i&&this.blackDict(a,t)}))},proudctClone(e){e.attributes.config.cloneState=!0,e.attributes.config.cloneState=!0;const t=e,a=Object(c["putProduct"])(e.id,t);a&&this.CloneData(e)},proudctEdit(e){var t=window.location.origin+"/spa";const{NODE_ENV:a}=Object({NODE_ENV:"production",VUE_APP_TITLE:"物联网开发平台",VUE_APP_AUTHOR:"xxb",VUE_APP_UPDATE_TIME:"2023年01月29日11时07分47秒",VUE_APP_VERSION:"4.7.4",VUE_APP_Keywords:"一站式物联网PaaS平台|物联网应用服务",VUE_APP_Description:"提供物联网垂直领域应用使能平台及解决方案",VUE_APP_URL:"http://1.117.219.8",VUE_APP_CDN_URL:"/dgiot_dashboard/public",BASE_URL:""});t="development"==a?this.$globalConfig.localTopoUrl:window.location.origin+"/spa";var i=`${t}/#?drawProudctid=${e.objectId}&proudctid=${e.objectId}`;localStorage.setItem("rowId",e.objectId),window.open(i,"__blank")},proudctView(e){var t=window.location.origin+"/spa";const{NODE_ENV:a}=Object({NODE_ENV:"production",VUE_APP_TITLE:"物联网开发平台",VUE_APP_AUTHOR:"xxb",VUE_APP_UPDATE_TIME:"2023年01月29日11时07分47秒",VUE_APP_VERSION:"4.7.4",VUE_APP_Keywords:"一站式物联网PaaS平台|物联网应用服务",VUE_APP_Description:"提供物联网垂直领域应用使能平台及解决方案",VUE_APP_URL:"http://1.117.219.8",VUE_APP_CDN_URL:"/dgiot_dashboard/public",BASE_URL:""});t="development"==a?this.$globalConfig.localTopoUrl:window.location.origin+"/spa";var i=`${t}/#/views/${e.objectId}`;window.open(i,"__blank")},goTopoview(){var e=window.location.origin+"/spa";const{NODE_ENV:t}=Object({NODE_ENV:"production",VUE_APP_TITLE:"物联网开发平台",VUE_APP_AUTHOR:"xxb",VUE_APP_UPDATE_TIME:"2023年01月29日11时07分47秒",VUE_APP_VERSION:"4.7.4",VUE_APP_Keywords:"一站式物联网PaaS平台|物联网应用服务",VUE_APP_Description:"提供物联网垂直领域应用使能平台及解决方案",VUE_APP_URL:"http://1.117.219.8",VUE_APP_CDN_URL:"/dgiot_dashboard/public",BASE_URL:""});e="development"==t?this.$globalConfig.localTopoUrl:window.location.origin+"/spa";var a=e+"/#/view";window.open(a,"__blank")},handleImport(){return x(this,null,(function*(){yield this.$refs.uploader.click()}))},exportpro(){return x(this,null,(function*(){const e=this.$baseColorfullLoading(2);try{const t=yield Object(h["ExportParse"])("Product",{});e.close(),this.$convertRes2Blob(t)}catch(t){e.close(),this.$baseMessage(t,"error","dgiot-hey-message-error")}}))}}},j=P,D=(a("2b72"),a("ef1f4"),a("2877")),A=Object(D["a"])(j,i,o,!1,null,"025b5801",null);t["default"]=A.exports},"30b0":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{ref:"custom-table",staticClass:"devproduct devproduct-container",class:{"dgiot-fullscreen":e.isFullscreen}},[t("el-dialog",{attrs:{"append-to-body":!0,center:"",title:"关联规则引擎",visible:e.Notification.show,width:"30%"},on:{"update:visible":function(t){return e.$set(e.Notification,"show",t)}}},[t("div",[t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.createdNotification(e.Notification.detail,"start")}}},[e._v(" 告警产生 ")]),t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.createdNotification(e.Notification.detail,"stop")}}},[e._v(" 告警恢复 ")])],1),t("div",{staticStyle:{"margin-top":"5px"}},[t("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{"cell-class-name":e.getRowindex,data:e.engineData}},[t("el-table-column",{attrs:{align:"center",label:"类型",prop:"type",width:"100"}}),t("el-table-column",{attrs:{align:"center",label:"ID",prop:"ruleid","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{align:"center",fixed:"right",label:e.$translateTitle("developer.operation"),width:"100"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-button",{attrs:{size:"mini",type:"success"},nativeOn:{click:function(t){return e.viewNotification(a)}}},[e._v(" "+e._s(e.$translateTitle("equipment.see"))+" ")])]}}])})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.Notification.show=!1}}},[e._v("关 闭")])],1)]),t("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.wmxhandleClose,"close-on-click-modal":!1,title:e.wmxSituation+"自定义属性",top:"5vh",visible:e.wmxdialogVisible,width:"60%"},on:{"update:visible":function(t){e.wmxdialogVisible=t}}},[t("dgiot-wmx",{ref:"sizeForm",attrs:{"size-form1":e.sizeForm},on:{addDas:e.addDas,addDomain:e.addDomain,removeDas:e.removeDas,removeDomain:e.removeDomain,submitForm:e.submitFormwmx,wmxhandleClose:e.wmxhandleClose}})],1),t("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("product.viewobjectmodel"),visible:e.schemadialogVisible},on:{"update:visible":function(t){e.schemadialogVisible=t}}},[t("div",[t("div",{staticStyle:{background:"#ffffff"}},[t("label",{attrs:{id:"plug-name"}})]),t("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"400px"},attrs:{id:"editor1"}},[t("textarea",{staticClass:"ace_text-input",staticStyle:{overflow:"scroll"}})])]),t("span",{staticClass:"dialog-footer",staticStyle:{height:"30px"},attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.preserve}},[e._v(" "+e._s(e.$translateTitle("equipment.update"))+" ")])],1)]),t("el-dialog",{attrs:{"append-to-body":!0,title:e.formConfig.uid,visible:e.amisVisible,width:"75%"},on:{"update:visible":function(t){e.amisVisible=t}}},[t("dgiot-views",{attrs:{"view-form":e.viewForm}})],1),t("el-dialog",{directives:[{name:"drag-dialog",rawName:"v-drag-dialog"}],attrs:{"append-to-body":"",visible:e.parserView},on:{"update:visible":function(t){e.parserView=t}}},[t("f-render",{attrs:{config:e.formConfig,pure:""},model:{value:e.formConfig,callback:function(t){e.formConfig=t},expression:"formConfig"}})],1),t("div",{staticClass:"prosecond"},[t("dgiot-query-form",[t("dgiot-query-form-top-panel",[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,"label-width":"100px",model:e.formInline},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{attrs:{label:e.$translateTitle("resource.category")}},[t("div",{staticClass:"border-panel"},[t("el-select",{attrs:{clearable:"",placeholder:"请选择",size:"mini"},on:{clear:e.clearCategory},model:{value:e.formInline.category,callback:function(t){e.$set(e.formInline,"category",t)},expression:"formInline.category"}},e._l(e.categoryList,(function(a,i){return t("el-option",{key:i,attrs:{label:a.name,value:a.objectId},nativeOn:{click:function(t){return e.categoryChange(a)}}})})),1)],1)]),t("el-form-item",{attrs:{label:e.$translateTitle("alert.product name")}},[t("el-input",{staticStyle:{width:"90%"},attrs:{clearable:"",placeholder:e.$translateTitle("product.searchproductname"),size:"mini"},model:{value:e.queryForm.name,callback:function(t){e.$set(e.queryForm,"name",t)},expression:"queryForm.name"}},[t("el-button",{staticStyle:{padding:"0 !important",margin:"0 !important"},attrs:{slot:"append",icon:"el-icon-search",size:"mini"},on:{click:function(t){return e.queryProduttemp({})}},slot:"append"})],1)],1)],1),t("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.$lodash.isEmpty(e.productDetail),expression:"!$lodash.isEmpty(productDetail)"}],attrs:{size:"mini",type:"primary"},on:{click:function(t){e.isFullscreen=!e.isFullscreen}}},[t("dgiot-icon",{attrs:{icon:e.isFullscreen?"fullscreen-exit-fill":"fullscreen-fill"}}),e._v(" "+e._s(e.isFullscreen?e.$translateTitle("alert.Exit Full Screen"):e.$translateTitle("alert.full screen"))+" ")],1)],1)],1),t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{lg:4,md:5,sm:6,xl:3,xs:4}},[t("ul",{staticClass:"infinite-list",staticStyle:{overflow:"auto"},style:{height:e.tableHeight+"px"}},e._l(e.categorysonList,(function(a,i){return t("li",{key:i,staticClass:"infinite-list-item",class:e.linkType==a.name?"select_category_product":"",attrs:{disabled:""},on:{click:function(t){return t.stopPropagation(),e.categorysonChange(a)}}},[t("div",[e._v(e._s(a.name))]),t("i",{staticClass:"el-icon-plus",staticStyle:{color:"#fff"},on:{click:function(t){return t.stopPropagation(),e.addproducttemp(a)}}})])})),0)]),t("el-col",{attrs:{lg:5,md:6,sm:6,xl:3,xs:4}},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e.proTableData,"header-cell-style":{"text-align":"center"},height:e.tableHeight,"highlight-current-row":"",size:"medium"},on:{"row-click":e.StepsListRowClick}},[t("el-table-column",{attrs:{label:e.$translateTitle("product.productname"),prop:"name","show-overflow-tooltip":"",sortable:"",width:"auto"}}),t("el-table-column",{attrs:{fixed:"right",label:e.$translateTitle("developer.operation"),width:"auto"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-button",{staticClass:"el-icon-edit",attrs:{title:e.$translateTitle("developer.delete"),type:"text"},on:{click:function(t){return t.stopPropagation(),e.editproducttemp(a)}}}),t("el-button",{staticClass:"el-icon-delete",staticStyle:{color:"red"},attrs:{title:e.$translateTitle("developer.delete"),type:"text"},on:{click:function(t){return t.stopPropagation(),e.deleteproducttemp(a)}}})]}}])})],1)],1),t("el-col",{attrs:{lg:15,md:13,sm:12,xl:18,xs:16}},[t("profile-descriptions",{ref:"ProfileDescription",attrs:{"decoder-table-list":e.decoderTableList,"dict-table-list":e.dictTableList,"parser-table-list":e.parserTableList,"product-detail":e.productDetail,"product-id":e.producttempId,"table-loading":e.tableLoading,"table-type":e.tableType,"thing-key":e.thingKey,things:e.things}})],1)],1)],1),t("profile-drawer",{ref:"drawer",attrs:{"parser-table":e.parserTable,"parser-tables":e.parserTables}}),t("profile-dict",{ref:"dict",attrs:{allunit:e.allunit,"data-list":e.dataList,"dict-visible":e.dictVisible,"edit-flag":e.edit_dict_temp_dialog,"parser-table":e.parserTable,rules:e.dictrules,tempparam:e.tempparams,"title-dict":e.title_dict_edit_dialog,"title-temp-dialog":e.title_temp_dialog}}),t("product-templet",{ref:"templet",on:{"fetch-data":function(t){return e.queryProduttemp({})}}}),t("el-drawer",{attrs:{"append-to-body":"","before-close":e.handleClose,"close-on-click-modal":!1,size:"50%",title:e.moduleTitle,top:"5vh",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("div",{staticClass:"devproduct-prodialog-content"},[t("div",{staticClass:"contentone"},[t("el-form",{ref:"form",attrs:{"label-width":"150px",model:e.form,rules:e.rules}},[t("el-form-item",{attrs:{label:e.$translateTitle("product.Producttemplatename"),prop:"name"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:e.$translateTitle("product.classification")}},[t("el-input",{attrs:{disabled:e.addflag,placeholder:e.$translateTitle("product.pleaseselectyourcate")},on:{focus:function(t){e.showTree=!e.showTree}},model:{value:e.form.categoryname,callback:function(t){e.$set(e.form,"categoryname",t)},expression:"form.categoryname"}}),e.showTree?t("div",[t("el-tree",{attrs:{data:e.categorytree,props:e.defaultProps},on:{"node-click":e.handleNodeClick}})],1):e._e()],1),t("el-form-item",{attrs:{label:e.$translateTitle("menu.icon"),prop:"icon"}},[e.imageUrl?t("div",[t("img",{staticClass:"avatar",attrs:{src:e.$FileServe+e.imageUrl}}),t("el-button",{staticStyle:{"vertical-align":"text-bottom"},attrs:{size:"mini",type:"danger"},on:{click:function(t){return t.stopPropagation(),e.deleteImgsrc.apply(null,arguments)}}},[e._v(" 删除 ")])],1):t("i",{staticClass:"el-icon-plus avatar-uploader-icon",on:{click:function(t){return e.uploadCkick("producttemp_ico")}}}),t("form",{ref:"uploadform",staticStyle:{position:"absolute",visibility:"hidden"},attrs:{enctype:"multipart/form-data",method:"POST"}},[t("input",{staticStyle:{position:"relative","z-index":"5",width:"100px",height:"100px",cursor:"pointer",opacity:"0"},attrs:{type:"file"},on:{change:function(t){return e.upload(t)}}})]),t("br")]),t("dgiot-input",{ref:"uploadFinish",attrs:{params:e.inputParams},on:{fileInfo:e.fileInfo,files:e.files}}),t("el-form-item",{attrs:{label:e.$translateTitle("developer.describe"),prop:"desc"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1)],1)],1)]),t("div",{staticClass:"devproduct-prodialog-footer",staticStyle:{"text-align":"center"}},[t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitForm()}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")]),t("el-button",{on:{click:function(t){return e.handleCloseDialogForm()}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")])],1)])],1)},o=[],r=a("e0e9"),s=a("03b1"),l=a("5880"),n=a("7212"),c=a("d0fdb"),d=a("5da9"),p=a("7497"),u=a("ed07"),m=a("ef68"),h=a("0af3"),g=a("ed08"),b=a("aed5"),f=a("5118"),v=a("d292"),y=a("0c3c"),w=Object.defineProperty,T=Object.defineProperties,$=Object.getOwnPropertyDescriptors,k=Object.getOwnPropertySymbols,C=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable,S=(e,t,a)=>t in e?w(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,I=(e,t)=>{for(var a in t||(t={}))C.call(t,a)&&S(e,a,t[a]);if(k)for(var a of k(t))x.call(t,a)&&S(e,a,t[a]);return e},P=(e,t)=>T(e,$(t)),j=(e,t,a)=>new Promise((i,o)=>{var r=e=>{try{l(a.next(e))}catch(t){o(t)}},s=e=>{try{l(a.throw(e))}catch(t){o(t)}},l=e=>e.done?i(e.value):Promise.resolve(e.value).then(r,s);l((a=a.apply(e,t)).next())});const D=a("6818");let A={};var F;D.keys().forEach(e=>{let t=D(e);A[e.replace(/^\.\/(.*)\.\w+$/,"$1")]=t.default});var O={components:P(I({dgiotViews:y["default"]},A),{"dgiot-wmx":b["default"]}),props:{},data(){return{engineData:[],Notification:{show:!1,detail:{}},amisVisible:!1,viewForm:{},tableHeight:this.$baseTableHeight(0),dataList:[{}],dictrules:{},isFullscreen:!1,things:[],tableType:"things",multipleTable:[],thingKey:moment(new Date).valueOf().toString(),productDetail:{decoder:{code:""},thing:{properties:[]},config:{parser:[],profile:[],basedate:{params:[]}}},linkType:"",productOptions:[],DbaTable:[],parserView:!1,parserTable:!1,parserType:"",parserTables:[],parserTableList:[],dictTableList:[],decoderTableList:{},productConfig:{},parserFromId:"",dialogVisible:!1,moduleTitle:this.$translateTitle("product.createproducttemplate"),allunit:[],productInfo:{},edit_dict_temp_dialog:!1,title_dict_edit_dialog:"新增字典数据",tempparams:{name:"",identifier:"",type:"",order:0,address:"",bytes:"",default:0,required:!1,readonly:!0,specs:[{attribute:"",attributevalue:""}],struct:{},unit:""},elactiveName:"Table",elactiveName1:"Table1",editDictTempId:"",title_temp_dialog:"",dictTempForm:{},rule:[],dictVisible:!1,listLoading:!1,tableLoading:!1,custom_row:{},custom_status:"add",hashkey:"",defaultProps:{children:"children",label:"label"},length:10,total:0,start:0,activeName:"first",formInline:{productname:"",category:""},uploadHeaders:{sessionToken:Cookies.get("access_token")},uploadAction:"",uploadData:{},fileList:[],producttempId:"",productIdentifier:"",proTableData:[],formLabelWidth:"120px",dialogFormVisible:!1,importDialogShow:!1,categorytree:[],inputParams:{},form:{name:"",decoder:{},thing:{},config:{},nodeType:0,netType:"",icon:""},formPro:{name:"",url:""},rules:{name:[{required:!0,message:"请输入产品",trigger:"blur"}]},option:[],ruleoptions:[],channel:[{label:"蜂窝(2G/3G/4G)(直连)",value:"CELLULAR"},{label:"NB-IOT通道",value:"NB-IOT"},{label:"BLE(低功耗蓝牙)",value:"Bluetooth"},{label:"5G通道(直连)",value:"5G"},{label:"WIFI通道(直连)",value:"WIFI"},{label:"ZigBee通道",value:"ZigBee"},{label:"Modbus",value:"Modbus"},{label:"LoRa(WAN)(直连)",value:"LoRaWAN"},{label:"OPC UA",value:" OPC UA"},{label:"ZETA通道",value:"ZETA"},{label:"网线连接(直连)",value:"网线连接"},{label:"自定义",value:"OTHER"}],imageUrl:"",parserDict:[],formConfig:{},editIndex:0,Parserzh:"",parseren:"",loading:!1,categoryList:[],categorysonList:[],queryForm:{name:""},categoryListOptions:[],fileServer:"",access_token:"",projectid:"",allTableDate:[],showTree:!1,addflag:!0,wmxdialogVisible:!1,schemadialogVisible:!1,wmxSituation:"新增",modifyIndex:-1}},computed:I({},Object(l["mapGetters"])({token:"user/token",roleTree:"user/roleTree",sizeForm:"konva/sizeForm"})),watch:{productDetail:{handler(e){this.$nextTick((function(){var t;(null==(t=null==e?void 0:e.thing)?void 0:t.properties)&&this.properties(e.thing.properties)}))},immediate:!0,deep:!0}},mounted(){this.$baseEventBus.$off("showNotificationSettings"),this.$baseEventBus.$on("showNotificationSettings",e=>{this.orginRule(e),this.Notification={show:!0,detail:e}}),this.$baseEventBus.$off("profileDialog"),this.$baseEventBus.$on("profileDialog",({config:e,type:t,flag:a,productInfo:i,parserType:o})=>{this.productDetail=i,this.productInfo=i,this.parserType=t,this.productConfig=_.merge({basedate:{params:{}}},e),this.editorParser(e,t,a)}),this.$baseEventBus.$off("profileAmisDialog"),this.$baseEventBus.$on("profileAmisDialog",({config:e,productInfo:t})=>{this.amisVisible=!0,this.viewForm={showRow:!0,class:"Product",type:"notification",key:this.$route.query.id,title:"",disabled:!0,data:{type:"page",initApi:{url:"iotapi/classes/Device/parse_objectid",method:"get",adaptor:'return {\r\n  "status":0,\r\n  "msg":"",\r\n  "data":response.data.basedata\r\n  }',headers:{store:"localStorage",dgiotReplace:"parse_objectid"},dataType:"json"},body:[{type:"form",api:{method:"put",url:"iotapi/classes/Device/parse_objectid",headers:{store:"localStorage",dgiotReplace:"parse_objectid"},dataType:"json",requestAdaptor:"return {\r\n    ...api,\r\n    data: {\r\n        basedata:{ ...api.data}\r\n    }\r\n}"},body:[{type:"input-text",label:"设备名称",name:"name"}]}]},hiddenRow:["class","key","createdAt"]}});const{project:e=""}=this.$route.query;this.formInline.productname=e,this.querycategorylist(),this.featchTable(),this.queryProduttemp({})},methods:P(I({createdNotification(e,t){return j(this,null,(function*(){yield this.$router.push({path:"/rules_engine/addengine",query:{productid:this.$route.query.id,uid:e.objectId,title:"编辑",type:"Notification_"+t+"_"+this.$route.query.id}})}))},viewNotification(e){return j(this,null,(function*(){yield this.$router.push({path:"/rules_engine/addengine",query:{productid:this.$route.query.id,title:"查看",type:e.ruleid,dictid:e.dictid}})}))},doUpload(e){return j(this,null,(function*(){const t=e.target.files[0],a=this.$baseColorfullLoading(3);try{const e=yield Object(h["ImportParse"])("Product",t);a.close(),dgiotlog.log("eresresrror",e),this.$message({showClose:!0,duration:2e3,message:this.$translateTitle("user.Save the template successfully"),type:"success"})}catch(i){a.close(),dgiotlog.log("error",i),this.$baseMessage(i,"error","dgiot-hey-message-error")}this.$dgiotBus.$emit("reload-router-view")}))},querycategorylist(){return j(this,null,(function*(){const e={order:"createdAt",keys:"count(*)",where:{level:{$in:[0,1]}}},{results:t}=yield Object(s["queryCategory"])(e);this.categoryList=t,t&&"/dashboard/profile"==this.$route.fullPath&&this.$nextTick(()=>{this.categoryChange({name:"所有领域"})})}))},StepsListRowClick(e){return j(this,null,(function*(){this.$dgiotBus.$off("monaco-save");var t={},a=!0;try{const i=a=!1,o=yield Object(m["getProductTemplet"])(e.objectId);t=_.merge(o,{decoder:{code:""},thing:{properties:[]},config:{parser:[],profile:[],basedate:{params:[]}}}),this.$baseMessage(this.$translateTitle("alert.Data request successfully"),"success","dgiot-hey-message-success"),a&&i.close()}catch(i){this.$baseMessage(this.$translateTitle("alert.Data request error")+""+i,"error","dgiot-hey-message-error")}this.producttempId=e.objectId,this.productDetail=t,this.$refs.ProfileDescription.productDetail=t}))},clearCategory(){this.linkType="",this.queryProduttemp({})},categoryChange(e){this.linkType=e.name;const t=this.$baseColorfullLoading();this.categorysonList=[];let a={order:"createdAt",include:"parent",where:{}};"所有领域"==e.name?(a.where={level:{$gte:1}},Object(s["queryCategory"])(a).then(e=>{this.categorysonList=e.results}),this.queryProduttemp({})):(a.where={parent:e.objectId},Object(s["queryCategory"])(a).then(t=>{this.categorysonList=[e].concat(t.results);var a=[];this.categorysonList.forEach(e=>{a.push(e.objectId)}),this.queryProduttemp({categorys:{$in:a}})})),t.close()},categorysonChange(e){this.linkType=e.name,this.queryProduttemp({category:e.objectId})},addproducttemp(e){this.fetchData(),this.addflag=!0,this.form={name:"",decoder:{},thing:{},config:{},nodeType:0,netType:"",categoryname:e.name,categoryid:e.objectId},this.dialogFormVisible=!0,this.producttempId=moment(new Date).valueOf().toString()},editproducttemp(e){dgiotlog.log("row",e),this.fetchData(),this.addflag=!1,this.form=e,this.producttempId=e.objectId,this.$set(this.form,"categoryname",e.category?e.category.name:""),this.$set(this.form,"categoryid",e.category?e.category.objectId:""),this.dialogFormVisible=!0},deleteproducttemp(e){Object(m["delProductTemplet"])(e.objectId).then(t=>{t?this.$message({showClose:!0,duration:2e3,type:"success",message:"产品模板删除成功"}):this.$message({showClose:!0,duration:2e3,type:"error",message:"产品模板删除失败"}),this.queryProduttemp({category:e.category.objectId})})},handleNodeClick(e){this.$set(this.form,"categoryid",e.objectId),this.$set(this.form,"categoryname",e.name),this.showTree=!this.showTree},fetchData(){return j(this,null,(function*(){let e=this.queryForm.name.length?'{ "$regex": "'+this.queryForm.name+'"}':'{ "$ne": "null" }',t={class:"Category",filter:'{"order": "createdAt","keys":["parent","name","level"],"where":{"level": {"$gte": 1}, "name":'+e+"}}",parent:"parent"};const{results:a=[]}=yield Object(v["post_tree"])(t);this.categorytree=a}))},queryProduttemp(e){return j(this,null,(function*(){let t={order:"-createdAt",keys:"count(*)",include:"category,name",where:{}};this.queryForm.name&&(t.where.name={$regex:this.queryForm.name}),e.category&&(t.where.category=e.category),e.categorys&&(t.where.category=e.categorys);try{const{results:e=[],count:a=0}=yield Object(m["queryProductTemplet"])(t);this.proTableData=e,this.total=a}catch(a){dgiotlog.log(a),this.$baseMessage(a,"error","dgiot-hey-message-error")}}))},properties(e,t="things"){this.tableLoading=!0,this.things=e,this.tableType=t,Object(f["setTimeout"])(()=>this.tableLoading=!1,1200)},previewParse(e){this.parserView=!0,this.formConfig=e},addParse(e){e.push({name:this.parserType+"name",enname:this.parserType+"English Name",uid:Object(g["uuid"])(6),config:{},type:this.parserType,identifier:"identifier",visible:!0,table:"Device",class:"profile",description:this.parserType+"description"}),this.saveParse(e,-1,!1)},editParse(e,t){dgiotlog.log(t),this.formConfig=t,this.editIndex=e,this.parserTable=!1,this.$nextTick(()=>{this.dialogVisible=!0})},deleteParse(e,t,a){dgiotlog.log("uid",e),a.forEach((t,i)=>{t.uid==e&&a.splice(i,1),dgiotlog.log("rows",a)}),this.saveParse(a,-1,!1)},editorParser(e,t,a){var i,o,r,s;const{objectId:l,thing:n={}}=this.productDetail;var c=[],d=[],p=[];this.producttempId=l,this.parserFromId=l,this.editDictTempId=l,this.parserType=t,this.tableType=t,this.productConfig=_.merge({basedate:{params:{}}},e),dgiotlog.log("this.parserTableList",this.parserTableList,this.parserTables,this.tableType),(null==(r=null==(o=null==(i=this.productDetail)?void 0:i.basedate)?void 0:o.params)?void 0:r.length)&&this.productDetail.basedate.params.forEach(e=>{c.push({field:e.identifier,label:e.name,default:e.default})}),(null==(s=null==n?void 0:n.properties)?void 0:s.length)&&n.properties.forEach(e=>{d.push({field:e.identifier,label:e.name,default:e.default||""})}),localStorage.setItem("_sourceDict",JSON.stringify(c)),localStorage.setItem("_sourceModule",d),localStorage.setItem("_sourceField",p),this.decoderTableList={},dgiotlog.log("this.tableType ",this.tableType)},saveParse(e,t=-1,a=!0){return j(this,null,(function*(){const i=this.productConfig.config[""+this.parserType];t+1>0?i[t]=_.merge({},e):this.productConfig.config[""+this.parserType]=e;try{yield Object(n["putProduct"])(this.parserFromId,{config:this.productConfig.config});this.$message({showClose:!0,duration:2e3,message:this.$translateTitle("user.Save the template successfully"),type:"success"}),this.dialogVisible=!1,a&&(this.parserTable=!1,this.queryProduttemp({}))}catch(o){this.$baseMessage(this.$translateTitle("user.Save the template error")+""+o,"error","dgiot-hey-message-error"),dgiotlog.log(o,"eeee")}dgiotlog.log(e)}))},featchTable(){return j(this,null,(function*(){this.setTreeFlag(!1);try{const{results:e=[]}=yield Object(u["getTable"])();this.DbaTable=e}catch(e){dgiotlog.log(e),this.$baseMessage(e,"error","dgiot-hey-message-error")}}))},uploadCkick(e){this.loading=!0,this.$refs["uploadFinish"].$refs.uploader.dispatchEvent(new MouseEvent("click")),this.inputParams={file:"",scene:"app",path:"producttemp/ico/",filename:`${this.producttempId}.${e}`}},fileInfo(e){dgiotlog.log("info",e),this.imageUrl=e.path,this.loading=!1},files(e,t){this.inputParams.filename=`${this.producttempId}.${t}`,this.inputParams.file=e},getAllunit(){return j(this,null,(function*(){this.allunit=[];const{results:e}=yield Object(r["getAllunit"])("unit",200);this.allunit=e.concat([])}))},onJsonSave(e,t){dgiotlog.log("this.$refs",this.$refs.dict),this.$refs.dict.$refs[e].validate(e=>{dgiotlog.log(this.editDictTempId),e&&this.put_Dict_temp(this.editDictTempId,t)})},put_Dict_temp(e,t){return j(this,null,(function*(){dgiotlog.log(t);const{config:a={basedate:{}}}=this.productInfo;a.basedate=t;const i={config:a},{updatedAt:o}=yield Object(n["putProduct"])(e,i);void 0!=o?(this.dictVisible=!1,this.$message("字典数据更新成功")):this.$message("字典数据更新失败")}))},changeNode(e,t){0!=t&&(this.form.netType=""),this.channel=0==e?[{label:"蜂窝(2G/3G/4G)",value:"CELLULAR"},{label:"NB-IOT通道",value:"NB-IOT"},{label:"BLE(低功耗蓝牙)",value:"Bluetooth"},{label:"5G通道",value:"5G"},{label:"WIFI通道",value:"WIFI"},{label:"ZigBee通道",value:"ZigBee"},{label:"LoRa(WAN)",value:"LoRaWAN"},{label:"Modbus",value:"Modbus"},{label:"OPC UA",value:" OPC UA"},{label:"ZETA通道",value:"ZETA"},{label:"网线连接",value:"网线连接"},{label:"自定义",value:"OTHER"}]:[{label:"蜂窝(2G/3G/4G)",value:"CELLULAR"},{label:"5G通道",value:"5G"},{label:"WIFI通道",value:"WIFI"},{label:"NB-IOT通道",value:"NB-IOT"},{label:"LoRaWAN",value:"LoRaWAN"},{label:"网线连接",value:"网线连接"},{label:"自定义",value:"OTHER"}]},selectApp(e){e&&Object(d["getServer"])(e).then(e=>{e&&(this.fileServer=e.file,this.access_token=e.access_token)})},deleteImgsrc(){this.imageUrl=""},handleClose(){this.dialogFormVisible=!1},handleCloseDialogForm(){this.dialogFormVisible=!1,this.$nextTick(()=>{this.$refs["form"].resetFields()})},submitForm(){const e={"*":{read:!0,write:!0}};var t={name:this.form.name,category:{objectId:this.form.categoryid,__type:"Pointer",className:"Category"},icon:this.imageUrl?this.imageUrl:"",desc:this.form.desc?this.form.desc:"",content:{},profile:{}};this.$refs.form.validate(a=>{a?this.addflag?(t.ACL=e,dgiotlog.log("params",t),Object(m["postProductTemplet"])(t).then(e=>{e.objectId?this.$message({type:"success",showClose:!0,duration:2e3,message:"产品模板创建成功"}):this.$message({showClose:!0,duration:2e3,type:"error",message:"产品模板创建失败"}),this.queryProduttemp({category:this.form.categoryid}),this.dialogFormVisible=!1})):Object(m["putProductTemplet"])(this.producttempId,t).then(e=>{dgiotlog.log("resresresres",e),e.updatedAt?this.$message({showClose:!0,duration:2e3,type:"success",message:"产品模板修改成功"}):this.$message({showClose:!0,duration:2e3,type:"error",message:"产品模板修改失败"}),this.queryProduttemp({category:this.form.categoryid}),this.dialogFormVisible=!1}):this.$message("必填项未填")})},productSizeChange(e){this.length=e,this.queryProduttemp({})},productCurrentChange(e){this.start=(e-1)*this.length,this.queryProduttemp({})},blackDict(e,t){return j(this,null,(function*(){const a={data:t,key:e,type:"Product"},i=yield Object(r["postDict"])(a);i?this.$message({showClose:!0,duration:2e3,type:"success",message:"备份成功"}):this.$message({showClose:!0,duration:2e3,type:"error",message:"备份失败"})}))},CloneData(e){return j(this,null,(function*(){const t={category:e.attributes.category,devType:e.attributes.devType,name:e.attributes.name,thing:e.attributes.thing},{objectId:a,code:i}=yield Object(p["getHashClass"])("Product",t);200==i&&this.blackDict(a,t)}))},proudctClone(e){e.attributes.config.cloneState=!0,e.attributes.config.cloneState=!0;const t=e,a=Object(n["putProduct"])(e.id,t);a&&this.CloneData(e)},proudctEdit(e){var t=window.location.origin+"/spa";const{NODE_ENV:a}=Object({NODE_ENV:"production",VUE_APP_TITLE:"物联网开发平台",VUE_APP_AUTHOR:"xxb",VUE_APP_UPDATE_TIME:"2023年01月29日11时07分47秒",VUE_APP_VERSION:"4.7.4",VUE_APP_Keywords:"一站式物联网PaaS平台|物联网应用服务",VUE_APP_Description:"提供物联网垂直领域应用使能平台及解决方案",VUE_APP_URL:"http://1.117.219.8",VUE_APP_CDN_URL:"/dgiot_dashboard/public",BASE_URL:""});t="development"==a?this.$globalConfig.localTopoUrl:window.location.origin+"/spa";var i=`${t}/#?drawProudctid=${e.objectId}&proudctid=${e.objectId}`;localStorage.setItem("rowId",e.objectId),window.open(i,"__blank")},proudctView(e){var t=window.location.origin+"/spa";const{NODE_ENV:a}=Object({NODE_ENV:"production",VUE_APP_TITLE:"物联网开发平台",VUE_APP_AUTHOR:"xxb",VUE_APP_UPDATE_TIME:"2023年01月29日11时07分47秒",VUE_APP_VERSION:"4.7.4",VUE_APP_Keywords:"一站式物联网PaaS平台|物联网应用服务",VUE_APP_Description:"提供物联网垂直领域应用使能平台及解决方案",VUE_APP_URL:"http://1.117.219.8",VUE_APP_CDN_URL:"/dgiot_dashboard/public",BASE_URL:""});t="development"==a?this.$globalConfig.localTopoUrl:window.location.origin+"/spa";var i=`${t}/#/views/${e.objectId}`;window.open(i,"__blank")},goTopoview(){var e=window.location.origin+"/spa";const{NODE_ENV:t}=Object({NODE_ENV:"production",VUE_APP_TITLE:"物联网开发平台",VUE_APP_AUTHOR:"xxb",VUE_APP_UPDATE_TIME:"2023年01月29日11时07分47秒",VUE_APP_VERSION:"4.7.4",VUE_APP_Keywords:"一站式物联网PaaS平台|物联网应用服务",VUE_APP_Description:"提供物联网垂直领域应用使能平台及解决方案",VUE_APP_URL:"http://1.117.219.8",VUE_APP_CDN_URL:"/dgiot_dashboard/public",BASE_URL:""});e="development"==t?this.$globalConfig.localTopoUrl:window.location.origin+"/spa";var a=e+"/#/view";window.open(a,"__blank")},lockingParse(e,t,a){const{disable:i=!1}=a[""+t];a[""+t].disable=!i,this.saveParse(a,-1,!1)},exportpro(){this.allTableDate?Object(c["export_txt_to_zip"])(JSON.stringify(this.allTableDate),"Dict","Dict"):this.$message({showClose:!0,duration:2e3,type:"warning",message:"数据为空,无法导出"})}},Object(l["mapMutations"])({setSizeForm:"konva/setSizeForm",setTreeFlag:"settings/setTreeFlag"})),{getFormOrginalData(){return{devicetype:this.devicetype,strategy:"20",resource:1,identifier:"",dis:"0X10",dinumber:"null",type:"int",startnumber:"",endnumber:"",step:"",true:"",truevalue:1,false:"",falsevalue:0,isread:"r",isshow:!0,unit:"",string:"",date:"String类型的UTC时间戳 (毫秒)",specs:{},precision:3,round:"all",struct:[{attribute:"",attributevalue:""}],rate:1,offset:0,order:0,protocol:"normal",operatetype:"readCoils",originaltype:"int",slaveid:"0X10",collection:"%s",control:"%d",nobound:[],editdatatype:!1,iscount:"0",countstrategy:20,countround:"all",countcollection:"%s",daslist:[]}},createProperty(){this.setSizeForm(this.getFormOrginalData()),this.wmxdialogVisible=!0,this.wmxSituation="新增"},wmxhandleClose(){this.$refs["sizeForm"].resource.disabled=!1,this.wmxdialogVisible=!1,this.setSizeForm(this.getFormOrginalData())},removeDomain(e){var t=this.sizeForm.struct.indexOf(e);-1!==t&&this.sizeForm.struct.splice(t,1)},addDomain(){this.sizeForm.struct.push({attribute:"",attributevalue:""})},deletewmx(e){this.productDetail.thing.properties.splice(e,1);let t={thing:{properties:this.productDetail.thing.properties}};Object(m["putProductTemplet"])(this.producttempId,t).then(e=>{e.updatedAt?this.$message({type:"success",showClose:!0,duration:2e3,message:"删除成功"}):this.$message({type:"warning",showClose:!0,duration:2e3,message:"删除失败"})}).catch(e=>{dgiotlog.log(e)})},wmxDataFill(e,t){this.modifyIndex=t,this.wmxdialogVisible=!0,this.wmxSituation="编辑";var a={},i=[];if(e.dataType.das.forEach(e=>{i.push({addr:e})}),-1!=["float","double","int","long"].indexOf(e.dataType.type))a={name:e.name,devicetype:e.devicetype,type:e.dataType.type,daslist:i,endnumber:this.$objGet(e,"dataType.specs.max"),startnumber:this.$objGet(e,"dataType.specs.min"),step:this.$objGet(e,"dataType.specs.step"),unit:this.$objGet(e,"dataType.specs.unit"),precision:this.$objGet(e,"dataType.specs.precision"),dis:this.$objGet(e,"dataForm.address"),round:this.$objGet(e,"dataForm.round"),dinumber:this.$objGet(e,"dataForm.data"),rate:this.$objGet(e,"dataForm.rate"),offset:this.$objGet(e,"dataForm.offset"),order:this.$objGet(e,"dataForm.order"),protocol:this.$objGet(e,"dataForm.protocol"),operatetype:this.$objGet(e,"dataForm.operatetype"),originaltype:this.$objGet(e,"dataForm.originaltype"),iscount:this.$objGet(e,"dataForm.iscount"),countstrategy:this.$objGet(e,"dataForm.countstrategy"),countround:this.$objGet(e,"dataForm.countround"),countcollection:this.$objGet(e,"dataForm.countcollection"),slaveid:this.$objGet(e,"dataForm.slaveid"),collection:"",control:"",strategy:"",required:!0,ico:e.ico,isread:e.accessMode,isshow:e.isshow,identifier:e.identifier,editdatatype:!0},e.dataForm&&(a.collection=e.dataForm.collection,a.control=e.dataForm.control,a.strategy=e.dataForm.strategy);else if("bool"==e.dataType.type)a={name:e.name,devicetype:e.devicetype,type:e.dataType.type,true:e.dataType.specs[1],false:e.dataType.specs[0],daslist:i,startnumber:this.$objGet(e,"dataType.specs.min"),step:this.$objGet(e,"dataType.specs.step"),unit:this.$objGet(e,"dataType.specs.unit"),round:this.$objGet(e,"dataForm.round"),dis:this.$objGet(e,"dataForm.address"),dinumber:this.$objGet(e,"dataForm.data"),rate:this.$objGet(e,"dataForm.rate"),offset:this.$objGet(e,"dataForm.offset"),order:this.$objGet(e,"dataForm.order"),protocol:this.$objGet(e,"dataForm.protocol"),operatetype:this.$objGet(e,"dataForm.operatetype"),originaltype:this.$objGet(e,"dataForm.originaltype"),slaveid:this.$objGet(e,"dataForm.slaveid"),iscount:this.$objGet(e,"dataForm.iscount"),countstrategy:this.$objGet(e,"dataForm.countstrategy"),countround:this.$objGet(e,"dataForm.countround"),countcollection:this.$objGet(e,"dataForm.countcollection"),required:!1,ico:e.ico,isread:e.accessMode,isshow:e.isshow,identifier:e.identifier,collection:void 0==e.dataForm?"":e.dataForm.collection,control:void 0==e.dataForm?"":e.dataForm.control,strategy:void 0==e.dataForm?"":e.dataForm.strategy,editdatatype:!0};else if("image"==e.dataType.type)a={name:e.name,devicetype:e.devicetype,type:e.dataType.type,imagevalue:e.dataType.imagevalue,daslist:i,startnumber:this.$objGet(e,"dataType.specs.min"),step:this.$objGet(e,"dataType.specs.step"),unit:this.$objGet(e,"dataType.specs.unit"),round:this.$objGet(e,"dataForm.round"),dis:this.$objGet(e,"dataForm.address"),dinumber:this.$objGet(e,"dataForm.data"),rate:this.$objGet(e,"dataForm.rate"),offset:this.$objGet(e,"dataForm.offset"),order:this.$objGet(e,"dataForm.order"),protocol:this.$objGet(e,"dataForm.protocol"),operatetype:this.$objGet(e,"dataForm.operatetype"),originaltype:this.$objGet(e,"dataForm.originaltype"),slaveid:this.$objGet(e,"dataForm.slaveid"),iscount:this.$objGet(e,"dataForm.iscount"),countstrategy:this.$objGet(e,"dataForm.countstrategy"),countround:this.$objGet(e,"dataForm.countround"),countcollection:this.$objGet(e,"dataForm.countcollection"),required:!1,ico:e.ico,isread:e.accessMode,isshow:e.isshow,identifier:e.identifier,collection:void 0==e.dataForm?"":e.dataForm.collection,control:void 0==e.dataForm?"":e.dataForm.control,strategy:void 0==e.dataForm?"":e.dataForm.strategy,editdatatype:!0};else if("enum"==e.dataType.type){var o=[];for(const t in e.dataType.specs)o.push({attribute:t,attributevalue:e.dataType.specs[t]});a={name:e.name,devicetype:e.devicetype,type:e.dataType.type,specs:e.dataType.specs,struct:o,daslist:i,startnumber:this.$objGet(e,"dataType.specs.min"),step:this.$objGet(e,"dataType.specs.step"),unit:this.$objGet(e,"dataType.specs.unit"),round:this.$objGet(e,"dataForm.round"),dis:this.$objGet(e,"dataForm.address"),dinumber:this.$objGet(e,"dataForm.data"),rate:this.$objGet(e,"dataForm.rate"),offset:this.$objGet(e,"dataForm.offset"),order:this.$objGet(e,"dataForm.order"),protocol:this.$objGet(e,"dataForm.protocol"),operatetype:this.$objGet(e,"dataForm.operatetype"),originaltype:this.$objGet(e,"dataForm.originaltype"),slaveid:this.$objGet(e,"dataForm.slaveid"),iscount:this.$objGet(e,"dataForm.iscount"),countstrategy:this.$objGet(e,"dataForm.countstrategy"),countround:this.$objGet(e,"dataForm.countround"),countcollection:this.$objGet(e,"dataForm.countcollection"),required:!0,ico:e.ico,isread:e.accessMode,isshow:e.isshow,identifier:e.identifier,collection:void 0==e.dataForm?"":e.dataForm.collection,control:void 0==e.dataForm?"":e.dataForm.control,strategy:void 0==e.dataForm?"":e.dataForm.strategy,editdatatype:!0}}else"struct"==e.dataType.type?a={name:e.name,devicetype:e.devicetype,type:e.dataType.type,struct:e.dataType.specs,daslist:i,startnumber:this.$objGet(e,"dataType.specs.min"),step:this.$objGet(e,"dataType.specs.step"),unit:this.$objGet(e,"dataType.specs.unit"),round:this.$objGet(e,"dataForm.round"),dis:this.$objGet(e,"dataForm.address"),dinumber:this.$objGet(e,"dataForm.data"),rate:this.$objGet(e,"dataForm.rate"),offset:this.$objGet(e,"dataForm.offset"),order:this.$objGet(e,"dataForm.order"),protocol:this.$objGet(e,"dataForm.protocol"),operatetype:this.$objGet(e,"dataForm.operatetype"),originaltype:this.$objGet(e,"dataForm.originaltype"),slaveid:this.$objGet(e,"dataForm.slaveid"),iscount:this.$objGet(e,"dataForm.iscount"),countstrategy:this.$objGet(e,"dataForm.countstrategy"),countround:this.$objGet(e,"dataForm.countround"),countcollection:this.$objGet(e,"dataForm.countcollection"),required:!0,ico:e.ico,isread:e.accessMode,isshow:e.isshow,collection:void 0==e.dataForm?"":e.dataForm.collection,control:void 0==e.dataForm?"":e.dataForm.control,identifier:void 0==e.dataForm?"":e.identifier,strategy:void 0==e.dataForm?"":e.dataForm.strategy,editdatatype:!0}:"text"==e.dataType.type?a={name:e.name,devicetype:e.devicetype,type:e.dataType.type,collection:void 0==e.dataForm?"":e.dataForm.collection,control:void 0==e.dataForm?"":e.dataForm.control,string:e.dataType.size,daslist:i,startnumber:this.$objGet(e,"dataType.specs.min"),step:this.$objGet(e,"dataType.specs.step"),unit:this.$objGet(e,"dataType.specs.unit"),round:this.$objGet(e,"dataForm.round"),dis:this.$objGet(e,"dataForm.address"),dinumber:this.$objGet(e,"dataForm.data"),rate:this.$objGet(e,"dataForm.rate"),offset:this.$objGet(e,"dataForm.offset"),order:this.$objGet(e,"dataForm.order"),protocol:this.$objGet(e,"dataForm.protocol"),operatetype:this.$objGet(e,"dataForm.operatetype"),originaltype:this.$objGet(e,"dataForm.originaltype"),slaveid:this.$objGet(e,"dataForm.slaveid"),iscount:this.$objGet(e,"dataForm.iscount"),countstrategy:this.$objGet(e,"dataForm.countstrategy"),countround:this.$objGet(e,"dataForm.countround"),countcollection:this.$objGet(e,"dataForm.countcollection"),required:!0,ico:e.ico,isread:e.accessMode,isshow:e.isshow,identifier:e.identifier,strategy:void 0==e.dataForm?"":e.dataForm.strategy,editdatatype:!0}:"date"==e.dataType.type?a={name:e.name,devicetype:e.devicetype,type:e.dataType.type,collection:void 0==e.dataForm?"":e.dataForm.collection,control:void 0==e.dataForm?"":e.dataForm.control,strategy:void 0==e.dataForm?"":e.dataForm.strategy,daslist:i,startnumber:this.$objGet(e,"dataType.specs.min"),step:this.$objGet(e,"dataType.specs.step"),unit:this.$objGet(e,"dataType.specs.unit"),round:this.$objGet(e,"dataForm.round"),dis:this.$objGet(e,"dataForm.address"),order:this.$objGet(e,"dataForm.order"),dinumber:this.$objGet(e,"dataForm.data"),rate:this.$objGet(e,"dataForm.rate"),offset:this.$objGet(e,"dataForm.offset"),protocol:this.$objGet(e,"dataForm.protocol"),operatetype:this.$objGet(e,"dataForm.operatetype"),originaltype:this.$objGet(e,"dataForm.originaltype"),slaveid:this.$objGet(e,"dataForm.slaveid"),iscount:this.$objGet(e,"dataForm.iscount"),countstrategy:this.$objGet(e,"dataForm.countstrategy"),countround:this.$objGet(e,"dataForm.countround"),countcollection:this.$objGet(e,"dataForm.countcollection"),required:!0,ico:e.ico,isread:e.accessMode,isshow:e.isshow,identifier:e.identifier,editdatatype:!0}:"geopoint"==e.dataType.type&&(a={name:e.name,devicetype:e.devicetype,type:e.dataType.type,gpstype:e.dataType.gpstype,collection:void 0==e.dataForm?"":e.dataForm.collection,control:void 0==e.dataForm?"":e.dataForm.control,strategy:void 0==e.dataForm?"":e.dataForm.strategy,daslist:i,startnumber:this.$objGet(e,"dataType.specs.min"),step:this.$objGet(e,"dataType.specs.step"),unit:this.$objGet(e,"dataType.specs.unit"),round:this.$objGet(e,"dataForm.round"),dis:this.$objGet(e,"dataForm.address"),order:this.$objGet(e,"dataForm.order"),dinumber:this.$objGet(e,"dataForm.data"),rate:this.$objGet(e,"dataForm.rate"),offset:this.$objGet(e,"dataForm.offset"),protocol:this.$objGet(e,"dataForm.protocol"),operatetype:this.$objGet(e,"dataForm.operatetype"),originaltype:this.$objGet(e,"dataForm.originaltype"),slaveid:this.$objGet(e,"dataForm.slaveid"),iscount:this.$objGet(e,"dataForm.iscount"),countstrategy:this.$objGet(e,"dataForm.countstrategy"),countround:this.$objGet(e,"dataForm.countround"),countcollection:this.$objGet(e,"dataForm.countcollection"),required:!0,ico:e.ico,isread:e.accessMode,isshow:e.isshow,identifier:e.identifier,editdatatype:!0});a.protocol=e.dataForm.protocol,this.setSizeForm(a),this.$nextTick(()=>j(this,null,(function*(){yield this.$refs["sizeForm"].queryResource(),this.$refs["sizeForm"].resource.value=e.dataForm.protocol,this.$refs["sizeForm"].resource.disabled=!!e.dataForm.protocol.length,this.$refs["sizeForm"].resource.arrlist=e.dataSource,this.$nextTick(()=>{this.$refs["sizeForm"].resource.data.forEach((t,a)=>{if(this.$refs["sizeForm"].resource.value===t.cType){for(var i in e.dataSource)for(var o in t.obj)i===o&&(t.obj[i]=e.dataSource[o]);this.$refs["sizeForm"].resource.addchannel=t.obj}this.$refs["sizeForm"].resource.changeData=e.dataSource,t.cType,e.dataForm.protocol})})})))},addDas(){this.sizeForm.daslist.push({addr:""})},removeDas(e){var t=this.sizeForm.daslist.indexOf(e);-1!==t&&this.sizeForm.daslist.splice(t,1)},submitFormwmx(e){var t=[];e.daslist.map(e=>{var a=e["addr"];t.push(a)}),dgiotlog.log("sizeForm",e);var a={name:e.name,devicetype:e.devicetype,dataForm:{round:e.round,data:e.dinumber,address:e.dis,rate:e.rate,offset:e.offset,order:e.order,protocol:e.protocol,operatetype:e.operatetype,originaltype:e.originaltype,slaveid:e.slaveid,collection:e.collection,control:e.control,strategy:e.strategy,iscount:e.iscount,countstrategy:e.countstrategy,countround:e.countround,countcollection:e.countcollection},ico:e.ico,required:!0,accessMode:e.isread,isshow:e.isshow,identifier:e.identifier};if("float"==e.type||"double"==e.type||"int"==e.type||"long"==e.type){var i={dataType:{type:e.type.toLowerCase(),specs:{max:e.endnumber,min:e.startnumber,step:e.step,precision:Number(e.precision),unit:""==e.unit?"":e.unit},das:t}};Object.assign(a,i)}else if("image"==e.type)i={dataType:{das:t,type:e.type.toLowerCase(),imagevalue:e.imagevalue,specs:{}}},Object.assign(a,i);else if("bool"==e.type)i={dataType:{das:t,type:e.type.toLowerCase(),specs:{0:e.false,1:e.true}}},Object.assign(a,i);else if("enum"==e.type){var o={};e.struct.map(e=>{var t=e["attribute"];o[t]=e["attributevalue"]}),i={dataType:{das:t,type:e.type.toLowerCase(),specs:o}},Object.assign(a,i)}else"struct"==e.type?(i={dataType:{das:t,type:e.type.toLowerCase(),specs:e.struct}},Object.assign(a,i)):"text"==e.type?(i={dataType:{das:t,type:e.type.toLowerCase(),size:e.string,specs:{}}},Object.assign(a,i)):"date"==e.type?(i={dataType:{das:t,type:e.type.toLowerCase(),specs:{}}},Object.assign(a,i)):"geopoint"==e.type&&(i={dataType:{das:t,type:e.type.toLowerCase(),gpstype:e.gpstype,specs:{}}},Object.assign(a,i));delete a.index,dgiotlog.log("obj",a),"新增"==this.wmxSituation?this.productDetail.thing.properties.unshift(a):"编辑"==this.wmxSituation&&(this.productDetail.thing.properties[this.modifyIndex]=a,this.thingKey=moment(new Date).valueOf().toString()),dgiotlog.log(this.wmxSituation,this.productDetail.thing.properties);let r={thing:{properties:this.productDetail.thing.properties}};Object(m["putProductTemplet"])(this.producttempId,r).then(e=>{e.updatedAt?this.$message({type:"success",showClose:!0,duration:2e3,message:this.wmxSituation+"成功"}):this.$message({type:"warning",showClose:!0,duration:2e3,message:this.wmxSituation+"失败"})}),this.wmxdialogVisible=!1},checkschema(){this.schemadialogVisible=!0,Object(f["setTimeout"])(()=>{F=ace.edit("editor1"),F.session.setMode("ace/mode/json"),F.setTheme("ace/theme/eclipse"),F.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}),F.setValue(JSON.stringify(this.productDetail.thing,null,4))},1)},preserve(){const e={thing:JSON.parse(F.getValue())};Object(m["putProductTemplet"])(this.producttempId,e).then(e=>{this.$message({type:"success",showClose:!0,duration:2e3,message:this.wmxSituation+"成功"})}),this.schemadialogVisible=!1},goKonva(e){this.$router.push({path:"/Topo?productid",query:{productid:e}})},orginRule(e){return j(this,null,(function*(){let t=this.$route.query.id;try{const a={order:"createdAt",keys:"data",where:{key:{$regex:t+"_"+e.objectId}}},{results:i=[]}=yield Object(r["queryDict"])(a);let o=[];i.forEach(e=>{e.data.args&&(-1!=e.data.args.ruleid.indexOf("start")?e.data.args.type="告警产生":e.data.args.type="告警恢复",e.data.args.dictid=e.objectId,o.push(e.data.args))}),this.engineData=o}catch(a){this.$baseMessage(this.$translateTitle("alert.Data request error")+""+a,"error","dgiot-hey-message-error")}}))},getRowindex(e,t,a){if(0==e.columnIndex)return"firstcolumn"},detailRules(e){this.$router.push({path:"/rules_engine/checkengine",query:{id:e}})},matched(e){for(var t=0,a=0;a<e.length;a++)t+=e[a].matched;return t}})},q=O,z=(a("8cae"),a("2877")),L=Object(z["a"])(q,i,o,!1,null,"030d2a08",null);t["default"]=L.exports},"34d2":function(e,t,a){},"3d98":function(e,t,a){e.exports={"menu-color":"rgba(255,255,255,.95)","menu-color-active":"rgba(255,255,255,.95)","menu-background":"#282c34","column-second-menu-background":"#fff"}},4968:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"devproduct devproduct-container"},[t("dgiot-input",{ref:"uploadFinish",on:{fileInfo:e.fileInfo}}),t("div",{staticClass:"prosecond"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline,size:"small"}},[t("el-form-item",{attrs:{label:e.$translateTitle("product.classification")}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("task.Select")},on:{change:e.handleCateSearch},model:{value:e.queryForm.category,callback:function(t){e.$set(e.queryForm,"category",t)},expression:"queryForm.category"}},e._l(e.categoryList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.name,value:e.objectId}})})),1)],1),t("el-form-item",[t("el-input",{attrs:{clearable:"",placeholder:e.$translateTitle("product.searchproductname")},model:{value:e.formInline.productname,callback:function(t){e.$set(e.formInline,"productname",t)},expression:"formInline.productname"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.searchProduct(0)}}},[e._v(" "+e._s(e.$translateTitle("developer.search"))+" ")])],1),t("el-form-item",{staticStyle:{float:"right","text-align":"right"}},[t("el-button",{attrs:{type:"primary"},on:{click:e.addproduct}},[e._v(" "+e._s(e.$translateTitle("product.createproduct"))+" ")]),t("el-button",{attrs:{type:"primary"},on:{click:e.exportpro}},[e._v(" "+e._s(e.$translateTitle("product.exportpro"))+" ")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleImport()}}},[e._v(" "+e._s(e.$translateTitle("product.importpro"))+" ")])],1)],1),t("div",{staticClass:"protable"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e.tableData,"header-cell-style":{"text-align":"center"}}},[t("el-table-column",{attrs:{label:"ProductID",prop:"objectId","show-overflow-tooltip":"",sortable:""}}),t("el-table-column",{attrs:{label:e.$translateTitle("product.productname")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.name))])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("product.productgrouping")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.netType))])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("product.addingtime"),width:"180"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(e.utc2beijing(a.createdAt)))])]}}])}),t("el-table-column",{attrs:{fixed:"right",label:e.$translateTitle("developer.operation"),width:"340"},scopedSlots:e._u([{key:"default",fn:function({row:a,$index:i}){return[t("el-button",{attrs:{size:"mini",type:"primary",underline:!1},on:{click:function(t){return e.deviceToDetail(a)}}},[e._v(" "+e._s(e.$translateTitle("product.config"))+" ")]),t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.goKonva(a.objectId)}}},[e._v(" "+e._s(e.$translateTitle("concentrator.konva"))+" ")]),t("el-button",{attrs:{size:"mini",type:"success",underline:!1},on:{click:function(t){return e.editorProduct(a)}}},[e._v(" "+e._s(e.$translateTitle("concentrator.edit"))+" ")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.makeSure(e.scope,i)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])]}}])})],1)],1),t("div",{staticClass:"elpagination",staticStyle:{"margin-top":"20px"}},[t("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.length,"page-sizes":[10,20,30,50],total:e.total},on:{"current-change":e.productCurrentChange,"size-change":e.productSizeChange}})],1)],1),t("div",{staticClass:"devproduct-prodialog"},[t("el-drawer",{attrs:{"before-close":e.handleClose,"close-on-click-modal":!1,size:"60%",title:e.moduleTitle,top:"5vh",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("div",{staticClass:"devproduct-prodialog-content"},[t("div",{staticClass:"contentone"},[t("div",{staticStyle:{display:"flex"}},[t("span",[e._v(" "+e._s(e.$translateTitle("product.productinformation"))+" ")]),t("p",{staticStyle:{"flex-grow":"2",width:"auto",height:"1px",margin:"10px","border-top":"1px dashed #dddddd"}})]),t("el-form",{ref:"form",attrs:{"label-width":"产品名称"==e.$translateTitle("product.productname")?"120px":"160px",model:e.form,rules:e.rules}},[t("el-form-item",{attrs:{label:e.$translateTitle("product.productname"),prop:"name"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:e.$translateTitle("product.productgrouping"),prop:"devType"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.devType,callback:function(t){e.$set(e.form,"devType",t)},expression:"form.devType"}})],1),t("el-form-item",{attrs:{label:e.$translateTitle("product.classification"),prop:"category"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}},[t("el-option",{staticStyle:{height:"auto",padding:"0"},attrs:{value:e.treeDataValue}},[t("el-tree",{ref:"workGroup",attrs:{data:e.categoryTreeData,"default-expand-all":"","expand-on-click-node":!1,"node-key":"index"},scopedSlots:e._u([{key:"default",fn:function({node:a,data:i}){return t("div",{staticClass:"custom-tree-node"},[t("span",{class:{selected:!1},on:{click:function(t){return e.handleCateClick(a,i)}}},[e._v(" "+e._s(a.label)+" ")])])}}])})],1)],1)],1),t("el-form-item",{attrs:{label:e.$translateTitle("developer.applicationtype"),prop:"relationApp"}},[t("el-input",{attrs:{disabled:"edit"==e.custom_status&&""!=e.form.relationApp,placeholder:e.$translateTitle("product.pleaseselectyourapp"),readonly:""},on:{focus:function(t){e.showTree=!e.showTree}},model:{value:e.form.relationApp,callback:function(t){e.$set(e.form,"relationApp",t)},expression:"form.relationApp"}}),e.showTree?t("div",[t("el-tree",{attrs:{data:e.allApps,props:e.defaultProps},on:{"node-click":e.handleNodeClick}})],1):e._e()],1),t("el-form-item",{attrs:{label:e.$translateTitle("menu.icon"),prop:"icon"}},[e.imageUrl?t("div",[t("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}),t("el-button",{staticStyle:{"vertical-align":"text-bottom"},attrs:{size:"mini",type:"danger"},on:{click:function(t){return t.stopPropagation(),e.deleteImgsrc.apply(null,arguments)}}},[e._v(" 删除 ")])],1):t("i",{staticClass:"el-icon-plus avatar-uploader-icon",on:{click:e.uploadCkick}}),t("form",{ref:"uploadform",staticStyle:{position:"absolute",visibility:"hidden"},attrs:{enctype:"multipart/form-data",method:"POST"}},[t("input",{staticStyle:{position:"relative","z-index":"5",width:"100px",height:"100px",cursor:"pointer",opacity:"0"},attrs:{type:"file"},on:{change:function(t){return e.upload(t)}}})]),t("br")]),t("el-form-item",{attrs:{label:e.$translateTitle("developer.describe"),prop:"desc"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1)],1)],1)]),t("div",{staticClass:"devproduct-prodialog-footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm()}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")]),t("el-button",{on:{click:function(t){return e.handleCloseDialogForm()}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")])],1)])],1)],1)},o=[],r=a("ed08"),s=a("5880"),l=a("7212"),n=a("e0e9"),c=a("1285"),d=a("5da9"),p=a("7497"),u=a("0af3"),m=a("ef68"),h=a("03b1"),g=a("d292"),b=Object.defineProperty,f=Object.getOwnPropertySymbols,v=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable,w=(e,t,a)=>t in e?b(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,T=(e,t)=>{for(var a in t||(t={}))v.call(t,a)&&w(e,a,t[a]);if(f)for(var a of f(t))y.call(t,a)&&w(e,a,t[a]);return e},k=(e,t,a)=>new Promise((i,o)=>{var r=e=>{try{l(a.next(e))}catch(t){o(t)}},s=e=>{try{l(a.throw(e))}catch(t){o(t)}},l=e=>e.done?i(e.value):Promise.resolve(e.value).then(r,s);l((a=a.apply(e,t)).next())});const C=a("6818");let x={};C.keys().forEach(e=>{let t=C(e);x[e.replace(/^\.\/(.*)\.\w+$/,"$1")]=t.default});var S={components:{},data(){return{selectedRow:{},tableData:[],allTemp:[],category:[],descriptions:{tableType:"things",things:[],productId:"",dictTableList:[],decoderTableList:{},productDetail:{decoder:{code:""},thing:{properties:[]},config:{parser:[],profile:[],basedate:{params:[]}}},parserTableList:[],tableLoading:!1},queryForm:{name:"",category:"",productId:"",productFlag:!1,pageNo:1,pageSize:20,searchDate:[],limt:10,skip:0,total:0,order:"-createdAt",keys:"count(*)"},cascaderDrawer:!1,drawerWidth:Number($(window).width())-240,height:this.$baseTableHeight(0),config:{},dataList:[{}],parserView:!1,parserTable:!1,parserTableList:{parser:[]},parserFromId:"",dialogVisible:!1,moduleTitle:this.$translateTitle("product.createproduct"),allunit:[],productInfo:{},edit_dict_temp_dialog:!1,title_dict_edit_dialog:"新增字典数据",tempparams:{name:"",identifier:"",type:"",order:0,address:"",bytes:"",registersnumber:"",default:0,required:!1,readonly:!0,specs:[{attribute:"",attributevalue:""}],struct:{},unit:"",inactivevalue:"",activevalue:""},elactiveName:"Table",elactiveName1:"Table1",editDictTempId:"",title_temp_dialog:"",dictTempForm:"",rule:[],dictVisible:!1,listLoading:!1,custom_row:{},custom_status:"add",hashkey:"",defaultProps:{children:"children",label:"label"},length:10,total:0,start:0,activeName:"first",formInline:{productname:""},uploadHeaders:{sessionToken:Cookies.get("access_token")},uploadAction:"",uploadData:{},fileList:[],proTableData:[],dialogFormVisible:!1,importDialogShow:!1,cType:"",treeDataValue:"",categoryTreeData:[],curCatementId:"",form:{type:1,storageStrategy:"",name:"",category:"",nodeType:3,desc:"",netType:"",devType:"",productSecret:"",roles:[],relationApp:""},formPro:{name:"",url:""},rules:{name:[{required:!0,message:"请输入产品",trigger:"blur"}],devType:[{required:!0,message:"请输入产品标识，用于区分不同设备",trigger:"blur"}],category:[{required:!0,message:"请选择所属分类",trigger:"change"}],nodeType:[{required:!0,message:"请选择节点类型",trigger:"change"}],netType:[{required:!0,message:"请选择联网方式",trigger:"change"}],relationApp:[{required:!0,message:"请选择产品可见角色",trigger:"change"}]},option:[],ruleoptions:[],dialogProfile:!1,imageUrl:"",selectfromtype:"",productid:"",parserDict:[],formConfig:{},editIndex:0,Parserzh:"",parseren:"",loading:!1,allApps:[],categoryList:[],fileServer:"",access_token:"",projectid:"",projectName:"",allTableDate:[],showTree:!1,showcateTree:!1,multipleSelection:[]}},computed:T({},Object(s["mapGetters"])({token:"user/token",roleTree:"user/roleTree"})),mounted(){this.queryProdut({}),this.categorytree(),this.categorylist(),this.searchProduct(0)},beforeDestroy(){this.projectName=""},methods:{handleIconClick(e){return k(this,null,(function*(){this.dialogProfile=!this.dialogProfile,yield this.$refs.dialogProfile.StepsListRowClick(this.selectedRow)}))},handleCateClick(e,t){dgiotlog.log("node",e),dgiotlog.log("data",t),this.form.category=t.objectId,this.curCatementId=t.name},queryProdut(e){return k(this,null,(function*(){const t=e.categorys,a=this.$baseColorfullLoading();e.limit||(e=this.queryForm),dgiotlog.log("args",e);let i={limit:e.limit,order:e.order,skip:e.skip,keys:e.keys,where:{}};e.name&&(i.where.name={$regex:e.name}),t&&(i.where.category={$in:t}),dgiotlog.log("params",i);try{const{results:e=[],count:t=0}=yield Object(m["queryProductTemplet"])(i);a.close(),this.tableData=e,this.queryForm.total=t}catch(o){a.close(),dgiotlog.log(o),this.$baseMessage(o,"error","dgiot-hey-message-error")}}))},goKonva(e){this.$router.push({path:"/Topo?productid",query:{productid:e}})},uploadCkick(){this.loading=!0,this.$refs["uploadFinish"].$refs.uploader.dispatchEvent(new MouseEvent("click"))},fileInfo(e){dgiotlog.log("info",e),this.imageUrl=e.url,this.loading=!1},getAllunit(){return k(this,null,(function*(){this.allunit=[];const{results:e}=yield Object(n["getAllunit"])("unit",200);this.allunit=e.concat([])}))},submitEnum(){"Enum"==this.tempparams.type&&this.tempparams.specs.map(e=>{var t=e["attribute"];this.tempparams.struct[t]=e["attributevalue"]})},addDomain(){this.tempparams.specs.push({attribute:"",attributevalue:""})},removeDomain(e){var t=this.tempparams.specs.indexOf(e);-1!==t&&this.tempparams.specs.splice(t,1)},delRow(e,t){t.splice(e,1)},editRow(e,t,a){this.editIndexId=t,this.title_dict_edit_dialog="修改字典数据",this.edit_dict_temp_dialog=!0,this.tempparams=e},closeDict(){this.edit_dict_temp_dialog=!this.edit_dict_temp_dialog},onJsonSave(e){this.$refs[e].validate(e=>{dgiotlog.log(this.editDictTempId),e&&this.put_Dict_temp(this.editDictTempId,this.dictTempForm)})},put_Dict_temp(e,t){return k(this,null,(function*(){dgiotlog.log(t);const{config:a={basedate:{}}}=this.productInfo;a.basedate=t;const i={config:a},{updatedAt:o}=yield Object(l["putProduct"])(e,i);void 0!=o?(this.dictVisible=!1,this.$message("字典数据更新成功")):this.$message("字典数据更新失败")}))},submitFormTempDict(){this.submitEnum(),this.edit_dict_temp_dialog=!1,void 0!=this.editIndexId?(this.dictTempForm.params[this.editIndexId]=this.tempparams,this.$message("编辑成功")):(this.dictTempForm.params.push(this.tempparams),this.$message("新增成功"))},opendialog(e){this.$nextTick(()=>{this.$refs[e].clearValidate()})},tempTypeChange(e){"bool"==e?(this.tempparams.default=!0,this.tempparams.default=!0):this.tempparams.default="int"==e?0:void 0},addRow(e){this.editIndexId=void 0,this.title_dict_edit_dialog="新增字典数据",this.edit_dict_temp_dialog=!0,this.tempparams={name:"",identifier:"",type:"",order:0,address:"",bytes:"",registersnumber:"",default:0,required:!1,readonly:!0,specs:[{attribute:"",attributevalue:""}],struct:{},collection:"%s",setting:"%s",unit:""}},onError(){this.$message("非Json数据类型")},handleNodeClick(e){dgiotlog.log(e,"data"),this.$set(this.form,"relationApp",e.name),this.showTree=!this.showTree},selectApp(e){e&&Object(d["getServer"])(e).then(e=>{e&&(this.fileServer=e.file,this.access_token=e.access_token)})},treeData(e){const t=JSON.parse(JSON.stringify(e));return t.filter(e=>{const a=t.filter(t=>e.objectId==t.parent.objectId);return a.length>0&&(e.children=a),0==e.parent.objectId})},deleteImgsrc(){this.imageUrl=""},dataURItoBlob(e){for(var t=atob(e.split(",")[1]),a=e.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(t.length),o=new Uint8Array(i),r=0;r<t.length;r++)o[r]=t.charCodeAt(r);return new Blob([i],{type:a})},submitUpload(){this.uploadAction="/product",this.$nextTick(()=>{this.uploadData.appid=Cookies.get("appids"),this.$refs.fileUpload.submit()})},handleUploadSuccess(e,t,a){this.$message({showClose:!0,duration:2e3,type:"success",message:"产品导入成功"}),this.importDialogShow=!1,this.$refs["uploadProForm"].resetFields(),this.searchProduct()},handleUploadError(e,t,a){this.$message({showClose:!0,duration:2e3,showClose:!0,message:e})},handleChange(e,t){t.length>0&&(this.fileList=[t[t.length-1]])},utc2beijing(e){var t=new Date(+new Date(e)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"");return t},searchProduct(e){return k(this,null,(function*(){try{this.listLoading=!0,0==e&&(this.start=0);var t=[];const a={count:"objectId",order:"-updatedAt",limit:this.length,skip:this.start,where:{}};this.formInline.productname&&(a.where.name={$regex:this.formInline.productname});const{results:i=[],count:o=0}=yield this.$query_object("Product",a);i&&(i.map(e=>{""!=e.category&&e.category&&"report"!=e.devType&&t.push(e.category)}),this.listLoading=!1,this.proTableData=i,this.total=o),this.getApps()}catch(a){this.listLoading=!1,dgiotlog.log(a),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+a,"error","dgiot-hey-message-error")}}))},getApps(){this.allApps=this.roleTree},handleClose(){this.dialogFormVisible=!1},chooseTemplate(e){dgiotlog.log("row",e),this.selectedRow=e,this.form.category=e.category,this.cascaderDrawer=!this.cascaderDrawer},handleCloseDialogForm(){this.dialogFormVisible=!1,this.$nextTick(()=>{this.$refs["form"].resetFields()})},properties(e,t="things"){this.descriptions.tableLoading=!0,dgiotlog.log(e),this.descriptions.things=e,this.descriptions.tableType=t,setTimeout(()=>this.descriptions.tableLoading=!1,1200)},addproduct(){this.custom_status="add",this.moduleTitle=this.$translateTitle("product.createproduct"),this.imageUrl="",this.handleNodeClick(this.allApps[0]),this.form={name:"",type:1,category:"",nodeType:3,desc:"",netType:" ",devType:"",productSecret:"",relationApp:this.allApps[0].name,roles:[]},this.dialogFormVisible=!0},getParent(e,t,a){return t.map(i=>{e==i.id?(a.unshift(i.value),this.getParent(i.parentid,t,a)):0==i.parentid&&i.id==e&&a.unshift(i.value)}),this.form.category=a[0],a},getIndustryParent(e,t){t.map(a=>{a.value==e&&this.getParent(a.id,t,[])})},editorParser(e){return k(this,null,(function*(){this.parserFromId=e;try{const{config:t={parser:[]},thing:a={}}=yield Object(l["getProduct"])(e);this.parserTableList=t,dgiotlog.log(this.parserTableList),this.parserDict=_.merge(a,t)}catch(t){this.parserTableList={parser:[]},dgiotlog.log("eeeeeeeeeeeee",t)}this.parserTable=!0}))},editParse(e,t){this.formConfig=t,this.editIndex=e,this.dialogVisible=!0},saveParse(e,t=-1){return k(this,null,(function*(){t+2>0&&(this.parserTableList.parser[t]=_.merge({},e));try{yield Object(l["putProduct"])(this.parserFromId,{config:t+2>0?this.parserTableList:e});this.$message({showClose:!0,duration:2e3,message:this.$translateTitle("user.Save the template successfully"),type:"success"}),this.dialogVisible=!1,this.parserTable=!1}catch(a){this.$baseMessage(this.$translateTitle("user.Save the template error")+""+a,"error","dgiot-hey-message-error"),dgiotlog.log(a,"eeee")}dgiotlog.log(e)}))},previewParse(e){this.parserView=!0,this.formConfig=e,dgiotlog.log("previewParse",e)},addParse(e){e["parser"].push({name:Object(r["uuid"])(6),enname:Object(r["uuid"])(6),config:{}})},deleteParse(e,t){t.splice(e,1)},editorDict(e){return k(this,null,(function*(){this.getAllunit();const t=yield Object(l["getProduct"])(e),{config:a={basedate:{}}}=t;this.productInfo=t,dgiotlog.log(" this.parserDict",this.parserDict),this.editDictTempId=e,this.dictTempForm={name:"",cType:"",enable:"1",description:"",params:[]},this.title_temp_dialog="创建字典模板",dgiotlog.log(a),a.basedate&&a.basedate.name&&(this.title_temp_dialog="修改字典模板",this.dictTempForm=a.basedate),this.rule={name:[{required:!0,message:"请输入字典模板名称",trigger:"blur"}],cType:[{required:!0,message:"请输入字典模板类型",trigger:"blur"}],enable:[{required:!0,message:"请选择状态",trigger:"change"}]},dgiotlog.log(this.dictTempForm,"config"),this.dictVisible=!0}))},editorProduct(e){this.imageUrl="",this.moduleTitle=this.$translateTitle("product.editproduct"),this.custom_status="edit",this.custom_row=e,this.dialogFormVisible=!0,this.productid=e.objectId,this.getIndustryParent(e.category,this.categoryList),this.form.desc=e.desc,this.form.name=e.name,this.form.nodeType=e.nodeType,this.form.netType=e.netType,this.form.devType=e.devType,this.form.productSecret=e.productSecret,e.icon&&(this.imageUrl=e.icon);let t=[];for(var a in e.ACL)t.push(a),a.includes("role")&&(dgiotlog.log(a,"key"),this.form.relationApp=a?a.substr(5):"")},categorylist(){return k(this,null,(function*(){const e={order:"createdAt",keys:"count(*)",where:{level:{$in:[0,1]}}},{results:t}=yield Object(h["queryCategory"])(e);this.categoryList=t,dgiotlog.log("this",this.categoryList)}))},categorytree(){return k(this,null,(function*(){let e=this.queryForm.name.length?'{ "$regex": "'+this.queryForm.name+'"}':'{ "$ne": "null" }';this.listLoading=!0;let t={class:"Category",filter:'{"order": "createdAt","keys":["parent","name","level"],"where":{"level": {"$gte": 1}, "name":'+e+"}}",parent:"parent"};dgiotlog.log(t);const{results:a=[]}=yield Object(g["post_tree"])(t);this.categoryTreeData=a,this.listLoading=!1}))},handleCateSearch(e){if(this.queryForm.category=e,this.showcateTree=!this.showcateTree,"a60a85475a"==e)this.queryProdut({});else{let t={keys:"objectId",where:{parent:{className:"Category",objectId:e,__type:"Pointer"}}};Object(h["queryCategory"])(t).then(t=>{const a=[];a.push(e),t.results.forEach(e=>{a.push(e.objectId)}),dgiotlog.log("ids",a),this.queryProdut({categorys:a})})}},submitForm(){this.form.name,this.form.nodeType,this.form.netType,this.imageUrl,this.form.devType,this.form.desc;this.$refs.form.validate(e=>{e?this.custom_status:this.$message("必填项未填")})},doUpload(e){return k(this,null,(function*(){const t=e.target.files[0],a=this.$baseColorfullLoading(3);try{const e=yield Object(u["ImportParse"])("Product",t);a.close(),dgiotlog.log("eresresrror",e),this.$message({showClose:!0,duration:2e3,message:this.$translateTitle("user.Save the template successfully"),type:"success"})}catch(i){a.close(),dgiotlog.log("error",i),this.$baseMessage(i,"error","dgiot-hey-message-error")}this.$dgiotBus.$emit("reload-router-view")}))},createProduct(e){return k(this,null,(function*(){const t=yield this.$create_object("Product",e);t.objectId?this.initQuery("产品创建成功","success"):this.$message({type:"error",message:t.error,showClose:!0,duration:2e3})}))},editProduct(e){return k(this,null,(function*(){const t=yield this.$update_object("Product",this.custom_row.objectId,e);t.updatedAt?this.initQuery("产品修改成功","success"):this.$message({type:"error",message:t.error,showClose:!0,duration:2e3})}))},initQuery(e,t){this.$message({type:t||"info",message:e,showClose:!0,duration:2e3}),this.dialogFormVisible=!1,this.resetProductForm(),this.$refs["form"].resetFields(),this.searchProduct()},resetProductForm(){this.form={name:"",category:"",nodeType:3,desc:"",netType:"",devType:"",productSecret:"",roles:[],relationApp:""},this.imageUrl=""},deviceToDetail(e){this.$router.push({path:"/roles/detailproduct",query:{id:e.objectId}})},GoTodevices(e){this.$router.push({path:"/roles/thing",query:{productid:e.objectId}})},makeSure(e,t){const a={count:"objectId",skip:0,limit:1,where:{product:e.objectId}};this.$confirm(`此操作将永久删除${e.name}, 是否继续?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>k(this,null,(function*(){const{count:i=0}=Object(c["queryDevice"])(a);i>0?this.$message("请先删除该产品下设备"):(yield Object(l["delProduct"])(e.objectId),this.tableData.splice(t,1))}))).catch(()=>{})},productSizeChange(e){this.length=e,this.searchProduct()},productCurrentChange(e){this.start=(e-1)*this.length,this.searchProduct()},blackDict(e,t){return k(this,null,(function*(){const a={data:t,key:e,type:"Product"},i=yield Object(n["postDict"])(a);i?this.$message({type:"success",message:"备份成功",showClose:!0,duration:2e3}):this.$message({showClose:!0,duration:2e3,type:"error",message:"备份失败"})}))},CloneData(e){return k(this,null,(function*(){const t={category:e.attributes.category,devType:e.attributes.devType,name:e.attributes.name,thing:e.attributes.thing},{objectId:a,code:i}=yield Object(p["getHashClass"])("Product",t);200==i&&this.blackDict(a,t)}))},proudctClone(e){e.attributes.config.cloneState=!0,e.attributes.config.cloneState=!0;const t=e,a=Object(l["putProduct"])(e.id,t);a&&this.CloneData(e)},proudctEdit(e){var t=window.location.origin+"/spa";const{NODE_ENV:a}=Object({NODE_ENV:"production",VUE_APP_TITLE:"物联网开发平台",VUE_APP_AUTHOR:"xxb",VUE_APP_UPDATE_TIME:"2023年01月29日11时07分47秒",VUE_APP_VERSION:"4.7.4",VUE_APP_Keywords:"一站式物联网PaaS平台|物联网应用服务",VUE_APP_Description:"提供物联网垂直领域应用使能平台及解决方案",VUE_APP_URL:"http://1.117.219.8",VUE_APP_CDN_URL:"/dgiot_dashboard/public",BASE_URL:""});t="development"==a?this.$globalConfig.localTopoUrl:window.location.origin+"/spa";var i=`${t}/#?drawProudctid=${e.objectId}&proudctid=${e.objectId}`;localStorage.setItem("rowId",e.objectId),window.open(i,"__blank")},proudctView(e){var t=window.location.origin+"/spa";const{NODE_ENV:a}=Object({NODE_ENV:"production",VUE_APP_TITLE:"物联网开发平台",VUE_APP_AUTHOR:"xxb",VUE_APP_UPDATE_TIME:"2023年01月29日11时07分47秒",VUE_APP_VERSION:"4.7.4",VUE_APP_Keywords:"一站式物联网PaaS平台|物联网应用服务",VUE_APP_Description:"提供物联网垂直领域应用使能平台及解决方案",VUE_APP_URL:"http://1.117.219.8",VUE_APP_CDN_URL:"/dgiot_dashboard/public",BASE_URL:""});t="development"==a?this.$globalConfig.localTopoUrl:window.location.origin+"/spa";var i=`${t}/#/views/${e.objectId}`;window.open(i,"__blank")},goTopoview(){var e=window.location.origin+"/spa";const{NODE_ENV:t}=Object({NODE_ENV:"production",VUE_APP_TITLE:"物联网开发平台",VUE_APP_AUTHOR:"xxb",VUE_APP_UPDATE_TIME:"2023年01月29日11时07分47秒",VUE_APP_VERSION:"4.7.4",VUE_APP_Keywords:"一站式物联网PaaS平台|物联网应用服务",VUE_APP_Description:"提供物联网垂直领域应用使能平台及解决方案",VUE_APP_URL:"http://1.117.219.8",VUE_APP_CDN_URL:"/dgiot_dashboard/public",BASE_URL:""});e="development"==t?this.$globalConfig.localTopoUrl:window.location.origin+"/spa";var a=e+"/#/view";window.open(a,"__blank")},handleImport(){return k(this,null,(function*(){yield this.$refs.uploader.click()}))},exportpro(){return k(this,null,(function*(){const e=this.$baseColorfullLoading(2);try{const t=yield Object(u["ExportParse"])("Product",{});e.close(),this.$convertRes2Blob(t)}catch(t){e.close(),this.$baseMessage(t,"error","dgiot-hey-message-error")}}))}}},I=S,P=(a("b3e1"),a("8048"),a("2877")),j=Object(P["a"])(I,i,o,!1,null,"a96ef730",null);t["default"]=j.exports},5987:function(e,t,a){},"611d":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"proddetail"},[t("dgiot-profile",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{"product-info":e.productInfo}}),t("el-dialog",{staticClass:"map_dialog",attrs:{"append-to-body":"","before-close":e.handleAddressClose,title:"安装位置",visible:e.dialog_address,width:"70%"},on:{"update:visible":function(t){e.dialog_address=t}}},[t("el-card",[t("label",[e._v(" 安装位置： "),t("el-input",{on:{input:e.inputAddress},model:{value:e.productdetail.config.address,callback:function(t){e.$set(e.productdetail.config,"address",t)},expression:"productdetail.config.address"}},[t("i",{staticClass:"el-icon-s-promotion",staticStyle:{cursor:"pointer"},attrs:{slot:"suffix"},slot:"suffix"})])],1),t("baidu-map",{key:e.productdetail.config.location.latitude,staticStyle:{height:"300px"},style:{height:"500px",width:"100%"},attrs:{id:"container",ak:e.ak,center:{lng:e.productdetail.config.location.longitude,lat:e.productdetail.config.location.latitude},"map-click":!1,"scroll-wheel-zoom":!0,zoom:15},on:{click:e.mapClick}},[t("bm-view",{staticClass:"map"}),t("bm-city-list",{attrs:{offset:{width:330,height:0}}}),t("bm-local-search",{attrs:{"auto-viewport":!0,keyword:e.productdetail.config.address,location:{lng:e.productdetail.config.location.longitude,lat:e.productdetail.config.location.latitude}}}),t("bm-control",[t("bm-panorama",{attrs:{anchor:"BMAP_ANCHOR_TOP_LEFT",offset:{width:500,height:0}}}),t("bm-overview-map",{attrs:{"is-open":!0}}),t("bm-scale",{attrs:{offset:{width:260,height:0}}}),t("bm-city-list",{attrs:{offset:{width:450,height:0}}}),t("bm-map-type",{attrs:{anchor:"BMAP_ANCHOR_TOP_LEFT","map-types":["BMAP_NORMAL_MAP","BMAP_HYBRID_MAP"],offset:{width:400,height:0}}})],1),t("bml-marker-clusterer",[t("bm-marker"),t("bm-label")],1),t("bm-navigation",{attrs:{anchor:"BMAP_ANCHOR_TOP_RIGHT"}}),t("bm-geolocation",{attrs:{anchor:"BMAP_ANCHOR_BOTTOM_RIGHT","auto-location":!0,"show-address-bar":!0,"show-zoom-info":!0}})],1)],1)],1),t("div",[t("el-tabs",{ref:"_tabs",on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$translateTitle("product.productinformation"),name:"first"}},[t("div",{staticStyle:{"box-sizing":"border-box",padding:"10px",background:"#ffffff"}},[t("dgiot-query-form",[t("dgiot-query-form-left-panel",{attrs:{disabled:!e.productName.length}},[t("div",{staticClass:"addtopic"},[t("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.exportProduct(e.productName)}}},[e._v(" "+e._s(e.$translateTitle("product.exportpro"))+" ")]),t("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.setTemplate(e.productInfo)}}},[e._v(" "+e._s(e.$translateTitle("product.Set as template"))+" ")])],1)]),t("dgiot-query-form-right-panel",[t("dgiot-help",{attrs:{src:"https://tech.iotn2n.com/w/docs/details?id=6",title:"产品下的所有设备都会继承该产品的 Topic 类",trigger:"click"}})],1)],1),t("div",[t("el-descriptions",{directives:[{name:"loading",rawName:"v-loading",value:""==e.productName,expression:"productName == ''"}],attrs:{border:"",column:3,"element-loading-background":"rgba(0, 0, 0, 0.8)","element-loading-spinner":"el-icon-loading","element-loading-text":e.$translateTitle("developer.Waitingtoreturn"),height:e.$baseTableHeight(0)-60,size:"'medium'"}},[t("el-descriptions-item",{attrs:{label:e.$translateTitle("product.productname")}},[e._v(" "+e._s(e.productdetail.name)+" ")]),t("el-descriptions-item",{attrs:{label:e.$translateTitle("product.ProductSecret")}},[0==e.isshow?t("span",[e._v(" ******************** "),t("el-link",{staticStyle:{"margin-left":"5px",cursor:"pointer"},attrs:{type:"primary",underline:!1},on:{click:function(t){e.isshow=!0}}},[e._v(" "+e._s(e.$translateTitle("product.display"))+" ")])],1):t("span",[t("span",{directives:[{name:"copyText",rawName:"v-copyText",value:e.ProductSecret,expression:"ProductSecret"}]},[e._v(e._s(e.ProductSecret))]),t("el-link",{staticStyle:{"margin-left":"5px",cursor:"pointer"},attrs:{type:"primary",underline:!1},on:{click:function(t){e.isshow=!1}}},[e._v(" "+e._s(e.$translateTitle("product.hidden"))+" ")])],1)]),t("el-descriptions-item",{attrs:{label:e.$translateTitle("product.numberofequipment")}},[t("el-link",{staticStyle:{"margin-left":"10px","font-size":"16px"},attrs:{type:"primary",underline:!1},nativeOn:{click:function(t){return e.goToDevices.apply(null,arguments)}}},[e._v(" "+e._s(e.form.ProductAll)+" ")])],1),t("el-descriptions-item",{attrs:{label:e.$translateTitle("product.nodetype")}},[1==e.productdetail.nodeType?t("td",{staticClass:"notbottom"},[e._v(" "+e._s(e.$translateTitle("product.gateway"))+" ")]):t("td",{staticClass:"notbottom"},[e._v(" "+e._s(e.$translateTitle("product.equipment"))+" ")])]),t("el-descriptions-item",{attrs:{label:e.$translateTitle("product.addingtime")}},[e._v(" "+e._s(e.productdetail.createdAt)+" ")]),t("el-descriptions-item",{attrs:{label:e.$translateTitle("deviceLog.productid")}},[e._v(" "+e._s(e.productdetail.objectId)+" ")]),t("el-descriptions-item",{attrs:{label:e.$translateTitle("product.classification")}},[e._v(" "+e._s(e.productdetail.categoryname)+" ")]),t("el-descriptions-item",[t("template",{slot:"label"},[t("el-tooltip",{staticStyle:{"margin-left":"5px",color:"#cccccc"},attrs:{content:e.$translateTitle("product.text1"),effect:"light",placement:"top"}},[t("i",{staticClass:"el-icon-question"})]),e._v(" "+e._s(e.$translateTitle("product.dynamicregistration"))+" ")],1),0==e.dynamicReg?t("span",{staticStyle:{color:"#cccccc"}},[e._v(" "+e._s(e.$translateTitle("product.close"))+" ")]):t("span",[e._v(e._s(e.$translateTitle("product.open")))]),t("el-switch",{attrs:{"active-color":"#5eb058","active-value":!0,"inactive-color":"#cccccc","inactive-value":!1},on:{change:function(t){return e.handelUpdate(t,e.dynamicReg)}},model:{value:e.dynamicReg,callback:function(t){e.dynamicReg=t},expression:"dynamicReg"}})],2),t("el-descriptions-item",{attrs:{label:e.$translateTitle("product.networking")}},["CELLULAR"==e.productdetail.netType?t("td",[e._v(" "+e._s(e.$translateTitle("product.honeycomb"))+"(2G/3G/4G) ")]):"WIFI"==e.productdetail.netType?t("td",[e._v("WiFi")]):"ETHERNET"==e.productdetail.netType?t("td",[e._v(" "+e._s(e.$translateTitle("product.ethernet"))+" ")]):"LORA"==e.productdetail.netType?t("td",[e._v("LoRaWAN")]):t("td",[e._v(" "+e._s(e.productdetail.netType)+" ")])]),t("el-descriptions-item",{attrs:{label:e.$translateTitle("developer.describe")}},[e._v(" "+e._s(e.productdetail.desc||"")+" ")]),t("el-descriptions-item",{attrs:{label:e.$translateTitle("product.physicalmodel")}},[t("el-button",{attrs:{disabled:0==e.productInfo.thing.properties.length,type:"text"},on:{click:function(t){e.activeName="third"}}},[e._v(" "+e._s(e.productInfo.thing.properties.length||0)+" ")])],1),t("el-descriptions-item",{attrs:{label:e.$translateTitle("konva.notificationtemplate")}},[t("el-button",{attrs:{disabled:0==e.amisproductInfo.length,type:"text"},on:{click:function(t){e.activeName="notification"}}},[e._v(" "+e._s(e.amisproductInfo.length||0)+" ")])],1),t("el-descriptions-item",{attrs:{label:e.$translateTitle("product.productinterval")}},[t("el-input",{staticStyle:{margin:"0 auto"},attrs:{size:"mini",type:"number"},on:{blur:function(t){return e.blurinterval(e.productdetail)}},model:{value:e.productdetail.config.interval,callback:function(t){e.$set(e.productdetail.config,"interval",t)},expression:"productdetail.config.interval"}})],1),t("el-descriptions-item",{attrs:{label:e.$translateTitle("equipment.address")}},[t("el-link",{attrs:{type:"success"},on:{click:function(t){e.dialog_address=!e.dialog_address}}},[e._v(" "+e._s(e.productdetail.config.address||"-")+" ")])],1),t("el-descriptions-item",{attrs:{label:e.$translateTitle("equipment.Longitude and latitude")}},[t("el-link",{attrs:{type:"success"}},[e._v(" "+e._s(e.productdetail.config.location.latitude)+" "+e._s(e.productdetail.config.location.longitude)+" ")])],1)],1)],1)],1)]),t("el-tab-pane",{attrs:{label:"Topic"+e.$translateTitle("product.list"),name:"second"}},[t("div",{staticClass:"card-container"},[t("a-tabs",{attrs:{type:"card"},on:{change:e.topicChange}},[t("a-tab-pane",{key:"basic",attrs:{tab:"基础通信Topic"}},[t("el-table",{ref:"basic",staticStyle:{width:"100%","margin-top":"20px"},attrs:{border:"",data:e.dlinkTopic.basic,"span-method":e.basicMethod}},[t("el-table-column",{attrs:{label:"功能",prop:"category",width:"180"}}),t("el-table-column",{attrs:{label:"topic",prop:"topic"}}),t("el-table-column",{attrs:{label:"描述",prop:"desc"}}),t("el-table-column",{attrs:{label:"唯一标识",prop:"id"}}),t("el-table-column",{attrs:{label:"发布者",prop:"publisher"}}),t("el-table-column",{attrs:{label:"订阅者",prop:"subscribe"}}),t("el-table-column",{attrs:{label:"类型",prop:"type"}})],1)],1),t("a-tab-pane",{key:"thing",attrs:{tab:"物模型通信Topic"}},[t("el-table",{ref:"thing",staticStyle:{width:"100%","margin-top":"20px"},attrs:{border:"",data:e.dlinkTopic.thing,"span-method":e.thingMethod}},[t("el-table-column",{attrs:{label:"功能",prop:"category",width:"180"}}),t("el-table-column",{attrs:{label:"topic",prop:"topic"}}),t("el-table-column",{attrs:{label:"描述",prop:"desc"}}),t("el-table-column",{attrs:{label:"描述",prop:"type"}})],1)],1),t("a-tab-pane",{key:"user",attrs:{tab:"自定义Topic"}},[t("div",{staticStyle:{"box-sizing":"border-box",padding:"10px",background:"#ffffff"}},[t("dgiot-query-form",[t("dgiot-query-form-left-panel",[t("div",{staticClass:"addtopic"},[t("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){e.topicdialogVisible=!0}}},[e._v(" "+e._s(e.$translateTitle("product.customtopicclass"))+" ")])],1)]),t("dgiot-query-form-right-panel",[t("dgiot-help",{attrs:{src:"https://tech.iotn2n.com/w/docs/details?id=6",title:"产品下的所有设备都会继承该产品的 Topic 类",trigger:"click"}})],1)],1),t("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.topicData,height:e.$baseTableHeight(0)-60},scopedSlots:e._u([{key:"empty",fn:function(){return[t("el-image",{staticClass:"dgiot-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[t("el-table-column",{attrs:{align:"center",label:"name",prop:"name","show-overflow-tooltip":"",sortable:"",width:"auto"}}),t("el-table-column",{attrs:{align:"center",label:"value",prop:"value","show-overflow-tooltip":"",sortable:"",width:"auto"}}),t("el-table-column",{attrs:{align:"center",label:"topic",prop:"topic","show-overflow-tooltip":"",sortable:"",width:"auto"}}),t("el-table-column",{attrs:{align:"center",label:"描述",prop:"desc","show-overflow-tooltip":"",sortable:"",width:"auto"}}),t("el-table-column",{attrs:{align:"center",label:"唯一标识",prop:"id","show-overflow-tooltip":"",sortable:"",width:"auto"}}),t("el-table-column",{attrs:{align:"center",label:"发布者",prop:"publisher","show-overflow-tooltip":"",sortable:"",width:"100"}}),t("el-table-column",{attrs:{align:"center",label:"订阅者",prop:"subscribe","show-overflow-tooltip":"",sortable:"",width:"100"}}),t("el-table-column",{attrs:{align:"center",label:"订阅类型",prop:"type","show-overflow-tooltip":"",sortable:"",width:"100"}}),t("el-table-column",{attrs:{align:"center",label:"所属类型",prop:"info","show-overflow-tooltip":"",sortable:"",width:"100"}}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.operation")},scopedSlots:e._u([{key:"default",fn:function({row:a,$index:i}){return[t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.updatetopic(a,i)}}},[e._v(" "+e._s(e.$translateTitle("developer.edit"))+" ")]),t("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},nativeOn:{click:function(t){return e.deletetopic(e.topicData,a,i)}},slot:"reference"},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])]}}])})],1)],1)])],1)],1),t("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("product.definetopicclass"),visible:e.topicdialogVisible,width:"40%"},on:{"update:visible":function(t){e.topicdialogVisible=t}}},[t("div",{staticClass:"topiccontent"},[t("div",{staticStyle:{"box-sizing":"border-box",padding:"10px","font-size":"16px",background:"#e6f9fc"}},[t("i",{staticClass:"el-icon-warning"}),e._v(" "+e._s(e.$translateTitle("product.text2"))+" ")]),t("div",{staticClass:"topicform"},[t("el-form",{ref:"topicform",attrs:{model:e.topicform,rules:e.topicrule}},[t("el-form-item",{attrs:{label:"所属类型：",prop:"info"}},[t("el-radio-group",{model:{value:e.topicform.info,callback:function(t){e.$set(e.topicform,"info",t)},expression:"topicform.info"}},[t("el-radio",{attrs:{label:"basic"}},[e._v("基础通信")]),t("el-radio",{attrs:{label:"thing"}},[e._v("物模型通信")])],1)],1),t("el-form-item",{attrs:{label:"官方 Topic：",prop:"topic"}},[t("el-select",{staticStyle:{float:"left",width:"91%"},attrs:{"allow-create":"",filterable:"",placeholder:"请选择活动区域"},model:{value:e.topicform.topic,callback:function(t){e.$set(e.topicform,"topic",t)},expression:"topicform.topic"}},e._l(e.dlinkTopic[e.topicform.info],(function(a,i){return t("el-option",{key:i,attrs:{label:a.topic,value:a.id}},[t("span",{staticStyle:{float:"left"}},[e._v(e._s(a.topic))]),t("span",{staticStyle:{float:"right","font-size":"13px",color:"#8492a6"}},[e._v(" "+e._s(a.id)+" ")])])})),1),t("dgiot-help",{staticStyle:{width:"60px","margin-top":"24px"},attrs:{src:"https://gitee.com/dgiiot/dgiot_dlink",title:"产品下的所有设备都会继承该产品的 Topic 类",trigger:"click"}})],1),t("el-form-item",{attrs:{label:"Topic value：",prop:"topic"}},[t("el-input",{staticStyle:{float:"left",width:"100%"},model:{value:e.topicform.value,callback:function(t){e.$set(e.topicform,"value",t)},expression:"topicform.value"}})],1)],1)],1)]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{nativeOn:{click:function(t){e.topicdialogVisible=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.subTopic("topicform",e.topicform.isupdated)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)])],1),t("el-tab-pane",{attrs:{label:e.$translateTitle("product.physicalmodel"),name:"third"}},[t("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("product.addMachine"),visible:e.machine,width:"30%"},on:{"update:visible":function(t){e.machine=t}}},[t("div",[t("el-form",{ref:"sizeForm",attrs:{"label-position":"left","label-width":"80px",model:e.machineForm,size:"mini"}},[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:e.$translateTitle("product.devicetype"),prop:"devicetype"}},[t("el-input",{model:{value:e.machineForm.name,callback:function(t){e.$set(e.machineForm,"name",t)},expression:"machineForm.name"}})],1)],1)],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){e.machine=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),t("el-button",{attrs:{size:"mini"},nativeOn:{click:function(t){return e.savemachine(e.machineForm)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)]),t("div",[t("a-drawer",{attrs:{closable:!1,title:e.wmxSituation+"物模型事件",visible:e.atbas.visible&&"events"===e.modules.type,width:"620"},on:{close:e.onClose}},[t("el-form",{directives:[{name:"show",rawName:"v-show",value:"services"==e.modules.type,expression:"modules.type == 'services'"}],ref:"services",attrs:{"label-position":"right","label-width":"80px",model:e.modules.services.data,rules:e.modules.services.rules,size:"mini"}},[t("el-form-item",{attrs:{label:"功能名称",prop:"name"}},[t("el-input",{model:{value:e.modules.services.data.name,callback:function(t){e.$set(e.modules.services.data,"name",t)},expression:"modules.services.data.name"}})],1),t("el-form-item",{attrs:{label:"标识符",prop:"identifier"}},[t("el-input",{model:{value:e.modules.services.data.identifier,callback:function(t){e.$set(e.modules.services.data,"identifier",t)},expression:"modules.services.data.identifier"}})],1),t("el-form-item",{attrs:{label:"调用方式",prop:"transfer"}},[t("el-radio-group",{attrs:{size:"mini"},model:{value:e.modules.services.data.transfer,callback:function(t){e.$set(e.modules.services.data,"transfer",t)},expression:"modules.services.data.transfer"}},[t("el-radio",{attrs:{border:"",label:"sync"}},[e._v("同步")]),t("el-radio",{attrs:{border:"",label:"async"}},[e._v("异步")])],1)],1),t("el-form-item",{attrs:{label:"输入参数",prop:"enter"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择输出参数"},model:{value:e.modules.services.data.enter,callback:function(t){e.$set(e.modules.services.data,"enter",t)},expression:"modules.services.data.enter"}},e._l(e.wmxDataBk,(function(a){return t("el-option",{key:a.name,attrs:{label:a.name,value:a.identifier}},[t("span",{staticStyle:{float:"left"}},[e._v(e._s(a.name))]),t("span",{staticStyle:{float:"right","font-size":"13px",color:"#8492a6"}},[e._v(" "+e._s(a.name)+" ")])])})),1)],1),t("el-form-item",{attrs:{label:"输出参数",prop:"output"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择输出参数"},model:{value:e.modules.services.data.output,callback:function(t){e.$set(e.modules.services.data,"output",t)},expression:"modules.services.data.output"}},e._l(e.wmxDataBk,(function(a){return t("el-option",{key:a.name,attrs:{label:a.identifier,value:a.identifier}},[t("span",{staticStyle:{float:"left"}},[e._v(e._s(a.name))]),t("span",{staticStyle:{float:"right","font-size":"13px",color:"#8492a6"}},[e._v(" "+e._s(a.identifier)+" ")])])})),1)],1),t("el-form-item",{attrs:{label:"描述",prop:"describe"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.modules.services.data.describe,callback:function(t){e.$set(e.modules.services.data,"describe",t)},expression:"modules.services.data.describe"}})],1),t("el-form-item",{staticStyle:{"text-align":"center"},attrs:{size:"large"}},[t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.submitModules("services",e.modules.services)}}},[e._v(" 确认 ")]),t("el-button",{attrs:{size:"mini"},nativeOn:{click:function(t){return e.handleClose.apply(null,arguments)}}},[e._v(" 取消 ")])],1)],1),t("el-form",{directives:[{name:"show",rawName:"v-show",value:"events"==e.modules.type,expression:"modules.type == 'events'"}],ref:"events",attrs:{"label-position":"right","label-width":"80px",model:e.modules.events.data,rules:e.modules.events.rules,size:"mini"}},[t("el-form-item",{attrs:{label:"功能名称",prop:"name"}},[t("el-input",{model:{value:e.modules.events.data.name,callback:function(t){e.$set(e.modules.events.data,"name",t)},expression:"modules.events.data.name"}})],1),t("el-form-item",{attrs:{label:"标识符",prop:"identifier"}},[t("el-input",{model:{value:e.modules.events.data.identifier,callback:function(t){e.$set(e.modules.events.data,"identifier",t)},expression:"modules.events.data.identifier"}})],1),t("el-form-item",{attrs:{label:"事件类型",prop:"types"}},[t("el-radio-group",{attrs:{size:"mini"},model:{value:e.modules.events.data.types,callback:function(t){e.$set(e.modules.events.data,"types",t)},expression:"modules.events.data.types"}},[t("el-radio",{attrs:{label:"info"}},[e._v("信息")]),t("el-radio",{attrs:{label:"warning"}},[e._v("告警")]),t("el-radio",{attrs:{label:"error"}},[e._v("故障")])],1)],1),t("el-form-item",{attrs:{label:"输出参数",prop:"output"}},[t("a-list",{attrs:{"data-source":e.modules.events.data.output,"item-layout":"horizontal"},scopedSlots:e._u([{key:"renderItem",fn:function(a,i){return t("a-list-item",{},[t("el-button",{attrs:{slot:"actions",type:"info"},nativeOn:{click:function(t){return e.editEvent(a,i,"output")}},slot:"actions"},[e._v(" 编辑 ")]),t("el-button",{attrs:{slot:"actions",size:"mini",type:"danger"},nativeOn:{click:function(t){return e.modules.events.data.output.splice(i,1)}},slot:"actions"},[e._v(" 删除 ")]),t("a-list-item-meta",{staticStyle:{border:"1px solid #e1e2e5"}},[t("el-tag",{attrs:{slot:"title",type:"success"},slot:"title"},[e._v(" 参数名称:"+e._s(a.identifier)+" ")])],1)],1)}}])}),t("el-link",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.showChildrenDrawer.apply(null,arguments)}}},[t("a-icon",{attrs:{type:"plus"}}),e._v(" 增加参数 ")],1)],1),t("el-form-item",{attrs:{label:"描述",prop:"describe"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.modules.events.data.describe,callback:function(t){e.$set(e.modules.events.data,"describe",t)},expression:"modules.events.data.describe"}})],1),t("el-form-item",{staticStyle:{"text-align":"center"},attrs:{size:"large"}},[t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.submitModules("events",e.modules.events)}}},[e._v(" 确认 ")]),t("el-button",{attrs:{size:"mini"},nativeOn:{click:function(t){return e.handleClose.apply(null,arguments)}}},[e._v(" 取消 ")])],1)],1),t("a-drawer",{attrs:{closable:!1,title:"add"==e.eventType?"新增":"修改"+e.thingType=="events"?"事件定义":"服务定义",visible:e.atbas.childrenDrawer,width:"550"},on:{close:e.onChildrenDrawerClose}},[t("thing-form",{ref:"thingForm",attrs:{"dlink-unit":e.dlinkUnit,"event-type":e.eventType,"form-type":e.formType,"rule-form":e.eventForm},on:{OutputParameters:e.thingParameters,editParameters:e.editParameters}})],1),t("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"}})],1),t("a-drawer",{attrs:{closable:!1,title:e.wmxSituation+"物模型服务",visible:e.atbas.visible&&"services"===e.modules.type,width:"620"},on:{close:e.onClose}},[t("el-form",{directives:[{name:"show",rawName:"v-show",value:"services"==e.modules.type,expression:"modules.type == 'services'"}],ref:"services",attrs:{"label-position":"right","label-width":"80px",model:e.modules.services.data,rules:e.modules.services.rules,size:"mini"}},[t("el-form-item",{attrs:{label:"功能名称",prop:"name"}},[t("el-input",{model:{value:e.modules.services.data.name,callback:function(t){e.$set(e.modules.services.data,"name",t)},expression:"modules.services.data.name"}})],1),t("el-form-item",{attrs:{label:"标识符",prop:"identifier"}},[t("el-input",{model:{value:e.modules.services.data.identifier,callback:function(t){e.$set(e.modules.services.data,"identifier",t)},expression:"modules.services.data.identifier"}})],1),t("el-form-item",{attrs:{label:"调用方式",prop:"transfer"}},[t("el-radio-group",{attrs:{size:"mini"},model:{value:e.modules.services.data.transfer,callback:function(t){e.$set(e.modules.services.data,"transfer",t)},expression:"modules.services.data.transfer"}},[t("el-radio",{attrs:{border:"",label:"sync"}},[e._v("同步")]),t("el-radio",{attrs:{border:"",label:"async"}},[e._v("异步")])],1)],1),t("el-form-item",{attrs:{label:"输入参数",prop:"enter"}},[t("a-list",{attrs:{"data-source":e.modules.services.data.enter,"item-layout":"horizontal"},scopedSlots:e._u([{key:"renderItem",fn:function(a,i){return t("a-list-item",{},[t("el-button",{attrs:{slot:"actions",type:"info"},nativeOn:{click:function(t){return e.editEvent(a,i,"enter")}},slot:"actions"},[e._v(" 编辑 ")]),t("el-button",{attrs:{slot:"actions",size:"mini",type:"danger"},nativeOn:{click:function(t){return e.modules.services.data.enter.splice(i,1)}},slot:"actions"},[e._v(" 删除 ")]),t("a-list-item-meta",{staticStyle:{border:"1px solid #e1e2e5"}},[t("el-tag",{attrs:{slot:"title",type:"success"},slot:"title"},[e._v(" 参数名称:"+e._s(a.identifier)+" ")])],1)],1)}}])}),t("el-link",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.showChildrenDrawer.apply(null,arguments)}}},[t("a-icon",{attrs:{type:"plus"}}),e._v(" 增加参数 ")],1)],1),t("el-form-item",{attrs:{label:"输出参数",prop:"output"}},[t("a-list",{attrs:{"data-source":e.modules.services.data.output,"item-layout":"horizontal"},scopedSlots:e._u([{key:"renderItem",fn:function(a,i){return t("a-list-item",{},[t("el-button",{attrs:{slot:"actions",type:"info"},nativeOn:{click:function(t){return e.editEvent(a,i,"output")}},slot:"actions"},[e._v(" 编辑 ")]),t("el-button",{attrs:{slot:"actions",size:"mini",type:"danger"},nativeOn:{click:function(t){return e.modules.services.data.output.splice(i,1)}},slot:"actions"},[e._v(" 删除 ")]),t("a-list-item-meta",{staticStyle:{border:"1px solid #e1e2e5"}},[t("el-tag",{attrs:{slot:"title",type:"success"},slot:"title"},[e._v(" 参数名称:"+e._s(a.identifier)+" ")])],1)],1)}}])}),t("el-link",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.showChildrenDrawer.apply(null,arguments)}}},[t("a-icon",{attrs:{type:"plus"}}),e._v(" 增加参数 ")],1)],1),t("el-form-item",{attrs:{label:"描述",prop:"describe"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.modules.services.data.describe,callback:function(t){e.$set(e.modules.services.data,"describe",t)},expression:"modules.services.data.describe"}})],1),t("el-form-item",{staticStyle:{"text-align":"center"},attrs:{size:"large"}},[t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.submitModules("services",e.modules.services)}}},[e._v(" 确认 ")]),t("el-button",{attrs:{size:"mini"},nativeOn:{click:function(t){return e.handleClose.apply(null,arguments)}}},[e._v(" 取消 ")])],1)],1),t("el-form",{directives:[{name:"show",rawName:"v-show",value:"events"==e.modules.type,expression:"modules.type == 'events'"}],ref:"events",attrs:{"label-position":"right","label-width":"80px",model:e.modules.events.data,rules:e.modules.events.rules,size:"mini"}},[t("el-form-item",{attrs:{label:"功能名称",prop:"name"}},[t("el-input",{model:{value:e.modules.events.data.name,callback:function(t){e.$set(e.modules.events.data,"name",t)},expression:"modules.events.data.name"}})],1),t("el-form-item",{attrs:{label:"标识符",prop:"identifier"}},[t("el-input",{model:{value:e.modules.events.data.identifier,callback:function(t){e.$set(e.modules.events.data,"identifier",t)},expression:"modules.events.data.identifier"}})],1),t("el-form-item",{attrs:{label:"事件类型",prop:"types"}},[t("el-radio-group",{attrs:{size:"mini"},model:{value:e.modules.events.data.types,callback:function(t){e.$set(e.modules.events.data,"types",t)},expression:"modules.events.data.types"}},[t("el-radio",{attrs:{label:"info"}},[e._v("信息")]),t("el-radio",{attrs:{label:"warning"}},[e._v("告警")]),t("el-radio",{attrs:{label:"error"}},[e._v("故障")])],1)],1),t("el-form-item",{attrs:{label:"输出参数",prop:"output"}},[t("a-list",{attrs:{"data-source":e.modules.events.data.output,"item-layout":"horizontal"},scopedSlots:e._u([{key:"renderItem",fn:function(a,i){return t("a-list-item",{},[t("el-button",{attrs:{slot:"actions",type:"info"},nativeOn:{click:function(t){return e.editEvent(a,i,"output")}},slot:"actions"},[e._v(" 编辑 ")]),t("el-button",{attrs:{slot:"actions",size:"mini",type:"danger"},nativeOn:{click:function(t){return e.modules.events.data.output.splice(i,1)}},slot:"actions"},[e._v(" 删除 ")]),t("a-list-item-meta",{staticStyle:{border:"1px solid #e1e2e5"}},[t("el-tag",{attrs:{slot:"title",type:"success"},slot:"title"},[e._v(" 参数名称:"+e._s(a.identifier)+" ")])],1)],1)}}])}),t("el-link",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.showChildrenDrawer.apply(null,arguments)}}},[t("a-icon",{attrs:{type:"plus"}}),e._v(" 增加参数 ")],1)],1),t("el-form-item",{attrs:{label:"描述",prop:"describe"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.modules.events.data.describe,callback:function(t){e.$set(e.modules.events.data,"describe",t)},expression:"modules.events.data.describe"}})],1),t("el-form-item",{staticStyle:{"text-align":"center"},attrs:{size:"large"}},[t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.submitModules("events",e.modules.events)}}},[e._v(" 确认 ")]),t("el-button",{attrs:{size:"mini"},nativeOn:{click:function(t){return e.handleClose.apply(null,arguments)}}},[e._v(" 取消 ")])],1)],1),t("a-drawer",{attrs:{closable:!1,title:(e.eventType,"events"==e.thingType?"事件定义":"服务定义"),visible:e.atbas.childrenDrawer,width:"550"},on:{close:e.onChildrenDrawerClose}},[t("thing-form",{ref:"thingForm",attrs:{"dlink-unit":e.dlinkUnit,"event-type":e.eventType,"rule-form":e.eventForm},on:{OutputParameters:e.thingParameters,editParameters:e.editParameters}})],1),t("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"}})],1)],1),t("el-tabs",{on:{"tab-click":e.handleChildClick},model:{value:e.tabsChild,callback:function(t){e.tabsChild=t},expression:"tabsChild"}},[t("el-tab-pane",{attrs:{label:"属性定义",name:"properties"}},[t("div",[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{lg:4,md:5,sm:6,xl:3,xs:24}},[t("dgiot-query-form",{staticClass:"query-form"},[t("dgiot-query-form-top-panel",[t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.addMachine.apply(null,arguments)}}},[e._v(" 添加类型 ")])],1)],1),t("el-table",{staticStyle:{width:"60vh",overflow:"auto"},attrs:{border:"",data:e.FromMachine,height:e.$baseTableHeight(0)-60,"row-class-name":e.tableRowClassName},on:{"row-click":e.clickmachine},scopedSlots:e._u([{key:"empty",fn:function(){return[t("el-image",{staticClass:"dgiot-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[t("el-table-column",{attrs:{align:"center",label:"序号",prop:"sort",width:"50"},scopedSlots:e._u([{key:"default",fn:function({$index:a}){return[t("span",[e._v(" "+e._s(a+1)+" ")])]}}])}),t("el-table-column",{attrs:{align:"center",label:"设备类型",prop:"name"}})],1)],1),t("el-col",{attrs:{lg:20,md:19,sm:18,xl:21,xs:24}},[t("dgiot-query-form",{staticClass:"query-form"},[t("dgiot-query-form-right-panel",{staticStyle:{width:"100%"}},[t("div",{staticClass:"stripe-panel"},[t("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.checkAddTest.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.collectionformulaofobjectmodel"))+" ")]),t("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.checkschema.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.viewobjectmodel"))+" ")]),t("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.createThing("properties")}}},[e._v(" "+e._s(e.$translateTitle("product.newcustomattribute"))+" ")])],1)])],1),t("el-table",{key:"tabsChild",staticStyle:{width:"100%","margin-top":"10px"},attrs:{border:"",data:e.wmxData.slice((e.wmxstart-1)*e.wmxPageSize,e.wmxstart*e.wmxPageSize),"default-expand-all":!1,"default-sort":{prop:"date",order:"descending"},height:e.$baseTableHeight(0)-60,"row-key":"identifier"},scopedSlots:e._u([{key:"empty",fn:function(){return[t("el-image",{staticClass:"dgiot-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[t("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-descriptions",{attrs:{border:"",column:4,direction:"vertical"}},[t("el-descriptions-item",{attrs:{label:"采集轮次"}},[e._v(" "+e._s(a.row.dataForm.round)+" ")]),t("el-descriptions-item",{attrs:{label:e.$translateTitle("product.functionaltypes")}},[e._v(" "+e._s(e.$translateTitle("product.attribute"))+" ")])],1)]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.order"),width:"60"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v(" "+e._s(t.dataForm.order)+" ")]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.devicetype"),prop:"devicetype"}}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.Strategy")},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v(" "+e._s(t.dataForm.strategy)+" ")]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.protocol")},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v(" "+e._s(t.dataForm.protocol)+" ")]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.identifier"),prop:"identifier"}}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.functionname"),prop:"name"}}),t("el-table-column",{attrs:{align:"center",label:"是否展示",prop:"name",width:"100"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("a-switch",{attrs:{checked:a.isshow,"checked-children":"展示","un-checked-children":"不展示"},on:{click:function(t){return e.toggleSwitch(a)}}})]}}])}),t("el-table-column",{attrs:{align:"center",label:"是否存储",prop:"name",width:"100"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("a-switch",{attrs:{checked:a.isstorage,"checked-children":"存储","un-checked-children":"不存储"},on:{click:function(t){return e.toggleStore(a)}}})]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.datatype"),width:"90"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.dataType.type))])]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.datadefinition")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[!a.dataType.specs||"double"!=a.dataType.type&&"float"!=a.dataType.type&&"long"!=a.dataType.type&&"int"!=a.dataType.type?"text"==a.dataType.type?t("span",[e._v(" "+e._s(e.$translateTitle("product.datalength")+":"+a.dataType.size+e.$translateTitle("product.byte"))+" ")]):"date"==a.dataType.type?t("span"):"struct"!=a.dataType.type?t("span",[e._v(" "+e._s(a.dataType.specs)+" ")]):t("span"):t("span",[e._v(" "+e._s(e.$translateTitle("product.rangeofvalues")+a.dataType.specs.min+"~"+a.dataType.specs.max)+" ")])]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.operation"),width:"160"},scopedSlots:e._u([{key:"default",fn:function({row:a,$index:i}){return[t("el-button",{attrs:{size:"mini",type:"danger"},nativeOn:{click:function(t){return e.deletewmx(a,i)}}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")]),t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.wmxDataFill(a,i,"properties")}}},[e._v(" "+e._s(e.$translateTitle("task.Edit"))+" ")])]}}])})],1),t("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.wmxPageSize,"page-sizes":[10,20,30,50],total:e.wmxData.length},on:{"current-change":e.wmxCurrentChange,"size-change":e.wmxSizeChange}})],1)],1)],1)]),t("el-tab-pane",{attrs:{label:"事件定义",name:"events"}},[t("dgiot-query-form",{staticClass:"query-form"},[t("dgiot-query-form-right-panel",{staticStyle:{width:"100%"}},[t("div",{staticClass:"stripe-panel"},[t("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.checkschema.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.viewobjectmodel"))+" ")]),t("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.createThing("events")}}},[e._v(" 新增事件 ")])],1)])],1),t("el-table",{key:"tabsChild",staticStyle:{width:"100%","margin-top":"10px"},attrs:{border:"",data:e.modules.data.events.slice((e.eventsStart-1)*e.eventsPageSize,e.eventsStart*e.eventsPageSize),"default-sort":{prop:"date",order:"descending"},height:e.$baseTableHeight(0)-60,"row-key":"identifier"},scopedSlots:e._u([{key:"empty",fn:function(){return[t("el-image",{staticClass:"dgiot-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[t("el-table-column",{attrs:{prop:"输出参数",type:"expand"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form",{staticClass:"demo-table-expand",attrs:{inline:"","label-position":"left"}},e._l(a.row.output,(function(a,i){return t("a-descriptions",{key:i,attrs:{bordered:"",title:"输出参数:"+a.name}},[t("a-descriptions-item",{attrs:{label:"标识符"}},[e._v(" "+e._s(a.identifier)+" ")]),t("a-descriptions-item",{attrs:{label:"数据类型"}},[e._v(" "+e._s(a.dataType)+" ")]),t("a-descriptions-item",{attrs:{label:"取值范围"}},[e._v(" 最小值:"+e._s(a.min)+" 最大值:"+e._s(a.max)+" ")]),t("a-descriptions-item",{attrs:{label:"步长"}},[e._v(" "+e._s(a.step)+" ")]),t("a-descriptions-item",{attrs:{label:"单位"}},e._l(e.dlinkUnit,(function(i,o){return t("el-tag",{directives:[{name:"show",rawName:"v-show",value:i.Symbol==a.unit,expression:"Unit.Symbol == item.unit"}],key:o,attrs:{type:"success"}},[t("span",[e._v(" "+e._s(i.Name)+" ")])])})),1),t("a-descriptions-item",{attrs:{label:"读写类型"}},[e._v(" "+e._s("rw"==a.isread?"读写":"只读")+" ")])],1)})),1)]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.order"),prop:"dataForm.order",sortable:"",width:"auto"}}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.identifier"),prop:"identifier",width:"auto"}}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.functionname"),prop:"name"}}),t("el-table-column",{attrs:{align:"center",label:"事件类型",prop:"types",sortable:""},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(" "+e._s(["信息","告警","故障"][["info","warning","error"].indexOf(a.types)])+" ")])]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.operation"),width:"160"},scopedSlots:e._u([{key:"default",fn:function({row:a,$index:i}){return[t("el-button",{attrs:{size:"mini",type:"danger"},nativeOn:{click:function(t){return e.deletewmx(a,i)}}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")]),t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.wmxDataFill(a,i,"events")}}},[e._v(" "+e._s(e.$translateTitle("task.Edit"))+" ")])]}}])})],1),t("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.eventsPageSize,"page-sizes":[10,20,30,50],total:e.modules.data.events.length},on:{"current-change":e.eventsCurrentChange,"size-change":e.eventsChange}})],1),t("el-tab-pane",{attrs:{label:"服务定义",name:"services"}},[t("dgiot-query-form",{staticClass:"query-form"},[t("dgiot-query-form-right-panel",{staticStyle:{width:"100%"}},[t("div",{staticClass:"stripe-panel"},[t("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.checkschema.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.viewobjectmodel"))+" ")]),t("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.createThing("services")}}},[e._v(" 新增服务 ")])],1)])],1),t("el-table",{key:"tabsChild",staticStyle:{width:"100%","margin-top":"10px"},attrs:{border:"",data:e.modules.data.services.slice((e.servicesStart-1)*e.servicesPageSize,e.servicesStart*e.servicesPageSize),"default-sort":{prop:"date",order:"descending"},height:e.$baseTableHeight(0)-60,"row-key":"identifier"},scopedSlots:e._u([{key:"empty",fn:function(){return[t("el-image",{staticClass:"dgiot-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[t("el-table-column",{attrs:{prop:"输出参数",type:"expand"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form",{staticClass:"demo-table-expand",attrs:{inline:"","label-position":"left"}},e._l(a.row.enter,(function(a,i){return t("a-descriptions",{key:i,attrs:{bordered:"",title:"输入参数:"+a.name}},[t("a-descriptions-item",{attrs:{label:"标识符"}},[e._v(" "+e._s(a.identifier)+" ")]),t("a-descriptions-item",{attrs:{label:"数据类型"}},[e._v(" "+e._s(a.dataType)+" ")]),t("a-descriptions-item",{attrs:{label:"取值范围"}},[e._v(" 最小值:"+e._s(a.min)+" 最大值:"+e._s(a.max)+" ")]),t("a-descriptions-item",{attrs:{label:"步长"}},[e._v(" "+e._s(a.step)+" ")]),t("a-descriptions-item",{attrs:{label:"单位"}},e._l(e.dlinkUnit,(function(i,o){return t("el-tag",{directives:[{name:"show",rawName:"v-show",value:i.Symbol==a.unit,expression:"Unit.Symbol == item.unit"}],key:o,attrs:{type:"success"}},[t("span",[e._v(" "+e._s(i.Name)+" ")])])})),1),t("a-descriptions-item",{attrs:{label:"读写类型"}},[e._v(" "+e._s("rw"==a.isread?"读写":"只读")+" ")])],1)})),1),t("el-form",{staticClass:"demo-table-expand",attrs:{inline:"","label-position":"left"}},e._l(a.row.output,(function(a,i){return t("a-descriptions",{key:i,attrs:{bordered:"",title:"输出参数:"+a.name}},[t("a-descriptions-item",{attrs:{label:"标识符"}},[e._v(" "+e._s(a.identifier)+" ")]),t("a-descriptions-item",{attrs:{label:"数据类型"}},[e._v(" "+e._s(a.dataType)+" ")]),t("a-descriptions-item",{attrs:{label:"取值范围"}},[e._v(" 最小值:"+e._s(a.min)+" 最大值:"+e._s(a.max)+" ")]),t("a-descriptions-item",{attrs:{label:"步长"}},[e._v(" "+e._s(a.step)+" ")]),t("a-descriptions-item",{attrs:{label:"单位"}},e._l(e.dlinkUnit,(function(i,o){return t("el-tag",{directives:[{name:"show",rawName:"v-show",value:i.Symbol==a.unit,expression:"Unit.Symbol == item.unit"}],key:o,attrs:{type:"success"}},[t("span",[e._v(" "+e._s(i.Name)+" ")])])})),1),t("a-descriptions-item",{attrs:{label:"读写类型"}},[e._v(" "+e._s("rw"==a.isread?"读写":"只读")+" ")])],1)})),1)]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.order"),width:"60"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v(" "+e._s(t.dataForm.order)+" ")]}}])}),t("el-table-column",{attrs:{align:"center",label:"标识符",prop:"identifier",width:"auto"}}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.datatype"),width:"auto"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.dataType.type))])]}}])}),t("el-table-column",{attrs:{align:"center",label:"调用方式",prop:"types",sortable:""},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(" "+e._s(["同步","异步"][["sync","async"].indexOf(a.transfer)])+" ")])]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.operation"),width:"160"},scopedSlots:e._u([{key:"default",fn:function({row:a,$index:i}){return[t("el-button",{attrs:{size:"mini",type:"danger"},nativeOn:{click:function(t){return e.deletewmx(a,i)}}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")]),t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.wmxDataFill(a,i,"services")}}},[e._v(" "+e._s(e.$translateTitle("task.Edit"))+" ")])]}}])})],1),t("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.servicesPageSize,"page-sizes":[10,20,30,50],total:e.modules.data.services.length},on:{"current-change":e.serverCurrentChange,"size-change":e.serverSizeChange}})],1),t("el-tab-pane",{attrs:{label:"标签定义",name:"tags"}},[t("dgiot-query-form",{staticClass:"query-form"},[t("dgiot-query-form-right-panel",{staticStyle:{width:"100%"}},[t("div",{staticClass:"stripe-panel"},[t("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.checkschema.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.viewobjectmodel"))+" ")]),t("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.createThing("tags")}}},[e._v(" 新增标签 ")])],1)])],1),t("el-table",{key:"tabsChild",staticStyle:{width:"100%","margin-top":"10px"},attrs:{border:"",data:e.modules.data.tags.slice((e.tagsStart-1)*e.tagsPageSize,e.tagsStart*e.tagsPageSize),"default-sort":{prop:"date",order:"descending"},height:e.$baseTableHeight(0)-60,"row-key":"identifier"},scopedSlots:e._u([{key:"empty",fn:function(){return[t("el-image",{staticClass:"dgiot-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.order"),width:"60"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v(" "+e._s(t.dataForm.order)+" ")]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.identifier"),prop:"identifier",width:"100"}}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.functionname"),prop:"name"}}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.datatype"),width:"90"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.dataType.type))])]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.datadefinition")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[!a.dataType.specs||"double"!=a.dataType.type&&"float"!=a.dataType.type&&"int"!=a.dataType.type?"string"==a.dataType.type?t("span",[e._v(" "+e._s(e.$translateTitle("product.datalength")+":"+a.dataType.size+e.$translateTitle("product.byte"))+" ")]):"date"==a.dataType.type?t("span"):"struct"!=a.dataType.type?t("span",[e._v(" "+e._s(a.dataType.specs)+" ")]):t("span"):t("span",[e._v(" "+e._s(e.$translateTitle("product.rangeofvalues")+a.dataType.specs.min+"~"+a.dataType.specs.max)+" ")])]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.operation"),width:"160"},scopedSlots:e._u([{key:"default",fn:function({row:a,$index:i}){return[t("el-button",{attrs:{size:"mini",type:"danger"},nativeOn:{click:function(t){return e.deletewmx(a,i)}}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")]),t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.wmxDataFill(a,i,"tags")}}},[e._v(" "+e._s(e.$translateTitle("task.Edit"))+" ")])]}}])})],1),t("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.tagsPageSize,"page-sizes":[10,20,30,50],total:e.modules.data.tags.length},on:{"current-change":e.tagsCurrentChange,"size-change":e.tagsSizeChange}})],1)],1),t("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("product.addfunction"),visible:e.originwmx,width:"50%"},on:{"update:visible":function(t){e.originwmx=t}}},[t("div",[t("div",{staticStyle:{margin:"20px 0"}},[t("label",{attrs:{for:""}},[e._v(" "+e._s(e.$translateTitle("product.classification"))+" ")]),t("el-cascader",{attrs:{options:e.treeData},on:{change:e.handleChange},model:{value:e.category,callback:function(t){e.category=t},expression:"category"}}),t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.getPropData(0)}}},[e._v(" "+e._s(e.$translateTitle("developer.search"))+" ")])],1),t("div",{staticStyle:{"margin-top":"10px","text-align":"center"}},[t("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.PropData},scopedSlots:e._u([{key:"empty",fn:function(){return[t("el-image",{staticClass:"dgiot-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[t("el-table-column",{attrs:{align:"center",label:"ID"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.data.SuperId))])]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.identifier")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.type))])]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.applicabletype")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.data.CategoryName))])]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.operation")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.addProCategory(a)}}},[e._v(" "+e._s(e.$translateTitle("product.add"))+" ")])]}}])})],1)],1),t("div",[t("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.productlength,"page-sizes":[10,20,30,50],small:"",total:e.producttotal},on:{"current-change":e.productCurrentChange,"size-change":e.productSizeChange}})],1)]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"mini"},nativeOn:{click:function(t){e.originwmx=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){e.originwmx=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)]),e.wmxdialogVisible?t("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.wmxhandleClose,"close-on-click-modal":!1,fullscreen:"properties"==e.moduletype,title:e.wmxSituation+"自定义属性",top:"properties"==e.moduletype?"0vh":"10vh",visible:e.wmxdialogVisible,width:"properties"==e.moduletype?"100%":"80%"},on:{"update:visible":function(t){e.wmxdialogVisible=t}}},[e.wmxdialogVisible?t("dgiot-wmx",{key:e.upKey,ref:"sizeForm",attrs:{moduletype:e.moduletype,"size-form1":e.sizeForm},on:{addDas:e.addDas,addDomain:e.addDomain,removeDas:e.removeDas,removeDomain:e.removeDomain,submitForm:e.submitForm,wmxhandleClose:function(t){return e.wmxhandleClose("close")}}}):e._e()],1):e._e(),t("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("product.addparameter"),top:"15vh",visible:e.structdialog,width:"40%"},on:{"update:visible":function(t){e.structdialog=t}}},[t("div",{staticClass:"structheader"},[t("el-form",{ref:"structform",attrs:{model:e.structform,rules:e.structrule,size:"small"}},[t("el-row",{attrs:{gutter:30}},[t("el-col",{attrs:{span:10}},[t("el-form-item",{attrs:{label:e.$translateTitle("product.functionname"),prop:"name"}},[t("el-input",{model:{value:e.structform.name,callback:function(t){e.$set(e.structform,"name",t)},expression:"structform.name"}})],1),t("el-form-item",{attrs:{label:e.$translateTitle("product.identifier"),prop:"identifier"}},[t("el-input",{model:{value:e.structform.identifier,callback:function(t){e.$set(e.structform,"identifier",t)},expression:"structform.identifier"}})],1)],1),t("el-col",{attrs:{span:10}},[t("el-form-item",{attrs:{label:e.$translateTitle("product.datatype"),prop:"type"}},[t("el-select",{model:{value:e.structform.type,callback:function(t){e.$set(e.structform,"type",t)},expression:"structform.type"}},[t("el-option",{attrs:{label:e.$translateTitle("product.init"),value:"int"}}),t("el-option",{attrs:{label:e.$translateTitle("product.float"),value:"float"}}),t("el-option",{attrs:{label:e.$translateTitle("product.double"),value:"double"}}),t("el-option",{attrs:{label:e.$translateTitle("product.bool"),value:"bool"}}),t("el-option",{attrs:{label:e.$translateTitle("product.enum"),value:"enum"}}),t("el-option",{attrs:{label:e.$translateTitle("product.string"),value:"string"}}),t("el-option",{attrs:{label:e.$translateTitle("product.date"),value:"date"}})],1)],1)],1)],1),t("div",[t("el-form-item",{attrs:{label:"数据标识",required:""}},[t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{prop:"dis"}},[t("el-input",{attrs:{placeholder:"数据标识"},model:{value:e.structform.dis,callback:function(t){e.$set(e.structform,"dis",t)},expression:"structform.dis"}})],1)],1),t("el-col",{attrs:{span:2}},[e._v("-")]),t("el-col",{attrs:{span:11}},[t("el-form-item",[t("el-input",{attrs:{placeholder:"数据长度(字节)"},model:{value:e.structform.dinumber,callback:function(t){e.$set(e.structform,"dinumber",e._n(t))},expression:"structform.dinumber"}})],1)],1)],1)],1),t("div",[t("el-form-item",{attrs:{label:"取值范围",required:""}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"startnumber"}},[t("el-input",{attrs:{placeholder:e.$translateTitle("product.minimumvalue"),type:"number"},on:{input:function(t){return e.changeStructValue("structform")}},model:{value:e.structform.startnumber,callback:function(t){e.$set(e.structform,"startnumber",e._n(t))},expression:"structform.startnumber"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"endnumber"}},[t("el-input",{attrs:{placeholder:e.$translateTitle("product.maximumvalue"),type:"number"},model:{value:e.structform.endnumber,callback:function(t){e.$set(e.structform,"endnumber",e._n(t))},expression:"structform.endnumber"}})],1)],1)],1),t("el-form-item",{attrs:{label:"步长",prop:"step"}},[t("el-input",{attrs:{"controls-position":"right",min:0,precision:2,step:.01},model:{value:e.structform.step,callback:function(t){e.$set(e.structform,"step",t)},expression:"structform.step"}})],1),t("el-form-item",{attrs:{label:e.$translateTitle("product.unit")}},[t("el-select",{attrs:{filterable:"",placeholder:e.$translateTitle("product.unit")},model:{value:e.structform.unit,callback:function(t){e.$set(e.structform,"unit",t)},expression:"structform.unit"}},e._l(e.allunit,(function(e,a){return t("el-option",{key:a,attrs:{label:e.Name+"/"+e.Symbol,value:e.Symbol}})})),1)],1)],1),"bool"==e.structform.type?t("div",[t("el-form-item",{attrs:{label:e.$translateTitle("product.attribute"),required:""}},[t("div",{staticStyle:{height:"40px"}},[t("el-col",{attrs:{span:11}},[t("el-form-item",[t("el-input",{staticClass:"inputnumber",attrs:{placeholder:e.$translateTitle("product.attributevalue"),readonly:"",type:"number"},model:{value:e.structform.truevalue,callback:function(t){e.$set(e.structform,"truevalue",t)},expression:"structform.truevalue"}})],1)],1),t("el-col",{attrs:{span:2}},[e._v("-")]),t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{prop:"true"}},[t("el-input",{staticClass:"inputnumber",attrs:{placeholder:e.$translateTitle("product.egopen")},model:{value:e.structform.true,callback:function(t){e.$set(e.structform,"true",t)},expression:"structform.true"}})],1)],1)],1),t("div",{staticStyle:{"margin-top":"20px"}},[t("el-col",{attrs:{span:11}},[t("el-form-item",[t("el-input",{staticClass:"inputnumber",attrs:{placeholder:e.$translateTitle("product.attributevalue"),readonly:"",type:"number"},model:{value:e.structform.falsevalue,callback:function(t){e.$set(e.structform,"falsevalue",t)},expression:"structform.falsevalue"}})],1)],1),t("el-col",{attrs:{span:2}},[e._v("-")]),t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{prop:"true"}},[t("el-input",{staticClass:"inputnumber",attrs:{placeholder:e.$translateTitle("product.egclost")},model:{value:e.structform.false,callback:function(t){e.$set(e.structform,"false",t)},expression:"structform.false"}})],1)],1)],1)])],1):e._e(),"enum"==e.structform.type?t("div",[e._l(e.structform.specs,(function(a,i){return t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.structform.specs.length,expression:"structform.specs.length"}],key:i,attrs:{required:""}},[t("el-col",{attrs:{span:9}},[t("el-form-item",{attrs:{label:e.$translateTitle("product.attribute")+i,prop:"specs."+i+".attribute",rules:[{required:!0,message:"输入属性"}]}},[t("el-input",{attrs:{placeholder:e.$translateTitle("product.egnumber0")},model:{value:a.attribute,callback:function(t){e.$set(a,"attribute",t)},expression:"item.attribute"}})],1)],1),t("el-col",{staticClass:"line",attrs:{span:2}},[e._v("-")]),t("el-col",{attrs:{span:9}},[t("el-form-item",{attrs:{label:e.$translateTitle("product.attribute")+i,prop:"specs."+i+".attributevalue",rules:[{required:!0,message:"输入属性值"}]}},[t("el-input",{attrs:{placeholder:e.$translateTitle("developer.describe")},model:{value:a.attributevalue,callback:function(t){e.$set(a,"attributevalue",t)},expression:"item.attributevalue"}})],1)],1),t("el-col",{staticClass:"line",attrs:{span:2}}),t("el-col",{staticClass:"line",attrs:{span:4}},[t("el-link",{staticStyle:{"margin-top":"30px","margin-left":"5px"},attrs:{icon:"el-icon-minus",type:"primary",underline:!1},on:{click:function(t){return t.preventDefault(),e.removeDomain1(a)}}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])],1)],1)})),t("el-link",{attrs:{icon:"el-icon-plus",type:"primary",underline:!1},nativeOn:{click:function(t){return e.addDomain1.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.add"))+" ")])],2):e._e(),"string"==e.structform.type?t("div",[t("el-form-item",{attrs:{label:e.$translateTitle("product.datalength"),prop:"string"}},[t("el-input",{attrs:{type:"number"},model:{value:e.structform.string,callback:function(t){e.$set(e.structform,"string",e._n(t))},expression:"structform.string"}},[t("template",{slot:"append"},[e._v(" "+e._s(e.$translateTitle("product.byte"))+" ")])],2)],1)],1):e._e(),"date"==e.structform.type?t("div",[t("el-form-item",{attrs:{label:e.$translateTitle("product.timeformat")}},[t("el-input",{attrs:{readonly:""},model:{value:e.structform.date,callback:function(t){e.$set(e.structform,"date",t)},expression:"structform.date"}})],1)],1):e._e(),t("el-form-item",{attrs:{label:e.$translateTitle("product.readandwritetype"),prop:"isread"}},[t("el-radio-group",{attrs:{size:"medium"},model:{value:e.structform.isread,callback:function(t){e.$set(e.structform,"isread",t)},expression:"structform.isread"}},[t("el-radio",{attrs:{label:"rw"}},[e._v(" "+e._s(e.$translateTitle("product.readandwrite"))+" ")]),t("el-radio",{attrs:{label:"r"}},[e._v(" "+e._s(e.$translateTitle("product.onlyread"))+" ")])],1)],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{nativeOn:{click:function(t){e.structdialog=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitStruct("structform")}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)])],1),t("el-tab-pane",{attrs:{label:e.$translateTitle("product.matteranalysis"),name:"fourth"}},[t("div",{staticClass:"protolheader"},[t("el-form",{ref:"formInline",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline,rules:e.addRules}},[t("el-form-item",{attrs:{label:e.$translateTitle("product.protocolname"),prop:"name"}},[t("el-input",{attrs:{placeholder:e.$translateTitle("product.protocolname")},model:{value:e.formInline.name,callback:function(t){e.$set(e.formInline,"name",t)},expression:"formInline.name"}})],1),t("el-form-item",{attrs:{label:e.$translateTitle("plugins.version")}},[t("el-input",{attrs:{placeholder:e.$translateTitle("plugins.version")},model:{value:e.formInline.version,callback:function(t){e.$set(e.formInline,"version",t)},expression:"formInline.version"}})],1),t("el-form-item",{attrs:{label:e.$translateTitle("developer.describe")}},[t("el-input",{attrs:{placeholder:e.$translateTitle("developer.describe")},model:{value:e.formInline.desc,callback:function(t){e.$set(e.formInline,"desc",t)},expression:"formInline.desc"}})],1),t("el-form-item",[t("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.subAce("formInline",!0)}}},[e._v(" "+e._s(e.$translateTitle("product.preservation"))+" ")]),t("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.subAce1("formInline")}}},[e._v(" "+e._s(e.$translateTitle("product.setaspublic"))+" ")]),t("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.chaxun.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.publicagreementlibrary"))+" ")])],1),t("el-form-item",{staticStyle:{display:"block"}},[t("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.protol.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.compile"))+" ")]),t("el-button",{attrs:{size:"small",type:"success"},nativeOn:{click:function(t){return e.updatesubdialog.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.thermalloading"))+" ")])],1)],1)],1),t("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("product.tdthermalloading"),visible:e.protoldialog,width:"50%"},on:{"update:visible":function(t){e.protoldialog=t}}},[t("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.protolchannel,"row-class-name":e.getChannelEnable},on:{"selection-change":e.handleSelectionChange},scopedSlots:e._u([{key:"empty",fn:function(){return[t("el-image",{staticClass:"dgiot-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.channelnumber")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.objectId))])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.channelname")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.name))])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.channeladdr")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s("channel/"+a.objectId))])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.channeltype")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[1==a.type?t("span",[e._v(" "+e._s(e.$translateTitle("developer.collectionchannel"))+" ")]):t("span",[e._v(" "+e._s(e.$translateTitle("developer.resourcechannel"))+" ")])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.servicetype")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.cType))])]}}])})],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.updateAllChannel.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)],1),t("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("product.publicagreementlibrary"),visible:e.dialogTableVisible,width:"50%"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[t("el-table",{staticStyle:{width:"100%","margin-top":"20px","text-align":"center"},attrs:{data:e.gridData},scopedSlots:e._u([{key:"empty",fn:function(){return[t("el-image",{staticClass:"dgiot-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.protocolname")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.data.name))])]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("plugins.version")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.data.version))])]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.describe")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.data.desc))])]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("equipment.createdAt")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(e.utc2beijing(a.createdAt)))])]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.operation"),width:"200"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.editordata(a)}}},[e._v(" "+e._s(e.$translateTitle("product.clone"))+" ")]),t("el-button",{attrs:{size:"mini",type:"danger"},nativeOn:{click:function(t){return e.deletedata(a.objectId)}}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])]}}])})],1),t("div",{staticClass:"elpagination",staticStyle:{padding:"20px 0"}},[t("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.decoderlength,"page-sizes":[10,20,30,50],total:e.decodertotal},on:{"current-change":e.devicerCurrentChange,"size-change":e.decoderSizeChange}})],1)],1),t("div",[t("div",{staticStyle:{background:"#ffffff"}},[t("label",{attrs:{id:"plug-name1"}})]),t("pre",{staticClass:"ace_editor ace-monokai ace_dark",staticStyle:{"min-height":"600px","margin-bottom":"0"},attrs:{id:"editor"}},[t("textarea",{staticClass:"ace_text-input"})]),t("div",{staticStyle:{background:"#ffffff"}},[t("label",{attrs:{id:"plug-name2"}})]),t("div",{staticStyle:{padding:"5px",color:"#c2be9e",background:"#272822","border-top":"1px solid #dddddd"}},[t("span",[e._v(e._s(e.$translateTitle("product.controloutput")))])]),t("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"300px","margin-top":"0","margin-bottom":"0"},attrs:{id:"editor2"}},[t("textarea",{staticClass:"ace_text-input"})])])],1),t("el-tab-pane",{attrs:{label:e.$translateTitle("product.physicalaccess"),name:"fiveth"}},[t("dgiot-query-form",[t("dgiot-query-form-left-panel",[t("div",{staticClass:"productchannel",staticStyle:{padding:"10px","text-align":"right"}},[t("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.showAllChannel.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("developer.createchannel"))+" ")])],1)]),t("dgiot-query-form-right-panel",[t("dgiot-help",{attrs:{src:"https://tech.iotn2n.com/w/docs/details?id=6",title:"产品下的所有设备都会继承该产品的 Topic 类",trigger:"click"}})],1)],1),t("div",[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.channelData,height:e.$baseTableHeight(0)-60,"row-class-name":e.getChannelEnable},scopedSlots:e._u([{key:"empty",fn:function(){return[t("el-image",{staticClass:"dgiot-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[t("el-table-column",{attrs:{label:e.$translateTitle("developer.channelnumber")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.objectId))])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.channelname")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.name))])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.channeladdr")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s("channel/"+a.objectId))])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.channeltype")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[1==a.type?t("span",[e._v(" "+e._s(e.$translateTitle("developer.collectionchannel"))+" ")]):3==a.type?t("span",[e._v(" "+e._s(e.$translateTitle("developer.missionchannel"))+" ")]):e._e()]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.servicetype")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.cType))])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.operation"),width:"350"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-button",{attrs:{size:"mini",type:"danger"},nativeOn:{click:function(t){return e.deleteRelation(a)}}},[e._v(" "+e._s(e.$translateTitle("developer.remove"))+" ")]),t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.subProTopic(a)}}},[e._v(" "+e._s(e.$translateTitle("product.subscriptionlog"))+" ")]),t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.updatesub(a)}}},[e._v(" "+e._s(e.$translateTitle("product.overloadconfiguration"))+" ")])]}}])})],1),t("div",{staticClass:"elpagination",staticStyle:{"margin-top":"20px"}},[t("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.channellength,"page-sizes":[10,20,30,50],total:e.channeltotal},on:{"current-change":e.channelCurrentChange,"size-change":e.channelSizeChange}})],1)],1)],1),t("el-tab-pane",{attrs:{label:e.$translateTitle("product.materialstorage"),name:"seven"}},[t("dgiot-query-form",[t("dgiot-query-form-left-panel",[t("div",{staticClass:"productchannel",staticStyle:{padding:"10px","text-align":"right"}},[t("el-popover",{attrs:{placement:"right",title:e.$translateTitle("developer.tipsforcustomdatamodel"),trigger:"hover",width:"600"},on:{show:e.questionModel}},[t("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"400px"},attrs:{id:"editorinsert"}},[t("el-input",{staticClass:"ace_text-input",attrs:{type:"textarea"}})],1),t("el-button",{attrs:{slot:"reference",icon:"el-icon-question",size:"mini",type:"primary"},slot:"reference"},[e._v(" "+e._s(e.$translateTitle("developer.customizedatamodelhelp"))+" ")])],1),t("el-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.resourceShowAllChannel.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("developer.createchannel"))+" ")])],1)]),t("dgiot-query-form-right-panel",[t("dgiot-help",{attrs:{src:"https://tech.iotn2n.com/w/docs/details?id=6",title:"产品下的所有设备都会继承该产品的 Topic 类",trigger:"manual"}})],1)],1),t("div",[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.resourcechannelData,height:e.$baseTableHeight(0)-60,"row-class-name":e.getChannelEnable},scopedSlots:e._u([{key:"empty",fn:function(){return[t("el-image",{staticClass:"dgiot-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[t("el-table-column",{attrs:{label:e.$translateTitle("developer.channelnumber")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.objectId))])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.channelname")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.name))])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.channeladdr")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s("channel/"+a.objectId))])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.channeltype")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[1==a.type?t("span",[e._v(" "+e._s(e.$translateTitle("developer.collectionchannel"))+" ")]):t("span",[e._v(" "+e._s(e.$translateTitle("developer.resourcechannel"))+" ")])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.servicetype")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.cType))])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.operation"),width:"350"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-button",{attrs:{size:"mini",type:"danger"},nativeOn:{click:function(t){return e.deleteRelation(a)}}},[e._v(" "+e._s(e.$translateTitle("developer.remove"))+" ")]),t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.subProTopic(a)}}},[e._v(" "+e._s(e.$translateTitle("product.subscriptionlog"))+" ")]),t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.customize(a)}}},[e._v(" "+e._s(e.$translateTitle("product.custommodel"))+" ")])]}}])})],1),t("div",{staticClass:"elpagination",staticStyle:{"margin-top":"20px"}},[t("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.resourcelength,"page-sizes":[10,20,30,50],total:e.resourcetotal},on:{"current-change":e.resourcechannelCurrentChange,"size-change":e.resourcechannelSizeChange}})],1)],1)],1),t("el-tab-pane",{attrs:{label:e.$translateTitle("konva.Visualization"),name:"view"}},[t("dgiot-views",{key:e.activeName,attrs:{"view-form":e.viewForm}})],1),t("el-tab-pane",{attrs:{label:e.$translateTitle("leftbar.alarms"),name:"notification"}},[t("dgiot-views",{attrs:{"view-form":e.viewForm}})],1),t("el-tab-pane",{attrs:{label:e.$translateTitle("product.dict"),name:"dict"}},[t("dgiot-dict")],1),t("el-tab-pane",{attrs:{label:e.$translateTitle("product.file"),name:"file"}},[t("dgiot-input",{ref:"uploadFinish",attrs:{params:e.inputParams},on:{fileInfo:e.fileInfo,files:e.files}}),t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.uploadCkick()}}},[e._v(" "+e._s(e.$translateTitle("application.uploadfile"))+" ")]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableRef",staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e.filelist,"header-cell-style":{"text-align":"center"}}},[t("el-table-column",{attrs:{label:e.$translateTitle("developer.filename"),prop:"name","show-overflow-tooltip":"",sortable:""}}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.filesize"),prop:"name","show-overflow-tooltip":"",sortable:"",width:"200"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[a.is_dir?t("span",[e._v(e._s("-"))]):t("span",[e._v(e._s(Math.round(a.size/1024)+"kb"))])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.filemtime"),prop:"name","show-overflow-tooltip":"",sortable:"",width:"260"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(" "+e._s(e.$moment(1e3*a.mtime).format("YYYY-MM-DD HH:mm:ss"))+" ")])]}}])}),t("el-table-column",{attrs:{fixed:"right",label:e.$translateTitle("developer.operation"),width:"300"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[a.is_dir?e._e():t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return t.stopPropagation(),e.get_fileinfo(a)}}},[e._v(" "+e._s(e.$translateTitle("application.detail"))+" ")]),a.is_dir?e._e():t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return t.stopPropagation(),e.download_file(a)}}},[e._v(" "+e._s(e.$translateTitle("application.preview"))+" ")]),a.is_dir?e._e():t("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},nativeOn:{click:function(t){return t.stopPropagation(),e.delete_file(a)}},slot:"reference"},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])]}}])})],1),t("el-dialog",{attrs:{"append-to-body":"",model:e.detailinfo,title:"文件信息",visible:e.detailView,width:"30%"},on:{"update:visible":function(t){e.detailView=t}}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.ViewLoading,expression:"ViewLoading"}]},[t("el-form-item",{attrs:{label:"名称","label-width":"200"}},[t("span",[e._v(e._s(e.detailinfo.rename))])]),t("el-form-item",{attrs:{label:"路径","label-width":"200"}},[t("span",[e._v(e._s(e.detailinfo.path))])]),t("el-form-item",{attrs:{label:"url","label-width":"200"}},[t("span",[e._v(e._s(e.detailinfo.url))])]),t("el-form-item",{attrs:{label:"MD5","label-width":"200"}},[t("span",[e._v(e._s(e.detailinfo.md5))])]),t("el-form-item",{attrs:{label:"场景","label-width":"200"}},[t("span",[e._v(e._s(e.detailinfo.scene))])]),t("el-form-item",{attrs:{label:"大小","label-width":"200"}},[t("span",[e._v(e._s(Math.round(e.detailinfo.size/1024)+"kb"))])]),t("el-form-item",{attrs:{label:"日期","label-width":"200"}},[t("span",[e._v(" "+e._s(e.$moment(1e3*e.detailinfo.timeStamp).format("YYYY-MM-DD HH:mm:ss"))+" ")])])],1)],1)],1)],1)],1),t("el-dialog",{attrs:{"append-to-body":"","before-close":e.handleClose,center:!0,"close-on-click-modal":!0,"close-on-press-escape":!0,"destroy-on-close":!0,modal:!0,title:"events"==e.modules.type?"自定义事件":"自定义服务",visible:e.modules.visible,width:"30%"},on:{"update:visible":function(t){return e.$set(e.modules,"visible",t)}}}),t("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("product.viewobjectmodel"),visible:e.schemadialogVisible},on:{"update:visible":function(t){e.schemadialogVisible=t}}},[t("div",[t("div",{staticStyle:{background:"#ffffff"}},[t("label",{attrs:{id:"plug-name"}})]),t("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"400px"},attrs:{id:"editor1"}},[t("textarea",{staticClass:"ace_text-input",staticStyle:{overflow:"scroll"}})])]),t("span",{staticClass:"dialog-footer",staticStyle:{height:"30px"},attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.preserve("json")}}},[e._v(" "+e._s(e.$translateTitle("equipment.update"))+" ")])],1)]),t("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("equipment.addchannel"),visible:e.innerVisible},on:{"update:visible":function(t){e.innerVisible=t}}},[t("div",{staticClass:"addchannel"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.allchannelData,height:"400"},scopedSlots:e._u([{key:"empty",fn:function(){return[t("el-image",{staticClass:"dgiot-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[t("el-table-column",{attrs:{label:e.$translateTitle("developer.channelnumber")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.objectId))])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.channelname")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.name))])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.channeladdr")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s("channel/"+a.objectId))])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.channeltype")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[1==a.type?t("span",[e._v(" "+e._s(e.$translateTitle("developer.collectionchannel"))+" ")]):2==a.type?t("span",[e._v(" "+e._s(e.$translateTitle("developer.resourcechannel"))+" ")]):t("span",[e._v(" "+e._s(e.$translateTitle("developer.missionchannel"))+" ")])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.servicetype")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.cType))])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.operation")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.addProductChannel(a.objectId)}}},[e._v(" "+e._s(e.$translateTitle("developer.add"))+" ")])]}}])})],1),t("div",{staticClass:"elpagination",staticStyle:{"margin-top":"20px"}},[t("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.allChannellength,"page-sizes":[10,20,30,50],total:e.allChanneltotal},on:{"current-change":e.allChannelCurrentChange,"size-change":e.allChannelSizeChange}})],1)],1)]),e.subdialog?t("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.handleCloseSubdialog,"close-on-click-modal":!1,title:e.channelname+"日志",visible:e.subdialog,width:"85%"},on:{"update:visible":function(t){e.subdialog=t}}},[t("mqtt-log",{attrs:{"channel-id":e.channelname,list:e.msgList,msg:e.submessage,"refresh-key":e.refreshFlag}})],1):e._e(),t("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.closeWuDialog,"close-on-click-modal":!1,"show-close":!1,top:"1vh",visible:e.resourcedialogFormVisible,width:"90%"},on:{"update:visible":function(t){e.resourcedialogFormVisible=t}}},[t("el-form",{ref:"resourceform",attrs:{model:e.resourceform}},[t("div",{staticClass:"wumoxing"},[t("el-row",[t("el-col",{attrs:{span:8}},[t("div",{staticClass:"grid-content bg-purple"},[t("el-form-item",{attrs:{label:e.$translateTitle("product.physicalmodel")}},[t("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"600px"},attrs:{id:"editormodel"}},[t("el-input",{staticClass:"ace_text-input",attrs:{type:"textarea"}})],1)])],1)]),t("el-col",{attrs:{span:16}},[t("div",{staticClass:"grid-content bg-purple-light"},[t("el-form-item",{attrs:{label:e.$translateTitle("product.customizedatamodel")}},[t("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"600px"},attrs:{id:"editorcreate"}},[t("el-input",{staticClass:"ace_text-input",attrs:{type:"textarea"}})],1)])],1)])],1)],1)]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{nativeOn:{click:function(t){return e.closeWuDialog.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.quit"))+" ")]),t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.addData.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.preservation"))+" ")])],1)],1),t("el-dialog",{attrs:{"append-to-body":!0,title:e.$translateTitle("product.export"),visible:e.exportDialogShow,width:"25%"},on:{"update:visible":function(t){e.exportDialogShow=t}}},[t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{staticClass:"btn-right",attrs:{size:"small"},nativeOn:{click:function(t){e.exportDialogShow=!1}}},[e._v(" "+e._s(e.$translateTitle("tagsView.close"))+" ")])],1)]),t("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.handleCloseCollecttion,"close-on-click-modal":!1,fullscreen:!0,title:e.$translateTitle("product.viewcollectionformula"),visible:e.collectionDialogVisible,width:"100%"},on:{"update:visible":function(t){e.collectionDialogVisible=t}}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("div",{staticClass:"diaCollLeftCls"},[t("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":e.activeIndex}},[e._l(e.wmxData,(function(a,i){return[t("el-menu-item",{key:i+"",attrs:{index:a.identifier},nativeOn:{click:function(t){return e.menuTabClick(a,i)}}},[a.dataType.specs?t("ol",[e._v(" "+e._s(a.identifier+"        "+a.name+"        取值范围"+a.dataType.specs.min+"~"+a.dataType.specs.max)+" ")]):t("ol",[e._v(" "+e._s(a.identifier+"        "+a.name)+" ")])])]}))],2)],1)]),t("el-col",{attrs:{span:18}},[t("el-tabs",{attrs:{closable:"",type:"card"},on:{"tab-click":e.handleRightTopTabClick,"tab-remove":e.removeTab},model:{value:e.editableTabsValue,callback:function(t){e.editableTabsValue=t},expression:"editableTabsValue"}},e._l(e.editableTabs,(function(a,i){return t("el-tab-pane",{key:a.name,attrs:{label:a.title,name:a.name}},[t("div",{staticClass:"diaCollRightCls"},[t("el-row",{staticStyle:{margin:"10px"}},[t("el-button",{attrs:{type:"success"}},[e._v(" "+e._s(e.$translateTitle("rule.Test"))+" ")]),t("el-button",{attrs:{type:"info"},nativeOn:{click:function(t){return e.onReductionTap(i)}}},[e._v(" "+e._s(e.$translateTitle("product.reduction"))+" ")]),t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.onSaveTap(i)}}},[e._v(" "+e._s(e.$translateTitle("product.preservation"))+" ")])],1),t("pre",{staticClass:"ace_editor3",staticStyle:{"min-height":"300px","margin-top":"0","margin-bottom":"0"},attrs:{id:a.name}},[t("textarea",{staticClass:"ace_text-input"})])],1)])})),1)],1)],1)],1)],1)},o=[],r=a("fe51"),s=(a("f77b"),a("2877")),l=Object(s["a"])(r["a"],i,o,!1,null,"21fcaa8e",null);t["default"]=l.exports},6974:function(e,t,a){e.exports={"menu-color":"rgba(255,255,255,.95)","menu-color-active":"rgba(255,255,255,.95)","menu-background":"#282c34","column-second-menu-background":"#fff"}},8048:function(e,t,a){"use strict";a("5987")},8199:function(e,t,a){"use strict";a.r(t);var i,o,r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"things-parse"},[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:4}},[t("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:e.AllDict,"highlight-current-row":""},on:{"current-change":e.handleCurrentChange}},[t("el-table-column",{attrs:{label:"ID",prop:"objectId"}}),t("el-table-column",{attrs:{label:e.$translateTitle("task.productname"),prop:"name"}})],1)],1),t("el-col",{attrs:{span:20}},[t("div",{staticClass:"protolheader"},[t("el-form",{ref:"thingsParseModel",attrs:{inline:!0,model:e.thingsParseModel,rules:e.thingsParseRules}},[t("el-form-item",{attrs:{label:e.$translateTitle("product.protocolname"),prop:"name"}},[t("el-input",{attrs:{placeholder:e.$translateTitle("product.protocolname")},model:{value:e.thingsParseModel.name,callback:function(t){e.$set(e.thingsParseModel,"name",t)},expression:"thingsParseModel.name"}})],1),t("el-form-item",{attrs:{label:e.$translateTitle("plugins.version")}},[t("el-input",{attrs:{placeholder:e.$translateTitle("plugins.version")},model:{value:e.thingsParseModel.version,callback:function(t){e.$set(e.thingsParseModel,"version",t)},expression:"thingsParseModel.version"}})],1),t("el-form-item",{attrs:{label:e.$translateTitle("developer.describe")}},[t("el-input",{attrs:{placeholder:e.$translateTitle("developer.describe")},model:{value:e.thingsParseModel.desc,callback:function(t){e.$set(e.thingsParseModel,"desc",t)},expression:"thingsParseModel.desc"}})],1),t("el-form-item",[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.subAce("thingsParseModel",!0)}}},[e._v(" "+e._s(e.$translateTitle("product.preservation"))+" ")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.subAce1("thingsParseModel")}}},[e._v(" "+e._s(e.$translateTitle("product.setaspublic"))+" ")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.chaxun}},[e._v(" "+e._s(e.$translateTitle("product.publicagreementlibrary"))+" ")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.protol}},[e._v(" "+e._s(e.$translateTitle("product.compile"))+" ")]),t("el-button",{attrs:{size:"small",type:"success"},on:{click:e.updatesubdialog}},[e._v(" "+e._s(e.$translateTitle("product.thermalloading"))+" ")])],1)],1)],1),t("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("product.tdthermalloading"),visible:e.protoldialog,width:"50%"},on:{"update:visible":function(t){e.protoldialog=t}}},[t("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.protolchannel,"row-class-name":e.getChannelEnable},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.channelnumber")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.objectId))])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.channelname")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.name))])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.channeladdr")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s("channel/"+a.objectId))])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.channeltype")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[1==a.type?t("span",[e._v(" "+e._s(e.$translateTitle("developer.collectionchannel"))+" ")]):t("span",[e._v(" "+e._s(e.$translateTitle("developer.resourcechannel"))+" ")])]}}])}),t("el-table-column",{attrs:{label:e.$translateTitle("developer.servicetype")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.cType))])]}}])})],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.updateAllChannel.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)],1),t("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("product.publicagreementlibrary"),visible:e.dialogTableVisible,width:"50%"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[t("el-table",{staticStyle:{width:"100%","margin-top":"20px","text-align":"center"},attrs:{data:e.gridData}},[t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.protocolname")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.data.name))])]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("plugins.version")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.data.version))])]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.describe")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(a.data.desc))])]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("application.createtime")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v(e._s(e.utc2beijing(a.createdAt)))])]}}])}),t("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.operation"),width:"200"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.editordata(a)}}},[e._v(" "+e._s(e.$translateTitle("product.clone"))+" ")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.deletedata(a.ObjectId)}}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])]}}])})],1),t("div",{staticClass:"elpagination",staticStyle:{padding:"20px 0"}},[t("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.decoderlength,"page-sizes":[10,20,30,50],total:e.decodertotal},on:{"current-change":e.devicerCurrentChange,"size-change":e.decoderSizeChange}})],1)],1),e.AllDict?t("div",[t("div",{staticStyle:{background:"#ffffff"}},[t("label",{attrs:{id:"plug-name1"}})]),t("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"600px","margin-bottom":"0"},attrs:{id:"editor"}},[t("textarea",{staticClass:"ace_text-input"})]),t("div",{staticStyle:{background:"#ffffff"}},[t("label",{attrs:{id:"plug-name"}})]),t("div",{staticStyle:{padding:"5px","margin-right":"80px",color:"#c2be9e",background:"#272822","border-top":"1px solid #dddddd"}},[t("span",[e._v(e._s(e.$translateTitle("product.controloutput")))])]),t("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"300px","margin-top":"0","margin-bottom":"0"},attrs:{id:"editor2"}},[t("textarea",{staticClass:"ace_text-input"})])]):e._e()],1)],1)],1)},s=[],l=a("1285"),n=a("89e8"),c=a("e0e9"),d=a("7212"),p=a("bb22"),u=(e,t,a)=>new Promise((i,o)=>{var r=e=>{try{l(a.next(e))}catch(t){o(t)}},s=e=>{try{l(a.throw(e))}catch(t){o(t)}},l=e=>e.done?i(e.value):Promise.resolve(e.value).then(r,s);l((a=a.apply(e,t)).next())}),m="",h="",g={name:"ThingsParse",props:{},data(){var e=(e,t,a)=>{const i=/[0-9a-zA-Z]/;i.test(t)?a():a(new Error("协议名称由数字和字母组合"))};return{currentRow:null,AllDict:[],productName:"",form:{Productname:"",ProductKey:"",ProductAll:0},decoderstart:0,decodertotal:0,decoderlength:10,protolchannel:[],productdetail:{},thingsParseModel:{name:"",version:"",desc:"",resource:!1},thingsParseRules:{name:[{required:!0,message:"请输入协议名称",trigger:"blur"},{validator:e,trigger:"blur"}]},dialogTableVisible:!1,gridData:[],protoldialog:!1}},computed:{tableFilterData(){return null}},mounted(){o=ace.edit("editor2"),o.session.setMode("ace/mode/text"),o.setTheme("ace/theme/monokai"),o.setReadOnly(!0),o.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}),this.Industry(),this.getAllunit(),this.getAllDict(),this.$route.query.activeName&&(this.activeName=this.$route.query.activeName)},methods:{handleCurrentChange(e){this.currentRow=e,this.$refs.singleTable.setCurrentRow(e),this.getProDetail(e.objectId)},getAllDict(){return u(this,null,(function*(){const e={where:{category:{$nin:["Evidence"]}},order:"updatedAt"},{results:t}=yield Object(d["queryProduct"])(e);t&&(this.AllDict=t,this.handleCurrentChange(t[0]))}))},Industry(){return u(this,null,(function*(){this.option=[];const{results:e}=yield this.$getIndustry("category",100);e.map(e=>{var t={};t.value=e.type,t.label=e.data.CategoryName,t.id=e.data.Id,t.parentid=e.data.SuperId,this.option.push(t)})}))},getProDetail(e){this.productId=e,i=ace.edit("editor"),i.session.setMode("ace/mode/erlang"),i.setTheme("ace/theme/monokai"),i.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}),this.$get_object("Product",e).then(e=>{if(e){for(var t in dgiotlog.log("response",e.decoder),this.productName=e.name,e)this.productdetail[t]=e[t];this.option.map(e=>{this.productdetail.category==e.value&&(this.productdetail.category=e.label)}),this.productdetail.createdAt=this.utc2beijing(e.createdAt),this.productdetail.id=e.id,this.dynamicReg=e.dynamicReg,this.productdetail.isshow=0,this.form.Productname=e.name,this.ProductSecret=e.productSecret,this.form.Productkey=this.productId,this.productimg=e.icon,e.decoder?(h=e.decoder.code,this.thingsParseModel.name=e.decoder.name,this.thingsParseModel.version=e.decoder.version,this.thingsParseModel.desc=e.decoder.desc):(this.$baseMessage("暂无decoder,将显示默认值","warning",!1),h="JSUlLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQolJSUgQGNvcHlyaWdodCAoQykgMjAxOCwgPHNodXdhPgolJSUgQGRvYwolJSUg5Y2P6K6u6Kej5p6QRGVtbwolJSUgQGVuZAolJSUgQ3JlYXRlZCA6IDA4LiDljYHkuIDmnIggMjAxOCAxNDo0OQolJSUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi1tb2R1bGUoc2h1d2FfZGVtb19kZWNvZGVyKS4KLWF1dGhvcigic2h1d2EiKS4KLWRlZmluZShNU0dfVFlQRSwgPDwiREVNTyI+PikuCi1wcm90b2NvbChbPDwiREVNTyI+Pl0pLgoKLWV4cG9ydChbcGFyc2VfZnJhbWUvMiwgdG9fZnJhbWUvMV0pLgoKCnBhcnNlX2ZyYW1lKEJ1ZmYsIE9wdHMpIC0+CiAgICBwYXJzZV9mcmFtZShCdWZmLCBbXSwgT3B0cykuCgoKcGFyc2VfZnJhbWUoPDw+PiwgQWNjLCBfT3B0cykgLT4KICAgIHs8PD4+LCBBY2N9OwpwYXJzZV9mcmFtZSg8PDE2IzY4LCBSZXN0L2JpbmFyeT4+ID0gQmluLCBBY2MsIF9PcHRzKSB3aGVuIGJ5dGVfc2l6ZShSZXN0KSA9PCA2IC0+CiAgICB7QmluLCBBY2N9OwpwYXJzZV9mcmFtZSg8PDE2IzY4LCBMZW46MTYvbGl0dGxlLWludGVnZXIsIExlbjoxNi9saXR0bGUtaW50ZWdlciwgMTYjNjgsIFJlc3QvYmluYXJ5Pj4gPSBCaW4sIEFjYywgT3B0cykgLT4KICAgIGNhc2UgYnl0ZV9zaXplKFJlc3QpIC0gMiA+PSBMZW4gb2YKICAgICAgICB0cnVlIC0+CiAgICAgICAgICAgIGNhc2UgUmVzdCBvZgogICAgICAgICAgICAgICAgPDxVc2VyWm9uZTpMZW4vYnl0ZXMsIENyYzo4LCAxNiMxNiwgUmVzdDEvYmluYXJ5Pj4gLT4KICAgICAgICAgICAgICAgICAgICBBY2MxID0KICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBzaHV3YV91dGlsczpnZXRfcGFyaXR5KFVzZXJab25lKSA9Oj0gQ3JjIG9mCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnVlIC0+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRnJhbWUgPSAjewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8PCJtc2d0eXBlIj4+ID0+ID9NU0dfVFlQRSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPDwiZGF0YSI+PiA9PiBVc2VyWm9uZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQWNjICsrIFtGcmFtZV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWxzZSAtPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFjYwogICAgICAgICAgICAgICAgICAgICAgICBlbmQsCiAgICAgICAgICAgICAgICAgICAgcGFyc2VfZnJhbWUoUmVzdDEsIEFjYzEsIE9wdHMpOwogICAgICAgICAgICAgICAgXyAtPgogICAgICAgICAgICAgICAgICAgIHBhcnNlX2ZyYW1lKFJlc3QsIEFjYywgT3B0cykKICAgICAgICAgICAgZW5kOwogICAgICAgIGZhbHNlIC0+CiAgICAgICAgICAgIHtCaW4sIEFjY30KICAgIGVuZDsKcGFyc2VfZnJhbWUoPDxfOjgsIFJlc3QvYmluYXJ5Pj4sIEFjYywgT3B0cykgLT4KICAgIHBhcnNlX2ZyYW1lKFJlc3QsIEFjYywgT3B0cykuCgoKJSUg57uE6KOF5oiQ5bCB5YyFLCDlj4LmlbDkuLpNYXDlvaLlvI8KdG9fZnJhbWUoI3s8PCJtc2d0eXBlIj4+IDo9ID9NU0dfVFlQRX0gPSBGcmFtZSkgLT4KICAgIFBheWxvYWQgPSB0ZXJtX3RvX2JpbmFyeShGcmFtZSksCiAgICA8PDE2IzAzLCBQYXlsb2FkL2JpbmFyeSwgMTYjMjM+Pi4="),this.productdetail.thing||(this.productdetail.thing={properties:[]}),this.wmxData=this.productdetail.thing.properties.filter(e=>e.name&&e.dataType),i.setValue(Base64.decode(h)),i.gotoLine(i.session.getLength()),this.queryDeviceCount(this.productId)}})},queryDeviceCount(e){return u(this,null,(function*(){this.form.ProductAll=yield Object(l["getDeviceCountByProduct"])(e)}))},editordata(e){this.thingsParseModel.name=e.data.name,this.thingsParseModel.version=e.data.version,this.thingsParseModel.desc=e.data.desc,this.thingsParseModel.resource=e.data.enable,i.setValue(Base64.decode(e.data.code)),this.dialogTableVisible=!1},getAllunit(){return u(this,null,(function*(){this.allunit=[];const{results:e}=yield Object(c["getAllunit"])("unit",100);this.allunit=e.concat([]),this.allunit.unshift({data:{Name:"无",Symbol:""}})}))},subAce(e,t){this.$refs[e].validate(a=>{if(a){var r={name:e.name,version:e.version,code:Base64.encode(i.getValue()),desc:e.desc};const a={decoder:r};this.$update_object("Product",this.productId,a).then(e=>{0==this.issub&&(this.$message({showClose:!0,duration:2e3,type:"success",message:"保存成功"}),1==t&&(m+="保存成功",o.setValue(m))),this.issub=!0})}else this.$message({showClose:!0,duration:2e3,type:"warning",message:"输入格式有误"})})},subAce1(e){this.$refs[e].validate(e=>{if(e){const e={where:{"data.name":this.thingsParseModel.name,"data.version":this.thingsParseModel.version}};this.$query_object("Dict",e).then(e=>{e.results&&e.results.length>=1?this.$message("此协议版本已存在"):this.$get_object("Product",this.productId).then(e=>{if(e){var t={name:this.thingsParseModel.name,version:this.thingsParseModel.version,code:Base64.encode(i.getValue()),desc:this.thingsParseModel.desc};const a={type:"decoder",data:t,ACL:e.ACL};this.$create_object("Dict",a).then(e=>{e.error?this.$message({showClose:!0,duration:2e3,type:"error",message:e.error}):this.$message({showClose:!0,duration:2e3,type:"success",message:"保存到公共协议库成功"})}).catch(e=>{dgiotlog.log(e)})}})})}else this.$message({showClose:!0,duration:2e3,type:"warning",message:"输入格式有误"})})},decoderSizeChange(e){this.decoder.length=e,this.chaxun()},devicerCurrentChange(e){this.decoderstart=(e-1)*this.decoderlength,this.chaxun()},updateAllChannel(){if(0==this.multipleSelection.length)this.protoldialog=!1;else{var e=[];this.multipleSelection.map(t=>{e.push(new Promise((e,a)=>Object(p["subupadte"])(t.id,"update").then(t=>{t&&e(t)}).catch(e=>{a(e)})))}),Promise.all(e).then(e=>{this.$message({showClose:!0,duration:2e3,message:"热加载成功",type:"success"}),e.length==this.multipleSelection.length&&(this.protoldialog=!1)}).catch(e=>{this.$message({showClose:!0,duration:2e3,message:e,type:"error"})})}},handleSelectionChange(e){this.multipleSelection=e},utc2beijing(e){var t=new Date(+new Date(e)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"");return t},getChannelEnable(e,t){return 1==e.isEnable?"green_active":"red_active"},deletedata(e){this.$del_object("Dict",e).then(e=>{e&&(this.$message("成功删除"),this.chaxun())})},updatesubdialog(){this.protoldialog=!0;const e="1",t={__type:"Pointer",className:"Product",objectId:this.productId};Object(n["getChannelCountByProduct"])(10,0,t,e).then(e=>{e.count>0?(this.protolchannel=e.results,this.$refs.multipleTable.toggleAllSelection()):(this.protolchannel={},this.$refs.multipleTable.toggleAllSelection())}).catch(e=>{dgiotlog.log(e),this.$baseMessage("请求出错",e.error,3e3)})},chaxun(){const e={skip:this.decoderstart,limit:this.decoderlength,order:"-createdAt",where:{type:"decoder"}};this.$query_object("Dict",e).then(e=>{e&&(this.decodertotal=e.count,this.dialogTableVisible=!0,this.gridData=e.results)})},protol(){var e="";Object(p["Compile"])(Base64.encode(i.getValue())).then(t=>{t&&(this.$message({showClose:!0,duration:2e3,type:"success",message:"编译成功"}),e="编译成功"+t.mod+"\r\n",this.warningeditror=t.warnings,this.warningeditror.map(t=>{e+=t+"\r\n"}),m+=e,o.setValue(m))}).catch(t=>{this.warningeditror=t.error,this.warningeditror.map(t=>{e+=t+"\r\n"}),m+=e,o.setValue(m)})}}},b=g,f=(a("ee25"),a("2877")),v=Object(f["a"])(b,r,s,!1,null,null,null);t["default"]=v.exports},"8cae":function(e,t,a){"use strict";a("9338")},9338:function(e,t,a){},"93f5":function(e,t,a){"use strict";a("aaff")},aaff:function(e,t,a){},b2d2:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"home_index"},[t("div",{ref:"platform",staticClass:"platform",style:{width:e.screenWidth}},[t("div",{staticClass:"home_dialog"},[t("el-dialog",{attrs:{"append-to-body":!0,title:e.deviceInfo.name,visible:e.deviceFlag,width:"100vh"},on:{"update:visible":function(t){e.deviceFlag=t}}},[t("info",{attrs:{devicedetail:e.deviceInfo}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.deviceFlag=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){e.deviceFlag=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)],1)],1),0==e.homeScreen?t("div",{staticClass:"baidu_map"},[t("el-card",{staticStyle:{height:"100%"},attrs:{shadow:"hover"}},[t("el-row",{directives:[{name:"show",rawName:"v-show",value:"baidu"==e.mapType,expression:"mapType == 'baidu'"}],staticStyle:{height:"100%"},attrs:{row:24}},[t("el-col",{staticStyle:{height:"100%"},attrs:{span:e.leftRow,xs:24}},[t("el-row",{staticStyle:{height:"100%"},attrs:{span:24}},[t("div",{staticClass:"chart_map",staticStyle:{position:"relative",width:"100%",height:"100%"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"card_left"},[t("el-row",{staticClass:"card_left-row",attrs:{gutter:24}},[t("el-col",{staticClass:"card_left-row-col",attrs:{span:6}},[t("Card",{staticClass:"card_left-row-col-card",staticStyle:{"background-color":"#ffad33","border-color":"#ffad33"}},[t("div",{staticStyle:{"text-align":"center"}},[t("Tag",{staticStyle:{background:"rgb(255, 173, 51)"},attrs:{checkable:"",color:"warning"}},[e._v(" "+e._s(e.offlineData.length||0)+" ")]),t("p",[e._v(e._s(e.$translateTitle("zetadevices.offline")))])],1)])],1),t("el-col",{staticClass:"card_left-row-col",attrs:{offset:2,span:6}},[t("Card",{staticClass:"card_left-row-col-card",staticStyle:{"background-color":"#19be6b","border-color":"#19be6b"}},[t("div",{staticStyle:{"text-align":"center"}},[t("Tag",{staticStyle:{background:"rgb(25, 190, 107)"},attrs:{checkable:"",color:"success"}},[e._v(" "+e._s(e.dev_online_count||0)+" ")]),t("p",[e._v(e._s(e.$translateTitle("zetadevices.online")))])],1)])],1),t("el-col",{staticClass:"card_left-row-col",attrs:{offset:2,span:6}},[t("Card",{staticClass:"card_left-row-col-card",staticStyle:{"background-color":"#f16643","border-color":"#f16643"}},[t("div",{staticStyle:{"text-align":"center"}},[t("Tag",{staticStyle:{background:"rgb(241, 102, 67)"},attrs:{checkable:"",color:"error"}},[e._v(" "+e._s(e.warnCount)+" ")])],1),t("p",[e._v(" "+e._s(e.$translateTitle("leftbar.alarms"))+" ")])])],1)],1)],1),t("baidu-map",{staticClass:"baidu_map",attrs:{id:"baidu_map",ak:e.ak,center:e.center,"scroll-wheel-zoom":!0,zoom:e.sizeZoom},on:{click:e.handleMapClick,ready:e.handler}},[t("div",{staticClass:"screen_top"},[t("div",{staticClass:"screen_top_item"},[t("router-link",{attrs:{to:"/dashboard/productlist"}},[t("p",[e._v(e._s(e.$translateTitle("home.pro_count")))]),t("p",{staticStyle:{color:"#f8a75c"}},[e._v(e._s(e._product_count))])])],1),t("div",{staticClass:"screen_top_item"},[t("router-link",{attrs:{to:"/roles/applicationManagement"}},[t("p",[e._v(e._s(e.$translateTitle("home.app_count")))]),t("p",{staticStyle:{color:"#efdb75"}},[e._v(e._s(e._app_count))])])],1),t("div",{staticClass:"screen_top_item",on:{click:function(t){return e.goDevice()}}},[t("p",[e._v(e._s(e.$translateTitle("home.dev_count")))]),t("p",{staticStyle:{color:"#03fcfa"}},[e._v(e._s(e._dev_count))])]),t("div",{staticClass:"screen_top_item"},[t("router-link",{attrs:{to:"/CloudOt/alarm"}},[t("p",[e._v(" "+e._s(e.$translateTitle("equipment.Total number of alarms"))+" ")]),t("p",{staticStyle:{color:"#179fff"}},[e._v(e._s(e.warnCount))])])],1)]),t("div",{staticClass:"screen_bottom"},[t("div",{staticClass:"screen_bottom_title"},[e._v(" "+e._s(e.$translateTitle("equipment.list"))+" ")]),t("screen-device",{attrs:{comp:e.comp}})],1),t("div",{staticClass:"screen_right_center"},[t("div",{staticClass:"screen_right_center_top"},[e._v("工单列表")]),t("work-order",{attrs:{comp:e.comp}})],1),t("div",{staticClass:"screen_left_center"},[t("div",{staticClass:"screen_left_center_top"},[e._v("告警列表")]),t("topo-caltable",{attrs:{comp:e.comp}})],1),t("div",{staticClass:"screen_right_bottom"},[t("div",{staticClass:"screen_right_bottom_top"},[e._v("设备运行状况")]),t("ve-pie",{attrs:{data:e.piechartData,extend:e.pieextend,height:"100%",settings:e.piechartSettings,width:"100%"}})],1),t("bm-map-type",{attrs:{anchor:"BMAP_ANCHOR_TOP_LEFT","map-types":["BMAP_HYBRID_MAP","BMAP_NORMAL_MAP"]}}),t("bm-control",[t("el-button",{attrs:{size:"mini"},on:{click:function(t){e.sizeZoom=19}}},[e._v(" "+e._s(e.$translateTitle("home.max"))+" ")]),t("el-button",{attrs:{size:"mini"},on:{click:function(t){e.sizeZoom=10}}},[e._v(" "+e._s(e.$translateTitle("home.restore"))+" ")]),t("el-button",{attrs:{size:"mini"},on:{click:function(t){e.sizeZoom=3}}},[e._v(" "+e._s(e.$translateTitle("home.min"))+" ")]),t("el-button",{staticClass:"ri-fullscreen-fill",attrs:{size:"mini"},on:{click:function(t){return e.toggleFull()}}}),t("bm-overview-map",{attrs:{"is-open":!0}}),t("bm-scale",{attrs:{offset:{width:260,height:0}}}),t("bm-city-list",{attrs:{offset:{width:330,height:0}}})],1),t("bml-marker-clusterer",{attrs:{"average-center":!0}},e._l(e._tableData,(function(a,i){return t("div",{key:i},[t("bm-marker",{ref:"bm_info"+i,refInFor:!0,attrs:{icon:{url:1==a.icon?e.icoPath.icoPath1:e.icoPath.icoPath2,size:{width:100,height:100}},position:{lng:a.location.longitude,lat:a.location.latitude}},on:{click:function(t){return e.showDeatils(a,i)}}},[t("bm-info-window",{key:i,staticStyle:{display:"none"},attrs:{position:{lng:a.location.longitude,lat:a.location.latitude},show:a.show},on:{close:function(t){return e.closeInfo(a,i)}}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.deviceInfo,expression:"deviceInfo"}],staticClass:"deviceInfo",staticStyle:{width:"400px"}},[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:6}},[t("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{"preview-src-list":[""+e.productIco],src:e.productIco}},[t("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[t("i",{staticClass:"el-icon-picture-outline empty",staticStyle:{width:"100px",height:"100px"}})])])],1),t("el-col",{attrs:{span:18}},[t("p",{attrs:{title:e.deviceInfo.name}},[e._v(" "+e._s(e.$translateTitle("equipment.devicename"))+" ： "+e._s(e.deviceInfo.name)+" ")]),t("p",[e._v(" "+e._s(e.$translateTitle("equipment.address"))+" ： "+e._s(e.deviceInfo.address)+" ")]),t("p",[e._v(" "+e._s(e.$translateTitle("zetadevices.devicestatus"))+" ： "),t("el-link",{attrs:{type:"ONLINE"===e.deviceInfo.status?"success":"warning",underline:!1}},[e._v(" "+e._s("ONLINE"===e.deviceInfo.status?e.$translateTitle("zetadevices.online"):e.$translateTitle("zetadevices.offline"))+" ")])],1),t("p",[t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.goLink("real-time",a)}}},[e._v(" "+e._s(e.$translateTitle("product.Device Information"))+" ")])],1)])],1)],1)])],1)],1)})),0),t("bm-navigation",{attrs:{anchor:"BMAP_ANCHOR_TOP_RIGHT"}}),t("bm-geolocation",{attrs:{anchor:"BMAP_ANCHOR_BOTTOM_RIGHT","auto-location":!0,"show-address-bar":!0,"show-zoom-info":!0}})],1)],1)])],1),t("el-col",{attrs:{span:24-e.leftRow,xs:24}},[t("div",{staticClass:"home_card"},[t("el-tabs",{on:{"tab-click":e.resizeTheChart},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$translateTitle("home.info"),name:"first"}},[t("div",{staticClass:"box-card"},[t("el-card",[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("el-button",[e._v(" "+e._s(e.$translateTitle("home.info"))+" ")])],1),t("div",[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:24}},[t("div",{staticClass:"grid-content bg-purple"},[e.Product?t("el-table",{staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e.Product,"header-cell-style":{"text-align":"center"},"row-class-name":e.tableRowClassName}},[t("el-table-column",{attrs:{label:e.$translateTitle("menu.icon"),width:"60"},scopedSlots:e._u([{key:"default",fn:function({row:e}){return[t("el-image",{staticStyle:{width:"26px",height:"26px"},attrs:{"preview-src-list":[""+e.icon],src:e.icon}},[t("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[t("i",{staticClass:"el-icon-picture-outline"})])])]}}],null,!1,3281234111)}),t("el-table-column",{attrs:{label:e.$translateTitle("task.productname"),prop:"name","show-overflow-tooltip":!0,width:"120"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",{on:{click:function(t){return e.goDevice(a.name)}}},[e._v(" "+e._s(a.name)+" ")])]}}],null,!1,699248853)}),t("el-table-column",{attrs:{label:e.$translateTitle("home.dev_count")},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",{on:{click:function(t){return e.goDevice(a.name)}}},[e._v(" "+e._s(a.deviceChild.length)+" ")])]}}],null,!1,100581394)})],1):e._e()],1)])],1)],1)])],1),t("el-col",{attrs:{md:24,sm:24,xl:24,xs:24}},[t("el-card",{staticClass:"box-card"},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v(" "+e._s(e.$translateTitle("equipment.Equipment Overview"))+" ")]),t("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{icon:"el-icon-refresh",type:"text"},on:{click:function(t){return e.resizeTheChart()}}})],1),t("div",{staticClass:"text item"},[t("dgiot-chart",{ref:"charts",attrs:{data:e._ChartStatus,"data-empty":!e.ChartStatus.rows,extend:e.chartExtend,height:"160px",loading:e.loading,settings:e.chartSettings,type:"ring"}})],1)])],1)],1),t("el-tab-pane",{attrs:{label:e.$translateTitle("home.dev_unline"),name:"second"}},[t("div",{staticClass:"box-card"},[t("el-card",[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("el-badge",{staticClass:"item",attrs:{value:e._dev_off_count}},[t("el-button",{attrs:{size:"small"},on:{click:function(t){return e._goDevice("dev_unline")}}},[e._v(" "+e._s(e.$translateTitle("home.dev_unline"))+" ")])],1)],1),t("div",[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:24}},[t("div",{staticClass:"grid-content bg-purple"},[t("el-table",{staticClass:"_el-table",staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e._offlineData,"header-cell-style":{"text-align":"center"},"row-class-name":e.tableRowClassName}},[t("el-table-column",{attrs:{label:e.$translateTitle("equipment.devicename"),prop:"name"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",{attrs:{title:a.name+e.$translateTitle("home.Last online Time")+a.updatedAt},on:{click:function(t){return e.showInfo(a.objectId)}}},[e._v(" "+e._s(a.name)+" ")])]}}],null,!1,1752624776)})],1)],1)])],1)],1)])],1)]),t("el-tab-pane",{attrs:{label:e.$translateTitle("home.dev_online"),name:"third"}},[t("div",{staticClass:"box-card"},[t("el-card",[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("el-badge",{staticClass:"item",attrs:{value:e._dev_online_count}},[t("el-button",{attrs:{size:"small"},on:{click:function(t){return e._goDevice("dev_online")}}},[e._v(" "+e._s(e.$translateTitle("home.dev_online"))+" ")])],1)],1),t("div",[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:24}},[t("div",{staticClass:"grid-content bg-purple"},[t("el-table",{staticClass:"_el-table",staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e._onlineData,"header-cell-style":{"text-align":"center"},"row-class-name":e.tableRowClassName}},[t("el-table-column",{attrs:{label:e.$translateTitle("equipment.devicename"),prop:"name"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",{attrs:{title:a.name+e.$translateTitle("home.Last online Time")+a.updatedAt},on:{click:function(t){return e.showInfo(a.objectId)}}},[e._v(" "+e._s(a.name)+" ")])]}}],null,!1,1752624776)})],1)],1)])],1)],1)])],1)])],1)],1)])],1)],1)],1):1==e.homeScreen?t("div",{staticClass:"baidu_map bg_screen1"},[t("div",{staticClass:"screen_top"},[t("div",{staticClass:"screen_top_item"},[t("router-link",{attrs:{to:"/dashboard/productlist"}},[t("p",[e._v(e._s(e.$translateTitle("home.pro_count")))]),t("p",{staticStyle:{color:"#f8a75c"}},[e._v(e._s(e._product_count))])])],1),t("div",{staticClass:"screen_top_item"},[t("router-link",{attrs:{to:"/roles/applicationManagement"}},[t("p",[e._v(e._s(e.$translateTitle("home.app_count")))]),t("p",{staticStyle:{color:"#efdb75"}},[e._v(e._s(e._app_count))])])],1),t("div",{staticClass:"screen_top_item",on:{click:function(t){return e.goDevice()}}},[t("p",[e._v(e._s(e.$translateTitle("home.dev_count")))]),t("p",{staticStyle:{color:"#03fcfa"}},[e._v(e._s(e._dev_count))])]),t("div",{staticClass:"screen_top_item"},[t("router-link",{attrs:{to:"/CloudOt/alarm"}},[t("p",[e._v(" "+e._s(e.$translateTitle("equipment.Total number of alarms"))+" ")]),t("p",{staticStyle:{color:"#179fff"}},[e._v(e._s(e.warnCount))])])],1)]),t("div",{staticClass:"screen_center_center",style:{backgroundImage:"url("+e.background+")",backgroundRepeat:"no-repeat",backgroundSize:"100% 100%"},attrs:{id:"screen_center_bg"},on:{mouseenter:e.enter,mouseleave:e.leave}}),t("div",{staticClass:"screen_bottom"},[t("div",{staticClass:"screen_bottom_title"},[e._v(" "+e._s(e.$translateTitle("equipment.list"))+" ")]),t("screen-device",{attrs:{comp:e.comp}})],1),t("div",{staticClass:"screen_right_center"},[t("div",{staticClass:"screen_right_center_top"},[e._v("工单列表")]),t("work-order",{attrs:{comp:e.comp}})],1),t("div",{staticClass:"screen_left_center"},[t("div",{staticClass:"screen_left_center_top"},[e._v("告警列表")]),t("topo-caltable",{attrs:{comp:e.comp}})],1),t("div",{staticClass:"screen_right_bottom"},[t("div",{staticClass:"screen_right_bottom_top"},[e._v("设备运行状况")]),t("ve-pie",{attrs:{data:e.piechartData,extend:e.pieextend,height:"100%",settings:e.piechartSettings,width:"100%"}})],1)]):2==e.homeScreen?t("div",{staticClass:"baidu_map bg_screen1"},[t("div",{staticClass:"screen_top"},[t("div",{staticClass:"screen_top_item"},[t("router-link",{attrs:{to:"/dashboard/productlist"}},[t("p",[e._v(e._s(e.$translateTitle("home.pro_count")))]),t("p",{staticStyle:{color:"#f8a75c"}},[e._v(e._s(e._product_count))])])],1),t("div",{staticClass:"screen_top_item"},[t("router-link",{attrs:{to:"/roles/applicationManagement"}},[t("p",[e._v(e._s(e.$translateTitle("home.app_count")))]),t("p",{staticStyle:{color:"#efdb75"}},[e._v(e._s(e._app_count))])])],1),t("div",{staticClass:"screen_top_item",on:{click:function(t){return e.goDevice()}}},[t("p",[e._v(e._s(e.$translateTitle("home.dev_count")))]),t("p",{staticStyle:{color:"#03fcfa"}},[e._v(e._s(e._dev_count))])]),t("div",{staticClass:"screen_top_item"},[t("router-link",{attrs:{to:"/CloudOt/alarm"}},[t("p",[e._v(" "+e._s(e.$translateTitle("equipment.Total number of alarms"))+" ")]),t("p",{staticStyle:{color:"#179fff"}},[e._v(e._s(e.warnCount))])])],1)]),t("div",{staticClass:"screen_center_center",style:{backgroundImage:"url("+e.background+")",backgroundRepeat:"no-repeat",backgroundSize:"100% 100%"},attrs:{id:"screen_center_bg"},on:{mouseenter:e.enter,mouseleave:e.leave}}),t("div",{staticClass:"screen_left_bottom"},[t("div",{staticClass:"screen_left_bottom_top"},[e._v("数据分析")]),t("div",{staticClass:"screen_left_bottom_ctt"},[t("screen-line",{staticStyle:{width:"100%",height:"100%"}})],1)]),t("div",{staticClass:"screen_right_bottom"},[t("div",{staticClass:"screen_right_bottom_top"},[e._v("设备运行状况")]),t("ve-pie",{attrs:{data:e.piechartData,extend:e.pieextend,height:"100%",settings:e.piechartSettings,width:"100%"}})],1)]):e._e()])])},o=[],r=a("58cc6"),s=a("d575"),l=a("22e3"),n=a("147a"),c=a("fdeb"),d=a.n(c),p=a("327b"),u=a.n(p),m=a("7212"),h=a("1285"),g=a("5880"),b=a("bc35"),f=a("bb22"),v=a("ed08"),y=a("c4e6"),_=a("22f9"),w=a("8ba7"),T=a("cb88"),k=Object.defineProperty,C=Object.defineProperties,x=Object.getOwnPropertyDescriptors,S=Object.getOwnPropertySymbols,I=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable,j=(e,t,a)=>t in e?k(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,D=(e,t)=>{for(var a in t||(t={}))I.call(t,a)&&j(e,a,t[a]);if(S)for(var a of S(t))P.call(t,a)&&j(e,a,t[a]);return e},A=(e,t)=>C(e,x(t)),F=(e,t,a)=>new Promise((i,o)=>{var r=e=>{try{l(a.next(e))}catch(t){o(t)}},s=e=>{try{l(a.throw(e))}catch(t){o(t)}},l=e=>e.done?i(e.value):Promise.resolve(e.value).then(r,s);l((a=a.apply(e,t)).next())});window.dgiot.dgiotEnv=Object({NODE_ENV:"production",VUE_APP_TITLE:"物联网开发平台",VUE_APP_AUTHOR:"xxb",VUE_APP_UPDATE_TIME:"2023年01月29日11时07分47秒",VUE_APP_VERSION:"4.7.4",VUE_APP_Keywords:"一站式物联网PaaS平台|物联网应用服务",VUE_APP_Description:"提供物联网垂直领域应用使能平台及解决方案",VUE_APP_URL:"http://1.117.219.8",VUE_APP_CDN_URL:"/dgiot_dashboard/public",BASE_URL:""});var O={name:"Home",components:{BmPointCollection:T["BmPointCollection"],BmInfoWindow:T["BmInfoWindow"],info:y["default"],BmScale:T["BmScale"],BmMapType:T["BmMapType"],BmOverviewMap:T["BmOverviewMap"],BmPanorama:T["BmPanorama"],BmControl:T["BmControl"],BmLabel:T["BmLabel"],BaiduMap:T["BaiduMap"],BmNavigation:T["BmNavigation"],BmGeolocation:T["BmGeolocation"],BmCityList:T["BmCityList"],BmMarker:T["BmMarker"],BmlMarkerClusterer:T["BmlMarkerClusterer"],BmPolyline:T["BmPolyline"],topoCaltable:r["default"],ScreenDevice:s["default"],WorkOrder:l["default"],ScreenLine:n["default"]},data(){return this.piechartSettings={type:"pie"},this.pieextend={series:{type:"pie",radius:["20%","50%"],center:["50%","50%"],itemStyle:{borderRadius:2,borderColor:"#fff",borderWidth:1}},legend:{left:5,top:5,textStyle:{color:"#fff"}},xAxis:{axisLine:{lineStyle:{color:"#fff"}}},yAxis:{axisLine:{lineStyle:{color:"#fff"}}}},this.chartSettings={radius:[5,40],offsetY:100},this.chartExtend={yAxisType:["percent"],tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"}},{lineList:[],homeScreen:0,backgroundimage:"",piechartData:{columns:["名称","数量"],rows:[{"名称":"在线设备","数量":0},{"名称":"离线设备","数量":0}]},comp:{height:390},queryParams:{},mapHeight:"800px",mapWidth:"800px",polyline:{editing:!1,paths:[]},list:{toolbar:!1,latitude:"31.551162",longitude:"120.260545",zoom:15},mapType:"baidu",isShow:!0,ak:this.$dgiot.secret.baidu.map,center:{lng:120.260545,lat:31.551162},icoPath:{icoPath1:d.a,icoPath2:u.a},router:"",loadingConfig:{product_count:!1,app_count:!1,device_count:!1,warn_count:!1},warnCount:0,count:0,productIco:"",ChartStatus:{columns:["状态","数量"],rows:[{"状态":"在线","数量":0},{"状态":"离线","数量":0}]},clientId:"dgiot_clientId_",infoWindow:{show:!0,contents:"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."},loading:!0,marker:{},deviceFlag:!1,deviceInfo:{detail:{}},Product:[],imgurl:"https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg",subtopic:"",isConnect:!1,queryForm:{account:"",searchDate:"",pageNo:1,pageSize:20,workGroupName:"",workGroupTreeShow:!1,access_token:""},roleProps:{children:"children",label:"name"},leftWidth:"",cardHeight:"",fixedPaddingTop:"",curDepartmentId:"",leftRow:24,treeDataValue:"",deptTreeData:[],show:!1,sizeZoom:6,tableData:[],offlineData:[],onlineData:[],chartSetting:{yAxis:{type:"value",minInterval:1}},msgtopic:"",NODE_ENV:"production",category:[],activeName:"second",filterBox:"filterBox-first",project_count:0,app_count:0,product_count:0,dev_count:0,active:!1,dev_active_count:0,dev_online_count:0,dev_off_count:0,projectList:[],formInline:{starttime:"",project:""},screenWidth:"100%",emicstatusList:[{label:"战时状态",value:"all"},{label:"平时状态",value:"0"}],emicstatus:"0"}},computed:D({},Object(g["mapGetters"])({objectId:"user/objectId",roleTree:"user/roleTree",collapse:"settings/collapse",_Product:"user/_Product",language:"settings/language",_dev_count:"dashboard/_dev_count",_project_count:"dashboard/_project_count",_app_count:"dashboard/_app_count",_product_count:"dashboard/_product_count",token:"user/token",_dev_online_count:"dashboard/_dev_online_count",_onlineData:"dashboard/_onlineData",_dev_off_count:"dashboard/_dev_off_count",_offlineData:"dashboard/_offlineData",_ChartStatus:"dashboard/_ChartStatus",_tableData:"dashboard/_tableData",_pcimg:"dashboard/_pcimg",_role:"acl/role",_mimg:"dashboard/_mimg",mqttInfo:"mqttDB/mqttInfo",treeFlag:"settings/treeFlag"})),watch:{treeFlag:{handler:function(e){this.mapWidth=e?.77*window.innerWidth+"px":.98*window.innerWidth+"px"},deep:!0,limit:!0},sizeZoom:{handler:function(e){console.log("当前sizeZoom 为 "+e)},deep:!0,limit:!0},_dev_online_count:{handler:function(e){this.piechartData.rows[0]["数量"]=e},deep:!0,limit:!0},_dev_off_count:{handler:function(e){this.piechartData.rows[1]["数量"]=e},deep:!0,limit:!0}},mounted(){let e=this;window.bh="",window.kd="",this.homeScreen=localStorage.getItem("homeScreen")||0;let t=localStorage.getItem("background")||"";this.background=""==t?"/assets/bg/screen_center.png":this.$FileServe+t,console.log("路径",this.$FileServe),this.piechartData.rows=[{"名称":"在线设备","数量":this._dev_online_count},{"名称":"离线设备","数量":this._dev_off_count}],this.initMapHeight(),this.router=this.$dgiotBus.router(this.$route.fullPath),this.$dgiotBus.$off("qqMapClcik"),this.$dgiotBus.$on("qqMapClcik",e=>{console.log(e)}),this.queryForm.account="zh"==this.language?"全部产品":"All Products",this.initDgiotMqtt(),setTimeout(()=>{var e=document.querySelector(".home_index");this.screenWidth=e.offsetWidth+"px"},2e3),window.onresize=()=>(()=>{this.mapHeight=.8*window.innerHeight+"px",this.mapWidth=.98*window.innerWidth+"px";var t=document.querySelector(".home_index");e.screenWidth=t.offsetWidth+"px"})()},beforeDestroy(){return F(this,null,(function*(){}))},activated(){this.resizeTheChart()},destroyed(){this.resizeTheChart()},methods:A(D({handleMapClick(e){return F(this,null,(function*(){console.log("单击地图事件",e);e.point.lat,e.point.lng}))},getSelectedTrack(e){console.log(e.target.value);let t=e.target.value;"0"!=t?Object(w["getTrack"])("7cd65c6745").then(e=>{console.log("轨迹坐标",e),this.lineList=e.results}):this.lineList=[]},enter(){window.addEventListener("mousewheel",this.handleScroll,!0)},leave(){window.removeEventListener("mousewheel",this.handleScroll,!0)},handleScroll(e){e=e||window.event;var t=document.querySelector(".screen_center_center");e.wheelDelta>0||e.detail<0?(t.style.width=1.02*t.offsetWidth+"px",t.style.height=1.02*t.offsetHeight+"px"):(t.style.width=.98*t.offsetWidth+"px",t.style.height=.98*t.offsetHeight+"px")},initMapHeight(){return F(this,null,(function*(){this.mapHeight=.7*window.innerHeight+"px",this.mapWidth=.98*window.innerWidth+"px"}))},handler({BMap:e,map:t}){console.log(e,t),t.setMapType(BMAP_HYBRID_MAP)},getPosition(e){return e.forEach(e=>{e.lng=e.location.longitude,e.lat=e.location.latitude}),e},initDgiotMqtt(){this.setTreeFlag(!1),this.$nextTick(()=>F(this,null,(function*(){yield this.queryData()})))},getWarnCount(){return F(this,arguments,(function*(e={count:"objectId",where:{}}){e.where["createdAt"]={$gt:{__type:"Date",iso:moment().subtract(1,"days").format("YYYY-MM-DD")}},e.where["updatedAt"]={$lt:{__type:"Date",iso:moment(new Date).format("YYYY-MM-DD")}};try{const{count:t=0}=yield this.$query_object("Maintenance",e);this.warnCount=t}catch(t){this.$baseMessage(""+t,"error","dgiot-hey-message-error")}}))},toggleFull(e){this.count++,this.count%2==0?this.$exitFull("baidu_map"):this.$beFull("baidu_map")},resizeTheChart(){this.loading=!0;let e=this.$refs["charts"];e&&(e.$children[0].resize(),setTimeout(()=>{this.loading=!1},2e3))},tableRowClassName({row:e,rowIndex:t}){return 1===t?"warning-row":2===t?"success-row":""}},Object(g["mapMutations"])({setTreeFlag:"settings/setTreeFlag",resaveMqttInfo:"mqttDB/resaveMqttInfo",set_Product:"user/set_Product",set_dev_count:"dashboard/set_dev_count",set_project_count:"dashboard/set_project_count",set_app_count:"dashboard/set_app_count",set_product_count:"dashboard/set_product_count",set_dev_online_count:"dashboard/set_dev_online_count",set_onlineData:"dashboard/set_onlineData",set_dev_off_count:"dashboard/set_dev_off_count",set_offlineData:"dashboard/set_offlineData",set_ChartStatus:"dashboard/set_ChartStatus",set_tableData:"dashboard/set_tableData"})),{deviceToDetail(e){this.$router.push({path:"/roles/editdevices",query:{deviceid:e.objectId,nodeType:"2",ischildren:"false"}})},getCategory(e){let t="";return this.category.filter(a=>{a.type==e&&(t=a.data.CategoryName)}),t},closeInfo(e,t){e.show=!1},showDeatils(e,t){return F(this,null,(function*(){const a=this.$baseColorfullLoading(0);this.productIco="",this.deviceInfo=yield Object(h["getDevice"])(e.objectId);const{results:i=[{icon:""}]}=yield Object(m["queryProduct"])({count:"objectId",order:"-updatedAt",keys:"icon",where:{objectId:this.deviceInfo.product.objectId}});this.productIco=i[0].icon,a.close(),this.$refs["bm_info"+t][0].$children[0].show=!0}))},showInfo(e){return F(this,null,(function*(){this.deviceInfo=yield Object(h["getDevice"])(e);let t=this.deviceInfo.product.objectId||"undefined",a=this.deviceInfo.devaddr||"undefined",i=[{topic:`thing/${t}/${a}/post`,type:"pub",desc:"设备上报",isdef:!0},{topic:`thing/${t}/${a}`,type:"sub",desc:"消息下发",isdef:!0}];this.deviceInfo.product.topics?this.deviceInfo.topicData=this.deviceInfo.product.topics.concat(i):this.deviceInfo.topicData=i,this.deviceFlag=!0}))},mqttMsg(e){let t=Object(v["isBase64"])(e)?Base64.decode(e):e,a=JSON.parse(t).value,i=JSON.parse(t).vuekey;switch(i){case"app_count":this.app_count=a.count,this.set_app_count(this.app_count);break;case"project_count":this.project_count=a.count,this.set_project_count(this.project_count);break;case"product_count":this.product_count=a.count,this.set_product_count(this.product_count),this.Product=a.results;break;case"dev_online_count":this.dev_online_count=a.count,this.set_dev_online_count(this.dev_online_count),this.onlineData=a.results,this.set_onlineData(this.onlineData);break;case"dev_off_count":console.error(a,"mqttMsgValue"),this.dev_off_count=a.count,this.offlineData=a.results,this.set_dev_off_count(this.dev_off_count),this.set_offlineData(this.offlineData);break;case"warn_count":this.warnCount=a.count;break;case"ChartStatus":this.ChartStatus=a.chartData,this.set_ChartStatus(this.ChartStatus),this.resizeTheChart(),this.$forceUpdate();break;case"baiduMap":this.tableData=a,this.tableData.forEach(e=>{e.show=!1,e.color="0"===e.icon?"yellow":"1"===e.icon?"blue":"red"}),this.set_tableData(this.tableData),this.$forceUpdate();break;case"device_count":this.dev_count=a.count,this.set_dev_count(this.dev_count);break;default:break}this.$forceUpdate()},toggleCard(e){"0px"!=e?($(".map_card").css({height:"0px"}),this.cardHeight="0px"):($(".map_card").css({height:"98px"}),this.cardHeight="98px")},toggleLeftWidth(e){"0px"!=e?($(".dgiot-side-bar").css({width:"0px"}),$(".dgiot-main").css({"margin-left":"0px"}),this.leftWidth="0px"):($(".dgiot-side-bar").css({width:"200px"}),$(".dgiot-main").css({"margin-left":"200px"}),this.leftWidth="200px")},selectProdChange(e){},queryData(){return F(this,null,(function*(){const{dashboard:e={}}=yield Object(_["getDlinkJson"])("Dashboard");this.queryParams=e,setTimeout(()=>{this.queryParams.forEach(e=>{let t=e.vuekey;this.loadingConfig[""+t]=!0})},1240);const t="32511dbfe5";yield Object(f["Startdashboard"])(this.queryParams,t),this.$dgiotBus.$on(this.$dgiotBus.getTopicKeyBypage("dashboard"),e=>{const{payloadString:t}=e;this.mqttMsg(t)}),this.$nextTick(()=>{if("tencent"==this.mapType&&(this.setTreeFlag(!1),this.$refs.qqmap.$children[0].qqmap)){console.clear(),console.error(this.$refs.qqmap.$children[0]," this.$refs.qqmap.$children[0].qqmap"),document.querySelector(".lngTips").style.display="none",window.qq.maps.event.addListener(this.$refs.qqmap.$children[0].qqmap,"mousemove",(function(e){document.querySelector(".lngTips").style.display="none"}));var e=new window.qq.maps.LatLng(28.475997,121.331121),t=new qq.maps.InfoWindow({map:this.$refs.qqmap.$children[0].qqmap,position:e,content:'<div><h3>国家水泵产品质量检验中心(浙江)\n</h3><p>浙江省台州市温岭市迎宾大道温岭市泵业创新服务综合体\n</p><img class="pic" style="width:320px" src="https://sv6.map.qq.com/mmthumb?svid=18091033131005101120600&amp;from=web"></div>'});t.open(),this.$refs.qqmap.$children[0].qqmap.setZoom(18)}})}))},getProduct(){return F(this,null,(function*(){const{results:e}=yield Object(m["queryProduct"])({count:"objectId",order:"-updatedAt",keys:"name,icon",where:{}});e.unshift({name:"zh"==this.language?"全部产品":"All Products",objectId:"0"}),this.set_Product(e)}))},change(e){e&&$(".el-tree").css({height:"100px",display:"block","overflow-x":"auto"})},handleNodeClick(e,t){return F(this,null,(function*(){const a=this._role.map(e=>e.name);if($(".el-tree").css({height:"0px",display:"none","overflow-x":"auto"}),$(".el-select-dropdown").css({display:"none"}),this.queryForm.workGroupName=e.label,this.treeDataValue=e.label,a.includes(e.name))this.queryForm.access_token=this.token;else if(1!=t.level){const{access_token:t=""}=yield Object(b["getToken"])(e.name);this.queryForm.access_token=t}else this.queryForm.access_token=this.token;this.queryForm.workGroupTreeShow=!this.queryForm.workGroupTreeShow;const{name:i,objectId:o}=e;this.curDepartmentId=o}))},handleChange(){},handleClickVisit(e){this.$router.push({path:"/Topo",query:{productid:e.objectId}})},goDevice(e){this.$router.push({path:"/dashboard/devicelist",query:{product:e}})},_goDevice(e){this.$router.push({path:"/roles/editdevices",query:{deviceid:e.objectId,ischildren:"false"}})},goLink(e,t){var a;switch(e){case"real-time":this.$router.push({path:"/roles/editdevices",query:{deviceid:this.deviceInfo.objectId,nodeType:2,ischildren:"false"}});break;case"konva":this.$router.push({path:"/Topo",query:{productid:this.deviceInfo.product.objectId,devaddr:this.deviceInfo.devaddr,deviceid:this.deviceInfo.objectId,type:"device"}});break;case"video":const{basedata:e}=this.deviceInfo;if(!(null==(a=null==e?void 0:e.videoSrc)?void 0:a.length))return this.$baseMessage(this.$translateTitle("equipment.The device is not bound to the video address yet"),"info","dgiot-hey-message-error"),!1;this.$router.push({path:"/Tools/player",query:{type:e.videoType||"m3u8",url:e.videoSrc}});break}},Gotoproduct(e){this.$router.push({path:"/dashboard/productlist",query:{project:e}})}})},q=O,z=(a("04c1"),a("2877")),L=Object(z["a"])(q,i,o,!1,null,"1a3af85e",null);t["default"]=L.exports},b3e1:function(e,t,a){"use strict";a("bb08")},bb08:function(e,t,a){e.exports={"menu-color":"rgba(255,255,255,.95)","menu-color-active":"rgba(255,255,255,.95)","menu-background":"#282c34","column-second-menu-background":"#fff"}},cb83:function(e,t,a){},ee25:function(e,t,a){"use strict";a("6974")},ef1f4:function(e,t,a){"use strict";a("34d2")},f55a:function(e,t,a){},f77b:function(e,t,a){"use strict";a("f55a")}}]);