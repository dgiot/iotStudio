/*!
 *  build: 杭州数蛙科技有限公司 
 *  copyright: dgiot-dashboard 
 *  author: h7ml(h7ml@qq.com) 
 *  Time: 2022年09月09日20时44分49秒
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8c06be0e"],{"26da":function(t,e,s){},"3e35f":function(t,e,s){t.exports=s.p+"static/img/background.8fed5e23.jpg"},"3fb4":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{ref:"container",staticClass:"login-container",style:{backgroundImage:"url("+t.backgroundImage+")",backgroundRepeat:"no-repeat",backgroundSize:"100% 100%"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.bgShow,expression:"bgShow"}],staticClass:"bg"},[e("video",{staticClass:"bg_video",attrs:{autoplay:"",loop:"",muted:"muted",playsinline:"",preload:"auto",src:"http://www.dgiotcloud.cn/wp-content/uploads/2022090710055845.mp4",tabindex:"-1"},domProps:{muted:!0}}),e("div",{staticClass:"bg_wrap"},[e("div",{staticClass:"bg_top"},[e("div",{staticClass:"btn_back",on:{click:t.handleIn}},[e("div",{staticClass:"btn_back_in"},[t._v("官网")])])]),e("div",{staticClass:"bg_content"},[e("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll"}],staticClass:"bg_content_left"},t._l(t.typeList,(function(s,i){return e("div",{key:i,staticClass:"bg_content_left_item",class:i==t.currentIndex?"experience-left-hover":"experience-left",on:{click:function(e){return t.handleChoose(s,i)}}},[e("div",[t._v(t._s(s.name))])])})),0),e("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll"}],staticClass:"bg_content_right"},t._l(t.progList,(function(s,i){return e("div",{key:i,staticClass:"bg_content_right_item",on:{click:function(e){return t.handleChooseProgram(s)}}},[e("img",{staticClass:"bg_content_right_item_img",attrs:{src:s.img}}),e("div",{staticClass:"bg_content_right_item_name"},[t._v(t._s(s.name))])])})),0)])])]),t.isShow?e("el-row",[e("div",{staticClass:"btn_back",on:{click:function(e){t.bgShow=!0}}},[t._v("返回")]),e("el-col",{attrs:{lg:14,md:11,sm:24,xl:14,xs:24}},[e("div",{staticStyle:{color:"transparent"}},[t._v("占位符")])]),e("el-col",{attrs:{lg:9,md:12,sm:24,xl:9,xs:24}},[e("el-form",{ref:"form",staticClass:"login-form",attrs:{"label-position":"left",model:t.form,rules:t.rules}},[t.Default.title?e("div",{staticClass:"title-tips"},[t._v(" "+t._s(t.$translateTitle("home.login"))+" ")]):t._e(),e("el-form-item",{staticStyle:{"margin-top":"40px"},attrs:{prop:"username"}},[e("el-input",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{placeholder:t.$translateTitle("home.Please enter user name"),tabindex:"1",type:"text"},scopedSlots:t._u([{key:"prefix",fn:function(){return[e("dgiot-icon",{attrs:{icon:"user-line"}})]},proxy:!0}],null,!1,584386874),model:{value:t.form.username,callback:function(e){t.$set(t.form,"username","string"===typeof e?e.trim():e)},expression:"form.username"}})],1),e("el-form-item",{attrs:{prop:"password"}},[e("el-input",{key:t.passwordType,ref:"password",attrs:{placeholder:t.$translateTitle("home.Please enter the password"),tabindex:"2",type:t.passwordType},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleLogin.apply(null,arguments)}},scopedSlots:t._u([{key:"prefix",fn:function(){return[t.form.password.length?e("dgiot-icon",{attrs:{icon:"lock-line"}}):t._e()]},proxy:!0},"password"===t.passwordType&&t.form.password.length?{key:"suffix",fn:function(){return[e("dgiot-icon",{staticClass:"show-password",attrs:{icon:"eye-off-line"},nativeOn:{click:function(e){return t.handlePassword.apply(null,arguments)}}})]},proxy:!0}:{key:"suffix",fn:function(){return[t.form.password.length?e("dgiot-icon",{staticClass:"show-password",attrs:{icon:"eye-line"},nativeOn:{click:function(e){return t.handlePassword.apply(null,arguments)}}}):t._e()]},proxy:!0}],null,!0),model:{value:t.form.password,callback:function(e){t.$set(t.form,"password","string"===typeof e?e.trim():e)},expression:"form.password"}})],1),e("el-form-item",[e("el-input",{staticClass:"sbMc"},[e("el-button",{staticClass:"login-btn",attrs:{slot:"append",loading:t.loading,type:"primary"},nativeOn:{click:function(e){return t.handleLogin.apply(null,arguments)}},slot:"append"},[t._v(" "+t._s(t.$translateTitle("home.login"))+" ")])],1)],1),e("span",[e("router-link",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticStyle:{float:"left"},attrs:{to:"/register"}},[e("div",{staticStyle:{"margin-top":"20px"}},[t._v(" "+t._s(t.$translateTitle("home.registered"))+" ")])]),e("dgiot-language",{staticStyle:{float:"right","margin-top":"20px",cursor:"pointer"}})],1)],1)],1)],1):t._e()],1)},n=[],o=s("3e35f"),a=s.n(o),r=s("5880"),l=s("28d7"),c=s("1c4e"),d=s("bc35"),p=Object.defineProperty,u=Object.defineProperties,m=Object.getOwnPropertyDescriptors,g=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable,f=(t,e,s)=>e in t?p(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,y=(t,e)=>{for(var s in e||(e={}))h.call(e,s)&&f(t,s,e[s]);if(g)for(var s of g(e))w.call(e,s)&&f(t,s,e[s]);return t},b=(t,e)=>u(t,m(e)),v=(t,e,s)=>new Promise((i,n)=>{var o=t=>{try{r(s.next(t))}catch(e){n(e)}},a=t=>{try{r(s.throw(t))}catch(e){n(e)}},r=t=>t.done?i(t.value):Promise.resolve(t.value).then(o,a);r((s=s.apply(t,e)).next())}),k={name:"Login",directives:{focus:{inserted(t){t.querySelector("input").focus()}}},beforeRouteLeave(t,e,s){clearInterval(this.timer),clearInterval(this.interval),s()},data(){const t=(t,e,s)=>{""===e?s(new Error(this.info.empty)):s()},e=(t,e,s)=>{let i=4;Object(l["isPassword"])(e,i)?s():s(new Error(this.info.than+i+this.info.Bit))};return{bgShow:!0,typeList:[{id:0,name:"全部"},{id:1,name:"设备运维"},{id:2,name:"智慧园区"},{id:3,name:"智慧工厂"},{id:4,name:"智慧能源"},{id:5,name:"智慧物流"},{id:6,name:"边缘主机"},{id:7,name:"云检测"},{id:8,name:"云压测"}],programList:[{img:"http://www.dgiotcloud.cn/wp-content/uploads/2022090901575769.png",name:"智慧厕所",type:2,username:"dgiot_st",password:"dgiot_st"},{img:"https://www.dgiotcloud.cn/wp-content/uploads/2022080511362579.jpg",name:"工业设备租赁一体化运维平台",type:1},{img:"https://www.dgiotcloud.cn/wp-content/uploads/2022080512380157.png",name:"智慧园区/智慧场馆数字驾驶舱",type:2},{img:"https://www.dgiotcloud.cn/wp-content/uploads/202208221014537.png",name:"智慧监控-海康",type:2},{img:"https://www.dgiotcloud.cn/wp-content/uploads/2022082210305987.png",name:"弱电动环-浦洛斯",type:2},{img:"https://www.dgiotcloud.cn/wp-content/uploads/2022082210005721.png",name:"高配动环",type:2},{img:"https://www.dgiotcloud.cn/wp-content/uploads/2022082210453148.png",name:"能耗电表-正泰",type:2},{img:"https://www.dgiotcloud.cn/wp-content/uploads/2022082210453148.png",name:"能耗采集器-正泰",type:2},{img:"https://www.dgiotcloud.cn/wp-content/uploads/2022082209463162.png",name:"智慧广播-sonbs",type:2},{img:"https://www.dgiotcloud.cn/wp-content/uploads/2022082608530468.jpg",name:"数字工厂MES系统",type:3},{img:"https://www.dgiotcloud.cn/wp-content/uploads/2022080910110444.png",name:"水泵远程检测平台",type:3},{img:"https://www.dgiotcloud.cn/wp-content/uploads/2022080910554595.png",name:"多型太阳能板远程管控和多屏运维系统",type:4},{img:"https://www.dgiotcloud.cn/wp-content/uploads/2022080511492543.png",name:"千万级Zetag物流标签压测",type:5},{img:"https://www.dgiotcloud.cn/wp-content/uploads/2022082512160365.png",name:"边缘主机",type:6},{img:"https://www.dgiotcloud.cn/wp-content/uploads/2022080910155274.png",name:"水泵远程质量检测与质量对比系统",type:7},{img:"https://www.dgiotcloud.cn/wp-content/uploads/202208051146353.png",name:"dgiot云压测",type:8},{img:"https://www.dgiotcloud.cn/wp-content/uploads/2022080511413072.png",name:"三千万电表集抄压测",type:8},{img:"https://www.dgiotcloud.cn/wp-content/uploads/2022080511492543.png",name:"千万级Zetag物流标签压测",type:8}],progList:[],currentIndex:0,interval:null,isShow:"dgiot_iframe"!=window.name,locationPath:location.href.split("/#")[0],info:{empty:this.$translateTitle("home.Username can not be empty"),than:this.$translateTitle("home.Password cannot be less than"),Bit:this.$translateTitle("home.Bit")},backgroundImage:a.a,nodeEnv:"production",form:{username:"",password:""},rules:{username:[{required:!0,trigger:"blur",validator:t}],password:[{required:!0,trigger:"blur",validator:e}]},loading:!1,passwordType:"password",redirect:void 0,timer:0}},computed:y({},Object(r["mapGetters"])({language:"settings/language",Default:"acl/Default",license:"acl/license",logo:"user/logo",objectId:"user/objectId",backgroundimage:"user/backgroundimage",currentDepartment:"user/currentDepartment"})),watch:{language:{handler(t){this.changeInfo(t),this.$nextTick(()=>{this.$refs.form.resetFields()})},deep:!0,immediate:!0},"Default.background":{handler(t){this.backgroundImage=t},immediate:!0},$route:{handler(t){this.redirect=t.query&&t.query.redirect||"/"},immediate:!0}},beforeDestroy(){window.removeEventListener("message",this.iframeLogin)},mounted(){return v(this,null,(function*(){yield this.initShuwa(),this.$nextTick(()=>v(this,null,(function*(){yield this.defaultSet(),yield this.init()})))}))},created(){this.progList=this.programList,this.$removeToken(),this.isShow="dgiot_iframe"!=window.name,window.addEventListener("message",this.iframeLogin)},methods:b(y(b(y({},Object(r["mapMutations"])({setTitle:"settings/setTitle",setCopyright:"acl/setCopyright",setDefault:"acl/setDefault",setRoleTree:"user/setRoleTree"})),{handleIn(){window.open("https://www.dgiotcloud.cn/")},handleChooseProgram(t){this.bgShow=!1,this.form={username:t.username||"",password:t.password||""}},handleChoose(t,e){this.currentIndex=e;let s=[];0==t.id?this.progList=this.programList:(this.programList.forEach(e=>{e.type==t.id&&s.push(e)}),this.progList=s)},iframeLogin(t){return v(this,null,(function*(){try{const e={value:moment().format("YYYY:MM:DD  HH:mm:ss"),key:"startIframe",action:"save",type:"cookie",time:moment().format("YYYY:MM:DD  HH:mm:ss")};t.source.postMessage(e,t.origin);moment().format("YYYY:MM:DD  HH:mm:ss"),moment().format("YYYY:MM:DD  HH:mm:ss")}catch(e){console.log(e),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+e,"error","dgiot-hey-message-error")}}))},init(){return v(this,null,(function*(){try{Cookies.remove("startIframe"),Cookies.remove("pwaLogin"),this.$nextTick(()=>v(this,null,(function*(){"dgiot_iframe"==window.name&&(Cookies.set("startIframe",moment().format("YYYY:MM:DD HH:mm:ss"),{expires:18e5}),yield this.login({username:"feiiplat",password:"feiiplat"}),yield this.goHome())})))}catch(t){console.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}}))},defaultSet(){return v(this,null,(function*(){console.log("dgiot build time: "+dgiot.dateTime),console.log("startIframe time: "+Cookies.get("startIframe")),this.backgroundImage=Cookies.get("startIframe")?"https://s2.loli.net/2021/12/15/ciVTb7w62rxQ3a9.jpg":this.backgroundimage;const t=location.origin;Cookies.set("fileServer",t,{expires:18e5})}))},changeInfo(t){this.$set(this.info,"empty",this.$translateTitle("home.Username can not be empty")),this.$set(this.info,"than",this.$translateTitle("home.Password cannot be less than")),this.$set(this.info,"Bit",this.$translateTitle("home.Bit")),this.$forceUpdate()},forgotPwd(){this.$message(this.$translateTitle("home.Forgot password"))}}),Object(r["mapActions"])({login:"user/login",queryAll:"user/queryAll",jwtlogin:"user/jwtlogin"})),{getCategory(t){let e="";return this.category.filter(s=>{s.type==t&&(e=s.data.CategoryName)}),e},initShuwa(){return v(this,null,(function*(){const t=yield Object(c["SiteDefault"])(),{copyright:e,logo:s,objectId:i,title:n}=t;this.setDefault(t),this.setTitle(n),this.setCopyright(e)}))},handlePassword(){"password"===this.passwordType?this.passwordType="":this.passwordType="password",this.$nextTick(()=>{this.$refs.password.focus()})},handleRoute(){return"/404"===this.redirect||"/403"===this.redirect?"/":this.redirect},handleLogin(){this.$refs.form.validate(t=>v(this,null,(function*(){if(!t)return!1;try{this.loading=!0,yield this.login(this.form),yield this.goHome()}finally{this.loading=!1}})))},goHome(){return v(this,null,(function*(){try{this.interval=setInterval(()=>v(this,null,(function*(){if(""!=Cookies.get("handleRoute")){console.log("handleRoute 存在，跳转页面");const{results:t=[]}=yield Object(d["Roletree"])();this.setRoleTree(t),yield this.$router.push(this.handleRoute()),clearInterval(this.interval),window.clearInterval(this.interval)}})),800)}catch(t){console.log(t),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+t,"error","dgiot-hey-message-error")}}))}})},_=k,x=(s("b5f2"),s("2877")),C=Object(x["a"])(_,i,n,!1,null,"218fda82",null);e["default"]=C.exports},b5f2:function(t,e,s){"use strict";s("26da")}}]);