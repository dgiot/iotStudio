/*!
 *  build: 杭州数蛙科技有限公司 
 *  copyright: dgiot-dashboard 
 *  author: h7ml(h7ml@qq.com) 
 *  Time: 2022年07月05日15时53分52秒
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["vendors-dgiot-e824449d"],{"030f":function(t,n,e){(function(t){(function(){"use strict";var n=function(t){var n=typeof t;return null===t?"null":"object"===n&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===n&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":n},e=function(t){return function(e){return n(e)===t}},o=function(t){return function(n){return typeof n===t}},r=function(t){return function(n){return t===n}},i=e("string"),u=e("object"),a=e("array"),c=r(null),s=o("boolean"),f=r(void 0),l=function(t){return null===t||void 0===t},d=function(t){return!l(t)},m=o("function"),g=o("number"),p=function(t,n){if(a(t)){for(var e=0,o=t.length;e<o;++e)if(!n(t[e]))return!1;return!0}return!1},v=function(){},h=function(t){return function(){return t()}},b=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t(n.apply(null,e))}},y=function(t,n){return function(e){return t(n(e))}},x=function(t){return function(){return t}},w=function(t){return t},S=function(t,n){return t===n};function k(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var r=n.concat(e);return t.apply(null,r)}}var C=function(t){return function(n){return!t(n)}},O=function(t){return function(){throw new Error(t)}},_=x(!1),T=x(!0),E=tinymce.util.Tools.resolve("tinymce.ThemeManager"),D=function(){return D=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e],n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t},D.apply(this,arguments)};function B(t,n){var e={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&n.indexOf(o)<0&&(e[o]=t[o]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(e[o[r]]=t[o[r]])}return e}function M(t,n,e){if(e||2===arguments.length)for(var o,r=0,i=n.length;r<i;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))}var A=function(){return F},F=function(){var t=function(t){return t()},n=w,e={fold:function(t,n){return t()},isSome:_,isNone:T,getOr:n,getOrThunk:t,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:x(null),getOrUndefined:x(void 0),or:n,orThunk:t,map:A,each:v,bind:A,exists:_,forall:T,filter:function(){return A()},toArray:function(){return[]},toString:x("none()")};return e}(),I=function(t){var n=x(t),e=function(){return r},o=function(n){return n(t)},r={fold:function(n,e){return e(t)},isSome:T,isNone:_,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return I(n(t))},each:function(n){n(t)},bind:o,exists:o,forall:o,filter:function(n){return n(t)?r:F},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return r},R=function(t){return null===t||void 0===t?F:I(t)},V={some:I,none:A,from:R},P=Array.prototype.slice,H=Array.prototype.indexOf,z=Array.prototype.push,N=function(t,n){return H.call(t,n)},L=function(t,n){var e=N(t,n);return-1===e?V.none():V.some(e)},W=function(t,n){return N(t,n)>-1},U=function(t,n){for(var e=0,o=t.length;e<o;e++){var r=t[e];if(n(r,e))return!0}return!1},j=function(t,n){for(var e=[],o=0;o<t;o++)e.push(n(o));return e},G=function(t,n){for(var e=[],o=0;o<t.length;o+=n){var r=P.call(t,o,o+n);e.push(r)}return e},X=function(t,n){for(var e=t.length,o=new Array(e),r=0;r<e;r++){var i=t[r];o[r]=n(i,r)}return o},Y=function(t,n){for(var e=0,o=t.length;e<o;e++){var r=t[e];n(r,e)}},q=function(t,n){for(var e=t.length-1;e>=0;e--){var o=t[e];n(o,e)}},K=function(t,n){for(var e=[],o=[],r=0,i=t.length;r<i;r++){var u=t[r],a=n(u,r)?e:o;a.push(u)}return{pass:e,fail:o}},J=function(t,n){for(var e=[],o=0,r=t.length;o<r;o++){var i=t[o];n(i,o)&&e.push(i)}return e},$=function(t,n,e){return q(t,(function(t,o){e=n(e,t,o)})),e},Q=function(t,n,e){return Y(t,(function(t,o){e=n(e,t,o)})),e},Z=function(t,n,e){for(var o=0,r=t.length;o<r;o++){var i=t[o];if(n(i,o))return V.some(i);if(e(i,o))break}return V.none()},tt=function(t,n){return Z(t,n,_)},nt=function(t,n){for(var e=0,o=t.length;e<o;e++){var r=t[e];if(n(r,e))return V.some(e)}return V.none()},et=function(t){for(var n=[],e=0,o=t.length;e<o;++e){if(!a(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);z.apply(n,t[e])}return n},ot=function(t,n){return et(X(t,n))},rt=function(t,n){for(var e=0,o=t.length;e<o;++e){var r=t[e];if(!0!==n(r,e))return!1}return!0},it=function(t){var n=P.call(t,0);return n.reverse(),n},ut=function(t,n){return J(t,(function(t){return!W(n,t)}))},at=function(t,n){for(var e={},o=0,r=t.length;o<r;o++){var i=t[o];e[String(i)]=n(i,o)}return e},ct=function(t){return[t]},st=function(t,n){var e=P.call(t,0);return e.sort(n),e},ft=function(t,n){return n>=0&&n<t.length?V.some(t[n]):V.none()},lt=function(t){return ft(t,0)},dt=function(t){return ft(t,t.length-1)},mt=m(Array.from)?Array.from:function(t){return P.call(t)},gt=function(t,n){for(var e=0;e<t.length;e++){var o=n(t[e],e);if(o.isSome())return o}return V.none()},pt=Object.keys,vt=Object.hasOwnProperty,ht=function(t,n){for(var e=pt(t),o=0,r=e.length;o<r;o++){var i=e[o],u=t[i];n(u,i)}},bt=function(t,n){return yt(t,(function(t,e){return{k:e,v:n(t,e)}}))},yt=function(t,n){var e={};return ht(t,(function(t,o){var r=n(t,o);e[r.k]=r.v})),e},xt=function(t){return function(n,e){t[e]=n}},wt=function(t,n,e,o){var r={};return ht(t,(function(t,r){(n(t,r)?e:o)(t,r)})),r},St=function(t,n){var e={};return wt(t,n,xt(e),v),e},kt=function(t,n){var e=[];return ht(t,(function(t,o){e.push(n(t,o))})),e},Ct=function(t,n){for(var e=pt(t),o=0,r=e.length;o<r;o++){var i=e[o],u=t[i];if(n(u,i,t))return V.some(u)}return V.none()},Ot=function(t){return kt(t,w)},_t=function(t,n){return Tt(t,n)?V.from(t[n]):V.none()},Tt=function(t,n){return vt.call(t,n)},Et=function(t,n){return Tt(t,n)&&void 0!==t[n]&&null!==t[n]},Dt=function(t,n,e){return void 0===e&&(e=S),t.exists((function(t){return e(t,n)}))},Bt=function(t,n,e){return void 0===e&&(e=S),Ft(t,n,e).getOr(t.isNone()&&n.isNone())},Mt=function(t){for(var n=[],e=function(t){n.push(t)},o=0;o<t.length;o++)t[o].each(e);return n},At=function(t){for(var n=[],e=0;e<t.length;e++){var o=t[e];if(!o.isSome())return V.none();n.push(o.getOrDie())}return V.some(n)},Ft=function(t,n,e){return t.isSome()&&n.isSome()?V.some(e(t.getOrDie(),n.getOrDie())):V.none()},It=function(t,n,e,o){return t.isSome()&&n.isSome()&&e.isSome()?V.some(o(t.getOrDie(),n.getOrDie(),e.getOrDie())):V.none()},Rt=function(t,n){return void 0!==t&&null!==t?V.some(n(t)):V.none()},Vt=function(t,n){return t?V.some(n):V.none()},Pt=function(t,n){return t+n},Ht=function(t,n){return t.substring(n)},zt=function(t,n,e){return""===n||t.length>=n.length&&t.substr(e,e+n.length)===n},Nt=function(t,n){return Ut(t,n)?Ht(t,n.length):t},Lt=function(t,n){return jt(t,n)?t:Pt(t,n)},Wt=function(t,n){return-1!==t.indexOf(n)},Ut=function(t,n){return zt(t,n,0)},jt=function(t,n){return zt(t,n,t.length-n.length)},Gt=function(t){return function(n){return n.replace(t,"")}},Xt=Gt(/^\s+|\s+$/g),Yt=function(t){return t.length>0},qt=function(t){return!Yt(t)},Kt=function(t){return void 0!==t.style&&m(t.style.getPropertyValue)},Jt=function(t,n){var e=n||document,o=e.createElement("div");if(o.innerHTML=t,!o.hasChildNodes()||o.childNodes.length>1)throw console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return Zt(o.childNodes[0])},$t=function(t,n){var e=n||document,o=e.createElement(t);return Zt(o)},Qt=function(t,n){var e=n||document,o=e.createTextNode(t);return Zt(o)},Zt=function(t){if(null===t||void 0===t)throw new Error("Node cannot be null or undefined");return{dom:t}},tn=function(t,n,e){return V.from(t.dom.elementFromPoint(n,e)).map(Zt)},nn={fromHtml:Jt,fromTag:$t,fromText:Qt,fromDom:Zt,fromPoint:tn};"undefined"!==typeof window?window:Function("return this;")();var en,on=9,rn=11,un=1,an=3,cn=function(t){var n=t.dom.nodeName;return n.toLowerCase()},sn=function(t){return t.dom.nodeType},fn=function(t){return function(n){return sn(n)===t}},ln=fn(un),dn=fn(an),mn=fn(on),gn=fn(rn),pn=function(t){var n,e=!1;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return e||(e=!0,n=t.apply(null,o)),n}},vn=function(t,n,e,o){var r=t.isiOS()&&!0===/ipad/i.test(e),i=t.isiOS()&&!r,u=t.isiOS()||t.isAndroid(),a=u||o("(pointer:coarse)"),c=r||!i&&u&&o("(min-device-width:768px)"),s=i||u&&!c,f=n.isSafari()&&t.isiOS()&&!1===/safari/i.test(e),l=!s&&!c&&!f;return{isiPad:x(r),isiPhone:x(i),isTablet:x(c),isPhone:x(s),isTouch:x(a),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:x(f),isDesktop:x(l)}},hn=function(t,n){for(var e=0;e<t.length;e++){var o=t[e];if(o.test(n))return o}},bn=function(t,n){var e=hn(t,n);if(!e)return{major:0,minor:0};var o=function(t){return Number(n.replace(e,"$"+t))};return wn(o(1),o(2))},yn=function(t,n){var e=String(n).toLowerCase();return 0===t.length?xn():bn(t,e)},xn=function(){return wn(0,0)},wn=function(t,n){return{major:t,minor:n}},Sn={nu:wn,detect:yn,unknown:xn},kn=function(t,n){return gt(n.brands,(function(n){var e=n.brand.toLowerCase();return tt(t,(function(t){var n;return e===(null===(n=t.brand)||void 0===n?void 0:n.toLowerCase())})).map((function(t){return{current:t.name,version:Sn.nu(parseInt(n.version,10),0)}}))}))},Cn=function(t,n){var e=String(n).toLowerCase();return tt(t,(function(t){return t.search(e)}))},On=function(t,n){return Cn(t,n).map((function(t){var e=Sn.detect(t.versionRegexes,n);return{current:t.name,version:e}}))},_n=function(t,n){return Cn(t,n).map((function(t){var e=Sn.detect(t.versionRegexes,n);return{current:t.name,version:e}}))},Tn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,En=function(t){return function(n){return Wt(n,t)}},Dn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return Wt(t,"edge/")&&Wt(t,"chrome")&&Wt(t,"safari")&&Wt(t,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Tn],search:function(t){return Wt(t,"chrome")&&!Wt(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return Wt(t,"msie")||Wt(t,"trident")}},{name:"Opera",versionRegexes:[Tn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:En("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:En("firefox")},{name:"Safari",versionRegexes:[Tn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(Wt(t,"safari")||Wt(t,"mobile/"))&&Wt(t,"applewebkit")}}],Bn=[{name:"Windows",search:En("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return Wt(t,"iphone")||Wt(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:En("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:En("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:En("linux"),versionRegexes:[]},{name:"Solaris",search:En("sunos"),versionRegexes:[]},{name:"FreeBSD",search:En("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:En("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Mn={browsers:x(Dn),oses:x(Bn)},An="Edge",Fn="Chrome",In="IE",Rn="Opera",Vn="Firefox",Pn="Safari",Hn=function(){return zn({current:void 0,version:Sn.unknown()})},zn=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}};return{current:n,version:e,isEdge:o(An),isChrome:o(Fn),isIE:o(In),isOpera:o(Rn),isFirefox:o(Vn),isSafari:o(Pn)}},Nn={unknown:Hn,nu:zn,edge:x(An),chrome:x(Fn),ie:x(In),opera:x(Rn),firefox:x(Vn),safari:x(Pn)},Ln="Windows",Wn="iOS",Un="Android",jn="Linux",Gn="OSX",Xn="Solaris",Yn="FreeBSD",qn="ChromeOS",Kn=function(){return Jn({current:void 0,version:Sn.unknown()})},Jn=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}};return{current:n,version:e,isWindows:o(Ln),isiOS:o(Wn),isAndroid:o(Un),isOSX:o(Gn),isLinux:o(jn),isSolaris:o(Xn),isFreeBSD:o(Yn),isChromeOS:o(qn)}},$n={unknown:Kn,nu:Jn,windows:x(Ln),ios:x(Wn),android:x(Un),linux:x(jn),osx:x(Gn),solaris:x(Xn),freebsd:x(Yn),chromeos:x(qn)},Qn=function(t,n,e){var o=Mn.browsers(),r=Mn.oses(),i=n.bind((function(t){return kn(o,t)})).orThunk((function(){return On(o,t)})).fold(Nn.unknown,Nn.nu),u=_n(r,t).fold($n.unknown,$n.nu),a=vn(u,i,t,e);return{browser:i,os:u,deviceType:a}},Zn={detect:Qn},te=function(t){return window.matchMedia(t).matches},ne=pn((function(){return Zn.detect(navigator.userAgent,V.from(navigator.userAgentData),te)})),ee=function(){return ne()},oe=function(t,n,e){return 0!==(t.compareDocumentPosition(n)&e)},re=function(t,n){return oe(t,n,Node.DOCUMENT_POSITION_CONTAINED_BY)},ie=function(t,n){var e=t.dom;if(e.nodeType!==un)return!1;var o=e;if(void 0!==o.matches)return o.matches(n);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(n);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(n);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},ue=function(t){return t.nodeType!==un&&t.nodeType!==on&&t.nodeType!==rn||0===t.childElementCount},ae=function(t,n){var e=void 0===n?document:n.dom;return ue(e)?[]:X(e.querySelectorAll(t),nn.fromDom)},ce=function(t,n){var e=void 0===n?document:n.dom;return ue(e)?V.none():V.from(e.querySelector(t)).map(nn.fromDom)},se=function(t,n){return t.dom===n.dom},fe=function(t,n){var e=t.dom,o=n.dom;return e!==o&&e.contains(o)},le=function(t,n){return re(t.dom,n.dom)},de=function(t,n){return ee().browser.isIE()?le(t,n):fe(t,n)},me=function(t){return nn.fromDom(t.dom.ownerDocument)},ge=function(t){return mn(t)?t:me(t)},pe=function(t){return nn.fromDom(ge(t).dom.documentElement)},ve=function(t){return nn.fromDom(ge(t).dom.defaultView)},he=function(t){return V.from(t.dom.parentNode).map(nn.fromDom)},be=function(t){return he(t)},ye=function(t){return V.from(t.dom.offsetParent).map(nn.fromDom)},xe=function(t){return V.from(t.dom.nextSibling).map(nn.fromDom)},we=function(t){return X(t.dom.childNodes,nn.fromDom)},Se=function(t,n){var e=t.dom.childNodes;return V.from(e[n]).map(nn.fromDom)},ke=function(t){return Se(t,0)},Ce=function(t,n){return{element:t,offset:n}},Oe=function(t,n){var e=we(t);return e.length>0&&n<e.length?Ce(e[n],0):Ce(t,n)},_e=function(t){return gn(t)&&d(t.dom.host)},Te=m(Element.prototype.attachShadow)&&m(Node.prototype.getRootNode),Ee=x(Te),De=Te?function(t){return nn.fromDom(t.dom.getRootNode())}:ge,Be=function(t){return _e(t)?t:nn.fromDom(ge(t).dom.body)},Me=function(t){return Ae(t).isSome()},Ae=function(t){var n=De(t);return _e(n)?V.some(n):V.none()},Fe=function(t){return nn.fromDom(t.dom.host)},Ie=function(t){if(Ee()&&d(t.target)){var n=nn.fromDom(t.target);if(ln(n)&&Re(n)&&t.composed&&t.composedPath){var e=t.composedPath();if(e)return lt(e)}}return V.from(t.target)},Re=function(t){return d(t.dom.shadowRoot)},Ve=function(t){var n=dn(t)?t.dom.parentNode:t.dom;if(void 0===n||null===n||null===n.ownerDocument)return!1;var e=n.ownerDocument;return Ae(nn.fromDom(n)).fold((function(){return e.body.contains(n)}),y(Ve,Fe))},Pe=function(){return He(nn.fromDom(document))},He=function(t){var n=t.dom.body;if(null===n||void 0===n)throw new Error("Body is not available yet");return nn.fromDom(n)},ze=function(t,n,e){if(!(i(e)||s(e)||g(e)))throw console.error("Invalid call to Attribute.set. Key ",n,":: Value ",e,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,e+"")},Ne=function(t,n,e){ze(t.dom,n,e)},Le=function(t,n){var e=t.dom;ht(n,(function(t,n){ze(e,n,t)}))},We=function(t,n){var e=t.dom.getAttribute(n);return null===e?void 0:e},Ue=function(t,n){return V.from(We(t,n))},je=function(t,n){var e=t.dom;return!(!e||!e.hasAttribute)&&e.hasAttribute(n)},Ge=function(t,n){t.dom.removeAttribute(n)},Xe=function(t,n,e){if(!i(e))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",e,":: Element ",t),new Error("CSS value must be a string: "+e);Kt(t)&&t.style.setProperty(n,e)},Ye=function(t,n){Kt(t)&&t.style.removeProperty(n)},qe=function(t,n,e){var o=t.dom;Xe(o,n,e)},Ke=function(t,n){var e=t.dom;ht(n,(function(t,n){Xe(e,n,t)}))},Je=function(t,n){var e=t.dom;ht(n,(function(t,n){t.fold((function(){Ye(e,n)}),(function(t){Xe(e,n,t)}))}))},$e=function(t,n){var e=t.dom,o=window.getComputedStyle(e),r=o.getPropertyValue(n);return""!==r||Ve(t)?r:Qe(e,n)},Qe=function(t,n){return Kt(t)?t.style.getPropertyValue(n):""},Ze=function(t,n){var e=t.dom,o=Qe(e,n);return V.from(o).filter((function(t){return t.length>0}))},to=function(t){var n={},e=t.dom;if(Kt(e))for(var o=0;o<e.style.length;o++){var r=e.style.item(o);n[r]=e.style[r]}return n},no=function(t,n,e){var o=nn.fromTag(t);qe(o,n,e);var r=Ze(o,n);return r.isSome()},eo=function(t,n){var e=t.dom;Ye(e,n),Dt(Ue(t,"style").map(Xt),"")&&Ge(t,"style")},oo=function(t){return t.dom.offsetWidth},ro=function(t,n){var e=function(n,e){if(!g(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e);var o=n.dom;Kt(o)&&(o.style[t]=e+"px")},o=function(e){var o=n(e);if(o<=0||null===o){var r=$e(e,t);return parseFloat(r)||0}return o},r=o,i=function(t,n){return Q(n,(function(n,e){var o=$e(t,e),r=void 0===o?0:parseInt(o,10);return isNaN(r)?n:n+r}),0)},u=function(t,n,e){var o=i(t,e),r=n>o?n-o:0;return r};return{set:e,get:o,getOuter:r,aggregate:i,max:u}},io=ro("height",(function(t){var n=t.dom;return Ve(t)?n.getBoundingClientRect().height:n.offsetHeight})),uo=function(t){return io.get(t)},ao=function(t){return io.getOuter(t)},co=function(t,n){var e=["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"],o=io.max(t,n,e);qe(t,"max-height",o+"px")},so=function(t,n){var e=function(e,o){return so(t+e,n+o)};return{left:t,top:n,translate:e}},fo=so,lo=function(t){var n=t.getBoundingClientRect();return fo(n.left,n.top)},mo=function(t,n){return void 0!==t?t:void 0!==n?n:0},go=function(t){var n=t.dom.ownerDocument,e=n.body,o=n.defaultView,r=n.documentElement;if(e===t.dom)return fo(e.offsetLeft,e.offsetTop);var i=mo(null===o||void 0===o?void 0:o.pageYOffset,r.scrollTop),u=mo(null===o||void 0===o?void 0:o.pageXOffset,r.scrollLeft),a=mo(r.clientTop,e.clientTop),c=mo(r.clientLeft,e.clientLeft);return po(t).translate(u-c,i-a)},po=function(t){var n=t.dom,e=n.ownerDocument,o=e.body;return o===n?fo(o.offsetLeft,o.offsetTop):Ve(t)?lo(n):fo(0,0)},vo=ro("width",(function(t){return t.dom.offsetWidth})),ho=function(t,n){return vo.set(t,n)},bo=function(t){return vo.get(t)},yo=function(t){return vo.getOuter(t)},xo=function(t,n){var e=["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"],o=vo.max(t,n,e);qe(t,"max-width",o+"px")},wo=function(t,n,e,o,r,i,u){return{target:t,x:n,y:e,stop:o,prevent:r,kill:i,raw:u}},So=function(t){var n=nn.fromDom(Ie(t).getOr(t.target)),e=function(){return t.stopPropagation()},o=function(){return t.preventDefault()},r=b(o,e);return wo(n,t.clientX,t.clientY,e,o,r,t)},ko=function(t,n){return function(e){t(e)&&n(So(e))}},Co=function(t,n,e,o,r){var i=ko(e,o);return t.dom.addEventListener(n,i,r),{unbind:k(To,t,n,i,r)}},Oo=function(t,n,e,o){return Co(t,n,e,o,!1)},_o=function(t,n,e,o){return Co(t,n,e,o,!0)},To=function(t,n,e,o){t.dom.removeEventListener(n,e,o)},Eo=function(t,n){var e=he(t);e.each((function(e){e.dom.insertBefore(n.dom,t.dom)}))},Do=function(t,n){var e=xe(t);e.fold((function(){var e=he(t);e.each((function(t){Mo(t,n)}))}),(function(t){Eo(t,n)}))},Bo=function(t,n){var e=ke(t);e.fold((function(){Mo(t,n)}),(function(e){t.dom.insertBefore(n.dom,e.dom)}))},Mo=function(t,n){t.dom.appendChild(n.dom)},Ao=function(t,n,e){Se(t,e).fold((function(){Mo(t,n)}),(function(t){Eo(t,n)}))},Fo=function(t,n){Y(n,(function(n){Eo(t,n)}))},Io=function(t,n){Y(n,(function(n){Mo(t,n)}))},Ro=function(t){t.dom.textContent="",Y(we(t),(function(t){Vo(t)}))},Vo=function(t){var n=t.dom;null!==n.parentNode&&n.parentNode.removeChild(n)},Po=function(t){var n=we(t);n.length>0&&Fo(t,n),Vo(t)},Ho=function(t){var n=void 0!==t?t.dom:document,e=n.body.scrollLeft||n.documentElement.scrollLeft,o=n.body.scrollTop||n.documentElement.scrollTop;return fo(e,o)},zo=function(t,n,e){var o=void 0!==e?e.dom:document,r=o.defaultView;r&&r.scrollTo(t,n)},No=function(t){var n=void 0===t?window:t;return ee().browser.isFirefox()?V.none():V.from(n["visualViewport"])},Lo=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},Wo=function(t){var n=void 0===t?window:t,e=n.document,o=Ho(nn.fromDom(e));return No(n).fold((function(){var t=n.document.documentElement,e=t.clientWidth,r=t.clientHeight;return Lo(o.left,o.top,e,r)}),(function(t){return Lo(Math.max(t.pageLeft,o.left),Math.max(t.pageTop,o.top),t.width,t.height)}))},Uo=function(t,n){var e=t.view(n);return e.fold(x([]),(function(n){var e=t.owner(n),o=Uo(t,e);return[n].concat(o)}))},jo=function(t,n){var e=n.owner(t),o=Uo(n,e);return V.some(o)},Go=function(t){var n,e=t.dom===document?V.none():V.from(null===(n=t.dom.defaultView)||void 0===n?void 0:n.frameElement);return e.map(nn.fromDom)},Xo=function(t){return me(t)},Yo=Object.freeze({__proto__:null,view:Go,owner:Xo}),qo=function(t){var n=nn.fromDom(document),e=Ho(n),o=jo(t,Yo);return o.fold(k(go,t),(function(n){var o=po(t),r=$(n,(function(t,n){var e=po(n);return{left:t.left+e.left,top:t.top+e.top}}),{left:0,top:0});return fo(r.left+o.left+e.left,r.top+o.top+e.top)}))},Ko=function(t,n,e){return{point:t,width:n,height:e}},Jo=function(t,n,e,o){return{x:t,y:n,width:e,height:o}},$o=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},Qo=function(t){var n=go(t),e=yo(t),o=ao(t);return $o(n.left,n.top,e,o)},Zo=function(t){var n=qo(t),e=yo(t),o=ao(t);return $o(n.left,n.top,e,o)},tr=function(){return Wo(window)},nr=function(t){var n=function(n){return nr(t)},e=function(n){return nr(t)},o=function(n){return nr(n(t))},r=function(n){return nr(t)},i=function(n){n(t)},u=function(n){return n(t)},a=function(n,e){return e(t)},c=function(n){return n(t)},s=function(n){return n(t)},f=function(){return V.some(t)};return{isValue:T,isError:_,getOr:x(t),getOrThunk:x(t),getOrDie:x(t),or:n,orThunk:e,fold:a,map:o,mapError:r,each:i,bind:u,exists:c,forall:s,toOptional:f}},er=function(t){var n=function(t){return t()},e=function(){return O(String(t))()},o=w,r=function(t){return t()},i=function(n){return er(t)},u=function(n){return er(n(t))},a=function(n){return er(t)},c=function(n,e){return n(t)};return{isValue:_,isError:T,getOr:w,getOrThunk:n,getOrDie:e,or:o,orThunk:r,fold:c,map:i,mapError:u,each:v,bind:a,exists:_,forall:T,toOptional:V.none}},or=function(t,n){return t.fold((function(){return er(n)}),nr)},rr={value:nr,error:er,fromOption:or};(function(t){t[t["Error"]=0]="Error",t[t["Value"]=1]="Value"})(en||(en={}));var ir=function(t,n,e){return t.stype===en.Error?n(t.serror):e(t.svalue)},ur=function(t){var n=[],e=[];return Y(t,(function(t){ir(t,(function(t){return e.push(t)}),(function(t){return n.push(t)}))})),{values:n,errors:e}},ar=function(t,n){return t.stype===en.Error?{stype:en.Error,serror:n(t.serror)}:t},cr=function(t,n){return t.stype===en.Value?{stype:en.Value,svalue:n(t.svalue)}:t},sr=function(t,n){return t.stype===en.Value?n(t.svalue):t},fr=function(t,n){return t.stype===en.Error?n(t.serror):t},lr=function(t){return{stype:en.Value,svalue:t}},dr=function(t){return{stype:en.Error,serror:t}},mr=function(t){return ir(t,rr.error,rr.value)},gr=function(t){return t.fold(dr,lr)},pr={fromResult:gr,toResult:mr,svalue:lr,partition:ur,serror:dr,bind:sr,bindError:fr,map:cr,mapError:ar,fold:ir},vr=function(t,n,e,o){return{tag:"field",key:t,newKey:n,presence:e,prop:o}},hr=function(t,n){return{tag:"custom",newKey:t,instantiator:n}},br=function(t,n,e){switch(t.tag){case"field":return n(t.key,t.newKey,t.presence,t.prop);case"custom":return e(t.newKey,t.instantiator)}},yr=function(t,n){return n},xr=function(t,n){var e=u(t)&&u(n);return e?Sr(t,n):n},wr=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var o={},r=0;r<n.length;r++){var i=n[r];for(var u in i)Tt(i,u)&&(o[u]=t(o[u],i[u]))}return o}},Sr=wr(xr),kr=wr(yr),Cr=function(){return{tag:"required",process:{}}},Or=function(t){return{tag:"defaultedThunk",process:t}},_r=function(t){return Or(x(t))},Tr=function(){return{tag:"option",process:{}}},Er=function(t){return{tag:"mergeWithThunk",process:t}},Dr=function(t){return Er(x(t))},Br=function(t,n){return t.length>0?pr.svalue(Sr(n,kr.apply(void 0,t))):pr.svalue(n)},Mr=function(t){return b(pr.serror,et)(t)},Ar=function(t,n){var e=pr.partition(t);return e.errors.length>0?Mr(e.errors):Br(e.values,n)},Fr=function(t){var n=pr.partition(t);return n.errors.length>0?Mr(n.errors):pr.svalue(n.values)},Ir={consolidateObj:Ar,consolidateArr:Fr},Rr=function(t){return u(t)&&pt(t).length>100?" removed due to size":JSON.stringify(t,null,2)},Vr=function(t){var n=t.length>10?t.slice(0,10).concat([{path:[],getErrorInfo:x("... (only showing first ten failures)")}]):t;return X(n,(function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()}))},Pr=function(t,n){return pr.serror([{path:t,getErrorInfo:n}])},Hr=function(t,n,e){return Pr(t,(function(){return'Could not find valid *required* value for "'+n+'" in '+Rr(e)}))},zr=function(t,n){return Pr(t,(function(){return'Choice schema did not contain choice key: "'+n+'"'}))},Nr=function(t,n,e){return Pr(t,(function(){return'The chosen schema: "'+e+'" did not exist in branches: '+Rr(n)}))},Lr=function(t,n){return Pr(t,(function(){return"There are unsupported fields: ["+n.join(", ")+"] specified"}))},Wr=function(t,n){return Pr(t,x(n))},Ur=function(t){var n=function(n,e){return pr.bindError(t(e),(function(t){return Wr(n,t)}))},e=x("val");return{extract:n,toString:e}},jr=Ur(pr.svalue),Gr=function(t,n,e,o){return _t(n,e).fold((function(){return Hr(t,e,n)}),o)},Xr=function(t,n,e,o){var r=_t(t,n).getOrThunk((function(){return e(t)}));return o(r)},Yr=function(t,n,e){return e(_t(t,n))},qr=function(t,n,e,o){var r=_t(t,n).map((function(n){return!0===n?e(t):n}));return o(r)},Kr=function(t,n,e,o,r){var i=function(t){return r.extract(n.concat([o]),t)},u=function(t){return t.fold((function(){return pr.svalue(V.none())}),(function(t){var e=r.extract(n.concat([o]),t);return pr.map(e,V.some)}))};switch(t.tag){case"required":return Gr(n,e,o,i);case"defaultedThunk":return Xr(e,o,t.process,i);case"option":return Yr(e,o,u);case"defaultedOptionThunk":return qr(e,o,t.process,u);case"mergeWithThunk":return Xr(e,o,x({}),(function(n){var o=Sr(t.process(e),n);return i(o)}))}},Jr=function(t,n,e){for(var o={},r=[],i=0,u=e;i<u.length;i++){var a=u[i];br(a,(function(e,i,u,a){var c=Kr(u,t,n,e,a);pr.fold(c,(function(t){r.push.apply(r,t)}),(function(t){o[i]=t}))}),(function(t,e){o[t]=e(n)}))}return r.length>0?pr.serror(r):pr.svalue(o)},$r=function(t){var n=function(n,e){return t().extract(n,e)},e=function(){return t().toString()};return{extract:n,toString:e}},Qr=function(t){return pt(St(t,d))},Zr=function(t){var n=ti(t),e=$(t,(function(t,n){return br(n,(function(n){var e;return Sr(t,(e={},e[n]=!0,e))}),x(t))}),{}),o=function(t,o){var r=s(o)?[]:Qr(o),i=J(r,(function(t){return!Et(e,t)}));return 0===i.length?n.extract(t,o):Lr(t,i)};return{extract:o,toString:n.toString}},ti=function(t){var n=function(n,e){return Jr(n,e,t)},e=function(){var n=X(t,(function(t){return br(t,(function(t,n,e,o){return t+" -> "+o.toString()}),(function(t,n){return"state("+t+")"}))}));return"obj{\n"+n.join("\n")+"}"};return{extract:n,toString:e}},ni=function(t){var n=function(n,e){var o=X(e,(function(e,o){return t.extract(n.concat(["["+o+"]"]),e)}));return Ir.consolidateArr(o)},e=function(){return"array("+t.toString()+")"};return{extract:n,toString:e}},ei=function(t){var n=function(n,e){for(var o=[],r=0,i=t;r<i.length;r++){var u=i[r],a=u.extract(n,e);if(a.stype===en.Value)return a;o.push(a)}return Ir.consolidateArr(o)},e=function(){return"oneOf("+X(t,(function(t){return t.toString()})).join(", ")+")"};return{extract:n,toString:e}},oi=function(t,n){var e=function(n,e){return ni(Ur(t)).extract(n,e)},o=function(t,o){var r=pt(o),i=e(t,r);return pr.bind(i,(function(e){var r=X(e,(function(t){return vr(t,t,Cr(),n)}));return ti(r).extract(t,o)}))},r=function(){return"setOf("+n.toString()+")"};return{extract:o,toString:r}},ri=function(t,n){var e=pn(n),o=function(t,n){return e().extract(t,n)},r=function(){return e().toString()};return{extract:o,toString:r}},ii=b(ni,ti),ui=x(jr),ai=function(t,n){return Ur((function(e){var o=typeof e;return t(e)?pr.svalue(e):pr.serror("Expected type: "+n+" but got: "+o)}))},ci=ai(g,"number"),si=ai(i,"string"),fi=ai(s,"boolean"),li=ai(m,"function"),di=function(t){if(Object(t)!==t)return!0;switch({}.toString.call(t).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(t).every((function(n){return di(t[n])}));default:return!1}},mi=Ur((function(t){return di(t)?pr.svalue(t):pr.serror("Expected value to be acceptable for sending via postMessage")})),gi=function(t,n,e,o){var r=_t(e,o);return r.fold((function(){return Nr(t,e,o)}),(function(e){return e.extract(t.concat(["branch: "+o]),n)}))},pi=function(t,n){var e=function(e,o){var r=_t(o,t);return r.fold((function(){return zr(e,t)}),(function(t){return gi(e,o,n,t)}))},o=function(){return"chooseOn("+t+"). Possible values: "+pt(n)};return{extract:e,toString:o}},vi=function(){return ni(jr)},hi=function(t){return Ur((function(n){return t(n).fold(pr.serror,pr.svalue)}))},bi=function(t,n){return oi((function(n){return pr.fromResult(t(n))}),n)},yi=function(t,n,e){var o=n.extract([t],e);return pr.mapError(o,(function(t){return{input:e,errors:t}}))},xi=function(t,n,e){return pr.toResult(yi(t,n,e))},wi=function(t){return t.fold((function(t){throw new Error(ki(t))}),w)},Si=function(t,n,e){return wi(xi(t,n,e))},ki=function(t){return"Errors: \n"+Vr(t.errors).join("\n")+"\n\nInput object: "+Rr(t.input)},Ci=function(t,n){return pi(t,bt(n,ti))},Oi=function(t,n){return ri(t,n)},_i=vr,Ti=hr,Ei=function(t){return hi((function(n){return W(t,n)?rr.value(n):rr.error('Unsupported value: "'+n+'", choose one of "'+t.join(", ")+'".')}))},Di=function(t){return _i(t,t,Cr(),ui())},Bi=function(t,n){return _i(t,t,Cr(),n)},Mi=function(t){return Bi(t,ci)},Ai=function(t){return Bi(t,si)},Fi=function(t,n){return _i(t,t,Cr(),Ei(n))},Ii=function(t){return Bi(t,fi)},Ri=function(t){return Bi(t,li)},Vi=function(t,n){return _i(t,t,Tr(),Ur((function(e){return pr.serror("The field: "+t+" is forbidden. "+n)})))},Pi=function(t,n){return _i(t,t,Cr(),ti(n))},Hi=function(t,n){return _i(t,t,Cr(),ii(n))},zi=function(t,n){return _i(t,t,Cr(),ni(n))},Ni=function(t){return _i(t,t,Tr(),ui())},Li=function(t,n){return _i(t,t,Tr(),n)},Wi=function(t){return Li(t,ci)},Ui=function(t){return Li(t,si)},ji=function(t){return Li(t,li)},Gi=function(t,n){return Li(t,ni(n))},Xi=function(t,n){return Li(t,ti(n))},Yi=function(t,n){return Li(t,Zr(n))},qi=function(t,n){return _i(t,t,_r(n),ui())},Ki=function(t,n,e){return _i(t,t,_r(n),e)},Ji=function(t,n){return Ki(t,n,ci)},$i=function(t,n){return Ki(t,n,si)},Qi=function(t,n,e){return Ki(t,n,Ei(e))},Zi=function(t,n){return Ki(t,n,fi)},tu=function(t,n){return Ki(t,n,li)},nu=function(t,n){return Ki(t,n,mi)},eu=function(t,n,e){return Ki(t,n,ni(e))},ou=function(t,n,e){return Ki(t,n,ti(e))},ru=function(t){var n=t,e=function(){return n},o=function(t){n=t};return{get:e,set:o}},iu=function(t){if(!a(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var n=[],e={};return Y(t,(function(o,r){var i=pt(o);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],c=o[u];if(void 0!==e[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!a(c))throw new Error("case arguments must be an array");n.push(u),e[u]=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var i=e.length;if(i!==c.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+c.length+" ("+c+"), got "+i);var a=function(t){var o=pt(t);if(n.length!==o.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+o.join(","));var r=rt(n,(function(t){return W(o,t)}));if(!r)throw new Error("Not all branches were specified when using match. Specified: "+o.join(", ")+"\nRequired: "+n.join(", "));return t[u].apply(null,e)};return{fold:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];if(n.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+n.length);var i=n[r];return i.apply(null,e)},match:a,log:function(t){console.log(t,{constructors:n,constructor:u,params:e})}}}})),e},uu={generate:iu};uu.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);var au,cu=function(t){var n=[],e=[];return Y(t,(function(t){t.fold((function(t){n.push(t)}),(function(t){e.push(t)}))})),{errors:n,values:e}},su=function(t,n){var e={};return ht(t,(function(t,o){W(n,o)||(e[o]=t)})),e},fu=function(t,n){var e;return e={},e[t]=n,e},lu=function(t){var n={};return Y(t,(function(t){n[t.key]=t.value})),n},du=function(t,n){return su(t,n)},mu=function(t,n){return fu(t,n)},gu=function(t){return lu(t)},pu=function(t,n){return 0===t.length?rr.value(n):rr.value(Sr(n,kr.apply(void 0,t)))},vu=function(t){return rr.error(et(t))},hu=function(t,n){var e=cu(t);return e.errors.length>0?vu(e.errors):pu(e.values,n)},bu=function(t){return m(t)?t:_},yu=function(t,n,e){var o=t.dom,r=bu(e);while(o.parentNode){o=o.parentNode;var i=nn.fromDom(o),u=n(i);if(u.isSome())return u;if(r(i))break}return V.none()},xu=function(t,n,e){var o=n(t),r=bu(e);return o.orThunk((function(){return r(t)?V.none():yu(t,n,r)}))},wu=function(t,n){return se(t.element,n.event.target)},Su={can:T,abort:_,run:v},ku=function(t){if(!Et(t,"can")&&!Et(t,"abort")&&!Et(t,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(t,null,2)+" does not have can, abort, or run!");return D(D({},Su),t)},Cu=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return Q(t,(function(t,o){return t&&n(o).apply(void 0,e)}),!0)}},Ou=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return Q(t,(function(t,o){return t||n(o).apply(void 0,e)}),!1)}},_u=function(t){return m(t)?{can:T,abort:_,run:t}:t},Tu=function(t){var n=Cu(t,(function(t){return t.can})),e=Ou(t,(function(t){return t.abort})),o=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];Y(t,(function(t){t.run.apply(void 0,n)}))};return{can:n,abort:e,run:o}},Eu=x,Du=Eu("touchstart"),Bu=Eu("touchmove"),Mu=Eu("touchend"),Au=Eu("touchcancel"),Fu=Eu("mousedown"),Iu=Eu("mousemove"),Ru=Eu("mouseout"),Vu=Eu("mouseup"),Pu=Eu("mouseover"),Hu=Eu("focusin"),zu=Eu("focusout"),Nu=Eu("keydown"),Lu=Eu("keyup"),Wu=Eu("input"),Uu=Eu("change"),ju=Eu("click"),Gu=Eu("transitioncancel"),Xu=Eu("transitionend"),Yu=Eu("transitionstart"),qu=Eu("selectstart"),Ku=function(t){return x("alloy."+t)},Ju={tap:Ku("tap")},$u=Ku("focus"),Qu=Ku("blur.post"),Zu=Ku("paste.post"),ta=Ku("receive"),na=Ku("execute"),ea=Ku("focus.item"),oa=Ju.tap,ra=Ku("longpress"),ia=Ku("sandbox.close"),ua=Ku("typeahead.cancel"),aa=Ku("system.init"),ca=Ku("system.touchmove"),sa=Ku("system.touchend"),fa=Ku("system.scroll"),la=Ku("system.resize"),da=Ku("system.attached"),ma=Ku("system.detached"),ga=Ku("system.dismissRequested"),pa=Ku("system.repositionRequested"),va=Ku("focusmanager.shifted"),ha=Ku("slotcontainer.visibility"),ba=Ku("change.tab"),ya=Ku("dismiss.tab"),xa=Ku("highlight"),wa=Ku("dehighlight"),Sa=function(t,n){_a(t,t.element,n,{})},ka=function(t,n,e){_a(t,t.element,n,e)},Ca=function(t){Sa(t,na())},Oa=function(t,n,e){_a(t,n,e,{})},_a=function(t,n,e,o){var r=D({target:n},o);t.getSystem().triggerEvent(e,n,r)},Ta=function(t,n,e,o){t.getSystem().triggerEvent(e,n,o.event)},Ea=function(t){return gu(t)},Da=function(t,n){return{key:t,value:ku({abort:n})}},Ba=function(t,n){return{key:t,value:ku({can:n})}},Ma=function(t){return{key:t,value:ku({run:function(t,n){n.event.prevent()}})}},Aa=function(t,n){return{key:t,value:ku({run:n})}},Fa=function(t,n,e){return{key:t,value:ku({run:function(t,o){n.apply(void 0,[t,o].concat(e))}})}},Ia=function(t){return function(n){return Aa(t,n)}},Ra=function(t){return function(n){return{key:t,value:ku({run:function(t,e){wu(t,e)&&n(t,e)}})}}},Va=function(t,n){return Aa(t,(function(e,o){e.getSystem().getByUid(n).each((function(n){Ta(n,n.element,t,o)}))}))},Pa=function(t,n,e){var o=n.partUids[e];return Va(t,o)},Ha=function(t,n){return Aa(t,(function(t,e){var o=e.event,r=t.getSystem().getByDom(o.target).getOrThunk((function(){var n=xu(o.target,(function(n){return t.getSystem().getByDom(n).toOptional()}),_);return n.getOr(t)}));n(t,r,e)}))},za=function(t){return Aa(t,(function(t,n){n.cut()}))},Na=function(t){return Aa(t,(function(t,n){n.stop()}))},La=function(t,n){return Ra(t)(n)},Wa=Ra(da()),Ua=Ra(ma()),ja=Ra(aa()),Ga=Ia(na()),Xa=function(t,n){var e=n||document,o=e.createElement("div");return o.innerHTML=t,we(nn.fromDom(o))},Ya=function(t){return t.dom.innerHTML},qa=function(t,n){var e=me(t),o=e.dom,r=nn.fromDom(o.createDocumentFragment()),i=Xa(n,o);Io(r,i),Ro(t),Mo(t,r)},Ka=function(t){var n=nn.fromTag("div"),e=nn.fromDom(t.dom.cloneNode(!0));return Mo(n,e),Ya(n)},Ja=function(t,n){return nn.fromDom(t.dom.cloneNode(n))},$a=function(t){return Ja(t,!1)},Qa=function(t){if(_e(t))return"#shadow-root";var n=$a(t);return Ka(n)},Za=function(t){return Qa(t)},tc=function(t,n,e){return se(n,t.element)&&!se(n,e)},nc=Ea([Ba($u(),(function(t,n){var e=n.event,o=e.originator,r=e.target;return!tc(t,o,r)||(console.warn($u()+" did not get interpreted by the desired target. \nOriginator: "+Za(o)+"\nTarget: "+Za(r)+"\nCheck the "+$u()+" event handlers"),!1)}))]),ec=Object.freeze({__proto__:null,events:nc}),oc=0,rc=function(t){var n=new Date,e=n.getTime(),o=Math.floor(1e9*Math.random());return oc++,t+"_"+o+oc+String(e)},ic=x("alloy-id-"),uc=x("data-alloy-id"),ac=ic(),cc=uc(),sc=function(t,n){var e=rc(ac+t);return fc(n,e),e},fc=function(t,n){Object.defineProperty(t.dom,cc,{value:n,writable:!0})},lc=function(t){var n=ln(t)?t.dom[cc]:null;return V.from(n)},dc=function(t){return rc(t)},mc=w,gc=function(t){var n=function(n){return"The component must be in a context to execute: "+n+(t?"\n"+Za(t().element)+" is not in context.":"")},e=function(t){return function(){throw new Error(n(t))}},o=function(t){return function(){console.warn(n(t))}};return{debugInfo:x("fake"),triggerEvent:o("triggerEvent"),triggerFocus:o("triggerFocus"),triggerEscape:o("triggerEscape"),broadcast:o("broadcast"),broadcastOn:o("broadcastOn"),broadcastEvent:o("broadcastEvent"),build:e("build"),addToWorld:e("addToWorld"),removeFromWorld:e("removeFromWorld"),addToGui:e("addToGui"),removeFromGui:e("removeFromGui"),getByUid:e("getByUid"),getByDom:e("getByDom"),isConnected:_}},pc=gc(),vc=function(t,n,e){var o=e.toString(),r=o.indexOf(")")+1,i=o.indexOf("("),u=o.substring(i+1,r-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:hc(u.slice(0,1).concat(u.slice(3)))}},t},hc=function(t){return X(t,(function(t){return jt(t,"/*")?t.substring(0,t.length-"/*".length):t}))},bc=function(t,n){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:hc(i)}},t},yc=function(t,n){var e=n.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:hc(i.slice(1))}},t},xc=rc("alloy-premade"),wc=function(t){return mu(xc,t)},Sc=function(t){return _t(t,xc)},kc=function(t){return yc((function(n){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return t.apply(void 0,M([n.getApis(),n],e,!1))}),t)},Cc={init:function(){return Oc({readState:x("No State required")})}},Oc=function(t){return t},_c=function(t,n){var e=X(n,(function(t){return Xi(t.name(),[Di("config"),qi("state",Cc)])})),o=xi("component.behaviours",ti(e),t.behaviours).fold((function(n){throw new Error(ki(n)+"\nComplete spec:\n"+JSON.stringify(t,null,2))}),w);return{list:n,data:bt(o,(function(t){var n=t.map((function(t){return{config:t.config,state:t.state.init(t.config)}}));return x(n)}))}},Tc=function(t){return t.list},Ec=function(t){return t.data},Dc=function(t,n){var e={};return ht(t,(function(t,o){ht(t,(function(t,r){var i=_t(e,r).getOr([]);e[r]=i.concat([n(o,t)])}))})),e},Bc=function(t){return{classes:f(t.classes)?[]:t.classes,attributes:f(t.attributes)?{}:t.attributes,styles:f(t.styles)?{}:t.styles}},Mc=function(t,n){return D(D({},t),{attributes:D(D({},t.attributes),n.attributes),styles:D(D({},t.styles),n.styles),classes:t.classes.concat(n.classes)})},Ac=function(t,n,e,o){var r=D({},n);Y(e,(function(n){r[n.name()]=n.exhibit(t,o)}));var i=Dc(r,(function(t,n){return{name:t,modification:n}})),u=function(t){return $(t,(function(t,n){return D(D({},n.modification),t)}),{})},a=$(i.classes,(function(t,n){return n.modification.concat(t)}),[]),c=u(i.attributes),s=u(i.styles);return Bc({classes:a,attributes:c,styles:s})},Fc=function(t,n,e,o){try{var r=st(e,(function(e,r){var i=e[n],u=r[n],a=o.indexOf(i),c=o.indexOf(u);if(-1===a)throw new Error("The ordering for "+t+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(o,null,2));if(-1===c)throw new Error("The ordering for "+t+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(o,null,2));return a<c?-1:c<a?1:0}));return rr.value(r)}catch(i){return rr.error([i])}},Ic=function(t,n){return{handler:t,purpose:n}},Rc=function(t,n){return{cHandler:t,purpose:n}},Vc=function(t,n){return Rc(k.apply(void 0,[t.handler].concat(n)),t.purpose)},Pc=function(t){return t.cHandler},Hc=function(t,n){return{name:t,handler:n}},zc=function(t,n){var e={};return Y(t,(function(t){e[t.name()]=t.handlers(n)})),e},Nc=function(t,n,e){var o=D(D({},e),zc(n,t));return Dc(o,Hc)},Lc=function(t,n,e,o){var r=Nc(t,e,o);return Gc(r,n)},Wc=function(t){var n=_u(t);return function(t,e){for(var o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];var i=[t,e].concat(o);n.abort.apply(void 0,i)?e.stop():n.can.apply(void 0,i)&&n.run.apply(void 0,i)}},Uc=function(t,n){return rr.error(["The event ("+t+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(X(n,(function(t){return t.name})),null,2)])},jc=function(t,n,e){var o=n[e];return o?Fc("Event: "+e,"name",t,o).map((function(t){var n=X(t,(function(t){return t.handler}));return Tu(n)})):Uc(e,t)},Gc=function(t,n){var e=kt(t,(function(t,e){var o=1===t.length?rr.value(t[0].handler):jc(t,n,e);return o.map((function(o){var r=Wc(o),i=t.length>1?J(n[e],(function(n){return U(t,(function(t){return t.name===n}))})).join(" > "):t[0].name;return mu(e,Ic(r,i))}))}));return hu(e,{})},Xc="alloy.base.behaviour",Yc=ti([_i("dom","dom",Cr(),ti([Di("tag"),qi("styles",{}),qi("classes",[]),qi("attributes",{}),Ni("value"),Ni("innerHtml")])),Di("components"),Di("uid"),qi("events",{}),qi("apis",{}),_i("eventOrder","eventOrder",Dr((au={},au[na()]=["disabling",Xc,"toggling","typeaheadevents"],au[$u()]=[Xc,"focusing","keying"],au[aa()]=[Xc,"disabling","toggling","representing"],au[Wu()]=[Xc,"representing","streaming","invalidating"],au[ma()]=[Xc,"representing","item-events","tooltipping"],au[Fu()]=["focusing",Xc,"item-type-events"],au[Du()]=["focusing",Xc,"item-type-events"],au[Pu()]=["item-type-events","tooltipping"],au[ta()]=["receiving","reflecting","tooltipping"],au)),ui()),Ni("domModification")]),qc=function(t){return xi("custom.definition",Yc,t)},Kc=function(t){return D(D({},t.dom),{uid:t.uid,domChildren:X(t.components,(function(t){return t.element}))})},Jc=function(t){return t.domModification.fold((function(){return Bc({})}),Bc)},$c=function(t){return t.events},Qc=function(t,n){var e=We(t,n);return void 0===e||""===e?[]:e.split(" ")},Zc=function(t,n,e){var o=Qc(t,n),r=o.concat([e]);return Ne(t,n,r.join(" ")),!0},ts=function(t,n,e){var o=J(Qc(t,n),(function(t){return t!==e}));return o.length>0?Ne(t,n,o.join(" ")):Ge(t,n),!1},ns=function(t){return void 0!==t.dom.classList},es=function(t){return Qc(t,"class")},os=function(t,n){return Zc(t,"class",n)},rs=function(t,n){return ts(t,"class",n)},is=function(t,n){ns(t)?t.dom.classList.add(n):os(t,n)},us=function(t){var n=ns(t)?t.dom.classList:es(t);0===n.length&&Ge(t,"class")},as=function(t,n){if(ns(t)){var e=t.dom.classList;e.remove(n)}else rs(t,n);us(t)},cs=function(t,n){return ns(t)&&t.dom.classList.contains(n)},ss=function(t,n){Y(n,(function(n){is(t,n)}))},fs=function(t,n){Y(n,(function(n){as(t,n)}))},ls=function(t,n){return rt(n,(function(n){return cs(t,n)}))},ds=function(t){return t.dom.value},ms=function(t,n){if(void 0===n)throw new Error("Value.set was undefined");t.dom.value=n},gs=function(t){var n=nn.fromTag(t.tag);Le(n,t.attributes),ss(n,t.classes),Ke(n,t.styles),t.innerHtml.each((function(t){return qa(n,t)}));var e=t.domChildren;return Io(n,e),t.value.each((function(t){ms(n,t)})),t.uid,fc(n,t.uid),n},ps=function(t){var n=_t(t,"behaviours").getOr({});return ot(pt(n),(function(t){var e=n[t];return d(e)?[e.me]:[]}))},vs=function(t,n){return _c(t,n)},hs=function(t){var n=ps(t);return vs(t,n)},bs=function(t,n,e){var o=Kc(t),r=Jc(t),i={"alloy.base.modification":r},u=n.length>0?Ac(e,i,n,o):r;return Mc(o,u)},ys=function(t,n,e){var o={"alloy.base.behaviour":$c(t)};return Lc(e,t.eventOrder,n,o).getOrDie()},xs=function(t){var n=function(){return y},e=ru(pc),o=wi(qc(t)),r=hs(t),i=Tc(r),u=Ec(r),a=bs(o,i,u),c=gs(a),s=ys(o,i,u),f=ru(o.components),l=function(t){e.set(t)},d=function(){e.set(gc(n))},g=function(){var t=we(c),n=ot(t,(function(t){return e.get().getByDom(t).fold((function(){return[]}),ct)}));f.set(n)},p=function(n){var e=u,o=m(e[n.name()])?e[n.name()]:function(){throw new Error("Could not find "+n.name()+" in "+JSON.stringify(t,null,2))};return o()},v=function(t){return m(u[t.name()])},h=function(){return o.apis},b=function(t){return u[t]().map((function(t){return t.state.readState()})).getOr("not enabled")},y={uid:t.uid,getSystem:e.get,config:p,hasConfigured:v,spec:t,readState:b,getApis:h,connect:l,disconnect:d,element:c,syncComponents:g,components:f.get,events:s};return y},ws=function(t){var n=_t(t,"components").getOr([]);return X(n,Ts)},Ss=function(t){var n=mc(t),e=n.events,o=B(n,["events"]),r=ws(o),i=D(D({},o),{events:D(D({},ec),e),components:r});return rr.value(xs(i))},ks=function(t){var n=nn.fromText(t);return Cs({element:n})},Cs=function(t){var n=Si("external.component",Zr([Di("element"),Ni("uid")]),t),e=ru(gc()),o=function(t){e.set(t)},r=function(){e.set(gc((function(){return u})))},i=n.uid.getOrThunk((function(){return dc("external")}));fc(n.element,i);var u={uid:i,getSystem:e.get,config:V.none,hasConfigured:_,connect:o,disconnect:r,getApis:function(){return{}},element:n.element,spec:t,readState:x("No state"),syncComponents:v,components:x([]),events:{}};return wc(u)},Os=dc,_s=function(t){return Tt(t,"uid")},Ts=function(t){return Sc(t).getOrThunk((function(){var n=_s(t)?t:D({uid:Os("")},t);return Ss(n).getOrDie()}))},Es=wc;function Ds(t,n,e,o,r){return t(e,o)?V.some(e):m(r)&&r(e)?V.none():n(e,o,r)}var Bs,Ms=function(t,n,e){var o=t.dom,r=m(e)?e:_;while(o.parentNode){o=o.parentNode;var i=nn.fromDom(o);if(n(i))return V.some(i);if(r(i))break}return V.none()},As=function(t,n,e){var o=function(t,n){return n(t)};return Ds(o,Ms,t,n,e)},Fs=function(t,n){var e=function(t){return n(nn.fromDom(t))},o=tt(t.dom.childNodes,e);return o.map(nn.fromDom)},Is=function(t,n){var e=function(t){for(var o=0;o<t.childNodes.length;o++){var r=nn.fromDom(t.childNodes[o]);if(n(r))return V.some(r);var i=e(t.childNodes[o]);if(i.isSome())return i}return V.none()};return e(t.dom)},Rs=function(t,n,e){return As(t,n,e).isSome()},Vs=function(t,n,e){return Ms(t,(function(t){return ie(t,n)}),e)},Ps=function(t,n){return Fs(t,(function(t){return ie(t,n)}))},Hs=function(t,n){return ce(n,t)},zs=function(t,n,e){var o=function(t,n){return ie(t,n)};return Ds(o,Vs,t,n,e)},Ns=function(t){var n=As(t,(function(t){if(!ln(t))return!1;var n=We(t,"id");return void 0!==n&&n.indexOf("aria-owns")>-1}));return n.bind((function(t){var n=We(t,"id"),e=De(t);return Hs(e,'[aria-owns="'+n+'"]')}))},Ls=function(){var t=rc("aria-owns"),n=function(n){Ne(n,"aria-owns",t)},e=function(t){Ge(t,"aria-owns")};return{id:t,link:n,unlink:e}},Ws=function(t,n){return Ns(n).exists((function(n){return Us(t,n)}))},Us=function(t,n){return Rs(n,(function(n){return se(n,t.element)}),_)||Ws(t,n)},js="unknown";(function(t){t[t["STOP"]=0]="STOP",t[t["NORMAL"]=1]="NORMAL",t[t["LOGGING"]=2]="LOGGING"})(Bs||(Bs={}));var Gs=ru({}),Xs=function(t,n){var e=[],o=(new Date).getTime();return{logEventCut:function(t,n,o){e.push({outcome:"cut",target:n,purpose:o})},logEventStopped:function(t,n,o){e.push({outcome:"stopped",target:n,purpose:o})},logNoParent:function(t,n,o){e.push({outcome:"no-parent",target:n,purpose:o})},logEventNoHandlers:function(t,n){e.push({outcome:"no-handlers-left",target:n})},logEventResponse:function(t,n,o){e.push({outcome:"response",purpose:o,target:n})},write:function(){var r=(new Date).getTime();W(["mousemove","mouseover","mouseout",aa()],t)||console.log(t,{event:t,time:r-o,target:n.dom,sequence:X(e,(function(t){return W(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+Za(t.target)+")":t.outcome}))})}}},Ys=function(t,n,e){var o=_t(Gs.get(),t).orThunk((function(){var n=pt(Gs.get());return gt(n,(function(n){return t.indexOf(n)>-1?V.some(Gs.get()[n]):V.none()}))})).getOr(Bs.NORMAL);switch(o){case Bs.NORMAL:return e(Qs());case Bs.LOGGING:var r=Xs(t,n),i=e(r);return r.write(),i;case Bs.STOP:return!0}},qs=["alloy/data/Fields","alloy/debugging/Debugging"],Ks=function(){var t=new Error;if(void 0!==t.stack){var n=t.stack.split("\n");return tt(n,(function(t){return t.indexOf("alloy")>0&&!U(qs,(function(n){return t.indexOf(n)>-1}))})).getOr(js)}return js},Js={logEventCut:v,logEventStopped:v,logNoParent:v,logEventNoHandlers:v,logEventResponse:v,write:v},$s=function(t,n,e){return Ys(t,n,e)},Qs=x(Js),Zs=x([Di("menu"),Di("selectedMenu")]),tf=x([Di("item"),Di("selectedItem")]);x(ti(tf().concat(Zs())));var nf=x(ti(tf())),ef=Pi("initSize",[Di("numColumns"),Di("numRows")]),of=function(){return Bi("markers",nf())},rf=function(){return Pi("markers",[Di("backgroundMenu")].concat(Zs()).concat(tf()))},uf=function(t){return Pi("markers",X(t,Di))},af=function(t,n,e){return Ks(),_i(n,n,e,hi((function(t){return rr.value((function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(void 0,n)}))})))},cf=function(t){return af("onHandler",t,_r(v))},sf=function(t){return af("onKeyboardHandler",t,_r(V.none))},ff=function(t){return af("onHandler",t,Cr())},lf=function(t){return af("onKeyboardHandler",t,Cr())},df=function(t,n){return Ti(t,x(n))},mf=function(t){return Ti(t,w)},gf=x(ef),pf=function(t,n,e,o,r,i,u,a){return void 0===a&&(a=!1),{x:t,y:n,bubble:e,direction:o,placement:r,restriction:i,label:u+"-"+r,alwaysFit:a}},vf=uu.generate([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),hf=function(t,n,e,o,r,i,u,a,c){return t.fold(n,e,o,r,i,u,a,c)},bf=function(t,n,e,o){return t.fold(n,n,o,o,n,o,e,e)},yf=function(t,n,e,o){return t.fold(n,o,n,o,e,e,n,o)},xf=vf.southeast,wf=vf.southwest,Sf=vf.northeast,kf=vf.northwest,Cf=vf.south,Of=vf.north,_f=vf.east,Tf=vf.west,Ef=function(t,n,e,o){var r=t+n;return r>o?e:r<e?o:r},Df=function(t,n,e){return Math.min(Math.max(t,n),e)},Bf=function(t,n){switch(n){case 1:return t.x;case 0:return t.x+t.width;case 2:return t.y;case 3:return t.y+t.height}},Mf=function(t,n){return at(["left","right","top","bottom"],(function(e){return _t(n,e).map((function(n){return Bf(t,n)}))}))},Af=function(t,n,e){var o=function(o,r){return n[o].map((function(n){var i="top"===o||"bottom"===o,u=i?e.top:e.left,a="left"===o||"top"===o?Math.max:Math.min,c=a(n,r)+u;return i?Df(c,t.y,t.bottom):Df(c,t.x,t.right)})).getOr(r)},r=o("left",t.x),i=o("top",t.y),u=o("right",t.right),a=o("bottom",t.bottom);return $o(r,i,u-r,a-i)},Ff="layout",If=function(t){return t.x},Rf=function(t,n){return t.x+t.width/2-n.width/2},Vf=function(t,n){return t.x+t.width-n.width},Pf=function(t,n){return t.y-n.height},Hf=function(t){return t.y+t.height},zf=function(t,n){return t.y+t.height/2-n.height/2},Nf=function(t){return t.x+t.width},Lf=function(t,n){return t.x-n.width},Wf=function(t,n,e){return pf(If(t),Hf(t),e.southeast(),xf(),"southeast",Mf(t,{left:1,top:3}),Ff)},Uf=function(t,n,e){return pf(Vf(t,n),Hf(t),e.southwest(),wf(),"southwest",Mf(t,{right:0,top:3}),Ff)},jf=function(t,n,e){return pf(If(t),Pf(t,n),e.northeast(),Sf(),"northeast",Mf(t,{left:1,bottom:2}),Ff)},Gf=function(t,n,e){return pf(Vf(t,n),Pf(t,n),e.northwest(),kf(),"northwest",Mf(t,{right:0,bottom:2}),Ff)},Xf=function(t,n,e){return pf(Rf(t,n),Pf(t,n),e.north(),Of(),"north",Mf(t,{bottom:2}),Ff)},Yf=function(t,n,e){return pf(Rf(t,n),Hf(t),e.south(),Cf(),"south",Mf(t,{top:3}),Ff)},qf=function(t,n,e){return pf(Nf(t),zf(t,n),e.east(),_f(),"east",Mf(t,{left:0}),Ff)},Kf=function(t,n,e){return pf(Lf(t,n),zf(t,n),e.west(),Tf(),"west",Mf(t,{right:1}),Ff)},Jf=function(){return[Wf,Uf,jf,Gf,Yf,Xf,qf,Kf]},$f=function(){return[Uf,Wf,Gf,jf,Yf,Xf,qf,Kf]},Qf=function(){return[jf,Gf,Wf,Uf,Xf,Yf]},Zf=function(){return[Gf,jf,Uf,Wf,Xf,Yf]},tl=function(){return[Wf,Uf,jf,Gf,Yf,Xf]},nl=function(){return[Uf,Wf,Gf,jf,Yf,Xf]},el=function(t,n){return n.universal?t:J(t,(function(t){return W(n.channels,t)}))},ol=function(t){return Ea([Aa(ta(),(function(n,e){var o=t.channels,r=pt(o),i=e,u=el(r,i);Y(u,(function(t){var e=o[t],r=e.schema,u=Si("channel["+t+"] data\nReceiver: "+Za(n.element),r,i.data);e.onReceive(n,u)}))}))])},rl=Object.freeze({__proto__:null,events:ol}),il=[Bi("channels",bi(rr.value,Zr([ff("onReceive"),qi("schema",ui())])))],ul=function(t,n,e){return Ga((function(o){e(o,t,n)}))},al=function(t,n,e){return ja((function(o,r){e(o,t,n)}))},cl=function(t,n,e,o,r,i){var u=Zr(t),a=Xi(n,[Yi("config",t)]);return dl(u,a,n,e,o,r,i)},sl=function(t,n,e,o,r,i){var u=t,a=Xi(n,[Li("config",t)]);return dl(u,a,n,e,o,r,i)},fl=function(t,n,e){var o=function(o){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var u=[o].concat(r);return o.config({name:x(t)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+t+". Using API: "+e)}),(function(t){var e=Array.prototype.slice.call(u,1);return n.apply(void 0,[o,t.config,t.state].concat(e))}))};return vc(o,e,n)},ll=function(t){return{key:t,value:void 0}},dl=function(t,n,e,o,r,i,u){var a=function(t){return Et(t,e)?t[e]():V.none()},c=bt(r,(function(t,n){return fl(e,t,n)})),s=bt(i,(function(t,n){return bc(t,n)})),f=D(D(D({},s),c),{revoke:k(ll,e),config:function(n){var o=Si(e+"-config",t,n);return{key:e,value:{config:o,me:f,configAsRaw:pn((function(){return Si(e+"-config",t,n)})),initialConfig:n,state:u}}},schema:x(n),exhibit:function(t,n){return Ft(a(t),_t(o,"exhibit"),(function(t,e){return e(n,t.config,t.state)})).getOrThunk((function(){return Bc({})}))},name:x(e),handlers:function(t){return a(t).map((function(t){var n=_t(o,"events").getOr((function(){return{}}));return n(t.config,t.state)})).getOr({})}});return f},ml=function(t){return gu(t)},gl=Zr([Di("fields"),Di("name"),qi("active",{}),qi("apis",{}),qi("state",Cc),qi("extra",{})]),pl=function(t){var n=Si("Creating behaviour: "+t.name,gl,t);return cl(n.fields,n.name,n.active,n.apis,n.extra,n.state)},vl=Zr([Di("branchKey"),Di("branches"),Di("name"),qi("active",{}),qi("apis",{}),qi("state",Cc),qi("extra",{})]),hl=function(t){var n=Si("Creating behaviour: "+t.name,vl,t);return sl(Ci(n.branchKey,n.branches),n.name,n.active,n.apis,n.extra,n.state)},bl=x(void 0),yl=pl({fields:il,name:"receiving",active:rl}),xl=function(t,n){return Bc({classes:[],styles:n.useFixed()?{}:{position:"relative"}})},wl=Object.freeze({__proto__:null,exhibit:xl}),Sl=function(){return nn.fromDom(document)},kl=function(t){return t.dom.focus()},Cl=function(t){return t.dom.blur()},Ol=function(t){var n=De(t).dom;return t.dom===n.activeElement},_l=function(t){return void 0===t&&(t=Sl()),V.from(t.dom.activeElement).map(nn.fromDom)},Tl=function(t){return _l(De(t)).filter((function(n){return t.dom.contains(n.dom)}))},El=function(t,n){var e=De(n),o=_l(e).bind((function(t){var e=function(n){return se(t,n)};return e(n)?V.some(n):Is(n,e)})),r=t(n);return o.each((function(t){_l(e).filter((function(n){return se(n,t)})).fold((function(){kl(t)}),v)})),r},Dl=function(t,n,e,o,r){var i=function(t){return t+"px"};return{position:t,left:n.map(i),top:e.map(i),right:o.map(i),bottom:r.map(i)}},Bl=function(t){return D(D({},t),{position:V.some(t.position)})},Ml=function(t,n){Je(t,Bl(n))},Al=uu.generate([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),Fl=function(t,n,e,o,r,i){var u=n.rect,a=u.x-e,c=u.y-o,s=u.width,f=u.height,l=r-(a+s),d=i-(c+f),m=V.some(a),g=V.some(c),p=V.some(l),v=V.some(d),h=V.none();return hf(n.direction,(function(){return Dl(t,m,g,h,h)}),(function(){return Dl(t,h,g,p,h)}),(function(){return Dl(t,m,h,h,v)}),(function(){return Dl(t,h,h,p,v)}),(function(){return Dl(t,m,g,h,h)}),(function(){return Dl(t,m,h,h,v)}),(function(){return Dl(t,m,g,h,h)}),(function(){return Dl(t,h,g,p,h)}))},Il=function(t,n){return t.fold((function(){var t=n.rect;return Dl("absolute",V.some(t.x),V.some(t.y),V.none(),V.none())}),(function(t,e,o,r){return Fl("absolute",n,t,e,o,r)}),(function(t,e,o,r){return Fl("fixed",n,t,e,o,r)}))},Rl=function(t,n){var e=k(qo,n),o=t.fold(e,e,(function(){var t=Ho();return qo(n).translate(-t.left,-t.top)})),r=yo(n),i=ao(n);return $o(o.left,o.top,r,i)},Vl=function(t,n){return n.fold((function(){return t.fold(tr,tr,$o)}),(function(n){return t.fold(n,n,(function(){var e=n(),o=Pl(t,e.x,e.y);return $o(o.left,o.top,e.width,e.height)}))}))},Pl=function(t,n,e){var o=fo(n,e),r=function(){var t=Ho();return o.translate(-t.left,-t.top)};return t.fold(x(o),x(o),r)},Hl=function(t,n,e,o){return t.fold(n,e,o)};Al.none;var zl,Nl=Al.relative,Ll=Al.fixed,Wl=function(t,n){return{anchorBox:t,origin:n}},Ul=function(t,n){return Wl(t,n)},jl="data-alloy-placement",Gl=function(t,n){Ne(t,jl,n)},Xl=function(t){return Ue(t,jl)},Yl=function(t){return Ge(t,jl)},ql=uu.generate([{fit:["reposition"]},{nofit:["reposition","visibleW","visibleH","isVisible"]}]),Kl=function(t,n){var e=n.x,o=n.y,r=n.right,i=n.bottom,u=t.x,a=t.y,c=t.right,s=t.bottom,f=t.width,l=t.height,d=u>=e&&u<=r,m=a>=o&&a<=i,g=d&&m,p=c<=r&&c>=e,v=s<=i&&s>=o,h=p&&v,b=Math.min(f,u>=e?r-u:c-e),y=Math.min(l,a>=o?i-a:s-o);return{originInBounds:g,sizeInBounds:h,visibleW:b,visibleH:y}},Jl=function(t,n){var e=n.x,o=n.y,r=n.right,i=n.bottom,u=t.x,a=t.y,c=t.width,s=t.height,f=Math.max(e,r-c),l=Math.max(o,i-s),d=Df(u,e,f),m=Df(a,o,l),g=Math.min(d+c,r)-d,p=Math.min(m+s,i)-m;return $o(d,m,g,p)},$l=function(t,n,e){var o=x(n.bottom-e.y),r=x(e.bottom-n.y),i=bf(t,r,r,o),u=x(n.right-e.x),a=x(e.right-n.x),c=yf(t,a,a,u);return{maxWidth:c,maxHeight:i}},Ql=function(t,n,e,o){var r=t.bubble,i=r.offset,u=Af(o,t.restriction,i),a=t.x+i.left,c=t.y+i.top,s=$o(a,c,n,e),f=Kl(s,u),l=f.originInBounds,d=f.sizeInBounds,m=f.visibleW,g=f.visibleH,p=l&&d,v=p?s:Jl(s,u),h=v.width>0&&v.height>0,b=$l(t.direction,v,o),y=b.maxWidth,x=b.maxHeight,w={rect:v,maxHeight:x,maxWidth:y,direction:t.direction,placement:t.placement,classes:{on:r.classesOn,off:r.classesOff},layout:t.label,testY:c};return p||t.alwaysFit?ql.fit(w):ql.nofit(w,m,g,h)},Zl=function(t,n,e,o,r,i){var u=o.width,a=o.height,c=function(n,c,s,f,l){var d=n(e,o,r,t,i),m=Ql(d,u,a,i);return m.fold(x(m),(function(t,n,e,o){var r=l===o?e>f||n>s:!l&&o;return r?m:ql.nofit(c,s,f,l)}))},s=Q(n,(function(t,n){var e=k(c,n);return t.fold(x(t),e)}),ql.nofit({rect:e,maxHeight:o.height,maxWidth:o.width,direction:xf(),placement:"southeast",classes:{on:[],off:[]},layout:"none",testY:e.y},-1,-1,!1));return s.fold(w,w)},td=function(t){var n=ru(V.none()),e=function(){return n.get().each(t)},o=function(){e(),n.set(V.none())},r=function(){return n.get().isSome()},i=function(){return n.get()},u=function(t){e(),n.set(V.some(t))};return{clear:o,isSet:r,get:i,set:u}},nd=function(){return td((function(t){return t.destroy()}))},ed=function(){return td((function(t){return t.unbind()}))},od=function(){var t=nd(),n=function(n){return t.get().each(n)};return D(D({},t),{run:n})},rd=function(){var t=td(v),n=function(n){return t.get().each(n)};return D(D({},t),{on:n})},id=T,ud=function(t,n,e){return Oo(t,n,id,e)},ad=function(t,n,e){return _o(t,n,id,e)},cd=So,sd=["top","bottom","right","left"],fd="data-alloy-transition-timer",ld=function(t,n){return ls(t,n.classes)},dd=function(t,n,e){return e.exists((function(e){var o=t.mode;return"all"===o||e[o]!==n[o]}))},md=function(t,n){var e=function(t){return parseFloat(t).toFixed(3)};return Ct(n,(function(n,o){var r=t[o].map(e),i=n.map(e);return!Bt(r,i)})).isSome()},gd=function(t){var n=function(n){var e=$e(t,n),o=i(e)?e.split(/\s*,\s*/):[];return J(o,Yt)},e=function(t){if(i(t)&&/^[\d.]+/.test(t)){var n=parseFloat(t);return jt(t,"ms")?n:1e3*n}return 0},o=n("transition-delay"),r=n("transition-duration");return Q(r,(function(t,n,r){var i=e(o[r])+e(n);return Math.max(t,i)}),0)},pd=function(t,n){var e,o=ed(),r=ed(),i=function(n){var e,o=null!==(e=n.raw.pseudoElement)&&void 0!==e?e:"";return se(n.target,t)&&qt(o)&&W(sd,n.raw.propertyName)},u=function(u){if(l(u)||i(u)){o.clear(),r.clear();var a=null===u||void 0===u?void 0:u.raw.type;(l(a)||a===Xu())&&(clearTimeout(e),Ge(t,fd),fs(t,n.classes))}},a=function(){o.set(ud(t,Xu(),u)),r.set(ud(t,Gu(),u))};if("ontransitionstart"in t.dom)var c=ud(t,Yu(),(function(t){i(t)&&(c.unbind(),a())}));else a();var s=gd(t);requestAnimationFrame((function(){e=setTimeout(u,s+17),Ne(t,fd,e)}))},vd=function(t,n){ss(t,n.classes),Ue(t,fd).each((function(n){clearTimeout(parseInt(n,10)),Ge(t,fd)})),pd(t,n)},hd=function(t,n,e,o,r,i){var u=dd(o,r,i);if(u||ld(t,o)){qe(t,"position",e.position);var a=Rl(n,t),c=Il(n,D(D({},r),{rect:a})),s=at(sd,(function(t){return c[t]}));md(e,s)&&(Je(t,s),u&&vd(t,o),oo(t))}else fs(t,o.classes)},bd=function(t){return{width:yo(t),height:ao(t)}},yd=function(t,n,e,o){eo(n,"max-height"),eo(n,"max-width");var r=bd(n);return Zl(n,o.preference,t,r,e,o.bounds)},xd=function(t,n){var e=n.classes;fs(t,e.off),ss(t,e.on)},wd=function(t,n,e){var o=e.maxHeightFunction;o(t,n.maxHeight)},Sd=function(t,n,e){var o=e.maxWidthFunction;o(t,n.maxWidth)},kd=function(t,n,e){var o=Il(e.origin,n);e.transition.each((function(r){hd(t,e.origin,o,r,n,e.lastPlacement)})),Ml(t,o)},Cd=function(t,n){Gl(t,n.placement)},Od=function(t,n){co(t,Math.floor(n))},_d=x((function(t,n){Od(t,n),Ke(t,{"overflow-x":"hidden","overflow-y":"auto"})})),Td=x((function(t,n){Od(t,n)})),Ed=function(t,n,e){return void 0===t[n]?e:t[n]},Dd=function(t,n,e,o,r,i,u,a){var c=Ed(u,"maxHeightFunction",_d()),s=Ed(u,"maxWidthFunction",v),f=t.anchorBox,l=t.origin,d={bounds:Vl(l,i),origin:l,preference:o,maxHeightFunction:c,maxWidthFunction:s,lastPlacement:r,transition:a};return Bd(f,n,e,d)},Bd=function(t,n,e,o){var r=yd(t,n,e,o);return kd(n,r,o),Cd(n,r),xd(n,r),wd(n,r,o),Sd(n,r,o),{layout:r.layout,placement:r.placement}},Md=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right","inset"],Ad=function(t,n,e,o){void 0===o&&(o=1);var r=t*o,i=n*o,u=function(t){return _t(e,t).getOr([])},a=function(t,n,e){var o=ut(Md,e);return{offset:fo(t,n),classesOn:ot(e,u),classesOff:ot(o,u)}};return{southeast:function(){return a(-t,n,["top","alignLeft"])},southwest:function(){return a(t,n,["top","alignRight"])},south:function(){return a(-t/2,n,["top","alignCentre"])},northeast:function(){return a(-t,-n,["bottom","alignLeft"])},northwest:function(){return a(t,-n,["bottom","alignRight"])},north:function(){return a(-t/2,-n,["bottom","alignCentre"])},east:function(){return a(t,-n/2,["valignCentre","left"])},west:function(){return a(-t,-n/2,["valignCentre","right"])},insetNortheast:function(){return a(r,i,["top","alignLeft","inset"])},insetNorthwest:function(){return a(-r,i,["top","alignRight","inset"])},insetNorth:function(){return a(-r/2,i,["top","alignCentre","inset"])},insetSoutheast:function(){return a(r,-i,["bottom","alignLeft","inset"])},insetSouthwest:function(){return a(-r,-i,["bottom","alignRight","inset"])},insetSouth:function(){return a(-r/2,-i,["bottom","alignCentre","inset"])},insetEast:function(){return a(-r,-i/2,["valignCentre","right","inset"])},insetWest:function(){return a(r,-i/2,["valignCentre","left","inset"])}}},Fd=function(){return Ad(0,0,{})},Id=w,Rd=function(t,n){return function(e){return"rtl"===Vd(e)?n:t}},Vd=function(t){return"rtl"===$e(t,"direction")?"rtl":"ltr"};(function(t){t["TopToBottom"]="toptobottom",t["BottomToTop"]="bottomtotop"})(zl||(zl={}));var Pd="data-alloy-vertical-dir",Hd=function(t){return Rs(t,(function(t){return ln(t)&&We(t,"data-alloy-vertical-dir")===zl.BottomToTop}))},zd=function(){return Xi("layouts",[Di("onLtr"),Di("onRtl"),Ni("onBottomLtr"),Ni("onBottomRtl")])},Nd=function(t,n,e,o,r,i,u){var a=u.map(Hd).getOr(!1),c=n.layouts.map((function(n){return n.onLtr(t)})),s=n.layouts.map((function(n){return n.onRtl(t)})),f=a?n.layouts.bind((function(n){return n.onBottomLtr.map((function(n){return n(t)}))})).or(c).getOr(r):c.getOr(e),l=a?n.layouts.bind((function(n){return n.onBottomRtl.map((function(n){return n(t)}))})).or(s).getOr(i):s.getOr(o),d=Rd(f,l);return d(t)},Ld=function(t,n,e){var o=n.hotspot,r=Rl(e,o.element),i=Nd(t.element,n,tl(),nl(),Qf(),Zf(),V.some(n.hotspot.element));return V.some(Id({anchorBox:r,bubble:n.bubble.getOr(Fd()),overrides:n.overrides,layouts:i,placer:V.none()}))},Wd=[Di("hotspot"),Ni("bubble"),qi("overrides",{}),zd(),df("placement",Ld)],Ud=function(t,n,e){var o=Pl(e,n.x,n.y),r=$o(o.left,o.top,n.width,n.height),i=Nd(t.element,n,Jf(),$f(),Jf(),$f(),V.none());return V.some(Id({anchorBox:r,bubble:n.bubble,overrides:n.overrides,layouts:i,placer:V.none()}))},jd=[Di("x"),Di("y"),qi("height",0),qi("width",0),qi("bubble",Fd()),qi("overrides",{}),zd(),df("placement",Ud)],Gd=uu.generate([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Xd=function(t){return t.fold(w,(function(t,n,e){return t.translate(-n,-e)}))},Yd=function(t){return t.fold(w,w)},qd=function(t){return Q(t,(function(t,n){return t.translate(n.left,n.top)}),fo(0,0))},Kd=function(t){var n=X(t,Xd);return qd(n)},Jd=function(t){var n=X(t,Yd);return qd(n)},$d=Gd.screen,Qd=Gd.absolute,Zd=function(t,n,e){var o=ve(e.root).dom,r=function(n){var e=me(n),o=me(t.element);return se(e,o)};return V.from(o.frameElement).map(nn.fromDom).filter(r).map(go)},tm=function(t,n,e){var o=me(t.element),r=Ho(o),i=Zd(t,n,e).getOr(r);return Qd(i,r.left,r.top)},nm=function(t,n,e,o){var r=$d(fo(t,n));return V.some(Ko(r,e,o))},em=function(t,n,e,o,r){return t.map((function(t){var i=[n,t.point],u=Hl(o,(function(){return Jd(i)}),(function(){return Jd(i)}),(function(){return Kd(i)})),a=Jo(u.left,u.top,t.width,t.height),c=e.showAbove?Qf():tl(),s=e.showAbove?Zf():nl(),f=Nd(r,e,c,s,c,s,V.none());return Id({anchorBox:a,bubble:e.bubble.getOr(Fd()),overrides:e.overrides,layouts:f,placer:V.none()})}))},om=function(t,n,e){var o=tm(t,e,n);return n.node.filter(Ve).bind((function(r){var i=r.dom.getBoundingClientRect(),u=nm(i.left,i.top,i.width,i.height),a=n.node.getOr(t.element);return em(u,o,n,e,a)}))},rm=[Di("node"),Di("root"),Ni("bubble"),zd(),qi("overrides",{}),qi("showAbove",!1),df("placement",om)],im="\ufeff",um=" ",am=function(t,n,e,o){return{start:t,soffset:n,finish:e,foffset:o}},cm={create:am},sm=uu.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),fm=function(t,n,e,o){return t.fold(n,e,o)},lm=function(t){return t.fold(w,w,w)},dm=sm.before,mm=sm.on,gm=sm.after,pm={before:dm,on:mm,after:gm,cata:fm,getStart:lm},vm=uu.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),hm=function(t){return vm.exact(t.start,t.soffset,t.finish,t.foffset)},bm=function(t){return t.match({domRange:function(t){return nn.fromDom(t.startContainer)},relative:function(t,n){return pm.getStart(t)},exact:function(t,n,e,o){return t}})},ym=vm.domRange,xm=vm.relative,wm=vm.exact,Sm=function(t){var n=bm(t);return ve(n)},km=cm.create,Cm={domRange:ym,relative:xm,exact:wm,exactFromRange:hm,getWin:Sm,range:km},Om=function(t,n){n.fold((function(n){t.setStartBefore(n.dom)}),(function(n,e){t.setStart(n.dom,e)}),(function(n){t.setStartAfter(n.dom)}))},_m=function(t,n){n.fold((function(n){t.setEndBefore(n.dom)}),(function(n,e){t.setEnd(n.dom,e)}),(function(n){t.setEndAfter(n.dom)}))},Tm=function(t,n,e){var o=t.document.createRange();return Om(o,n),_m(o,e),o},Em=function(t,n,e,o,r){var i=t.document.createRange();return i.setStart(n.dom,e),i.setEnd(o.dom,r),i},Dm=function(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom,width:t.width,height:t.height}},Bm=function(t){var n=t.getClientRects(),e=n.length>0?n[0]:t.getBoundingClientRect();return e.width>0||e.height>0?V.some(e).map(Dm):V.none()},Mm=function(t){var n=t.getBoundingClientRect();return n.width>0||n.height>0?V.some(n).map(Dm):V.none()},Am=uu.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Fm=function(t,n,e){return n(nn.fromDom(e.startContainer),e.startOffset,nn.fromDom(e.endContainer),e.endOffset)},Im=function(t,n){return n.match({domRange:function(t){return{ltr:x(t),rtl:V.none}},relative:function(n,e){return{ltr:pn((function(){return Tm(t,n,e)})),rtl:pn((function(){return V.some(Tm(t,e,n))}))}},exact:function(n,e,o,r){return{ltr:pn((function(){return Em(t,n,e,o,r)})),rtl:pn((function(){return V.some(Em(t,o,r,n,e))}))}}})},Rm=function(t,n){var e=n.ltr();if(e.collapsed){var o=n.rtl().filter((function(t){return!1===t.collapsed}));return o.map((function(t){return Am.rtl(nn.fromDom(t.endContainer),t.endOffset,nn.fromDom(t.startContainer),t.startOffset)})).getOrThunk((function(){return Fm(t,Am.ltr,e)}))}return Fm(t,Am.ltr,e)},Vm=function(t,n){var e=Im(t,n);return Rm(t,e)},Pm=function(t,n){var e=Vm(t,n);return e.match({ltr:function(n,e,o,r){var i=t.document.createRange();return i.setStart(n.dom,e),i.setEnd(o.dom,r),i},rtl:function(n,e,o,r){var i=t.document.createRange();return i.setStart(o.dom,r),i.setEnd(n.dom,e),i}})};Am.ltr,Am.rtl;var Hm,zm=function(t,n){var e=function(e){if(!t(e))throw new Error("Can only get "+n+" value of a "+n+" node");return o(e).getOr("")},o=function(n){return t(n)?V.from(n.dom.nodeValue):V.none()},r=function(e,o){if(!t(e))throw new Error("Can only set raw "+n+" value of a "+n+" node");e.dom.nodeValue=o};return{get:e,getOption:o,set:r}},Nm=zm(dn,"text"),Lm=function(t){return Nm.get(t)},Wm=function(t){return Nm.getOption(t)},Um=function(t){return"img"===cn(t)?1:Wm(t).fold((function(){return we(t).length}),(function(t){return t.length}))},jm=function(t){return Wm(t).filter((function(t){return 0!==t.trim().length||t.indexOf(um)>-1})).isSome()},Gm=["img","br"],Xm=function(t){var n=jm(t);return n||W(Gm,cn(t))},Ym=function(t){return qm(t,Xm)},qm=function(t,n){var e=function(t){for(var o=we(t),r=o.length-1;r>=0;r--){var i=o[r];if(n(i))return V.some(i);var u=e(i);if(u.isSome())return u}return V.none()};return e(t)},Km=function(t,n){return ae(n,t)},Jm=function(t,n,e,o){var r=me(t),i=r.dom.createRange();return i.setStart(t.dom,n),i.setEnd(e.dom,o),i},$m=function(t,n,e,o){var r=Jm(t,n,e,o),i=se(t,e)&&n===o;return r.collapsed&&!i},Qm=function(t){return V.from(t.getSelection())},Zm=function(t){if(t.rangeCount>0){var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1);return V.some(cm.create(nn.fromDom(n.startContainer),n.startOffset,nn.fromDom(e.endContainer),e.endOffset))}return V.none()},tg=function(t){if(null===t.anchorNode||null===t.focusNode)return Zm(t);var n=nn.fromDom(t.anchorNode),e=nn.fromDom(t.focusNode);return $m(n,t.anchorOffset,e,t.focusOffset)?V.some(cm.create(n,t.anchorOffset,e,t.focusOffset)):Zm(t)},ng=function(t){return Qm(t).filter((function(t){return t.rangeCount>0})).bind(tg)},eg=function(t,n){var e=Pm(t,n);return Bm(e)},og=function(t,n){var e=Pm(t,n);return Mm(e)},rg=function(t,n){return{element:t,offset:n}},ig=function(t,n){var e=we(t);if(0===e.length)return rg(t,n);if(n<e.length)return rg(e[n],0);var o=e[e.length-1],r=dn(o)?Lm(o).length:we(o).length;return rg(o,r)},ug=function(t,n){return dn(t)?rg(t,n):ig(t,n)},ag=function(t,n){var e=n.getSelection.getOrThunk((function(){return function(){return ng(t)}}));return e().map((function(t){var n=ug(t.start,t.soffset),e=ug(t.finish,t.foffset);return Cm.range(n.element,n.offset,e.element,e.offset)}))},cg=function(t,n,e){var o=ve(n.root).dom,r=tm(t,e,n),i=ag(o,n).bind((function(t){var n=og(o,Cm.exactFromRange(t)).orThunk((function(){var n=nn.fromText(im);Eo(t.start,n);var e=eg(o,Cm.exact(n,0,n,1));return Vo(n),e}));return n.bind((function(t){return nm(t.left,t.top,t.width,t.height)}))})),u=ag(o,n).bind((function(t){return ln(t.start)?V.some(t.start):be(t.start)})),a=u.getOr(t.element);return em(i,r,n,e,a)},sg=[Ni("getSelection"),Di("root"),Ni("bubble"),zd(),qi("overrides",{}),qi("showAbove",!1),df("placement",cg)],fg="link-layout",lg=function(t){return t.x+t.width},dg=function(t,n){return t.x-n.width},mg=function(t,n){return t.y-n.height+t.height},gg=function(t){return t.y},pg=function(t,n,e){return pf(lg(t),gg(t),e.southeast(),xf(),"southeast",Mf(t,{left:0,top:2}),fg)},vg=function(t,n,e){return pf(dg(t,n),gg(t),e.southwest(),wf(),"southwest",Mf(t,{right:1,top:2}),fg)},hg=function(t,n,e){return pf(lg(t),mg(t,n),e.northeast(),Sf(),"northeast",Mf(t,{left:0,bottom:3}),fg)},bg=function(t,n,e){return pf(dg(t,n),mg(t,n),e.northwest(),kf(),"northwest",Mf(t,{right:1,bottom:3}),fg)},yg=function(){return[pg,vg,hg,bg]},xg=function(){return[vg,pg,bg,hg]},wg=function(t,n,e){var o=Rl(e,n.item.element),r=Nd(t.element,n,yg(),xg(),yg(),xg(),V.none());return V.some(Id({anchorBox:o,bubble:Fd(),overrides:n.overrides,layouts:r,placer:V.none()}))},Sg=[Di("item"),zd(),qi("overrides",{}),df("placement",wg)],kg=Ci("type",{selection:sg,node:rm,hotspot:Wd,submenu:Sg,makeshift:jd}),Cg=[zi("classes",si),Qi("mode","all",["all","layout","placement"])],Og=[qi("useFixed",_),Ni("getBounds")],_g=[Bi("anchor",kg),Xi("transition",Cg)],Tg=function(){var t=document.documentElement;return Ll(0,0,t.clientWidth,t.clientHeight)},Eg=function(t){var n=go(t.element),e=t.element.dom.getBoundingClientRect();return Nl(n.left,n.top,e.width,e.height)},Dg=function(t,n,e,o,r,i,u){var a=Ul(e.anchorBox,n);return Dd(a,r.element,e.bubble,e.layouts,i,o,e.overrides,u)},Bg=function(t,n,e,o,r){Mg(t,n,e,o,r,V.none())},Mg=function(t,n,e,o,r,i){var u=i.map(Qo);return Ag(t,n,e,o,r,u)},Ag=function(t,n,e,o,r,i){var u=Si("placement.info",ti(_g),r),a=u.anchor,c=o.element,s=e.get(o.uid);El((function(){qe(c,"position","fixed");var r=Ze(c,"visibility");qe(c,"visibility","hidden");var f=n.useFixed()?Tg():Eg(t),l=a.placement,d=i.map(x).or(n.getBounds);l(t,a,f).each((function(n){var r=n.placer.getOr(Dg),i=r(t,f,n,d,o,s,u.transition);e.set(o.uid,i)})),r.fold((function(){eo(c,"visibility")}),(function(t){qe(c,"visibility",t)})),Ze(c,"left").isNone()&&Ze(c,"top").isNone()&&Ze(c,"right").isNone()&&Ze(c,"bottom").isNone()&&Dt(Ze(c,"position"),"fixed")&&eo(c,"position")}),c)},Fg=function(t,n,e){return n.useFixed()?"fixed":"absolute"},Ig=function(t,n,e,o){var r=o.element;Y(["position","left","right","top","bottom"],(function(t){return eo(r,t)})),Yl(r),e.clear(o.uid)},Rg=Object.freeze({__proto__:null,position:Bg,positionWithin:Mg,positionWithinBounds:Ag,getMode:Fg,reset:Ig}),Vg=function(){var t={},n=function(n,e){t[n]=e},e=function(n){return _t(t,n)},o=function(n){d(n)?delete t[n]:t={}};return Oc({readState:function(){return t},clear:o,set:n,get:e})},Pg=Object.freeze({__proto__:null,init:Vg}),Hg=pl({fields:Og,name:"positioning",active:wl,apis:Rg,state:Pg}),zg=function(t){Sa(t,ma());var n=t.components();Y(n,zg)},Ng=function(t){var n=t.components();Y(n,Ng),Sa(t,da())},Lg=function(t,n){Mo(t.element,n.element)},Wg=function(t){Y(t.components(),(function(t){return Vo(t.element)})),Ro(t.element),t.syncComponents()},Ug=function(t,n){var e=t.components();Wg(t);var o=ut(e,n);Y(o,(function(n){zg(n),t.getSystem().removeFromWorld(n)})),Y(n,(function(n){n.getSystem().isConnected()?Lg(t,n):(t.getSystem().addToWorld(n),Lg(t,n),Ve(t.element)&&Ng(n)),t.syncComponents()}))},jg=function(t,n){Gg(t,n,Mo)},Gg=function(t,n,e){t.getSystem().addToWorld(n),e(t.element,n.element),Ve(t.element)&&Ng(n),t.syncComponents()},Xg=function(t){zg(t),Vo(t.element),t.getSystem().removeFromWorld(t)},Yg=function(t){var n=he(t.element).bind((function(n){return t.getSystem().getByDom(n).toOptional()}));Xg(t),n.each((function(t){t.syncComponents()}))},qg=function(t){var n=t.components();Y(n,Xg),Ro(t.element),t.syncComponents()},Kg=function(t,n){$g(t,n,Mo)},Jg=function(t,n){$g(t,n,Do)},$g=function(t,n,e){e(t,n.element);var o=we(n.element);Y(o,(function(t){n.getByDom(t).each(Ng)}))},Qg=function(t){var n=we(t.element);Y(n,(function(n){t.getByDom(n).each(zg)})),Vo(t.element)},Zg=function(t,n,e,o){e.get().each((function(n){qg(t)}));var r=n.getAttachPoint(t);jg(r,t);var i=t.getSystem().build(o);return jg(t,i),e.set(i),i},tp=function(t,n,e,o){var r=Zg(t,n,e,o);return n.onOpen(t,r),r},np=function(t,n,e,o){return e.get().map((function(){return Zg(t,n,e,o)}))},ep=function(t,n,e,o,r){sp(t,n),tp(t,n,e,o),r(),lp(t,n)},op=function(t,n,e){e.get().each((function(o){qg(t),Yg(t),n.onClose(t,o),e.clear()}))},rp=function(t,n,e){return e.isOpen()},ip=function(t,n,e,o){return rp(t,n,e)&&e.get().exists((function(e){return n.isPartOf(t,e,o)}))},up=function(t,n,e){return e.get()},ap=function(t,n,e,o){Ze(t.element,n).fold((function(){Ge(t.element,e)}),(function(n){Ne(t.element,e,n)})),qe(t.element,n,o)},cp=function(t,n,e){Ue(t.element,e).fold((function(){return eo(t.element,n)}),(function(e){return qe(t.element,n,e)}))},sp=function(t,n,e){var o=n.getAttachPoint(t);qe(t.element,"position",Hg.getMode(o)),ap(t,"visibility",n.cloakVisibilityAttr,"hidden")},fp=function(t){return U(["top","left","right","bottom"],(function(n){return Ze(t,n).isSome()}))},lp=function(t,n,e){fp(t.element)||eo(t.element,"position"),cp(t,"visibility",n.cloakVisibilityAttr)},dp=Object.freeze({__proto__:null,cloak:sp,decloak:lp,open:tp,openWhileCloaked:ep,close:op,isOpen:rp,isPartOf:ip,getState:up,setContent:np}),mp=function(t,n){return Ea([Aa(ia(),(function(e,o){op(e,t,n)}))])},gp=Object.freeze({__proto__:null,events:mp}),pp=[cf("onOpen"),cf("onClose"),Di("isPartOf"),Di("getAttachPoint"),qi("cloakVisibilityAttr","data-precloak-visibility")],vp=function(){var t=rd(),n=x("not-implemented");return Oc({readState:n,isOpen:t.isSet,clear:t.clear,set:t.set,get:t.get})},hp=Object.freeze({__proto__:null,init:vp}),bp=pl({fields:pp,name:"sandboxing",active:gp,apis:dp,state:hp}),yp=x("dismiss.popups"),xp=x("reposition.popups"),wp=x("mouse.released"),Sp=Zr([qi("isExtraPart",_),Xi("fireEventInstead",[qi("event",ga())])]),kp=function(t){var n,e=Si("Dismissal",Sp,t);return n={},n[yp()]={schema:Zr([Di("target")]),onReceive:function(t,n){if(bp.isOpen(t)){var o=bp.isPartOf(t,n.target)||e.isExtraPart(t,n.target);o||e.fireEventInstead.fold((function(){return bp.close(t)}),(function(n){return Sa(t,n.event)}))}}},n},Cp=Zr([Xi("fireEventInstead",[qi("event",pa())]),Ri("doReposition")]),Op=function(t){var n,e=Si("Reposition",Cp,t);return n={},n[xp()]={onReceive:function(t){bp.isOpen(t)&&e.fireEventInstead.fold((function(){return e.doReposition(t)}),(function(n){return Sa(t,n.event)}))}},n},_p=function(t,n,e){n.store.manager.onLoad(t,n,e)},Tp=function(t,n,e){n.store.manager.onUnload(t,n,e)},Ep=function(t,n,e,o){n.store.manager.setValue(t,n,e,o)},Dp=function(t,n,e){return n.store.manager.getValue(t,n,e)},Bp=function(t,n,e){return e},Mp=Object.freeze({__proto__:null,onLoad:_p,onUnload:Tp,setValue:Ep,getValue:Dp,getState:Bp}),Ap=function(t,n){var e=t.resetOnDom?[Wa((function(e,o){_p(e,t,n)})),Ua((function(e,o){Tp(e,t,n)}))]:[al(t,n,_p)];return Ea(e)},Fp=Object.freeze({__proto__:null,events:Ap}),Ip=function(){var t=ru(null),n=function(){return{mode:"memory",value:t.get()}},e=function(){return null===t.get()},o=function(){t.set(null)};return Oc({set:t.set,get:t.get,isNotSet:e,clear:o,readState:n})},Rp=function(){var t=v;return Oc({readState:t})},Vp=function(){var t=ru({}),n=ru({}),e=function(){return{mode:"dataset",dataByValue:t.get(),dataByText:n.get()}},o=function(){t.set({}),n.set({})},r=function(e){return _t(t.get(),e).orThunk((function(){return _t(n.get(),e)}))},i=function(e){var o=t.get(),r=n.get(),i={},u={};Y(e,(function(t){i[t.value]=t,_t(t,"meta").each((function(n){_t(n,"text").each((function(n){u[n]=t}))}))})),t.set(D(D({},o),i)),n.set(D(D({},r),u))};return Oc({readState:e,lookup:r,update:i,clear:o})},Pp=function(t){return t.store.manager.state(t)},Hp=Object.freeze({__proto__:null,memory:Ip,dataset:Vp,manual:Rp,init:Pp}),zp=function(t,n,e,o){var r=n.store;e.update([o]),r.setValue(t,o),n.onSetValue(t,o)},Np=function(t,n,e){var o=n.store,r=o.getDataKey(t);return e.lookup(r).getOrThunk((function(){return o.getFallbackEntry(r)}))},Lp=function(t,n,e){var o=n.store;o.initialValue.each((function(o){zp(t,n,e,o)}))},Wp=function(t,n,e){e.clear()},Up=[Ni("initialValue"),Di("getFallbackEntry"),Di("getDataKey"),Di("setValue"),df("manager",{setValue:zp,getValue:Np,onLoad:Lp,onUnload:Wp,state:Vp})],jp=function(t,n,e){return n.store.getValue(t)},Gp=function(t,n,e,o){n.store.setValue(t,o),n.onSetValue(t,o)},Xp=function(t,n,e){n.store.initialValue.each((function(e){n.store.setValue(t,e)}))},Yp=[Di("getValue"),qi("setValue",v),Ni("initialValue"),df("manager",{setValue:Gp,getValue:jp,onLoad:Xp,onUnload:v,state:Cc.init})],qp=function(t,n,e,o){e.set(o),n.onSetValue(t,o)},Kp=function(t,n,e){return e.get()},Jp=function(t,n,e){n.store.initialValue.each((function(t){e.isNotSet()&&e.set(t)}))},$p=function(t,n,e){e.clear()},Qp=[Ni("initialValue"),df("manager",{setValue:qp,getValue:Kp,onLoad:Jp,onUnload:$p,state:Ip})],Zp=[Ki("store",{mode:"memory"},Ci("mode",{memory:Qp,manual:Yp,dataset:Up})),cf("onSetValue"),qi("resetOnDom",!1)],tv=pl({fields:Zp,name:"representing",active:Fp,apis:Mp,extra:{setValueFrom:function(t,n){var e=tv.getValue(n);tv.setValue(t,e)}},state:Hp}),nv=function(t,n){return ou(t,{},X(n,(function(n){return Vi(n.name(),"Cannot configure "+n.name()+" for "+t)})).concat([Ti("dump",w)]))},ev=function(t){return t.dump},ov=function(t,n){return D(D({},ml(n)),t.dump)},rv={field:nv,augment:ov,get:ev},iv="placeholder",uv=uu.generate([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),av=function(t){return Tt(t,"uiType")},cv=function(t,n,e,o){return t.exists((function(t){return t!==e.owner}))?uv.single(!0,x(e)):_t(o,e.name).fold((function(){throw new Error("Unknown placeholder component: "+e.name+"\nKnown: ["+pt(o)+"]\nNamespace: "+t.getOr("none")+"\nSpec: "+JSON.stringify(e,null,2))}),(function(t){return t.replace()}))},sv=function(t,n,e,o){return av(e)&&e.uiType===iv?cv(t,n,e,o):uv.single(!1,x(e))},fv=function(t,n,e,o){var r=sv(t,n,e,o);return r.fold((function(r,i){var u=av(e)?i(n,e.config,e.validated):i(n),a=_t(u,"components").getOr([]),c=ot(a,(function(e){return fv(t,n,e,o)}));return[D(D({},u),{components:c})]}),(function(t,o){if(av(e)){var r=o(n,e.config,e.validated),i=e.validated.preprocess.getOr(w);return i(r)}return o(n)}))},lv=function(t,n,e,o){return ot(e,(function(e){return fv(t,n,e,o)}))},dv=function(t,n){var e=!1,o=function(){return e},r=function(){if(e)throw new Error("Trying to use the same placeholder more than once: "+t);return e=!0,n},i=function(){return n.fold((function(t,n){return t}),(function(t,n){return t}))};return{name:x(t),required:i,used:o,replace:r}},mv=function(t,n,e,o){var r=bt(o,(function(t,n){return dv(n,t)})),i=lv(t,n,e,r);return ht(r,(function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+t.getOr("none")+"\nComponents: "+JSON.stringify(n.components,null,2))})),i},gv=uv.single,pv=uv.multiple,vv=x(iv),hv=uu.generate([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),bv=qi("factory",{sketch:w}),yv=qi("schema",[]),xv=Di("name"),wv=_i("pname","pname",Or((function(t){return"<alloy."+rc(t.name)+">"})),ui()),Sv=Ti("schema",(function(){return[Ni("preprocess")]})),kv=qi("defaults",x({})),Cv=qi("overrides",x({})),Ov=ti([bv,yv,xv,wv,kv,Cv]),_v=ti([bv,yv,xv,kv,Cv]),Tv=ti([bv,yv,xv,wv,kv,Cv]),Ev=ti([bv,Sv,xv,Di("unit"),wv,kv,Cv]),Dv=function(t){return t.fold(V.some,V.none,V.some,V.some)},Bv=function(t){var n=function(t){return t.name};return t.fold(n,n,n,n)},Mv=function(t){return t.fold(w,w,w,w)},Av=function(t,n){return function(e){var o=Si("Converting part type",n,e);return t(o)}},Fv=Av(hv.required,Ov),Iv=Av(hv.external,_v),Rv=Av(hv.optional,Tv),Vv=Av(hv.group,Ev),Pv=x("entirety"),Hv=Object.freeze({__proto__:null,required:Fv,external:Iv,optional:Rv,group:Vv,asNamedPart:Dv,name:Bv,asCommon:Mv,original:Pv}),zv=function(t,n,e,o){return Sr(n.defaults(t,e,o),e,{uid:t.partUids[n.name]},n.overrides(t,e,o))},Nv=function(t,n,e){var o={},r={};return Y(e,(function(t){t.fold((function(t){o[t.pname]=gv(!0,(function(n,e,o){return t.factory.sketch(zv(n,t,e,o))}))}),(function(t){var e=n.parts[t.name];r[t.name]=x(t.factory.sketch(zv(n,t,e[Pv()]),e))}),(function(t){o[t.pname]=gv(!1,(function(n,e,o){return t.factory.sketch(zv(n,t,e,o))}))}),(function(t){o[t.pname]=pv(!0,(function(n,e,o){var r=n[t.name];return X(r,(function(e){return t.factory.sketch(Sr(t.defaults(n,e,o),e,t.overrides(n,e)))}))}))}))})),{internals:x(o),externals:x(r)}},Lv=function(t,n){var e={};return Y(n,(function(n){Dv(n).each((function(n){var o=Wv(t,n.pname);e[n.name]=function(e){var r=Si("Part: "+n.name+" in "+t,ti(n.schema),e);return D(D({},o),{config:e,validated:r})}}))})),e},Wv=function(t,n){return{uiType:vv(),owner:t,name:n}},Uv=function(t,n,e){return{uiType:vv(),owner:t,name:n,config:e,validated:{}}},jv=function(t){return ot(t,(function(t){return t.fold(V.none,V.some,V.none,V.none).map((function(t){return Pi(t.name,t.schema.concat([mf(Pv())]))})).toArray()}))},Gv=function(t){return X(t,Bv)},Xv=function(t,n,e){return Nv(t,n,e)},Yv=function(t,n,e){return mv(V.some(t),n,n.components,e)},qv=function(t,n,e){var o=n.partUids[e];return t.getSystem().getByUid(o).toOptional()},Kv=function(t,n,e){return qv(t,n,e).getOrDie("Could not find part: "+e)},Jv=function(t,n,e){var o={},r=n.partUids,i=t.getSystem();return Y(e,(function(t){o[t]=x(i.getByUid(r[t]))})),o},$v=function(t,n){var e=t.getSystem();return bt(n.partUids,(function(t,n){return x(e.getByUid(t))}))},Qv=function(t){return pt(t.partUids)},Zv=function(t,n,e){var o={},r=n.partUids,i=t.getSystem();return Y(e,(function(t){o[t]=x(i.getByUid(r[t]).getOrDie())})),o},th=function(t,n){var e=Gv(n);return gu(X(e,(function(n){return{key:n,value:t+"-"+n}})))},nh=function(t){return _i("partUids","partUids",Er((function(n){return th(n.uid,t)})),ui())},eh=Object.freeze({__proto__:null,generate:Lv,generateOne:Uv,schemas:jv,names:Gv,substitutes:Xv,components:Yv,defaultUids:th,defaultUidsSchema:nh,getAllParts:$v,getAllPartNames:Qv,getPart:qv,getPartOrDie:Kv,getParts:Jv,getPartsOrDie:Zv}),oh=function(t,n){var e=t.length>0?[Pi("parts",t)]:[];return e.concat([Di("uid"),qi("dom",{}),qi("components",[]),mf("originalSpec"),qi("debug.sketcher",{})]).concat(n)},rh=function(t,n,e,o,r){var i=oh(o,r);return Si(t+" [SpecSchema]",Zr(i.concat(n)),e)},ih=function(t,n,e,o){var r=ch(o),i=rh(t,n,r,[],[]);return e(i,r)},uh=function(t,n,e,o,r){var i=ch(r),u=jv(e),a=nh(e),c=rh(t,n,i,u,[a]),s=Xv(t,c,e),f=Yv(t,c,s.internals());return o(c,f,i,s.externals())},ah=function(t){return Tt(t,"uid")},ch=function(t){return ah(t)?t:D(D({},t),{uid:dc("uid")})},sh=function(t){return void 0!==t.uid},fh=Zr([Di("name"),Di("factory"),Di("configFields"),qi("apis",{}),qi("extraApis",{})]),lh=Zr([Di("name"),Di("factory"),Di("configFields"),Di("partFields"),qi("apis",{}),qi("extraApis",{})]),dh=function(t){var n=Si("Sketcher for "+t.name,fh,t),e=function(t){return ih(n.name,n.configFields,n.factory,t)},o=bt(n.apis,kc),r=bt(n.extraApis,(function(t,n){return bc(t,n)}));return D(D({name:n.name,configFields:n.configFields,sketch:e},o),r)},mh=function(t){var n=Si("Sketcher for "+t.name,lh,t),e=function(t){return uh(n.name,n.configFields,n.partFields,n.factory,t)},o=Lv(n.name,n.partFields),r=bt(n.apis,kc),i=bt(n.extraApis,(function(t,n){return bc(t,n)}));return D(D({name:n.name,partFields:n.partFields,configFields:n.configFields,sketch:e,parts:o},r),i)},gh=function(t){return"input"===cn(t)&&"radio"!==We(t,"type")||"textarea"===cn(t)},ph=function(t,n,e){return n.find(t)},vh=Object.freeze({__proto__:null,getCurrent:ph}),hh=[Di("find")],bh=pl({fields:hh,name:"composing",apis:vh}),yh=["input","button","textarea","select"],xh=function(t,n,e){var o=n.disabled()?Eh:Dh;o(t,n)},wh=function(t,n){return!0===n.useNative&&W(yh,cn(t.element))},Sh=function(t){return je(t.element,"disabled")},kh=function(t){Ne(t.element,"disabled","disabled")},Ch=function(t){Ge(t.element,"disabled")},Oh=function(t){return"true"===We(t.element,"aria-disabled")},_h=function(t){Ne(t.element,"aria-disabled","true")},Th=function(t){Ne(t.element,"aria-disabled","false")},Eh=function(t,n,e){n.disableClass.each((function(n){is(t.element,n)}));var o=wh(t,n)?kh:_h;o(t),n.onDisabled(t)},Dh=function(t,n,e){n.disableClass.each((function(n){as(t.element,n)}));var o=wh(t,n)?Ch:Th;o(t),n.onEnabled(t)},Bh=function(t,n){return wh(t,n)?Sh(t):Oh(t)},Mh=function(t,n,e,o){var r=o?Eh:Dh;r(t,n)},Ah=Object.freeze({__proto__:null,enable:Dh,disable:Eh,isDisabled:Bh,onLoad:xh,set:Mh}),Fh=function(t,n){return Bc({classes:n.disabled()?n.disableClass.toArray():[]})},Ih=function(t,n){return Ea([Da(na(),(function(n,e){return Bh(n,t)})),al(t,n,xh)])},Rh=Object.freeze({__proto__:null,exhibit:Fh,events:Ih}),Vh=[tu("disabled",_),qi("useNative",!0),Ni("disableClass"),cf("onDisabled"),cf("onEnabled")],Ph=pl({fields:Vh,name:"disabling",active:Rh,apis:Ah}),Hh=function(t,n,e,o){var r=Km(t.element,"."+n.highlightClass);Y(r,(function(e){U(o,(function(t){return t.element===e}))||(as(e,n.highlightClass),t.getSystem().getByDom(e).each((function(e){n.onDehighlight(t,e),Sa(e,wa())})))}))},zh=function(t,n,e){return Hh(t,n,e,[])},Nh=function(t,n,e,o){Xh(t,n,e,o)&&(as(o.element,n.highlightClass),n.onDehighlight(t,o),Sa(o,wa()))},Lh=function(t,n,e,o){Hh(t,n,e,[o]),Xh(t,n,e,o)||(is(o.element,n.highlightClass),n.onHighlight(t,o),Sa(o,xa()))},Wh=function(t,n,e){Kh(t,n).each((function(o){Lh(t,n,e,o)}))},Uh=function(t,n,e){Jh(t,n).each((function(o){Lh(t,n,e,o)}))},jh=function(t,n,e,o){qh(t,n,e,o).fold((function(t){throw t}),(function(o){Lh(t,n,e,o)}))},Gh=function(t,n,e,o){var r=tb(t,n),i=tt(r,o);i.each((function(o){Lh(t,n,e,o)}))},Xh=function(t,n,e,o){return cs(o.element,n.highlightClass)},Yh=function(t,n,e){return Hs(t.element,"."+n.highlightClass).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},qh=function(t,n,e,o){var r=Km(t.element,"."+n.itemClass);return V.from(r[o]).fold((function(){return rr.error(new Error("No element found with index "+o))}),t.getSystem().getByDom)},Kh=function(t,n,e){return Hs(t.element,"."+n.itemClass).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},Jh=function(t,n,e){var o=Km(t.element,"."+n.itemClass),r=o.length>0?V.some(o[o.length-1]):V.none();return r.bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},$h=function(t,n,e,o){var r=Km(t.element,"."+n.itemClass),i=nt(r,(function(t){return cs(t,n.highlightClass)}));return i.bind((function(n){var e=Ef(n,o,0,r.length-1);return t.getSystem().getByDom(r[e]).toOptional()}))},Qh=function(t,n,e){return $h(t,n,e,-1)},Zh=function(t,n,e){return $h(t,n,e,1)},tb=function(t,n,e){var o=Km(t.element,"."+n.itemClass);return Mt(X(o,(function(n){return t.getSystem().getByDom(n).toOptional()})))},nb=Object.freeze({__proto__:null,dehighlightAll:zh,dehighlight:Nh,highlight:Lh,highlightFirst:Wh,highlightLast:Uh,highlightAt:jh,highlightBy:Gh,isHighlighted:Xh,getHighlighted:Yh,getFirst:Kh,getLast:Jh,getPrevious:Qh,getNext:Zh,getCandidates:tb}),eb=[Di("highlightClass"),Di("itemClass"),cf("onHighlight"),cf("onDehighlight")],ob=pl({fields:eb,name:"highlighting",apis:nb}),rb=[8],ib=[9],ub=[13],ab=[27],cb=[32],sb=[37],fb=[38],lb=[39],db=[40],mb=function(t,n,e){var o=it(t.slice(0,n)),r=it(t.slice(n+1));return tt(o.concat(r),e)},gb=function(t,n,e){var o=it(t.slice(0,n));return tt(o,e)},pb=function(t,n,e){var o=t.slice(0,n),r=t.slice(n+1);return tt(r.concat(o),e)},vb=function(t,n,e){var o=t.slice(n+1);return tt(o,e)},hb=function(t){return function(n){var e=n.raw;return W(t,e.which)}},bb=function(t){return function(n){return rt(t,(function(t){return t(n)}))}},yb=function(t){var n=t.raw;return!0===n.shiftKey},xb=function(t){var n=t.raw;return!0===n.ctrlKey},wb=C(yb),Sb=function(t,n){return{matches:t,classification:n}},kb=function(t,n){var e=tt(t,(function(t){return t.matches(n)}));return e.map((function(t){return t.classification}))},Cb=function(t,n,e){var o=n.exists((function(t){return e.exists((function(n){return se(n,t)}))}));o||ka(t,va(),{prevFocus:n,newFocus:e})},Ob=function(){var t=function(t){return Tl(t.element)},n=function(n,e){var o=t(n);n.getSystem().triggerFocus(e,n.element);var r=t(n);Cb(n,o,r)};return{get:t,set:n}},_b=function(){var t=function(t){return ob.getHighlighted(t).map((function(t){return t.element}))},n=function(n,e){var o=t(n);n.getSystem().getByDom(e).fold(v,(function(t){ob.highlight(n,t)}));var r=t(n);Cb(n,o,r)};return{get:t,set:n}};(function(t){t["OnFocusMode"]="onFocus",t["OnEnterOrSpaceMode"]="onEnterOrSpace",t["OnApiMode"]="onApi"})(Hm||(Hm={}));var Tb=function(t,n,e,o,r){var i=function(){return t.concat([qi("focusManager",Ob()),Ki("focusInside","onFocus",hi((function(t){return W(["onFocus","onEnterOrSpace","onApi"],t)?rr.value(t):rr.error("Invalid value for focusInside")}))),df("handler",c),df("state",n),df("sendFocusIn",r)])},u=function(t,n,e,o,r){var i=e(t,n,o,r);return kb(i,n.event).bind((function(e){return e(t,n,o,r)}))},a=function(t,n){var i=t.focusInside!==Hm.OnFocusMode?V.none():r(t).map((function(e){return Aa($u(),(function(o,r){e(o,t,n),r.stop()}))})),a=function(e,o){var i=hb(cb.concat(ub))(o.event);t.focusInside===Hm.OnEnterOrSpaceMode&&i&&wu(e,o)&&r(t).each((function(r){r(e,t,n),o.stop()}))},c=[Aa(Nu(),(function(o,r){u(o,r,e,t,n).fold((function(){a(o,r)}),(function(t){r.stop()}))})),Aa(Lu(),(function(e,r){u(e,r,o,t,n).each((function(t){r.stop()}))}))];return Ea(i.toArray().concat(c))},c={schema:i,processKey:u,toEvents:a};return c},Eb=function(t){var n=[Ni("onEscape"),Ni("onEnter"),qi("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),qi("firstTabstop",0),qi("useTabstopAt",T),Ni("visibilitySelector")].concat([t]),e=function(t,n){var e=t.visibilitySelector.bind((function(t){return zs(n,t)})).getOr(n);return uo(e)>0},o=function(t,n){var o=Km(t.element,n.selector),r=J(o,(function(t){return e(n,t)}));return V.from(r[n.firstTabstop])},r=function(t,n){return n.focusManager.get(t).bind((function(t){return zs(t,n.selector)}))},i=function(t,n){return e(t,n)&&t.useTabstopAt(n)},u=function(t,n,e){o(t,n).each((function(e){n.focusManager.set(t,e)}))},a=function(t,n,e,o,r){return r(n,e,(function(t){return i(o,t)})).fold((function(){return o.cyclic?V.some(!0):V.none()}),(function(n){return o.focusManager.set(t,n),V.some(!0)}))},c=function(t,n,e,o){var i=Km(t.element,e.selector);return r(t,e).bind((function(n){var r=nt(i,k(se,n));return r.bind((function(n){return a(t,i,n,e,o)}))}))},s=function(t,n,e){var o=e.cyclic?mb:gb;return c(t,n,e,o)},f=function(t,n,e){var o=e.cyclic?pb:vb;return c(t,n,e,o)},l=function(t,n,e){return e.onEnter.bind((function(e){return e(t,n)}))},d=function(t,n,e){return e.onEscape.bind((function(e){return e(t,n)}))},m=x([Sb(bb([yb,hb(ib)]),s),Sb(hb(ib),f),Sb(hb(ab),d),Sb(bb([wb,hb(ub)]),l)]),g=x([]);return Tb(n,Cc.init,m,g,(function(){return V.some(u)}))},Db=Eb(Ti("cyclic",_)),Bb=Eb(Ti("cyclic",T)),Mb=function(t,n,e){return Oa(t,e,na()),V.some(!0)},Ab=function(t,n,e){var o=gh(e)&&hb(cb)(n.event);return o?V.none():Mb(t,n,e)},Fb=function(t,n){return V.some(!0)},Ib=[qi("execute",Ab),qi("useSpace",!1),qi("useEnter",!0),qi("useControlEnter",!1),qi("useDown",!1)],Rb=function(t,n,e){return e.execute(t,n,t.element)},Vb=function(t,n,e,o){var r=e.useSpace&&!gh(t.element)?cb:[],i=e.useEnter?ub:[],u=e.useDown?db:[],a=r.concat(i).concat(u);return[Sb(hb(a),Rb)].concat(e.useControlEnter?[Sb(bb([xb,hb(ub)]),Rb)]:[])},Pb=function(t,n,e,o){return e.useSpace&&!gh(t.element)?[Sb(hb(cb),Fb)]:[]},Hb=Tb(Ib,Cc.init,Vb,Pb,(function(){return V.none()})),zb=function(){var t=rd(),n=function(n,e){t.set({numRows:n,numColumns:e})},e=function(){return t.get().map((function(t){return t.numRows}))},o=function(){return t.get().map((function(t){return t.numColumns}))};return Oc({readState:function(){return t.get().map((function(t){return{numRows:String(t.numRows),numColumns:String(t.numColumns)}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:n,getNumRows:e,getNumColumns:o})},Nb=function(t){return t.state(t)},Lb=Object.freeze({__proto__:null,flatgrid:zb,init:Nb}),Wb=function(t){return function(n,e,o,r){var i=t(n.element);return Xb(i,n,e,o,r)}},Ub=function(t,n){var e=Rd(t,n);return Wb(e)},jb=function(t,n){var e=Rd(n,t);return Wb(e)},Gb=function(t){return function(n,e,o,r){return Xb(t,n,e,o,r)}},Xb=function(t,n,e,o,r){var i=o.focusManager.get(n).bind((function(e){return t(n.element,e,o,r)}));return i.map((function(t){return o.focusManager.set(n,t),!0}))},Yb=Gb,qb=Gb,Kb=Gb,Jb=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0},$b=function(t){return!Jb(t.dom)},Qb=function(t,n){return nt(t,n).map((function(n){return{index:n,candidates:t}}))},Zb=function(t,n,e){var o=function(t){return se(t,n)},r=Km(t,e),i=J(r,$b);return Qb(i,o)},ty=function(t,n){return nt(t,(function(t){return se(n,t)}))},ny=function(t,n,e,o){var r=Math.floor(n/e),i=n%e;return o(r,i).bind((function(n){var o=n.row*e+n.column;return o>=0&&o<t.length?V.some(t[o]):V.none()}))},ey=function(t,n,e,o,r){return ny(t,n,o,(function(n,i){var u=n===e-1,a=u?t.length-n*o:o,c=Ef(i,r,0,a-1);return V.some({row:n,column:c})}))},oy=function(t,n,e,o,r){return ny(t,n,o,(function(n,i){var u=Ef(n,r,0,e-1),a=u===e-1,c=a?t.length-u*o:o,s=Df(i,0,c-1);return V.some({row:u,column:s})}))},ry=function(t,n,e,o){return ey(t,n,e,o,1)},iy=function(t,n,e,o){return ey(t,n,e,o,-1)},uy=function(t,n,e,o){return oy(t,n,e,o,-1)},ay=function(t,n,e,o){return oy(t,n,e,o,1)},cy=[Di("selector"),qi("execute",Ab),sf("onEscape"),qi("captureTab",!1),gf()],sy=function(t,n,e){Hs(t.element,n.selector).each((function(e){n.focusManager.set(t,e)}))},fy=function(t,n){return n.focusManager.get(t).bind((function(t){return zs(t,n.selector)}))},ly=function(t,n,e,o){return fy(t,e).bind((function(o){return e.execute(t,n,o)}))},dy=function(t){return function(n,e,o,r){return Zb(n,e,o.selector).bind((function(n){return t(n.candidates,n.index,r.getNumRows().getOr(o.initSize.numRows),r.getNumColumns().getOr(o.initSize.numColumns))}))}},my=function(t,n,e){return e.captureTab?V.some(!0):V.none()},gy=function(t,n,e){return e.onEscape(t,n)},py=dy(iy),vy=dy(ry),hy=dy(uy),by=dy(ay),yy=x([Sb(hb(sb),Ub(py,vy)),Sb(hb(lb),jb(py,vy)),Sb(hb(fb),Yb(hy)),Sb(hb(db),qb(by)),Sb(bb([yb,hb(ib)]),my),Sb(bb([wb,hb(ib)]),my),Sb(hb(ab),gy),Sb(hb(cb.concat(ub)),ly)]),xy=x([Sb(hb(cb),Fb)]),wy=Tb(cy,zb,yy,xy,(function(){return V.some(sy)})),Sy=function(t,n,e,o){var r=function(t){return"button"===cn(t)&&"disabled"===We(t,"disabled")},i=function(t,n,e){var u=Ef(n,o,0,e.length-1);return u===t?V.none():r(e[u])?i(t,u,e):V.from(e[u])};return Zb(t,e,n).bind((function(t){var n=t.index,e=t.candidates;return i(n,n,e)}))},ky=[Di("selector"),qi("getInitial",V.none),qi("execute",Ab),sf("onEscape"),qi("executeOnMove",!1),qi("allowVertical",!0)],Cy=function(t,n){return n.focusManager.get(t).bind((function(t){return zs(t,n.selector)}))},Oy=function(t,n,e){return Cy(t,e).bind((function(o){return e.execute(t,n,o)}))},_y=function(t,n,e){n.getInitial(t).orThunk((function(){return Hs(t.element,n.selector)})).each((function(e){n.focusManager.set(t,e)}))},Ty=function(t,n,e){return Sy(t,e.selector,n,-1)},Ey=function(t,n,e){return Sy(t,e.selector,n,1)},Dy=function(t){return function(n,e,o,r){return t(n,e,o,r).bind((function(){return o.executeOnMove?Oy(n,e,o):V.some(!0)}))}},By=function(t,n,e){return e.onEscape(t,n)},My=function(t,n,e,o){var r=sb.concat(e.allowVertical?fb:[]),i=lb.concat(e.allowVertical?db:[]);return[Sb(hb(r),Dy(Ub(Ty,Ey))),Sb(hb(i),Dy(jb(Ty,Ey))),Sb(hb(ub),Oy),Sb(hb(cb),Oy),Sb(hb(ab),By)]},Ay=x([Sb(hb(cb),Fb)]),Fy=Tb(ky,Cc.init,My,Ay,(function(){return V.some(_y)})),Iy=function(t,n,e){return V.from(t[n]).bind((function(t){return V.from(t[e]).map((function(t){return{rowIndex:n,columnIndex:e,cell:t}}))}))},Ry=function(t,n,e,o){var r=t[n],i=r.length,u=Ef(e,o,0,i-1);return Iy(t,n,u)},Vy=function(t,n,e,o){var r=Ef(e,o,0,t.length-1),i=t[r].length,u=Df(n,0,i-1);return Iy(t,r,u)},Py=function(t,n,e,o){var r=t[n],i=r.length,u=Df(e+o,0,i-1);return Iy(t,n,u)},Hy=function(t,n,e,o){var r=Df(e+o,0,t.length-1),i=t[r].length,u=Df(n,0,i-1);return Iy(t,r,u)},zy=function(t,n,e){return Ry(t,n,e,1)},Ny=function(t,n,e){return Ry(t,n,e,-1)},Ly=function(t,n,e){return Vy(t,e,n,-1)},Wy=function(t,n,e){return Vy(t,e,n,1)},Uy=function(t,n,e){return Py(t,n,e,-1)},jy=function(t,n,e){return Py(t,n,e,1)},Gy=function(t,n,e){return Hy(t,e,n,-1)},Xy=function(t,n,e){return Hy(t,e,n,1)},Yy=[Pi("selectors",[Di("row"),Di("cell")]),qi("cycles",!0),qi("previousSelector",V.none),qi("execute",Ab)],qy=function(t,n,e){var o=n.previousSelector(t).orThunk((function(){var e=n.selectors;return Hs(t.element,e.cell)}));o.each((function(e){n.focusManager.set(t,e)}))},Ky=function(t,n,e){return Tl(t.element).bind((function(o){return e.execute(t,n,o)}))},Jy=function(t,n){return X(t,(function(t){return Km(t,n.selectors.cell)}))},$y=function(t,n){return function(e,o,r){var i=r.cycles?t:n;return zs(o,r.selectors.row).bind((function(t){var n=Km(t,r.selectors.cell);return ty(n,o).bind((function(n){var o=Km(e,r.selectors.row);return ty(o,t).bind((function(t){var e=Jy(o,r);return i(e,t,n).map((function(t){return t.cell}))}))}))}))}},Qy=$y(Ny,Uy),Zy=$y(zy,jy),tx=$y(Ly,Gy),nx=$y(Wy,Xy),ex=x([Sb(hb(sb),Ub(Qy,Zy)),Sb(hb(lb),jb(Qy,Zy)),Sb(hb(fb),Yb(tx)),Sb(hb(db),qb(nx)),Sb(hb(cb.concat(ub)),Ky)]),ox=x([Sb(hb(cb),Fb)]),rx=Tb(Yy,Cc.init,ex,ox,(function(){return V.some(qy)})),ix=[Di("selector"),qi("execute",Ab),qi("moveOnTab",!1)],ux=function(t,n,e){return e.focusManager.get(t).bind((function(o){return e.execute(t,n,o)}))},ax=function(t,n,e){Hs(t.element,n.selector).each((function(e){n.focusManager.set(t,e)}))},cx=function(t,n,e){return Sy(t,e.selector,n,-1)},sx=function(t,n,e){return Sy(t,e.selector,n,1)},fx=function(t,n,e,o){return e.moveOnTab?Kb(cx)(t,n,e,o):V.none()},lx=function(t,n,e,o){return e.moveOnTab?Kb(sx)(t,n,e,o):V.none()},dx=x([Sb(hb(fb),Kb(cx)),Sb(hb(db),Kb(sx)),Sb(bb([yb,hb(ib)]),fx),Sb(bb([wb,hb(ib)]),lx),Sb(hb(ub),ux),Sb(hb(cb),ux)]),mx=x([Sb(hb(cb),Fb)]),gx=Tb(ix,Cc.init,dx,mx,(function(){return V.some(ax)})),px=[sf("onSpace"),sf("onEnter"),sf("onShiftEnter"),sf("onLeft"),sf("onRight"),sf("onTab"),sf("onShiftTab"),sf("onUp"),sf("onDown"),sf("onEscape"),qi("stopSpaceKeyup",!1),Ni("focusIn")],vx=function(t,n,e){return[Sb(hb(cb),e.onSpace),Sb(bb([wb,hb(ub)]),e.onEnter),Sb(bb([yb,hb(ub)]),e.onShiftEnter),Sb(bb([yb,hb(ib)]),e.onShiftTab),Sb(bb([wb,hb(ib)]),e.onTab),Sb(hb(fb),e.onUp),Sb(hb(db),e.onDown),Sb(hb(sb),e.onLeft),Sb(hb(lb),e.onRight),Sb(hb(cb),e.onSpace),Sb(hb(ab),e.onEscape)]},hx=function(t,n,e){return e.stopSpaceKeyup?[Sb(hb(cb),Fb)]:[]},bx=Tb(px,Cc.init,vx,hx,(function(t){return t.focusIn})),yx=Db.schema(),xx=Bb.schema(),wx=Fy.schema(),Sx=wy.schema(),kx=rx.schema(),Cx=Hb.schema(),Ox=gx.schema(),_x=bx.schema(),Tx=Object.freeze({__proto__:null,acyclic:yx,cyclic:xx,flow:wx,flatgrid:Sx,matrix:kx,execution:Cx,menu:Ox,special:_x}),Ex=function(t){return Et(t,"setGridSize")},Dx=hl({branchKey:"mode",branches:Tx,name:"keying",active:{events:function(t,n){var e=t.handler;return e.toEvents(t,n)}},apis:{focusIn:function(t,n,e){n.sendFocusIn(n).fold((function(){t.getSystem().triggerFocus(t.element,t.element)}),(function(o){o(t,n,e)}))},setGridSize:function(t,n,e,o,r){Ex(e)?e.setGridSize(o,r):console.error("Layout does not support setGridSize")}},state:Lb}),Bx=function(t,n,e,o){El((function(){var n=X(o,t.getSystem().build);Ug(t,n)}),t.element)},Mx=function(t,n,e,o){var r=t.getSystem().build(o);Gg(t,r,e)},Ax=function(t,n,e,o){Mx(t,n,Mo,o)},Fx=function(t,n,e,o){Mx(t,n,Bo,o)},Ix=function(t,n,e,o){var r=Rx(t),i=tt(r,(function(t){return se(o.element,t.element)}));i.each(Yg)},Rx=function(t,n){return t.components()},Vx=function(t,n,e,o,r){var i=Rx(t);return V.from(i[o]).map((function(i){return Ix(t,n,e,i),r.each((function(e){Mx(t,n,(function(t,n){Ao(t,n,o)}),e)})),i}))},Px=function(t,n,e,o,r){var i=Rx(t);return nt(i,o).bind((function(o){return Vx(t,n,e,o,r)}))},Hx=Object.freeze({__proto__:null,append:Ax,prepend:Fx,remove:Ix,replaceAt:Vx,replaceBy:Px,set:Bx,contents:Rx}),zx=pl({fields:[],name:"replacing",apis:Hx}),Nx=function(t,n){var e=Ea(n);return pl({fields:[Di("enabled")],name:t,active:{events:x(e)}})},Lx=function(t,n){var e=Nx(t,n);return{key:t,value:{config:{},me:e,configAsRaw:x({}),initialConfig:{},state:Cc}}},Wx=function(t,n){n.ignore||(kl(t.element),n.onFocus(t))},Ux=function(t,n){n.ignore||Cl(t.element)},jx=function(t){return Ol(t.element)},Gx=Object.freeze({__proto__:null,focus:Wx,blur:Ux,isFocused:jx}),Xx=function(t,n){var e=n.ignore?{}:{attributes:{tabindex:"-1"}};return Bc(e)},Yx=function(t){return Ea([Aa($u(),(function(n,e){Wx(n,t),e.stop()}))].concat(t.stopMousedown?[Aa(Fu(),(function(t,n){n.event.prevent()}))]:[]))},qx=Object.freeze({__proto__:null,exhibit:Xx,events:Yx}),Kx=[cf("onFocus"),qi("stopMousedown",!1),qi("ignore",!1)],Jx=pl({fields:Kx,name:"focusing",active:qx,apis:Gx}),$x=function(t){var n=function(){var n=ru(t),e=function(){return n.get()},o=function(t){return n.set(t)},r=function(){return n.set(t)},i=function(){return n.get()};return{get:e,set:o,clear:r,readState:i}};return{init:n}},Qx=function(t,n,e){var o=n.aria;o.update(t,o,e.get())},Zx=function(t,n,e){n.toggleClass.each((function(n){e.get()?is(t.element,n):as(t.element,n)}))},tw=function(t,n,e){ow(t,n,e,!e.get())},nw=function(t,n,e){e.set(!0),Zx(t,n,e),Qx(t,n,e)},ew=function(t,n,e){e.set(!1),Zx(t,n,e),Qx(t,n,e)},ow=function(t,n,e,o){var r=o?nw:ew;r(t,n,e)},rw=function(t,n,e){return e.get()},iw=function(t,n,e){ow(t,n,e,n.selected)},uw=Object.freeze({__proto__:null,onLoad:iw,toggle:tw,isOn:rw,on:nw,off:ew,set:ow}),aw=function(){return Bc({})},cw=function(t,n){var e=ul(t,n,tw),o=al(t,n,iw);return Ea(et([t.toggleOnExecute?[e]:[],[o]]))},sw=Object.freeze({__proto__:null,exhibit:aw,events:cw}),fw=function(t,n,e){Ne(t.element,"aria-pressed",e),n.syncWithExpanded&&mw(t,n,e)},lw=function(t,n,e){Ne(t.element,"aria-selected",e)},dw=function(t,n,e){Ne(t.element,"aria-checked",e)},mw=function(t,n,e){Ne(t.element,"aria-expanded",e)},gw=[qi("selected",!1),Ni("toggleClass"),qi("toggleOnExecute",!0),Ki("aria",{mode:"none"},Ci("mode",{pressed:[qi("syncWithExpanded",!1),df("update",fw)],checked:[df("update",dw)],expanded:[df("update",mw)],selected:[df("update",lw)],none:[df("update",v)]}))],pw=pl({fields:gw,name:"toggling",active:sw,apis:uw,state:$x(!1)}),vw=function(){var t=function(t,n){n.stop(),Ca(t)};return[Aa(ju(),t),Aa(oa(),t),za(Du()),za(Fu())]},hw=function(t){var n=function(t){return Ga((function(n,e){t(n),e.stop()}))};return Ea(et([t.map(n).toArray(),vw()]))},bw="alloy.item-hover",yw="alloy.item-focus",xw=function(t){(Tl(t.element).isNone()||Jx.isFocused(t))&&(Jx.isFocused(t)||Jx.focus(t),ka(t,bw,{item:t}))},ww=function(t){ka(t,yw,{item:t})},Sw=x(bw),kw=x(yw),Cw=function(t){return{dom:t.dom,domModification:D(D({},t.domModification),{attributes:D(D(D({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes),{"aria-haspopup":t.hasSubmenu}),t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:rv.augment(t.itemBehaviours,[t.toggling.fold(pw.revoke,(function(t){return pw.config(D({aria:{mode:"checked"}},t))})),Jx.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){ww(t)}}),Dx.config({mode:"execution"}),tv.config({store:{mode:"memory",initialValue:t.data}}),Lx("item-type-events",M(M([],vw(),!0),[Aa(Pu(),xw),Aa(ea(),Jx.focus)],!1))]),components:t.components,eventOrder:t.eventOrder}},Ow=[Di("data"),Di("components"),Di("dom"),qi("hasSubmenu",!1),Ni("toggling"),rv.field("itemBehaviours",[pw,Jx,Dx,tv]),qi("ignoreFocus",!1),qi("domModification",{}),df("builder",Cw),qi("eventOrder",{})],_w=function(t){return{dom:t.dom,components:t.components,events:Ea([Na(ea())])}},Tw=[Di("dom"),Di("components"),df("builder",_w)],Ew=x("item-widget"),Dw=x([Fv({name:"widget",overrides:function(t){return{behaviours:ml([tv.config({store:{mode:"manual",getValue:function(n){return t.data},setValue:v}})])}}})]),Bw=function(t){var n=Xv(Ew(),t,Dw()),e=Yv(Ew(),t,n.internals()),o=function(n){return qv(n,t,"widget").map((function(t){return Dx.focusIn(t),t}))},r=function(n,e){return gh(e.event.target)?V.none():function(){return t.autofocus?(e.setSource(n.element),V.none()):V.none()}()};return{dom:t.dom,components:e,domModification:t.domModification,events:Ea([Ga((function(t,n){o(t).each((function(t){n.stop()}))})),Aa(Pu(),xw),Aa(ea(),(function(n,e){t.autofocus?o(n):Jx.focus(n)}))]),behaviours:rv.augment(t.widgetBehaviours,[tv.config({store:{mode:"memory",initialValue:t.data}}),Jx.config({ignore:t.ignoreFocus,onFocus:function(t){ww(t)}}),Dx.config({mode:"special",focusIn:t.autofocus?function(t){o(t)}:bl(),onLeft:r,onRight:r,onEscape:function(n,e){return Jx.isFocused(n)||t.autofocus?t.autofocus?(e.setSource(n.element),V.none()):V.none():(Jx.focus(n),V.some(!0))}})])}},Mw=[Di("uid"),Di("data"),Di("components"),Di("dom"),qi("autofocus",!1),qi("ignoreFocus",!1),rv.field("widgetBehaviours",[tv,Jx,Dx]),qi("domModification",{}),nh(Dw()),df("builder",Bw)],Aw=Ci("type",{widget:Mw,item:Ow,separator:Tw}),Fw=function(t,n){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:n.initSize.numColumns,numRows:n.initSize.numRows},focusManager:t.focusManager}},Iw=function(t,n){return{mode:"matrix",selectors:{row:n.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}},Rw=function(t,n){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:n.moveOnTab,focusManager:t.focusManager}},Vw=x([Vv({factory:{sketch:function(t){var n=Si("menu.spec item",Aw,t);return n.builder(n)}},name:"items",unit:"item",defaults:function(t,n){return Tt(n,"uid")?n:D(D({},n),{uid:dc("item")})},overrides:function(t,n){return{type:n.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),Pw=x([Di("value"),Di("items"),Di("dom"),Di("components"),qi("eventOrder",{}),nv("menuBehaviours",[ob,tv,bh,Dx]),Ki("movement",{mode:"menu",moveOnTab:!0},Ci("mode",{grid:[gf(),df("config",Fw)],matrix:[df("config",Iw),Di("rowSelector")],menu:[qi("moveOnTab",!0),df("config",Rw)]})),of(),qi("fakeFocus",!1),qi("focusManager",Ob()),cf("onHighlight")]),Hw=x("alloy.menu-focus"),zw=function(t,n,e,o){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:ov(t.menuBehaviours,[ob.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),tv.config({store:{mode:"memory",initialValue:t.value}}),bh.config({find:V.some}),Dx.config(t.movement.config(t,t.movement))]),events:Ea([Aa(kw(),(function(t,n){var e=n.event;t.getSystem().getByDom(e.target).each((function(e){ob.highlight(t,e),n.stop(),ka(t,Hw(),{menu:t,item:e})}))})),Aa(Sw(),(function(t,n){var e=n.event.item;ob.highlight(t,e)}))]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}},Nw=mh({name:"Menu",configFields:Pw(),partFields:Vw(),factory:zw}),Lw=function(t){return yt(t,(function(t,n){return{k:t,v:n}}))},Ww=function(t,n,e,o){return _t(e,o).bind((function(o){return _t(t,o).bind((function(o){var r=Ww(t,n,e,o);return V.some([o].concat(r))}))})).getOr([])},Uw=function(t,n){var e={};ht(t,(function(t,n){Y(t,(function(t){e[t]=n}))}));var o=n,r=Lw(n),i=bt(r,(function(t,n){return[n].concat(Ww(e,o,r,n))}));return bt(e,(function(t){return _t(i,t).getOr([t])}))},jw=function(){var t=ru({}),n=ru({}),e=ru({}),o=rd(),r=ru({}),i=function(){t.set({}),n.set({}),e.set({}),o.clear()},u=function(){return o.get().isNone()},a=function(t,e){var o;n.set(D(D({},n.get()),(o={},o[t]={type:"prepared",menu:e},o)))},c=function(i,u,a,c){o.set(i),t.set(a),n.set(u),r.set(c);var s=Uw(c,a);e.set(s)},s=function(n){return Ct(t.get(),(function(t,e){return t===n}))},f=function(t,n,e){return p(t).bind((function(o){return s(t).bind((function(t){return n(t).map((function(t){return{triggeredMenu:o,triggeringItem:t,triggeringPath:e}}))}))}))},l=function(t,n){var r=J(h(t).toArray(),(function(t){return p(t).isSome()}));return _t(e.get(),t).bind((function(t){var e=it(r.concat(t)),i=ot(e,(function(t,r){return f(t,n,e.slice(0,r+1)).fold((function(){return Dt(o.get(),t)?[]:[V.none()]}),(function(t){return[V.some(t)]}))}));return At(i)}))},d=function(n){return _t(t.get(),n).map((function(t){var o=_t(e.get(),n).getOr([]);return[t].concat(o)}))},m=function(t){return _t(e.get(),t).bind((function(t){return t.length>1?V.some(t.slice(1)):V.none()}))},g=function(t){return _t(e.get(),t)},p=function(t){return v(t).bind(Gw)},v=function(t){return _t(n.get(),t)},h=function(n){return _t(t.get(),n)},b=function(t){var n=r.get();return ut(pt(n),t)},y=function(){return o.get().bind(p)},x=function(){return n.get()};return{setMenuBuilt:a,setContents:c,expand:d,refresh:g,collapse:m,lookupMenu:v,lookupItem:h,otherMenus:b,getPrimary:y,getMenus:x,clear:i,isClear:u,getTriggeringPath:l}},Gw=function(t){return"prepared"===t.type?V.some(t.menu):V.none()},Xw={init:jw,extractPreparedMenu:Gw},Yw=function(t,n){var e,o=rd(),r=function(n,e,o){return bt(o,(function(o,r){var i=function(){return Nw.sketch(D(D({},o),{value:r,markers:t.markers,fakeFocus:t.fakeFocus,onHighlight:t.onHighlight,focusManager:t.fakeFocus?_b():Ob()}))};return r===e?{type:"prepared",menu:n.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}}))},i=Xw.init(),u=function(n){var e=r(n,t.data.primary,t.data.menus),o=s();return i.setContents(t.data.primary,e,t.data.expansions,o),i.getPrimary()},a=function(t){return tv.getValue(t).value},c=function(t,n,e){return gt(n,(function(t){if(!t.getSystem().isConnected())return V.none();var n=ob.getCandidates(t);return tt(n,(function(t){return a(t)===e}))}))},s=function(n){return bt(t.data.menus,(function(t,n){return ot(t.items,(function(t){return"separator"===t.type?[]:[t.data.value]}))}))},f=function(t,n){ob.highlight(t,n),ob.getHighlighted(n).orThunk((function(){return ob.getFirst(n)})).each((function(n){Oa(t,n.element,ea())}))},l=function(t,n){return Mt(X(n,(function(n){return t.lookupMenu(n).bind((function(t){return"prepared"===t.type?V.some(t.menu):V.none()}))})))},d=function(n,e,o){var r=l(e,e.otherMenus(o));Y(r,(function(e){fs(e.element,[t.markers.backgroundMenu]),t.stayInDom||zx.remove(n,e)}))},m=function(n){return o.get().getOrThunk((function(){var e={},r=Km(n.element,"."+t.markers.item),i=J(r,(function(t){return"true"===We(t,"aria-haspopup")}));return Y(i,(function(t){n.getSystem().getByDom(t).each((function(t){var n=a(t);e[n]=t}))})),o.set(e),e}))},g=function(t,n){var e=m(t);ht(e,(function(t,e){var o=W(n,e);Ne(t.element,"aria-expanded",o)}))},p=function(n,e,o){return V.from(o[0]).bind((function(r){return e.lookupMenu(r).bind((function(r){if("notbuilt"===r.type)return V.none();var i=r.menu,u=l(e,o.slice(1));return Y(u,(function(n){is(n.element,t.markers.backgroundMenu)})),Ve(i.element)||zx.append(n,Es(i)),fs(i.element,[t.markers.backgroundMenu]),f(n,i),d(n,e,o),V.some(i)}))}))};(function(t){t[t["HighlightSubmenu"]=0]="HighlightSubmenu",t[t["HighlightParent"]=1]="HighlightParent"})(e||(e={}));var h=function(t,n,e){if("notbuilt"===e.type){var o=t.getSystem().build(e.nbMenu());return i.setMenuBuilt(n,o),o}return e.menu},b=function(n,o,r){if(void 0===r&&(r=e.HighlightSubmenu),o.hasConfigured(Ph)&&Ph.isDisabled(o))return V.some(o);var u=a(o);return i.expand(u).bind((function(u){return g(n,u),V.from(u[0]).bind((function(a){return i.lookupMenu(a).bind((function(c){var s=h(n,a,c);return Ve(s.element)||zx.append(n,Es(s)),t.onOpenSubmenu(n,o,s,it(u)),r===e.HighlightSubmenu?(ob.highlightFirst(s),p(n,i,u)):(ob.dehighlightAll(s),V.some(o))}))}))}))},y=function(n,e){var o=a(e);return i.collapse(o).bind((function(o){return g(n,o),p(n,i,o).map((function(o){return t.onCollapseMenu(n,e,o),o}))}))},x=function(t,n){var e=a(n);return i.refresh(e).bind((function(n){return g(t,n),p(t,i,n)}))},w=function(t,n){return gh(n.element)?V.none():b(t,n,e.HighlightSubmenu)},S=function(t,n){return gh(n.element)?V.none():y(t,n)},k=function(n,e){return y(n,e).orThunk((function(){return t.onEscape(n,e).map((function(){return n}))}))},C=function(n){return function(e,o){return zs(o.getSource(),"."+t.markers.item).bind((function(t){return e.getSystem().getByDom(t).toOptional().bind((function(t){return n(e,t).map(T)}))}))}},O=Ea([Aa(Hw(),(function(t,n){var e=n.event.item;i.lookupItem(a(e)).each((function(){var e=n.event.menu;ob.highlight(t,e);var o=a(n.event.item);i.refresh(o).each((function(n){return d(t,i,n)}))}))})),Ga((function(n,o){var r=o.event.target;n.getSystem().getByDom(r).each((function(o){var r=a(o);0===r.indexOf("collapse-item")&&y(n,o),b(n,o,e.HighlightSubmenu).fold((function(){t.onExecute(n,o)}),v)}))})),Wa((function(n,e){u(n).each((function(e){zx.append(n,Es(e)),t.onOpenMenu(n,e),t.highlightImmediately&&f(n,e)}))}))].concat(t.navigateOnHover?[Aa(Sw(),(function(n,o){var r=o.event.item;x(n,r),b(n,r,e.HighlightParent),t.onHover(n,r)}))]:[])),_=function(t){return ob.getHighlighted(t).bind(ob.getHighlighted)},E=function(t){_(t).each((function(n){y(t,n)}))},B=function(t){i.getPrimary().each((function(n){f(t,n)}))},M=function(t){return V.from(t.components()[0]).filter((function(t){return"menu"===We(t.element,"role")}))},A=function(n){var e=i.getPrimary().bind((function(t){return _(n).bind((function(t){var e=a(t),o=Ot(i.getMenus()),r=Mt(X(o,Xw.extractPreparedMenu));return i.getTriggeringPath(e,(function(t){return c(n,r,t)}))})).map((function(n){return{primary:t,triggeringPath:n}}))}));e.fold((function(){M(n).each((function(e){t.onRepositionMenu(n,e,[])}))}),(function(e){var o=e.primary,r=e.triggeringPath;t.onRepositionMenu(n,o,r)}))},F={collapseMenu:E,highlightPrimary:B,repositionMenus:A};return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:ov(t.tmenuBehaviours,[Dx.config({mode:"special",onRight:C(w),onLeft:C(S),onEscape:C(k),focusIn:function(t,n){i.getPrimary().each((function(n){Oa(t,n.element,ea())}))}}),ob.config({highlightClass:t.markers.selectedMenu,itemClass:t.markers.menu}),bh.config({find:function(t){return ob.getHighlighted(t)}}),zx.config({})]),eventOrder:t.eventOrder,apis:F,events:O}},qw=x("collapse-item"),Kw=function(t,n,e){return{primary:t,menus:n,expansions:e}},Jw=function(t,n){return{primary:t,menus:mu(t,n),expansions:{}}},$w=function(t){return{value:rc(qw()),meta:{text:t}}},Qw=dh({name:"TieredMenu",configFields:[lf("onExecute"),lf("onEscape"),ff("onOpenMenu"),ff("onOpenSubmenu"),cf("onRepositionMenu"),cf("onCollapseMenu"),qi("highlightImmediately",!0),Pi("data",[Di("primary"),Di("menus"),Di("expansions")]),qi("fakeFocus",!1),cf("onHighlight"),cf("onHover"),rf(),Di("dom"),qi("navigateOnHover",!0),qi("stayInDom",!1),nv("tmenuBehaviours",[Dx,ob,bh,zx]),qi("eventOrder",{})],apis:{collapseMenu:function(t,n){t.collapseMenu(n)},highlightPrimary:function(t,n){t.highlightPrimary(n)},repositionMenus:function(t,n){t.repositionMenus(n)}},factory:Yw,extraApis:{tieredData:Kw,singleData:Jw,collapseItem:$w}}),Zw=function(t,n,e,o,r){var i=function(){return t.lazySink(n)},u="horizontal"===o.type?{layouts:{onLtr:function(){return tl()},onRtl:function(){return nl()}}}:{},a=function(t){return 2===t.length},c=function(t){return a(t)?u:{}};return Qw.sketch({dom:{tag:"div"},data:o.data,markers:o.menu.markers,highlightImmediately:o.menu.highlightImmediately,onEscape:function(){return bp.close(n),t.onEscape.map((function(t){return t(n)})),V.some(!0)},onExecute:function(){return V.some(!0)},onOpenMenu:function(t,n){Hg.positionWithinBounds(i().getOrDie(),n,e,r())},onOpenSubmenu:function(t,n,e,o){var r=i().getOrDie();Hg.position(r,e,{anchor:D({type:"submenu",item:n},c(o))})},onRepositionMenu:function(t,n,o){var u=i().getOrDie();Hg.positionWithinBounds(u,n,e,r()),Y(o,(function(t){var n=c(t.triggeringPath);Hg.position(u,t.triggeredMenu,{anchor:D({type:"submenu",item:t.triggeringItem},n)})}))}})},tS=function(t,n){var e=function(n,e){var o=t.getRelated(n);return o.exists((function(t){return Us(t,e)}))},o=function(t,n){bp.setContent(t,n)},r=function(t,n,e){i(t,n,e,V.none())},i=function(t,n,e,o){u(t,n,e,(function(){return o.map((function(t){return Qo(t)}))}))},u=function(n,e,o,r){var i=t.lazySink(n).getOrDie();bp.openWhileCloaked(n,e,(function(){return Hg.positionWithinBounds(i,n,o,r())})),tv.setValue(n,V.some({mode:"position",config:o,getBounds:r}))},a=function(t,n,e){c(t,n,e,V.none)},c=function(n,e,o,r){var i=Zw(t,n,e,o,r);bp.open(n,i),tv.setValue(n,V.some({mode:"menu",menu:i}))},s=function(t){bp.isOpen(t)&&(tv.setValue(t,V.none()),bp.close(t))},f=function(t){return bp.getState(t)},l=function(n){bp.isOpen(n)&&tv.getValue(n).each((function(e){switch(e.mode){case"menu":bp.getState(n).each(Qw.repositionMenus);break;case"position":var o=t.lazySink(n).getOrDie();Hg.positionWithinBounds(o,n,e.config,e.getBounds());break}}))},d={setContent:o,showAt:r,showWithin:i,showWithinBounds:u,showMenuAt:a,showMenuWithinBounds:c,hide:s,getContent:f,reposition:l,isOpen:bp.isOpen};return{uid:t.uid,dom:t.dom,behaviours:ov(t.inlineBehaviours,[bp.config({isPartOf:function(t,n,o){return Us(n,o)||e(t,o)},getAttachPoint:function(n){return t.lazySink(n).getOrDie()},onOpen:function(n){t.onShow(n)},onClose:function(n){t.onHide(n)}}),tv.config({store:{mode:"memory",initialValue:V.none()}}),yl.config({channels:D(D({},kp(D({isExtraPart:n.isExtraPart},t.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))),Op(D(D({},t.fireRepositionEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})),{doReposition:l})))})]),eventOrder:t.eventOrder,apis:d}},nS=dh({name:"InlineView",configFields:[Di("lazySink"),cf("onShow"),cf("onHide"),ji("onEscape"),nv("inlineBehaviours",[bp,tv,yl]),Xi("fireDismissalEventInstead",[qi("event",ga())]),Xi("fireRepositionEventInstead",[qi("event",pa())]),qi("getRelated",V.none),qi("isExtraPart",_),qi("eventOrder",V.none)],factory:tS,apis:{showAt:function(t,n,e,o){t.showAt(n,e,o)},showWithin:function(t,n,e,o,r){t.showWithin(n,e,o,r)},showWithinBounds:function(t,n,e,o,r){t.showWithinBounds(n,e,o,r)},showMenuAt:function(t,n,e,o){t.showMenuAt(n,e,o)},showMenuWithinBounds:function(t,n,e,o,r){t.showMenuWithinBounds(n,e,o,r)},hide:function(t,n){t.hide(n)},isOpen:function(t,n){return t.isOpen(n)},getContent:function(t,n){return t.getContent(n)},setContent:function(t,n,e){t.setContent(n,e)},reposition:function(t,n){t.reposition(n)}}}),eS="layout-inset",oS=function(t){return t.x},rS=function(t,n){return t.x+t.width/2-n.width/2},iS=function(t,n){return t.x+t.width-n.width},uS=function(t){return t.y},aS=function(t,n){return t.y+t.height-n.height},cS=function(t,n){return t.y+t.height/2-n.height/2},sS=function(t,n,e){return pf(iS(t,n),aS(t,n),e.insetSouthwest(),kf(),"southwest",Mf(t,{right:0,bottom:3}),eS)},fS=function(t,n,e){return pf(oS(t),aS(t,n),e.insetSoutheast(),Sf(),"southeast",Mf(t,{left:1,bottom:3}),eS)},lS=function(t,n,e){return pf(iS(t,n),uS(t),e.insetNorthwest(),wf(),"northwest",Mf(t,{right:0,top:2}),eS)},dS=function(t,n,e){return pf(oS(t),uS(t),e.insetNortheast(),xf(),"northeast",Mf(t,{left:1,top:2}),eS)},mS=function(t,n,e){return pf(rS(t,n),uS(t),e.insetNorth(),Cf(),"north",Mf(t,{top:2}),eS)},gS=function(t,n,e){return pf(rS(t,n),aS(t,n),e.insetSouth(),Of(),"south",Mf(t,{bottom:3}),eS)},pS=function(t,n,e){return pf(iS(t,n),cS(t,n),e.insetEast(),Tf(),"east",Mf(t,{right:0}),eS)},vS=function(t,n,e){return pf(oS(t),cS(t,n),e.insetWest(),_f(),"west",Mf(t,{left:1}),eS)},hS=function(t){switch(t){case"north":return mS;case"northeast":return dS;case"northwest":return lS;case"south":return gS;case"southeast":return fS;case"southwest":return sS;case"east":return pS;case"west":return vS}},bS=function(t,n,e,o,r){var i=Xl(o).map(hS).getOr(mS);return i(t,n,e,o,r)},yS=function(t){switch(t){case"north":return gS;case"northeast":return fS;case"northwest":return sS;case"south":return mS;case"southeast":return dS;case"southwest":return lS;case"east":return vS;case"west":return pS}},xS=function(t,n,e,o,r){var i=Xl(o).map(yS).getOr(mS);return i(t,n,e,o,r)},wS=tinymce.util.Tools.resolve("tinymce.util.Delay"),SS=function(t){var n=hw(t.action),e=t.dom.tag,o=function(n){return _t(t.dom,"attributes").bind((function(t){return _t(t,n)}))},r=function(){if("button"===e){var t=o("type").getOr("button"),n=o("role").map((function(t){return{role:t}})).getOr({});return D({type:t},n)}var r=o("role").getOr("button");return{role:r}};return{uid:t.uid,dom:t.dom,components:t.components,events:n,behaviours:rv.augment(t.buttonBehaviours,[Jx.config({}),Dx.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:r()},eventOrder:t.eventOrder}},kS=dh({name:"Button",factory:SS,configFields:[qi("uid",void 0),Di("dom"),qi("components",[]),rv.field("buttonBehaviours",[Jx,Dx]),Ni("action"),Ni("role"),qi("eventOrder",{})]}),CS=function(t){var n=sh(t)&&Et(t,"uid")?t.uid:dc("memento"),e=function(t){return t.getSystem().getByUid(n).getOrDie()},o=function(t){return t.getSystem().getByUid(n).toOptional()},r=function(){return D(D({},t),{uid:n})};return{get:e,getOpt:o,asSpec:r}},OS=tinymce.util.Tools.resolve("tinymce.util.I18n"),_S={indent:!0,outdent:!0,"table-insert-column-after":!0,"table-insert-column-before":!0,"paste-column-after":!0,"paste-column-before":!0,"unordered-list":!0,"list-bull-circle":!0,"list-bull-default":!0,"list-bull-square":!0},TS="temporary-placeholder",ES=function(t){return function(){return _t(t,TS).getOr("!not found!")}},DS=function(t,n){var e=t.toLowerCase();if(OS.isRtl()){var o=Lt(e,"-rtl");return Tt(n,o)?o:e}return e},BS=function(t,n){return _t(n,DS(t,n))},MS=function(t,n){var e=n();return BS(t,e).getOrThunk(ES(e))},AS=function(t,n,e){var o=n();return BS(t,o).or(e).getOrThunk(ES(o))},FS=function(t){return!!OS.isRtl()&&Tt(_S,t)},IS=function(){return Lx("add-focusable",[Wa((function(t){Ps(t.element,"svg").each((function(t){return Ne(t,"focusable","false")}))}))])},RS=function(t,n,e,o){var r,i,u=FS(n)?["tox-icon--flip"]:[],a=_t(e,DS(n,e)).or(o).getOrThunk(ES(e));return{dom:{tag:t.tag,attributes:null!==(r=t.attributes)&&void 0!==r?r:{},classes:t.classes.concat(u),innerHtml:a},behaviours:ml(M(M([],null!==(i=t.behaviours)&&void 0!==i?i:[],!0),[IS()],!1))}},VS=function(t,n,e,o){return void 0===o&&(o=V.none()),RS(n,t,e(),o)},PS=function(t,n,e){var o=e(),r=tt(t,(function(t){return Tt(o,DS(t,o))}));return RS(n,r.getOr(TS),o,V.none())},HS={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},zS=function(t){var n=CS({dom:{tag:"p",innerHtml:t.translationProvider(t.text)},behaviours:ml([zx.config({})])}),e=function(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}},o=function(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}},r=CS({dom:{tag:"div",classes:t.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(0)]},o(0)],behaviours:ml([zx.config({})])}),i=function(t,n){t.getSystem().isConnected()&&r.getOpt(t).each((function(t){zx.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(n)]},o(n)])}))},u=function(t,e){if(t.getSystem().isConnected()){var o=n.get(t);zx.set(o,[ks(e)])}},a={updateProgress:i,updateText:u},c=et([t.icon.toArray(),t.level.toArray(),t.level.bind((function(t){return V.from(HS[t])})).toArray()]),s=CS(kS.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[VS("close",{tag:"div",classes:["tox-icon"],attributes:{"aria-label":t.translationProvider("Close")}},t.iconProvider)],action:function(n){t.onAction(n)}})),f=PS(c,{tag:"div",classes:["tox-notification__icon"]},t.iconProvider),l={dom:{tag:"div",classes:["tox-notification__body"]},components:[n.asSpec()],behaviours:ml([zx.config({})])},d=[f,l];return{uid:t.uid,dom:{tag:"div",attributes:{role:"alert"},classes:t.level.map((function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]})).getOr(["tox-notification","tox-notification--in"])},behaviours:ml([Jx.config({}),Lx("notification-events",[Aa(Hu(),(function(t){s.getOpt(t).each(Jx.focus)}))])]),components:d.concat(t.progress?[r.asSpec()]:[]).concat(t.closeButton?[s.asSpec()]:[]),apis:a}},NS=dh({name:"Notification",factory:zS,configFields:[Ni("level"),Di("progress"),Di("icon"),Di("onAction"),Di("text"),Di("iconProvider"),Di("translationProvider"),Zi("closeButton",!0)],apis:{updateProgress:function(t,n,e){t.updateProgress(n,e)},updateText:function(t,n,e){t.updateText(n,e)}}});function LS(t,n,e){var o=n.backstage.shared,r=function(t){switch(t){case"bc-bc":return gS;case"tc-tc":return mS;case"tc-bc":return Xf;case"bc-tc":default:return Yf}},i=function(t){t.length>0&&Y(t,(function(n,e){0===e?n.moveRel(null,"banner"):n.moveRel(t[e-1].getEl(),"bc-tc")}))},u=function(n,i){var u=!n.closeButton&&n.timeout&&(n.timeout>0||n.timeout<0),a=function(){i(),nS.hide(s)},c=Ts(NS.sketch({text:n.text,level:W(["success","error","warning","warn","info"],n.type)?n.type:void 0,progress:!0===n.progressBar,icon:V.from(n.icon),closeButton:!u,onAction:a,iconProvider:o.providers.icons,translationProvider:o.providers.translate})),s=Ts(nS.sketch(D({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:o.getSink,fireDismissalEventInstead:{}},o.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));e.add(s),n.timeout>0&&wS.setTimeout((function(){a()}),n.timeout);var f=function(){var n=Qo(nn.fromDom(t.getContentAreaContainer())),e=tr(),o=Df(e.x,n.x,n.right),r=Df(e.y,n.y,n.bottom),i=Math.max(n.right,e.right),u=Math.max(n.bottom,e.bottom);return V.some($o(o,r,i-o,u-r))};return{close:a,moveTo:function(t,n){nS.showAt(s,Es(c),{anchor:{type:"makeshift",x:t,y:n}})},moveRel:function(t,n){var e=Es(c),i={maxHeightFunction:Td()};if("banner"!==n&&d(t)){var u=r(n),a={type:"node",root:Pe(),node:V.some(nn.fromDom(t)),overrides:i,layouts:{onRtl:function(){return[u]},onLtr:function(){return[u]}}};nS.showWithinBounds(s,e,{anchor:a},f)}else{var l=D(D({},o.anchors.banner()),{overrides:i});nS.showWithinBounds(s,e,{anchor:l},f)}},text:function(t){NS.updateText(c,t)},settings:n,getEl:function(){return c.element.dom},progressBar:{value:function(t){NS.updateProgress(c,t)}}}},a=function(t){t.close()},c=function(t){return t.settings};return{open:u,close:a,reposition:i,getArgs:c}}var WS,US=function(t,n){var e=null,o=function(){c(e)||(clearTimeout(e),e=null)},r=function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];c(e)&&(e=setTimeout((function(){e=null,t.apply(null,o)}),n))};return{cancel:o,throttle:r}},jS=function(t,n){var e=null,o=function(){c(e)||(clearTimeout(e),e=null)},r=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];o(),e=setTimeout((function(){e=null,t.apply(null,r)}),n)};return{cancel:o,throttle:r}},GS=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),XS=function(t,n){return t.isBlock(n)||W(["BR","IMG","HR","INPUT"],n.nodeName)||"false"===t.getContentEditable(n)},YS=function(t,n,e,o,r){var i=GS(t,(function(n){return XS(t,n)}));return V.from(i.backwards(n,e,o,r))},qS="[data-mce-autocompleter]",KS=function(t,n){return JS(nn.fromDom(t.selection.getNode())).getOrThunk((function(){var e=nn.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',t.getDoc());return Mo(e,nn.fromDom(n.extractContents())),n.insertNode(e.dom),he(e).each((function(t){return t.dom.normalize()})),Ym(e).map((function(n){t.selection.setCursorLocation(n.dom,Um(n))})),e}))},JS=function(t){return zs(t,qS)},$S=function(t){return t.collapsed&&3===t.startContainer.nodeType},QS=function(t){return t.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},ZS=function(t){return""!==t&&-1!=="  \f\n\r\t\v".indexOf(t)},tk=function(t,n){return t.substring(n.length)},nk=function(t,n,e){var o;for(o=n-1;o>=0;o--){var r=t.charAt(o);if(ZS(r))return V.none();if(r===e)break}return V.some(o)},ek=function(t,n,e,o){if(void 0===o&&(o=0),!$S(n))return V.none();var r=function(t,n,o){return nk(o,n,e).getOr(n)},i=t.getParent(n.startContainer,t.isBlock)||t.getRoot();return YS(t,n.startContainer,n.startOffset,r,i).bind((function(t){var r=n.cloneRange();if(r.setStart(t.container,t.offset),r.setEnd(n.endContainer,n.endOffset),r.collapsed)return V.none();var i=QS(r),u=i.lastIndexOf(e);return 0!==u||tk(i,e).length<o?V.none():V.some({text:tk(i,e),range:r,triggerChar:e})}))},ok=function(t,n,e,o){return void 0===o&&(o=0),JS(nn.fromDom(n.startContainer)).fold((function(){return ek(t,n,e,o)}),(function(n){var o=t.createRng();o.selectNode(n.dom);var r=QS(o);return V.some({range:o,text:tk(r,e),triggerChar:e})}))},rk=function(t,n){n.on("keypress compositionend",t.onKeypress.throttle),n.on("remove",t.onKeypress.cancel);var e=function(t,n){ka(t,Nu(),{raw:n})};n.on("keydown",(function(n){var o=function(){return t.getView().bind(ob.getHighlighted)};8===n.which&&t.onKeypress.throttle(n),t.isActive()&&(27===n.which&&t.cancelIfNecessary(),t.isMenuOpen()?13===n.which?(o().each(Ca),n.preventDefault()):40===n.which?(o().fold((function(){t.getView().each(ob.highlightFirst)}),(function(t){e(t,n)})),n.preventDefault(),n.stopImmediatePropagation()):37!==n.which&&38!==n.which&&39!==n.which||o().each((function(t){e(t,n),n.preventDefault(),n.stopImmediatePropagation()})):13!==n.which&&38!==n.which&&40!==n.which||t.cancelIfNecessary())})),n.on("NodeChange",(function(n){t.isActive()&&!t.isProcessingAction()&&JS(nn.fromDom(n.element)).isNone()&&t.cancelIfNecessary()}))},ik={setup:rk},uk=tinymce.util.Tools.resolve("tinymce.util.Promise"),ak=function(t,n){return{container:t,offset:n}},ck=function(t){return t.nodeType===an},sk=function(t){return t.nodeType===un},fk=function(t){if(ck(t))return ak(t,t.data.length);var n=t.childNodes;return n.length>0?fk(n[n.length-1]):ak(t,n.length)},lk=function(t,n){var e=t.childNodes;return e.length>0&&n<e.length?lk(e[n],0):e.length>0&&sk(t)&&e.length===n?fk(e[e.length-1]):ak(t,n)},dk=function(t,n){return YS(t,n.container,n.offset,(function(t,n){return 0===n?-1:n}),t.getRoot()).filter((function(t){var n=t.container.data.charAt(t.offset-1);return!ZS(n)})).isSome()},mk=function(t){return function(n){var e=lk(n.startContainer,n.startOffset);return!dk(t,e)}},gk=function(t,n,e){return gt(e.triggerChars,(function(e){return ok(t,n,e)}))},pk=function(t,n){var e=n(),o=t.selection.getRng();return gk(t.dom,o,e).bind((function(e){return vk(t,n,e)}))},vk=function(t,n,e,o){void 0===o&&(o={});var r=n(),i=t.selection.getRng(),u=i.startContainer.nodeValue,a=J(r.lookupByChar(e.triggerChar),(function(n){return e.text.length>=n.minChars&&n.matches.getOrThunk((function(){return mk(t.dom)}))(e.range,u,e.text)}));if(0===a.length)return V.none();var c=uk.all(X(a,(function(t){var n=t.fetch(e.text,t.maxResults,o);return n.then((function(n){return{matchText:e.text,items:n,columns:t.columns,onAction:t.onAction,highlightOn:t.highlightOn}}))})));return V.some({lookupData:c,context:e})},hk=ti([Ai("type"),Ui("text")]),bk=function(t){return xi("separatormenuitem",hk,t)},yk=ti([qi("type","autocompleteitem"),qi("active",!1),qi("disabled",!1),qi("meta",{}),Ai("value"),Ui("text"),Ui("icon")]),xk=ti([Ai("type"),Ai("ch"),Ji("minChars",1),qi("columns",1),Ji("maxResults",10),ji("matches"),Ri("fetch"),Ri("onAction"),eu("highlightOn",[],si)]),wk=function(t){return xi("Autocompleter.Separator",hk,t)},Sk=function(t){return xi("Autocompleter.Item",yk,t)},kk=function(t){return xi("Autocompleter",xk,t)},Ck=[Zi("disabled",!1),Ui("tooltip"),Ui("icon"),Ui("text"),tu("onSetup",(function(){return v}))],Ok=ti([Ai("type"),Ri("onAction")].concat(Ck)),_k=function(t){return xi("toolbarbutton",Ok,t)},Tk=[Zi("active",!1)].concat(Ck),Ek=ti(Tk.concat([Ai("type"),Ri("onAction")])),Dk=function(t){return xi("ToggleButton",Ek,t)},Bk=[tu("predicate",_),Qi("scope","node",["node","editor"]),Qi("position","selection",["node","selection","line"])],Mk=Ck.concat([qi("type","contextformbutton"),qi("primary",!1),Ri("onAction"),Ti("original",w)]),Ak=Tk.concat([qi("type","contextformbutton"),qi("primary",!1),Ri("onAction"),Ti("original",w)]),Fk=Ck.concat([qi("type","contextformbutton")]),Ik=Tk.concat([qi("type","contextformtogglebutton")]),Rk=Ci("type",{contextformbutton:Mk,contextformtogglebutton:Ak}),Vk=ti([qi("type","contextform"),tu("initValue",x("")),Ui("label"),zi("commands",Rk),Li("launch",Ci("type",{contextformbutton:Fk,contextformtogglebutton:Ik}))].concat(Bk)),Pk=function(t){return xi("ContextForm",Vk,t)},Hk=ti([qi("type","contexttoolbar"),Ai("items")].concat(Bk)),zk=function(t){return xi("ContextToolbar",Hk,t)},Nk=function(t){var n={};return Y(t,(function(t){n[t]={}})),pt(n)},Lk=function(t){var n=t.ui.registry.getAll().popups,e=bt(n,(function(t){return kk(t).fold((function(t){throw new Error(ki(t))}),w)})),o=Nk(kt(e,(function(t){return t.ch}))),r=Ot(e),i=function(t){return J(r,(function(n){return n.ch===t}))};return{dataset:e,triggerChars:o,lookupByChar:i}};(function(t){t[t["CLOSE_ON_EXECUTE"]=0]="CLOSE_ON_EXECUTE",t[t["BUBBLE_TO_SANDBOX"]=1]="BUBBLE_TO_SANDBOX"})(WS||(WS={}));var Wk,Uk=WS,jk="tox-menu-nav__js",Gk="tox-collection__item",Xk="tox-swatch",Yk={normal:jk,color:Xk},qk="tox-collection__item--enabled",Kk="tox-collection__group-heading",Jk="tox-collection__item-icon",$k="tox-collection__item-label",Qk="tox-collection__item-accessory",Zk="tox-collection__item-caret",tC="tox-collection__item-checkmark",nC="tox-collection__item--active",eC="tox-collection__item-container",oC="tox-collection__item-container--column",rC="tox-collection__item-container--row",iC="tox-collection__item-container--align-right",uC="tox-collection__item-container--align-left",aC="tox-collection__item-container--valign-top",cC="tox-collection__item-container--valign-middle",sC="tox-collection__item-container--valign-bottom",fC=function(t){return _t(Yk,t).getOr(jk)},lC=function(t){return"color"===t?"tox-swatches":"tox-menu"},dC=function(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:lC(t),tieredMenu:"tox-tiered-menu"}},mC=function(t){var n=dC(t);return{backgroundMenu:n.backgroundMenu,selectedMenu:n.selectedMenu,menu:n.menu,selectedItem:n.selectedItem,item:fC(t)}},gC=function(t,n,e){var o=dC(e);return{tag:"div",classes:et([[o.menu,"tox-menu-"+n+"-column"],t?[o.hasIcons]:[]])}},pC=[Nw.parts.items({})],vC=function(t,n,e){var o=dC(e),r={tag:"div",classes:et([[o.tieredMenu]])};return{dom:r,markers:mC(e)}},hC=function(t,n){return function(e){var o=G(e,n);return X(o,(function(n){return{dom:t,components:n}}))}},bC=function(t){return{dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[Nw.parts.items({preprocess:"auto"!==t?hC({tag:"div",classes:["tox-swatches__row"]},t):w})]}]}},yC=function(t){return{dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[Nw.parts.items({preprocess:hC({tag:"div",classes:["tox-collection__group"]},t)})]}},xC=function(t,n){var e=[],o=[];return Y(t,(function(t,r){n(t,r)?(o.length>0&&e.push(o),o=[],Tt(t.dom,"innerHtml")&&o.push(t)):o.push(t)})),o.length>0&&e.push(o),X(e,(function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}}))},wC=function(t,n,e){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===t?["tox-collection--list"]:["tox-collection--grid"])},components:[Nw.parts.items({preprocess:function(e){return"auto"!==t&&t>1?hC({tag:"div",classes:["tox-collection__group"]},t)(e):xC(e,(function(t,e){return"separator"===n[e].type}))}})]}},SC=function(t,n){return{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[Nw.parts.items({preprocess:function(n){return xC(n,(function(n,e){return"separator"===t[e].type}))}})]}},kC=function(t){return U(t,(function(t){return"icon"in t&&void 0!==t.icon}))},CC=function(t){return console.error(ki(t)),console.log(t),V.none()},OC=function(t,n,e,o,r){var i=SC(e);return{value:t,dom:i.dom,components:i.components,items:e}},_C=function(t,n,e,o,r){if("color"===r){var i=bC(o);return{value:t,dom:i.dom,components:i.components,items:e}}if("normal"===r&&"auto"===o){i=wC(o,e);return{value:t,dom:i.dom,components:i.components,items:e}}if("normal"===r&&1===o){i=wC(1,e);return{value:t,dom:i.dom,components:i.components,items:e}}if("normal"===r){i=wC(o,e);return{value:t,dom:i.dom,components:i.components,items:e}}if("listpreview"===r&&"auto"!==o){i=yC(o);return{value:t,dom:i.dom,components:i.components,items:e}}return{value:t,dom:gC(n,o,r),components:pC,items:e}},TC=[Ai("type"),Ai("src"),Ui("alt"),eu("classes",[],si)],EC=ti(TC),DC=[Ai("type"),Ai("text"),Ui("name"),eu("classes",["tox-collection__item-label"],si)],BC=ti(DC),MC=$r((function(){return pi("type",{cardimage:EC,cardtext:BC,cardcontainer:AC})})),AC=ti([Ai("type"),$i("direction","horizontal"),$i("align","left"),$i("valign","middle"),zi("items",MC)]),FC=[Zi("disabled",!1),Ui("text"),Ui("shortcut"),_i("value","value",Or((function(){return rc("menuitem-value")})),ui()),qi("meta",{})],IC=ti([Ai("type"),Ui("label"),zi("items",MC),tu("onSetup",(function(){return v})),tu("onAction",v)].concat(FC)),RC=function(t){return xi("cardmenuitem",IC,t)},VC=ti([Ai("type"),Zi("active",!1),Ui("icon")].concat(FC)),PC=function(t){return xi("choicemenuitem",VC,t)},HC=[Ai("type"),Ai("fancytype"),tu("onAction",v)],zC=[qi("initData",{})].concat(HC),NC=[ou("initData",{},[Zi("allowCustomColors",!0),Gi("colors",ui())])].concat(HC),LC=Ci("fancytype",{inserttable:zC,colorswatch:NC}),WC=function(t){return xi("fancymenuitem",LC,t)},UC=ti([Ai("type"),tu("onSetup",(function(){return v})),tu("onAction",v),Ui("icon")].concat(FC)),jC=function(t){return xi("menuitem",UC,t)},GC=ti([Ai("type"),Ri("getSubmenuItems"),tu("onSetup",(function(){return v})),Ui("icon")].concat(FC)),XC=function(t){return xi("nestedmenuitem",GC,t)},YC=ti([Ai("type"),Ui("icon"),Zi("active",!1),tu("onSetup",(function(){return v})),Ri("onAction")].concat(FC)),qC=function(t){return xi("togglemenuitem",YC,t)},KC=function(t,n,e){var o=Km(t.element,"."+e);if(o.length>0){var r=nt(o,(function(t){var e=t.dom.getBoundingClientRect().top,r=o[0].dom.getBoundingClientRect().top;return Math.abs(e-r)>n})).getOr(o.length);return V.some({numColumns:r,numRows:Math.ceil(o.length/r)})}return V.none()},JC=function(t,n){return ml([Lx(t,n)])},$C=function(t){return JC(rc("unnamed-events"),t)},QC={namedEvents:JC,unnamedEvents:$C},ZC=rc("tooltip.exclusive"),tO=rc("tooltip.show"),nO=rc("tooltip.hide"),eO=function(t,n,e){t.getSystem().broadcastOn([ZC],{})},oO=function(t,n,e,o){e.getTooltip().each((function(t){t.getSystem().isConnected()&&zx.set(t,o)}))},rO=Object.freeze({__proto__:null,hideAllExclusive:eO,setComponents:oO}),iO=function(t,n){var e=function(e){n.getTooltip().each((function(o){Yg(o),t.onHide(e,o),n.clearTooltip()})),n.clearTimer()},o=function(e){if(!n.isShowing()){eO(e);var o=t.lazySink(e).getOrDie(),r=e.getSystem().build({dom:t.tooltipDom,components:t.tooltipComponents,events:Ea("normal"===t.mode?[Aa(Pu(),(function(t){Sa(e,tO)})),Aa(Ru(),(function(t){Sa(e,nO)}))]:[]),behaviours:ml([zx.config({})])});n.setTooltip(r),jg(o,r),t.onShow(e,r),Hg.position(o,r,{anchor:t.anchor(e)})}};return Ea(et([[Aa(tO,(function(e){n.resetTimer((function(){o(e)}),t.delay)})),Aa(nO,(function(o){n.resetTimer((function(){e(o)}),t.delay)})),Aa(ta(),(function(t,n){var o=n;o.universal||W(o.channels,ZC)&&e(t)})),Ua((function(t){e(t)}))],"normal"===t.mode?[Aa(Hu(),(function(t){Sa(t,tO)})),Aa(Qu(),(function(t){Sa(t,nO)})),Aa(Pu(),(function(t){Sa(t,tO)})),Aa(Ru(),(function(t){Sa(t,nO)}))]:[Aa(xa(),(function(t,n){Sa(t,tO)})),Aa(wa(),(function(t){Sa(t,nO)}))]]))},uO=Object.freeze({__proto__:null,events:iO}),aO=[Di("lazySink"),Di("tooltipDom"),qi("exclusive",!0),qi("tooltipComponents",[]),qi("delay",300),Qi("mode","normal",["normal","follow-highlight"]),qi("anchor",(function(t){return{type:"hotspot",hotspot:t,layouts:{onLtr:x([Yf,Xf,Wf,jf,Uf,Gf]),onRtl:x([Yf,Xf,Wf,jf,Uf,Gf])}}})),cf("onHide"),cf("onShow")],cO=function(){var t=rd(),n=rd(),e=function(){t.on(clearTimeout)},o=function(n,o){e(),t.set(setTimeout(n,o))},r=x("not-implemented");return Oc({getTooltip:n.get,isShowing:n.isSet,setTooltip:n.set,clearTooltip:n.clear,clearTimer:e,resetTimer:o,readState:r})},sO=Object.freeze({__proto__:null,init:cO}),fO=pl({fields:aO,name:"tooltipping",active:uO,state:sO,apis:rO}),lO=function(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},dO=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),mO=tinymce.util.Tools.resolve("tinymce.EditorManager"),gO=function(t){var n=t.getParam("skin"),e=t.getParam("skin_url");if(!1!==n){var o=n||"oxide";e=e?t.documentBaseURI.toAbsolute(e):mO.baseURL+"/skins/ui/"+o}return e},pO=function(t){return t.getParam("readonly",!1,"boolean")},vO=function(t){return!1===t.getParam("skin")},hO=function(t){return t.getParam("height",Math.max(t.getElement().offsetHeight,200))},bO=function(t){return t.getParam("width",dO.DOM.getStyle(t.getElement(),"width"))},yO=function(t){return V.from(t.getParam("min_width")).filter(g)},xO=function(t){return V.from(t.getParam("min_height")).filter(g)},wO=function(t){return V.from(t.getParam("max_width")).filter(g)},SO=function(t){return V.from(t.getParam("max_height")).filter(g)},kO=function(t){return V.from(t.getParam("style_formats")).filter(a)},CO=function(t){return t.getParam("style_formats_merge",!1,"boolean")},OO=function(t){return t.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" ")},_O=function(t){return t.getParam("content_langs",void 0,"array")},TO=function(t){return t.getParam("removed_menuitems","")},EO=function(t){return!1!==t.getParam("menubar",!0,"boolean")},DO=function(t){var n=t.getParam("toolbar",!0),e=!0===n,o=i(n),r=a(n)&&n.length>0;return!MO(t)&&(r||o||e)},BO=function(t){var n=j(9,(function(n){return t.getParam("toolbar"+(n+1),!1,"string")})),e=J(n,(function(t){return"string"===typeof t}));return e.length>0?V.some(e):V.none()},MO=function(t){return BO(t).fold((function(){var n=t.getParam("toolbar",[],"string[]");return n.length>0}),T)};(function(t){t["default"]="wrap",t["floating"]="floating",t["sliding"]="sliding",t["scrolling"]="scrolling"})(Wk||(Wk={}));var AO,FO=function(t){return t.getParam("toolbar_mode","","string")};(function(t){t["auto"]="auto",t["top"]="top",t["bottom"]="bottom"})(AO||(AO={}));var IO,RO=function(t){return t.getParam("toolbar_groups",{},"object")},VO=function(t){return t.getParam("toolbar_location",AO.auto,"string")},PO=function(t){return VO(t)===AO.bottom},HO=function(t){return t.getParam("fixed_toolbar_container","","string")},zO=function(t){return t.getParam("fixed_toolbar_container_target")},NO=function(t){return t.getParam("toolbar_persist",!1,"boolean")},LO=function(t){if(!t.inline)return V.none();var n=HO(t);if(n.length>0)return Hs(Pe(),n);var e=zO(t);return d(e)?V.some(nn.fromDom(e)):V.none()},WO=function(t){return t.inline&&LO(t).isSome()},UO=function(t){var n=LO(t);return n.getOrThunk((function(){return Be(De(nn.fromDom(t.getElement())))}))},jO=function(t){return t.inline&&!EO(t)&&!DO(t)&&!MO(t)},GO=function(t){var n=t.getParam("toolbar_sticky",!1,"boolean");return(n||t.inline)&&!WO(t)&&!jO(t)},XO=function(t){return t.getParam("toolbar_sticky_offset",0,"number")},YO=function(t){return t.getParam("draggable_modal",!1,"boolean")},qO=function(t){var n=t.getParam("menu");return n?bt(n,(function(t){return D(D({},t),{items:t.items})})):{}},KO=function(t){return t.getParam("menubar")},JO=function(t){return t.getParam("toolbar",!0)},$O=function(t){return t.getParam("file_picker_callback")},QO=function(t){return t.getParam("file_picker_types")},ZO=function(t){return t.getParam("file_browser_callback_types")},t_=function(t){return!1===t.getParam("typeahead_urls")},n_=function(t){return t.getParam("anchor_top","#top")},e_=function(t){return t.getParam("anchor_bottom","#bottom")},o_=function(t){var n=t.getParam("file_picker_validator_handler",void 0,"function");return void 0===n?t.getParam("filepicker_validator_handler",void 0,"function"):n},r_="silver.readonly",i_=ti([Ii("readonly")]),u_=function(t,n){var e=t.outerContainer,o=e.element;n&&(t.mothership.broadcastOn([yp()],{target:o}),t.uiMothership.broadcastOn([yp()],{target:o})),t.mothership.broadcastOn([r_],{readonly:n}),t.uiMothership.broadcastOn([r_],{readonly:n})},a_=function(t,n){t.on("init",(function(){t.mode.isReadOnly()&&u_(n,!0)})),t.on("SwitchMode",(function(){return u_(n,t.mode.isReadOnly())})),pO(t)&&t.setMode("readonly")},c_=function(){var t;return yl.config({channels:(t={},t[r_]={schema:i_,onReceive:function(t,n){Ph.set(t,n.readonly)}},t)})},s_=function(t){return Ph.config({disabled:t,disableClass:"tox-collection__item--state-disabled"})},f_=function(t){return Ph.config({disabled:t})},l_=function(t){return Ph.config({disabled:t,disableClass:"tox-tbtn--disabled"})},d_=function(t){return Ph.config({disabled:t,disableClass:"tox-tbtn--disabled",useNative:!1})},m_={item:s_,button:f_,splitButton:l_,toolbarButton:d_},g_=function(t,n){var e=t.getApi(n);return function(t){t(e)}},p_=function(t,n){return Wa((function(e){var o=g_(t,e);o((function(e){var o=t.onSetup(e);m(o)&&n.set(o)}))}))},v_=function(t,n){return Ua((function(e){return g_(t,e)(n.get())}))},h_=function(t,n){return Ga((function(e,o){g_(t,e)(t.onAction),t.triggersSubmenu||n!==Uk.CLOSE_ON_EXECUTE||(Sa(e,ia()),o.stop())}))},b_=(IO={},IO[na()]=["disabling","alloy.base.behaviour","toggling","item-events"],IO),y_=Mt,x_=function(t,n,e,o){var r=ru(v);return{type:"item",dom:n.dom,components:y_(n.optComponents),data:t.data,eventOrder:b_,hasSubmenu:t.triggersSubmenu,itemBehaviours:ml([Lx("item-events",[h_(t,e),p_(t,r),v_(t,r)]),m_.item((function(){return t.disabled||o.isDisabled()})),c_(),zx.config({})].concat(t.itemBehaviours))}},w_=function(t){return{value:t.value,meta:D({text:t.text.getOr("")},t.meta)}},S_=tinymce.util.Tools.resolve("tinymce.Env"),k_=function(t){var n={alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"},e={meta:"Ctrl",access:"Shift+Alt"},o=S_.mac?n:e,r=t.split("+"),i=X(r,(function(t){var n=t.toLowerCase().trim();return Tt(o,n)?o[n]:t}));return S_.mac?i.join(""):i.join("+")},C_=function(t,n,e){return void 0===e&&(e=[Jk]),VS(t,{tag:"div",classes:e},n)},O_=function(t){return{dom:{tag:"div",classes:[$k]},components:[ks(OS.translate(t))]}},__=function(t,n){return{dom:{tag:"div",classes:n,innerHtml:t}}},T_=function(t,n){return{dom:{tag:"div",classes:[$k]},components:[{dom:{tag:t.tag,styles:t.styles},components:[ks(OS.translate(n))]}]}},E_=function(t){return{dom:{tag:"div",classes:[Qk],innerHtml:k_(t)}}},D_=function(t){return C_("checkmark",t,[tC])},B_=function(t){return C_("chevron-right",t,[Zk])},M_=function(t){return C_("chevron-down",t,[Zk])},A_=function(t,n){var e="vertical"===t.direction?oC:rC,o="left"===t.align?uC:iC,r=function(){switch(t.valign){case"top":return aC;case"middle":return cC;case"bottom":return sC}};return{dom:{tag:"div",classes:[eC,e,o,r()]},components:n}},F_=function(t,n,e){return{dom:{tag:"img",classes:n,attributes:{src:t,alt:e.getOr("")}}}},I_=function(t,n,e){var o="custom",r="remove",i=t.ariaLabel,u=t.value,a=t.iconContent.map((function(t){return AS(t,n.icons,e)})),c=function(){var t=Xk,e=a.getOr(""),c=i.map((function(t){return{title:n.translate(t)}})).getOr({}),s={tag:"div",attributes:c,classes:[t]};return D(D({},s),u===o?{tag:"button",classes:M(M([],s.classes,!0),["tox-swatches__picker-btn"],!1),innerHtml:e}:u===r?{classes:M(M([],s.classes,!0),["tox-swatch--remove"],!1),innerHtml:e}:{attributes:D(D({},s.attributes),{"data-mce-color":u}),styles:{"background-color":u}})};return{dom:c(),optComponents:[]}},R_=function(t){var n=t.map((function(t){return{attributes:{title:OS.translate(t)}}})).getOr({});return D({tag:"div",classes:[jk,Gk]},n)},V_=function(t,n,e,o){var r={tag:"div",classes:[Jk]},i=function(t){return VS(t,r,n.icons,o)},u=function(){return V.some({dom:r})},a=e?t.iconContent.map(i).orThunk(u):V.none(),c=t.checkMark,s=V.from(t.meta).fold((function(){return O_}),(function(t){return Tt(t,"style")?k(T_,t.style):O_})),f=t.htmlContent.fold((function(){return t.textContent.map(s)}),(function(t){return V.some(__(t,[$k]))})),l={dom:R_(t.ariaLabel),optComponents:[a,f,t.shortcutContent.map(E_),c,t.caret]};return l},P_=function(t,n,e,o){return void 0===o&&(o=V.none()),"color"===t.presets?I_(t,n,o):V_(t,n,e,o)},H_=function(t,n){return _t(t,"tooltipWorker").map((function(t){return[fO.config({lazySink:n.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(t){return{type:"submenu",item:t,overrides:{maxHeightFunction:Td}}},mode:"follow-highlight",onShow:function(n,e){t((function(t){fO.setComponents(n,[Cs({element:nn.fromDom(t)})])}))}})]})).getOr([])},z_=function(t){return dO.DOM.encode(t)},N_=function(t,n){var e=OS.translate(t),o=z_(e);if(n.length>0){var r=new RegExp(lO(n),"gi");return o.replace(r,(function(t){return'<span class="tox-autocompleter-highlight">'+t+"</span>"}))}return o},L_=function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0);var c=P_({presets:o,textContent:V.none(),htmlContent:e?t.text.map((function(t){return N_(t,n)})):V.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:V.none(),checkMark:V.none(),caret:V.none(),value:t.value},u.providers,a,t.icon);return x_({data:w_(t),disabled:t.disabled,getApi:x({}),onAction:function(n){return r(t.value,t.meta)},onSetup:x(v),triggersSubmenu:!1,itemBehaviours:H_(t.meta,u)},c,i,u.providers)},W_=function(t,n){return X(t,(function(t){switch(t.type){case"cardcontainer":return A_(t,W_(t.items,n));case"cardimage":return F_(t.src,t.classes,t.alt);case"cardtext":var e=t.name.exists((function(t){return W(n.cardText.highlightOn,t)})),o=e?V.from(n.cardText.matchText).getOr(""):"";return __(N_(t.text,o),t.classes)}}))},U_=function(t,n,e,o){var r=function(t){return{isDisabled:function(){return Ph.isDisabled(t)},setDisabled:function(n){Ph.set(t,n),Y(Km(t.element,"*"),(function(e){t.getSystem().getByDom(e).each((function(t){t.hasConfigured(Ph)&&Ph.set(t,n)}))}))}}},i={dom:R_(t.label),optComponents:[V.some({dom:{tag:"div",classes:[eC,rC]},components:W_(t.items,o)})]};return x_({data:w_(D({text:V.none()},t)),disabled:t.disabled,getApi:r,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:V.from(o.itemBehaviours).getOr([])},i,n,e.providers)},j_=function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0);var c=function(t){return{setActive:function(n){pw.set(t,n)},isActive:function(){return pw.isOn(t)},isDisabled:function(){return Ph.isDisabled(t)},setDisabled:function(n){return Ph.set(t,n)}}},s=P_({presets:e,textContent:n?t.text:V.none(),htmlContent:V.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:n?t.shortcut:V.none(),checkMark:n?V.some(D_(u.icons)):V.none(),caret:V.none(),value:t.value},u,a);return Sr(x_({data:w_(t),disabled:t.disabled,getApi:c,onAction:function(n){return o(t.value)},onSetup:function(t){return t.setActive(r),v},triggersSubmenu:!1,itemBehaviours:[]},s,i,u),{toggling:{toggleClass:qk,toggleOnExecute:!1,selected:t.active}})},G_=Lv(Ew(),Dw()),X_=function(t){return{value:t}},Y_=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,q_=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,K_=function(t){return Y_.test(t)||q_.test(t)},J_=function(t){return Nt(t,"#").toUpperCase()},$_=function(t){return K_(t)?V.some({value:J_(t)}):V.none()},Q_=function(t){var n=t.value.replace(Y_,(function(t,n,e,o){return n+n+e+e+o+o}));return{value:n}},Z_=function(t){var n=Q_(t),e=q_.exec(n.value);return null===e?["FFFFFF","FF","FF","FF"]:e},tT=function(t){var n=t.toString(16);return(1===n.length?"0"+n:n).toUpperCase()},nT=function(t){var n=tT(t.red)+tT(t.green)+tT(t.blue);return X_(n)},eT=Math.min,oT=Math.max,rT=Math.round,iT=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,uT=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,aT=function(t,n,e,o){return{red:t,green:n,blue:e,alpha:o}},cT=function(t){var n=parseInt(t,10);return n.toString()===t&&n>=0&&n<=255},sT=function(t){var n,e,o,r=(t.hue||0)%360,i=t.saturation/100,u=t.value/100;if(i=oT(0,eT(i,1)),u=oT(0,eT(u,1)),0===i)return n=e=o=rT(255*u),aT(n,e,o,1);var a=r/60,c=u*i,s=c*(1-Math.abs(a%2-1)),f=u-c;switch(Math.floor(a)){case 0:n=c,e=s,o=0;break;case 1:n=s,e=c,o=0;break;case 2:n=0,e=c,o=s;break;case 3:n=0,e=s,o=c;break;case 4:n=s,e=0,o=c;break;case 5:n=c,e=0,o=s;break;default:n=e=o=0}return n=rT(255*(n+f)),e=rT(255*(e+f)),o=rT(255*(o+f)),aT(n,e,o,1)},fT=function(t){var n=Z_(t),e=parseInt(n[1],16),o=parseInt(n[2],16),r=parseInt(n[3],16);return aT(e,o,r,1)},lT=function(t,n,e,o){var r=parseInt(t,10),i=parseInt(n,10),u=parseInt(e,10),a=parseFloat(o);return aT(r,i,u,a)},dT=function(t){if("transparent"===t)return V.some(aT(0,0,0,0));var n=iT.exec(t);if(null!==n)return V.some(lT(n[1],n[2],n[3],"1"));var e=uT.exec(t);return null!==e?V.some(lT(e[1],e[2],e[3],e[4])):V.none()},mT=function(t){return"rgba("+t.red+","+t.green+","+t.blue+","+t.alpha+")"},gT=aT(255,0,0,1),pT=function(t){return t.fire("SkinLoaded")},vT=function(t,n){return t.fire("SkinLoadError",n)},hT=function(t){return t.fire("ResizeEditor")},bT=function(t,n){return t.fire("ResizeContent",n)},yT=function(t,n){return t.fire("ScrollContent",n)},xT=function(t,n){return t.fire("TextColorChange",n)},wT=function(t,n,e){return{hue:t,saturation:n,value:e}},ST=function(t){var n=0,e=0,o=0,r=t.red/255,i=t.green/255,u=t.blue/255,a=Math.min(r,Math.min(i,u)),c=Math.max(r,Math.max(i,u));if(a===c)return o=a,wT(0,0,100*o);var s=r===a?i-u:u===a?r-i:u-r;return n=r===a?3:u===a?1:5,n=60*(n-s/(c-a)),e=(c-a)/c,o=c,wT(Math.round(n),Math.round(100*e),Math.round(100*o))},kT=function(t){return ST(fT(t))},CT=function(t){return nT(sT(t))},OT=function(t){return $_(t).orThunk((function(){return dT(t).map(nT)})).getOrThunk((function(){var n=document.createElement("canvas");n.height=1,n.width=1;var e=n.getContext("2d");e.clearRect(0,0,n.width,n.height),e.fillStyle="#FFFFFF",e.fillStyle=t,e.fillRect(0,0,1,1);var o=e.getImageData(0,0,1,1).data,r=o[0],i=o[1],u=o[2],a=o[3];return nT(aT(r,i,u,a))}))},_T=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),TT="tinymce-custom-colors";function ET(t){void 0===t&&(t=10);var n=_T.getItem(TT),e=i(n)?JSON.parse(n):[],o=function(n){var e=t-n.length;return e<0?n.slice(0,t):n},r=o(e),u=function(n){L(r,n).each(a),r.unshift(n),r.length>t&&r.pop(),_T.setItem(TT,JSON.stringify(r))},a=function(t){r.splice(t,1)},c=function(){return r.slice(0)};return{add:u,state:c}}var DT,BT="choiceitem",MT=[{type:BT,text:"Light Green",value:"#BFEDD2"},{type:BT,text:"Light Yellow",value:"#FBEEB8"},{type:BT,text:"Light Red",value:"#F8CAC6"},{type:BT,text:"Light Purple",value:"#ECCAFA"},{type:BT,text:"Light Blue",value:"#C2E0F4"},{type:BT,text:"Green",value:"#2DC26B"},{type:BT,text:"Yellow",value:"#F1C40F"},{type:BT,text:"Red",value:"#E03E2D"},{type:BT,text:"Purple",value:"#B96AD9"},{type:BT,text:"Blue",value:"#3598DB"},{type:BT,text:"Dark Turquoise",value:"#169179"},{type:BT,text:"Orange",value:"#E67E23"},{type:BT,text:"Dark Red",value:"#BA372A"},{type:BT,text:"Dark Purple",value:"#843FA1"},{type:BT,text:"Dark Blue",value:"#236FA1"},{type:BT,text:"Light Gray",value:"#ECF0F1"},{type:BT,text:"Medium Gray",value:"#CED4D9"},{type:BT,text:"Gray",value:"#95A5A6"},{type:BT,text:"Dark Gray",value:"#7E8C8D"},{type:BT,text:"Navy Blue",value:"#34495E"},{type:BT,text:"Black",value:"#000000"},{type:BT,text:"White",value:"#ffffff"}],AT=ET(10),FT=function(t){for(var n=[],e=0;e<t.length;e+=2)n.push({text:t[e+1],value:"#"+OT(t[e]).value,type:"choiceitem"});return n},IT=function(t,n){return t.getParam("color_cols",n,"number")},RT=function(t){return!1!==t.getParam("custom_colors")},VT=function(t){return t.getParam("color_map")},PT=function(t){var n=VT(t);return void 0!==n?FT(n):MT},HT=function(){return X(AT.state(),(function(t){return{type:BT,text:t,value:t}}))},zT=function(t){AT.add(t)},NT="#000000",LT=function(t,n){var e;return t.dom.getParents(t.selection.getStart(),(function(t){var o;(o=t.style["forecolor"===n?"color":"background-color"])&&(e=e||o)})),V.from(e)},WT=function(t,n,e){t.undoManager.transact((function(){t.focus(),t.formatter.apply(n,{value:e}),t.nodeChanged()}))},UT=function(t,n){t.undoManager.transact((function(){t.focus(),t.formatter.remove(n,{value:null},null,!0),t.nodeChanged()}))},jT=function(t){t.addCommand("mceApplyTextcolor",(function(n,e){WT(t,n,e)})),t.addCommand("mceRemoveTextcolor",(function(n){UT(t,n)}))},GT=function(t){return Math.max(5,Math.ceil(Math.sqrt(t)))},XT=function(t){var n=PT(t),e=GT(n.length);return IT(t,e)},YT=function(t){var n="choiceitem",e={type:n,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},o={type:n,text:"Custom color",icon:"color-picker",value:"custom"};return t?[e,o]:[e]},qT=function(t,n,e,o){if("custom"===e){var r=tE(t);r((function(e){e.each((function(e){zT(e),t.execCommand("mceApplyTextcolor",n,e),o(e)}))}),NT)}else"remove"===e?(o(""),t.execCommand("mceRemoveTextcolor",n)):(o(e),t.execCommand("mceApplyTextcolor",n,e))},KT=function(t,n){return t.concat(HT().concat(YT(n)))},JT=function(t,n){return function(e){e(KT(t,n))}},$T=function(t,n,e){var o="forecolor"===n?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color";t.setIconFill(o,e)},QT=function(t,n,e,o,r){t.ui.registry.addSplitButton(n,{tooltip:o,presets:"color",icon:"forecolor"===n?"text-color":"highlight-bg-color",select:function(n){var o=LT(t,e);return o.bind((function(t){return dT(t).map((function(t){var e=nT(t).value;return Wt(n.toLowerCase(),e)}))})).getOr(!1)},columns:XT(t),fetch:JT(PT(t),RT(t)),onAction:function(n){qT(t,e,r.get(),v)},onItemAction:function(o,i){qT(t,e,i,(function(e){r.set(e),xT(t,{name:n,color:e})}))},onSetup:function(e){$T(e,n,r.get());var o=function(t){t.name===n&&$T(e,t.name,t.color)};return t.on("TextColorChange",o),function(){t.off("TextColorChange",o)}}})},ZT=function(t,n,e,o){t.ui.registry.addNestedMenuItem(n,{text:o,icon:"forecolor"===n?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(n){qT(t,e,n.value,v)}}]}})},tE=function(t){return function(n,e){var o=!1,r=function(e){var r=e.getData(),i=r.colorpicker;o?(n(V.from(i)),e.close()):t.windowManager.alert(t.translate(["Invalid hex color code: {0}",i]))},i=function(t,n){"hex-valid"===n.name&&(o=n.value)},u={colorpicker:e};t.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:u,onAction:i,onSubmit:r,onClose:v,onCancel:function(){n(V.none())}})}},nE=function(t){jT(t);var n=ru(NT),e=ru(NT);QT(t,"forecolor","forecolor","Text color",n),QT(t,"backcolor","hilitecolor","Background color",e),ZT(t,"forecolor","forecolor","Text color"),ZT(t,"backcolor","hilitecolor","Background color")},eE=function(t,n,e,o,r,i,u,a){var c=kC(n),s="color"!==r?"normal":"color",f=oE(n,e,o,s,i,u,a);return _C(t,c,f,o,r)},oE=function(t,n,e,o,r,i,u){return Mt(X(t,(function(a){return"choiceitem"===a.type?PC(a).fold(CC,(function(c){return V.some(j_(c,1===e,o,n,i(a.value),r,u,kC(t)))})):V.none()})))},rE=function(t,n){var e=mC(n);if(1===t)return{mode:"menu",moveOnTab:!0};if("auto"===t)return{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}};var o="color"===n?"tox-swatches__row":"tox-collection__group";return{mode:"matrix",rowSelector:"."+o}},iE=function(t,n){return 1===t?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===t?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===n?".tox-swatches__row":".tox-collection__group",cell:"color"===n?"."+Xk:"."+Gk}}},uE=function(t,n){var e=aE(t,n),o=n.colorinput.getColorCols(),r="color",i=eE(rc("menu-value"),e,(function(n){t.onAction({value:n})}),o,r,Uk.CLOSE_ON_EXECUTE,_,n.shared.providers),u=D(D({},i),{markers:mC(r),movement:rE(o,r)});return{type:"widget",data:{value:rc("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[G_.widget(Nw.sketch(u))]}},aE=function(t,n){var e=t.initData.allowCustomColors&&n.colorinput.hasCustomColors();return t.initData.colors.fold((function(){return KT(n.colorinput.getColors(),e)}),(function(t){return t.concat(YT(e))}))},cE=rc("cell-over"),sE=rc("cell-execute"),fE=function(t,n,e){var o,r=function(e){return ka(e,cE,{row:t,col:n})},i=function(e){return ka(e,sE,{row:t,col:n})},u=function(t,n){n.stop(),i(t)};return Ts({dom:{tag:"div",attributes:(o={role:"button"},o["aria-labelledby"]=e,o)},behaviours:ml([Lx("insert-table-picker-cell",[Aa(Pu(),Jx.focus),Aa(na(),i),Aa(ju(),u),Aa(oa(),u)]),pw.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),Jx.config({onFocus:r})])})},lE=function(t,n,e){for(var o=[],r=0;r<n;r++){for(var i=[],u=0;u<e;u++)i.push(fE(r,u,t));o.push(i)}return o},dE=function(t,n,e,o,r){for(var i=0;i<o;i++)for(var u=0;u<r;u++)pw.set(t[i][u],i<=n&&u<=e)},mE=function(t){return ot(t,(function(t){return X(t,Es)}))},gE=function(t,n){return ks(n+"x"+t)},pE=function(t){var n=10,e=10,o=rc("size-label"),r=lE(o,n,e),i=gE(0,0),u=CS({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:o}},components:[i],behaviours:ml([zx.config({})])});return{type:"widget",data:{value:rc("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[G_.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:mE(r).concat(u.asSpec()),behaviours:ml([Lx("insert-table-picker",[Wa((function(t){zx.set(u.get(t),[i])})),Ha(cE,(function(t,o,i){var a=i.event,c=a.row,s=a.col;dE(r,c,s,n,e),zx.set(u.get(t),[gE(c+1,s+1)])})),Ha(sE,(function(n,e,o){var r=o.event,i=r.row,u=r.col;t.onAction({numRows:i+1,numColumns:u+1}),Sa(n,ia())}))]),Dx.config({initSize:{numRows:n,numColumns:e},mode:"flatgrid",selector:'[role="button"]'})])})]}},vE={inserttable:pE,colorswatch:uE},hE=function(t,n){return _t(vE,t.fancytype).map((function(e){return e(t,n)}))},bE=function(t,n,e,o,r){void 0===o&&(o=!0),void 0===r&&(r=!1);var i=r?M_(e.icons):B_(e.icons),u=function(t){return{isDisabled:function(){return Ph.isDisabled(t)},setDisabled:function(n){return Ph.set(t,n)}}},a=P_({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:V.none(),ariaLabel:t.text,caret:V.some(i),checkMark:V.none(),shortcutContent:t.shortcut},e,o);return x_({data:w_(t),getApi:u,disabled:t.disabled,onAction:v,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},a,n,e)},yE=function(t,n,e,o){void 0===o&&(o=!0);var r=function(t){return{isDisabled:function(){return Ph.isDisabled(t)},setDisabled:function(n){return Ph.set(t,n)}}},i=P_({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:V.none(),ariaLabel:t.text,caret:V.none(),checkMark:V.none(),shortcutContent:t.shortcut},e,o);return x_({data:w_(t),getApi:r,disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},i,n,e)},xE=function(t){var n=t.text.fold((function(){return{}}),(function(t){return{innerHtml:t}}));return{type:"separator",dom:D({tag:"div",classes:[Gk,Kk]},n),components:[]}},wE=function(t,n,e,o){void 0===o&&(o=!0);var r=function(t){return{setActive:function(n){pw.set(t,n)},isActive:function(){return pw.isOn(t)},isDisabled:function(){return Ph.isDisabled(t)},setDisabled:function(n){return Ph.set(t,n)}}},i=P_({iconContent:t.icon,textContent:t.text,htmlContent:V.none(),ariaLabel:t.text,checkMark:V.some(D_(e.icons)),caret:V.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},e,o);return Sr(x_({data:w_(t),disabled:t.disabled,getApi:r,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},i,n,e),{toggling:{toggleClass:qk,toggleOnExecute:!1,selected:t.active}})},SE=L_,kE=xE,CE=yE,OE=bE,_E=wE,TE=hE,EE=U_;(function(t){t[t["ContentFocus"]=0]="ContentFocus",t[t["UiFocus"]=1]="UiFocus"})(DT||(DT={}));var DE=function(t,n,e,o,r){var i=e.shared.providers,u=function(t){return r?D(D({},t),{shortcut:V.none(),icon:t.text.isSome()?V.none():t.icon}):t};switch(t.type){case"menuitem":return jC(t).fold(CC,(function(t){return V.some(CE(u(t),n,i,o))}));case"nestedmenuitem":return XC(t).fold(CC,(function(t){return V.some(OE(u(t),n,i,o,r))}));case"togglemenuitem":return qC(t).fold(CC,(function(t){return V.some(_E(u(t),n,i,o))}));case"separator":return bk(t).fold(CC,(function(t){return V.some(kE(t))}));case"fancymenuitem":return WC(t).fold(CC,(function(t){return TE(u(t),e)}));default:return console.error("Unknown item in general menu",t),V.none()}},BE=function(t,n,e,o,r,i,u){var a=1===o,c=!a||kC(t);return Mt(X(t,(function(t){switch(t.type){case"separator":return wk(t).fold(CC,(function(t){return V.some(kE(t))}));case"cardmenuitem":return RC(t).fold(CC,(function(t){return V.some(EE(D(D({},t),{onAction:function(n){t.onAction(n),e(t.value,t.meta)}}),r,i,{itemBehaviours:H_(t.meta,i),cardText:{matchText:n,highlightOn:u}}))}));case"autocompleteitem":default:return Sk(t).fold(CC,(function(t){return V.some(SE(t,n,a,"normal",e,r,i,c))}))}})))},ME=function(t,n,e,o,r){var i=kC(n),u=Mt(X(n,(function(t){var n=function(t){return r?!Tt(t,"text"):i},u=function(t){return DE(t,e,o,n(t),r)};return"nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?u(D(D({},t),{disabled:!0})):u(t)}))),a=r?OC:_C;return a(t,i,u,1,"normal")},AE=function(t){return Qw.singleData(t.value,t)},FE=function(t,n,e,o){var r=e===DT.ContentFocus?_b():Ob(),i=rE(n,o),u=mC(o);return{dom:t.dom,components:t.components,items:t.items,value:t.value,markers:{selectedItem:u.selectedItem,item:u.item},movement:i,fakeFocus:e===DT.ContentFocus,focusManager:r,menuBehaviours:QC.unnamedEvents("auto"!==n?[]:[Wa((function(t,n){KC(t,4,u.item).each((function(n){var e=n.numColumns,o=n.numRows;Dx.setGridSize(t,o,e)}))}))])}},IE=function(t,n){var e=rd(),o=ru(!1),r=Ts(nS.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:ml([Lx("dismissAutocompleter",[Aa(ga(),(function(){return c()}))])]),lazySink:n.getSink})),i=function(){return nS.isOpen(r)},u=function(){return e.get().isSome()},a=function(){u()&&nS.hide(r)},c=function(){if(u()){var n=e.get().map((function(t){return t.element}));JS(n.getOr(nn.fromDom(t.selection.getNode()))).each(Po),a(),e.clear(),o.set(!1)}},s=pn((function(){return Lk(t)})),f=function(e,r){var i=gt(r,(function(t){return V.from(t.columns)})).getOr(1);return ot(r,(function(r){var u=r.items;return BE(u,r.matchText,(function(n,i){var u=t.selection.getRng();ok(t.dom,u,e).fold((function(){return console.error("Lost context. Cursor probably moved")}),(function(t){var e=t.range,u={hide:function(){c()},reload:function(t){a(),g(t)}};o.set(!0),r.onAction(u,e,n,i),o.set(!1)}))}),i,Uk.BUBBLE_TO_SANDBOX,n,r.highlightOn)}))},l=function(n){if(!u()){var r=KS(t,n.range);e.set({triggerChar:n.triggerChar,element:r,matchLength:n.text.length}),o.set(!1)}},d=function(n,e,o,i){n.matchLength=e.text.length;var u=gt(o,(function(t){return V.from(t.columns)})).getOr(1);nS.showAt(r,Nw.sketch(FE(_C("autocompleter-value",!0,i,u,"normal"),u,DT.ContentFocus,"normal")),{anchor:{type:"node",root:nn.fromDom(t.getBody()),node:V.from(n.element)}}),nS.getContent(r).each(ob.highlightFirst)},m=function(n){return e.get().map((function(e){return ok(t.dom,t.selection.getRng(),e.triggerChar).bind((function(e){return vk(t,s,e,n)}))})).getOrThunk((function(){return pk(t,s)}))},g=function(t){m(t).fold(c,(function(t){l(t.context),t.lookupData.then((function(n){e.get().map((function(e){var o=t.context;if(e.triggerChar===o.triggerChar){var r=f(o.triggerChar,n);r.length>0?d(e,o,n,r):o.text.length-e.matchLength>=10?c():a()}}))}))}))},p=jS((function(t){27!==t.which&&g()}),50),v={onKeypress:p,cancelIfNecessary:c,isMenuOpen:i,isActive:u,isProcessingAction:o.get,getView:function(){return nS.getContent(r)}};!1===t.hasPlugin("rtc")&&ik.setup(v,t)},RE={register:IE},VE=function(t,n,e){return zs(t,n,e).isSome()},PE=function(t,n){var e=null,o=function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];e=setTimeout((function(){t.apply(null,o),e=null}),n)},r=function(){null!==e&&(clearTimeout(e),e=null)};return{cancel:r,schedule:o}},HE=5,zE=400,NE=function(t){var n=t.raw;return void 0===n.touches||1!==n.touches.length?V.none():V.some(n.touches[0])},LE=function(t,n){var e=Math.abs(t.clientX-n.x),o=Math.abs(t.clientY-n.y);return e>HE||o>HE},WE=function(t){var n=rd(),e=ru(!1),o=PE((function(n){t.triggerEvent(ra(),n),e.set(!0)}),zE),r=function(t){return NE(t).each((function(r){o.cancel();var i={x:r.clientX,y:r.clientY,target:t.target};o.schedule(t),e.set(!1),n.set(i)})),V.none()},i=function(t){return o.cancel(),NE(t).each((function(t){n.on((function(e){LE(t,e)&&n.clear()}))})),V.none()},u=function(r){o.cancel();var i=function(t){return se(t.target,r.target)};return n.get().filter(i).map((function(n){return e.get()?(r.prevent(),!1):t.triggerEvent(oa(),r)}))},a=gu([{key:Du(),value:r},{key:Bu(),value:i},{key:Mu(),value:u}]),c=function(t,n){return _t(a,n).bind((function(n){return n(t)}))};return{fireIfReady:c}},UE=function(t){var n=t.raw;return n.which===rb[0]&&!W(["input","textarea"],cn(t.target))&&!VE(t.target,'[contenteditable="true"]')},jE=function(){return ee().browser.isFirefox()},GE=function(t,n){return jE()?ad(t,"focus",n):ud(t,"focusin",n)},XE=function(t,n){return jE()?ad(t,"blur",n):ud(t,"focusout",n)},YE=function(t,n){var e=D({stopBackspace:!0},n),o=["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"],r=WE(e),i=X(o.concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(n){return ud(t,n,(function(t){r.fireIfReady(t,n).each((function(n){n&&t.kill()}));var o=e.triggerEvent(n,t);o&&t.kill()}))})),u=rd(),a=ud(t,"paste",(function(t){r.fireIfReady(t,"paste").each((function(n){n&&t.kill()}));var n=e.triggerEvent("paste",t);n&&t.kill(),u.set(setTimeout((function(){e.triggerEvent(Zu(),t)}),0))})),c=ud(t,"keydown",(function(t){var n=e.triggerEvent("keydown",t);n?t.kill():e.stopBackspace&&UE(t)&&t.prevent()})),s=GE(t,(function(t){var n=e.triggerEvent("focusin",t);n&&t.kill()})),f=rd(),l=XE(t,(function(t){var n=e.triggerEvent("focusout",t);n&&t.kill(),f.set(setTimeout((function(){e.triggerEvent(Qu(),t)}),0))})),d=function(){Y(i,(function(t){t.unbind()})),c.unbind(),s.unbind(),l.unbind(),a.unbind(),u.on(clearTimeout),f.on(clearTimeout)};return{unbind:d}},qE=function(t,n){var e=_t(t,"target").getOr(n);return ru(e)},KE=function(t,n){var e=ru(!1),o=ru(!1),r=function(){e.set(!0)},i=function(){o.set(!0)};return{stop:r,cut:i,isStopped:e.get,isCut:o.get,event:t,setSource:n.set,getSource:n.get}},JE=function(t){var n=ru(!1),e=function(){n.set(!0)};return{stop:e,cut:v,isStopped:n.get,isCut:_,event:t,setSource:O("Cannot set source of a broadcasted event"),getSource:O("Cannot get source of a broadcasted event")}},$E=uu.generate([{stopped:[]},{resume:["element"]},{complete:[]}]),QE=function(t,n,e,o,r,i){var u=t(n,o),a=KE(e,r);return u.fold((function(){return i.logEventNoHandlers(n,o),$E.complete()}),(function(t){var e=t.descHandler,o=Pc(e);return o(a),a.isStopped()?(i.logEventStopped(n,t.element,e.purpose),$E.stopped()):a.isCut()?(i.logEventCut(n,t.element,e.purpose),$E.complete()):he(t.element).fold((function(){return i.logNoParent(n,t.element,e.purpose),$E.complete()}),(function(o){return i.logEventResponse(n,t.element,e.purpose),$E.resume(o)}))}))},ZE=function(t,n,e,o,r,i){return QE(t,n,e,o,r,i).fold(T,(function(o){return ZE(t,n,e,o,r,i)}),_)},tD=function(t,n,e,o,r){var i=qE(e,o);return QE(t,n,e,o,i,r)},nD=function(t,n,e){var o=JE(n);return Y(t,(function(t){var n=t.descHandler,e=Pc(n);e(o)})),o.isStopped()},eD=function(t,n,e,o){return oD(t,n,e,e.target,o)},oD=function(t,n,e,o,r){var i=qE(e,o);return ZE(t,n,e,o,i,r)},rD=function(t,n){return{element:t,descHandler:n}},iD=function(t,n){return{id:t,descHandler:n}},uD=function(){var t={},n=function(n,e,o){ht(o,(function(o,r){var i=void 0!==t[r]?t[r]:{};i[e]=Vc(o,n),t[r]=i}))},e=function(t,n){return lc(n).bind((function(n){return _t(t,n)})).map((function(t){return rD(n,t)}))},o=function(n){return _t(t,n).map((function(t){return kt(t,(function(t,n){return iD(n,t)}))})).getOr([])},r=function(n,o,r){return _t(t,o).bind((function(t){return xu(r,(function(n){return e(t,n)}),n)}))},i=function(n){ht(t,(function(t,e){Tt(t,n)&&delete t[n]}))};return{registerId:n,unregisterId:i,filterByType:o,find:r}},aD=function(){var t=uD(),n={},e=function(t){var n=t.element;return lc(n).getOrThunk((function(){return sc("uid-",t.element)}))},o=function(t,e){var o=n[e];if(o!==t)throw new Error('The tagId "'+e+'" is already used by: '+Za(o.element)+"\nCannot use it for: "+Za(t.element)+"\nThe conflicting element is"+(Ve(o.element)?" ":" not ")+"already in the DOM");i(t)},r=function(r){var i=e(r);Et(n,i)&&o(r,i);var u=[r];t.registerId(u,i,r.events),n[i]=r},i=function(e){lc(e.element).each((function(e){delete n[e],t.unregisterId(e)}))},u=function(n){return t.filterByType(n)},a=function(n,e,o){return t.find(n,e,o)},c=function(t){return _t(n,t)};return{find:a,filter:u,register:r,unregister:i,getById:c}},cD=function(t){var n=t.dom,e=n.attributes,o=B(n,["attributes"]);return{uid:t.uid,dom:D({tag:"div",attributes:D({role:"presentation"},e)},o),components:t.components,behaviours:ev(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},sD=dh({name:"Container",factory:cD,configFields:[qi("components",[]),nv("containerBehaviours",[]),qi("events",{}),qi("domModification",{}),qi("eventOrder",{})]}),fD=function(t){var n=function(n){return he(t.element).fold(T,(function(t){return se(n,t)}))},e=aD(),o=function(t,o){return e.find(n,t,o)},r=YE(t.element,{triggerEvent:function(t,n){return $s(t,n.target,(function(e){return eD(o,t,n,e)}))}}),i={debugInfo:x("real"),triggerEvent:function(t,n,e){$s(t,n,(function(r){return oD(o,t,e,n,r)}))},triggerFocus:function(t,n){lc(t).fold((function(){kl(t)}),(function(e){$s($u(),t,(function(e){return tD(o,$u(),{originator:n,kill:v,prevent:v,target:t},t,e),!1}))}))},triggerEscape:function(t,n){i.triggerEvent("keydown",t.element,n.event)},getByUid:function(t){return p(t)},getByDom:function(t){return h(t)},build:Ts,addToGui:function(t){c(t)},removeFromGui:function(t){s(t)},addToWorld:function(t){u(t)},removeFromWorld:function(t){a(t)},broadcast:function(t){d(t)},broadcastOn:function(t,n){m(t,n)},broadcastEvent:function(t,n){g(t,n)},isConnected:T},u=function(t){t.connect(i),dn(t.element)||(e.register(t),Y(t.components(),u),i.triggerEvent(aa(),t.element,{target:t.element}))},a=function(t){dn(t.element)||(Y(t.components(),a),e.unregister(t)),t.disconnect()},c=function(n){jg(t,n)},s=function(t){Yg(t)},f=function(){r.unbind(),Vo(t.element)},l=function(t){var n=e.filter(ta());Y(n,(function(n){var e=n.descHandler,o=Pc(e);o(t)}))},d=function(t){l({universal:!0,data:t})},m=function(t,n){l({universal:!1,channels:t,data:n})},g=function(t,n){var o=e.filter(t);return nD(o,n)},p=function(t){return e.getById(t).fold((function(){return rr.error(new Error('Could not find component with uid: "'+t+'" in system.'))}),rr.value)},h=function(t){var n=lc(t).getOr("not found");return p(n)};return u(t),{root:t,element:t.element,destroy:f,add:c,remove:s,getByUid:p,getByDom:h,addToWorld:u,removeFromWorld:a,broadcast:d,broadcastOn:m,broadcastEvent:g}},lD=function(t,n){return{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:X(t.items,n.interpreter)}},dD=x([qi("prefix","form-field"),nv("fieldBehaviours",[bh,tv])]),mD=x([Rv({schema:[Di("dom")],name:"label"}),Rv({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Di("text")],name:"aria-descriptor"}),Fv({factory:{sketch:function(t){var n=du(t,["factory"]);return t.factory.sketch(n)}},schema:[Di("factory")],name:"field"})]),gD=function(t,n,e,o){var r=ov(t.fieldBehaviours,[bh.config({find:function(n){return qv(n,t,"field")}}),tv.config({store:{mode:"manual",getValue:function(t){return bh.getCurrent(t).bind(tv.getValue)},setValue:function(t,n){bh.getCurrent(t).each((function(t){tv.setValue(t,n)}))}}})]),i=Ea([Wa((function(n,e){var o=Jv(n,t,["label","field","aria-descriptor"]);o.field().each((function(n){var e=rc(t.prefix);o.label().each((function(t){Ne(t.element,"for",e),Ne(n.element,"id",e)})),o["aria-descriptor"]().each((function(e){var o=rc(t.prefix);Ne(e.element,"id",o),Ne(n.element,"aria-describedby",o)}))}))}))]),u={getField:function(n){return qv(n,t,"field")},getLabel:function(n){return qv(n,t,"label")}};return{uid:t.uid,dom:t.dom,components:n,behaviours:r,events:i,apis:u}},pD=mh({name:"FormField",configFields:dD(),partFields:mD(),factory:gD,apis:{getField:function(t,n){return t.getField(n)},getLabel:function(t,n){return t.getLabel(n)}}}),vD=function(t,n){return Bc({attributes:gu([{key:n.tabAttr,value:"true"}])})},hD=Object.freeze({__proto__:null,exhibit:vD}),bD=[qi("tabAttr","data-alloy-tabstop")],yD=pl({fields:bD,name:"tabstopping",active:hD}),xD=tinymce.util.Tools.resolve("tinymce.html.Entities"),wD=function(t,n,e,o){var r=kD(t,n,e,o);return pD.sketch(r)},SD=function(t,n){return wD(t,n,[],[])},kD=function(t,n,e,o){return{dom:OD(e),components:t.toArray().concat([n]),fieldBehaviours:ml(o)}},CD=function(){return OD([])},OD=function(t){return{tag:"div",classes:["tox-form__group"].concat(t)}},_D=function(t,n){return pD.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}})},TD=rc("form-component-change"),ED=rc("form-close"),DD=rc("form-cancel"),BD=rc("form-action"),MD=rc("form-submit"),AD=rc("form-block"),FD=rc("form-unblock"),ID=rc("form-tabchange"),RD=rc("form-resize"),VD=function(t,n){var e,o=t.label.map((function(t){return _D(t,n)})),r=function(t){return function(n,e){zs(e.event.target,"[data-collection-item-value]").each((function(o){t(n,e,o,We(o,"data-collection-item-value"))}))}},i=function(e,o){var r=X(o,(function(e){var o=OS.translate(e.text),r=1===t.columns?'<div class="tox-collection__item-label">'+o+"</div>":"",i='<div class="tox-collection__item-icon">'+e.icon+"</div>",u={_:" "," - ":" ","-":" "},a=o.replace(/\_| \- |\-/g,(function(t){return u[t]})),c=n.isDisabled()?" tox-collection__item--state-disabled":"";return'<div class="tox-collection__item'+c+'" tabindex="-1" data-collection-item-value="'+xD.encodeAllRaw(e.value)+'" title="'+a+'" aria-label="'+a+'">'+i+r+"</div>"})),i="auto"!==t.columns&&t.columns>1?G(r,t.columns):[r],u=X(i,(function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"}));qa(e.element,u.join(""))},u=r((function(e,o,r,i){o.stop(),n.isDisabled()||ka(e,BD,{name:t.name,value:i})})),a=[Aa(Pu(),r((function(t,n,e){kl(e)}))),Aa(ju(),u),Aa(oa(),u),Aa(Hu(),r((function(t,n,e){Hs(t.element,"."+nC).each((function(t){as(t,nC)})),is(e,nC)}))),Aa(zu(),r((function(t){Hs(t.element,"."+nC).each((function(t){as(t,nC)}))}))),Ga(r((function(n,e,o,r){ka(n,BD,{name:t.name,value:r})})))],c=function(t,n){return X(Km(t.element,".tox-collection__item"),n)},s=pD.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==t.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:w},behaviours:ml([Ph.config({disabled:n.isDisabled,onDisabled:function(t){c(t,(function(t){is(t,"tox-collection__item--state-disabled"),Ne(t,"aria-disabled",!0)}))},onEnabled:function(t){c(t,(function(t){as(t,"tox-collection__item--state-disabled"),Ge(t,"aria-disabled")}))}}),c_(),zx.config({}),tv.config({store:{mode:"memory",initialValue:[]},onSetValue:function(n,e){i(n,e),"auto"===t.columns&&KC(n,5,"tox-collection__item").each((function(t){var e=t.numRows,o=t.numColumns;Dx.setGridSize(n,e,o)})),Sa(n,RD)}}),yD.config({}),Dx.config(iE(t.columns,"normal")),Lx("collection-events",a)]),eventOrder:(e={},e[na()]=["disabling","alloy.base.behaviour","collection-events"],e)}),f=["tox-form__group--collection"];return wD(o,s,f,[])},PD=x([Ni("data"),qi("inputAttributes",{}),qi("inputStyles",{}),qi("tag","input"),qi("inputClasses",[]),cf("onSetValue"),qi("styles",{}),qi("eventOrder",{}),nv("inputBehaviours",[tv,Jx]),qi("selectOnFocus",!0)]),HD=function(t){return ml([Jx.config({onFocus:t.selectOnFocus?function(t){var n=t.element,e=ds(n);n.dom.setSelectionRange(0,e.length)}:v})])},zD=function(t){return D(D({},HD(t)),ov(t.inputBehaviours,[tv.config({store:D(D({mode:"manual"},t.data.map((function(t){return{initialValue:t}})).getOr({})),{getValue:function(t){return ds(t.element)},setValue:function(t,n){var e=ds(t.element);e!==n&&ms(t.element,n)}}),onSetValue:t.onSetValue})]))},ND=function(t){return{tag:t.tag,attributes:D({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}},LD=function(t,n){return{uid:t.uid,dom:ND(t),components:[],behaviours:zD(t),eventOrder:t.eventOrder}},WD=dh({name:"Input",configFields:PD(),factory:LD}),UD={},jD={exports:UD};(function(n,e,o,r){(function(t,r){"object"===typeof e&&"undefined"!==typeof o?o.exports=r():"function"===typeof n&&n.amd?n(r):(t="undefined"!==typeof globalThis?globalThis:t||self,t.EphoxContactWrapper=r())})(this,(function(){var n="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:{},e={exports:{}};(function(t){(function(n){var e=setTimeout;function o(){}function r(t,n){return function(){t.apply(n,arguments)}}function i(t){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(t,this)}function u(t,n){while(3===t._state)t=t._value;0!==t._state?(t._handled=!0,i._immediateFn((function(){var e=1===t._state?n.onFulfilled:n.onRejected;if(null!==e){var o;try{o=e(t._value)}catch(r){return void c(n.promise,r)}a(n.promise,o)}else(1===t._state?a:c)(n.promise,t._value)}))):t._deferreds.push(n)}function a(t,n){try{if(n===t)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"===typeof n||"function"===typeof n)){var e=n.then;if(n instanceof i)return t._state=3,t._value=n,void s(t);if("function"===typeof e)return void l(r(e,n),t)}t._state=1,t._value=n,s(t)}catch(o){c(t,o)}}function c(t,n){t._state=2,t._value=n,s(t)}function s(t){2===t._state&&0===t._deferreds.length&&i._immediateFn((function(){t._handled||i._unhandledRejectionFn(t._value)}));for(var n=0,e=t._deferreds.length;n<e;n++)u(t,t._deferreds[n]);t._deferreds=null}function f(t,n,e){this.onFulfilled="function"===typeof t?t:null,this.onRejected="function"===typeof n?n:null,this.promise=e}function l(t,n){var e=!1;try{t((function(t){e||(e=!0,a(n,t))}),(function(t){e||(e=!0,c(n,t))}))}catch(o){if(e)return;e=!0,c(n,o)}}i.prototype["catch"]=function(t){return this.then(null,t)},i.prototype.then=function(t,n){var e=new this.constructor(o);return u(this,new f(t,n,e)),e},i.all=function(t){var n=Array.prototype.slice.call(t);return new i((function(t,e){if(0===n.length)return t([]);var o=n.length;function r(i,u){try{if(u&&("object"===typeof u||"function"===typeof u)){var a=u.then;if("function"===typeof a)return void a.call(u,(function(t){r(i,t)}),e)}n[i]=u,0===--o&&t(n)}catch(c){e(c)}}for(var i=0;i<n.length;i++)r(i,n[i])}))},i.resolve=function(t){return t&&"object"===typeof t&&t.constructor===i?t:new i((function(n){n(t)}))},i.reject=function(t){return new i((function(n,e){e(t)}))},i.race=function(t){return new i((function(n,e){for(var o=0,r=t.length;o<r;o++)t[o].then(n,e)}))},i._immediateFn="function"===typeof setImmediate?function(t){setImmediate(t)}:function(t){e(t,0)},i._unhandledRejectionFn=function(t){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},i._setImmediateFn=function(t){i._immediateFn=t},i._setUnhandledRejectionFn=function(t){i._unhandledRejectionFn=t},t.exports?t.exports=i:n.Promise||(n.Promise=i)})(n)})(e);var o=e.exports,r=function(){return"undefined"!==typeof window?window:Function("return this;")()}(),i={boltExport:r.Promise||o};return i}))})(void 0,UD,jD);var GD,XD=jD.exports.boltExport,YD=function(t){var n=V.none(),e=[],o=function(t){return YD((function(n){r((function(e){n(t(e))}))}))},r=function(t){u()?c(t):e.push(t)},i=function(t){u()||(n=V.some(t),a(e),e=[])},u=function(){return n.isSome()},a=function(t){Y(t,c)},c=function(t){n.each((function(n){setTimeout((function(){t(n)}),0)}))};return t(i),{get:r,map:o,isReady:u}},qD=function(t){return YD((function(n){n(t)}))},KD={nu:YD,pure:qD},JD=function(t){setTimeout((function(){throw t}),0)},$D=function(t){var n=function(n){t().then(n,JD)},e=function(n){return $D((function(){return t().then(n)}))},o=function(n){return $D((function(){return t().then((function(t){return n(t).toPromise()}))}))},r=function(n){return $D((function(){return t().then((function(){return n.toPromise()}))}))},i=function(){return KD.nu(n)},u=function(){var n=null;return $D((function(){return null===n&&(n=t()),n}))},a=t;return{map:e,bind:o,anonBind:r,toLazy:i,toCached:u,toPromise:a,get:n}},QD=function(t){return $D((function(){return new XD(t)}))},ZD=function(t){return $D((function(){return XD.resolve(t)}))},tB={nu:QD,pure:ZD},nB=["input","textarea"],eB=function(t){var n=cn(t);return W(nB,n)},oB=function(t,n){var e=n.getRoot(t).getOr(t.element);as(e,n.invalidClass),n.notify.each((function(n){eB(t.element)&&Ne(t.element,"aria-invalid",!1),n.getContainer(t).each((function(t){qa(t,n.validHtml)})),n.onValid(t)}))},rB=function(t,n,e,o){var r=n.getRoot(t).getOr(t.element);is(r,n.invalidClass),n.notify.each((function(n){eB(t.element)&&Ne(t.element,"aria-invalid",!0),n.getContainer(t).each((function(t){qa(t,o)})),n.onInvalid(t,o)}))},iB=function(t,n,e){return n.validator.fold((function(){return tB.pure(rr.value(!0))}),(function(n){return n.validate(t)}))},uB=function(t,n,e){return n.notify.each((function(n){n.onValidate(t)})),iB(t,n).map((function(o){return t.getSystem().isConnected()?o.fold((function(o){return rB(t,n,e,o),rr.error(o)}),(function(e){return oB(t,n),rr.value(e)})):rr.error("No longer in system")}))},aB=function(t,n){var e=n.getRoot(t).getOr(t.element);return cs(e,n.invalidClass)},cB=Object.freeze({__proto__:null,markValid:oB,markInvalid:rB,query:iB,run:uB,isInvalid:aB}),sB=function(t,n){return t.validator.map((function(e){return Ea([Aa(e.onEvent,(function(e){uB(e,t,n).get(w)}))].concat(e.validateOnLoad?[Wa((function(e){uB(e,t,n).get(v)}))]:[]))})).getOr({})},fB=Object.freeze({__proto__:null,events:sB}),lB=[Di("invalidClass"),qi("getRoot",V.none),Xi("notify",[qi("aria","alert"),qi("getContainer",V.none),qi("validHtml",""),cf("onValid"),cf("onInvalid"),cf("onValidate")]),Xi("validator",[Di("validate"),qi("onEvent","input"),qi("validateOnLoad",!0)])],dB=pl({fields:lB,name:"invalidating",active:fB,apis:cB,extra:{validation:function(t){return function(n){var e=tv.getValue(n);return tB.pure(t(e))}}}}),mB=function(t,n,e,o){return e.getOrCreate(t,n,o)},gB=Object.freeze({__proto__:null,getCoupled:mB}),pB=[Bi("others",bi(rr.value,ui()))],vB=function(){var t={},n=function(n,e,o){var r=pt(e.others);if(r)return _t(t,o).getOrThunk((function(){var r=_t(e.others,o).getOrDie("No information found for coupled component: "+o),i=r(n),u=n.getSystem().build(i);return t[o]=u,u}));throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(r,null,2))},e=x({});return Oc({readState:e,getOrCreate:n})},hB=Object.freeze({__proto__:null,init:vB}),bB=pl({fields:pB,name:"coupling",apis:gB,state:hB}),yB=x("sink"),xB=x(Rv({name:yB(),overrides:x({dom:{tag:"div"},behaviours:ml([Hg.config({useFixed:T})]),events:Ea([za(Nu()),za(Fu()),za(ju())])})}));(function(t){t[t["HighlightFirst"]=0]="HighlightFirst",t[t["HighlightNone"]=1]="HighlightNone"})(GD||(GD={}));var wB,SB=function(t,n){var e=t.getHotspot(n).getOr(n),o="hotspot",r=t.getAnchorOverrides();return t.layouts.fold((function(){return{type:o,hotspot:e,overrides:r}}),(function(t){return{type:o,hotspot:e,overrides:r,layouts:t}}))},kB=function(t,n,e){var o=t.fetch;return o(e).map(n)},CB=function(t,n,e,o,r,i,u){var a=kB(t,n,o),c=DB(o,t);return a.map((function(t){return t.bind((function(t){return V.from(Qw.sketch(D(D({},i.menu()),{uid:dc(""),data:t,highlightImmediately:u===GD.HighlightFirst,onOpenMenu:function(t,n){var o=c().getOrDie();Hg.position(o,n,{anchor:e}),bp.decloak(r)},onOpenSubmenu:function(t,n,e){var o=c().getOrDie();Hg.position(o,e,{anchor:{type:"submenu",item:n}}),bp.decloak(r)},onRepositionMenu:function(t,n,o){var r=c().getOrDie();Hg.position(r,n,{anchor:e}),Y(o,(function(t){Hg.position(r,t.triggeredMenu,{anchor:{type:"submenu",item:t.triggeringItem}})}))},onEscape:function(){return Jx.focus(o),bp.close(r),V.some(!0)}})))}))}))},OB=function(t,n,e,o,r,i,u){var a=SB(t,e),c=CB(t,n,a,e,o,r,u);return c.map((function(t){return t.fold((function(){bp.isOpen(o)&&bp.close(o)}),(function(t){bp.cloak(o),bp.open(o,t),i(o)})),o}))},_B=function(t,n,e,o,r,i,u){return bp.close(o),tB.pure(o)},TB=function(t,n,e,o,r,i){var u=bB.getCoupled(e,"sandbox"),a=bp.isOpen(u),c=a?_B:OB;return c(t,n,e,u,o,r,i)},EB=function(t,n,e){var o=bh.getCurrent(n).getOr(n),r=bo(t.element);e?qe(o.element,"min-width",r+"px"):ho(o.element,r)},DB=function(t,n){return t.getSystem().getByUid(n.uid+"-"+yB()).map((function(t){return function(){return rr.value(t)}})).getOrThunk((function(){return n.lazySink.fold((function(){return function(){return rr.error(new Error("No internal sink is specified, nor could an external sink be found"))}}),(function(n){return function(){return n(t)}}))}))},BB=function(t){bp.getState(t).each((function(t){Qw.repositionMenus(t)}))},MB=function(t,n,e){var o=Ls(),r=function(r,i){var u=SB(t,n);o.link(n.element),t.matchWidth&&EB(u.hotspot,i,t.useMinWidth),t.onOpen(u,r,i),void 0!==e&&void 0!==e.onOpen&&e.onOpen(r,i)},i=function(t,r){o.unlink(n.element),void 0!==e&&void 0!==e.onClose&&e.onClose(t,r)},u=DB(n,t);return{dom:{tag:"div",classes:t.sandboxClasses,attributes:{id:o.id,role:"listbox"}},behaviours:rv.augment(t.sandboxBehaviours,[tv.config({store:{mode:"memory",initialValue:n}}),bp.config({onOpen:r,onClose:i,isPartOf:function(t,e,o){return Us(e,o)||Us(n,o)},getAttachPoint:function(){return u().getOrDie()}}),bh.config({find:function(t){return bp.getState(t).bind((function(t){return bh.getCurrent(t)}))}}),yl.config({channels:D(D({},kp({isExtraPart:_})),Op({doReposition:BB}))})])}},AB=function(t){var n=bB.getCoupled(t,"sandbox");BB(n)},FB=function(){return[qi("sandboxClasses",[]),rv.field("sandboxBehaviours",[bh,yl,bp,tv])]},IB=x([Di("dom"),Di("fetch"),cf("onOpen"),sf("onExecute"),qi("getHotspot",V.some),qi("getAnchorOverrides",x({})),zd(),nv("dropdownBehaviours",[pw,bB,Dx,Jx]),Di("toggleClass"),qi("eventOrder",{}),Ni("lazySink"),qi("matchWidth",!1),qi("useMinWidth",!1),Ni("role")].concat(FB())),RB=x([Iv({schema:[rf()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),xB()]),VB=function(t,n,e,o){var r,i=function(n){return _t(t.dom,"attributes").bind((function(t){return _t(t,n)}))},u=function(t){bp.getState(t).each((function(t){Qw.highlightPrimary(t)}))},a=function(n){var e=u;TB(t,w,n,o,e,GD.HighlightFirst).get(v)},c={expand:function(n){pw.isOn(n)||TB(t,w,n,o,v,GD.HighlightNone).get(v)},open:function(n){pw.isOn(n)||TB(t,w,n,o,v,GD.HighlightFirst).get(v)},isOpen:pw.isOn,close:function(n){pw.isOn(n)&&TB(t,w,n,o,v,GD.HighlightFirst).get(v)},repositionMenus:function(t){pw.isOn(t)&&AB(t)}},s=function(t,n){return Ca(t),V.some(!0)};return{uid:t.uid,dom:t.dom,components:n,behaviours:ov(t.dropdownBehaviours,[pw.config({toggleClass:t.toggleClass,aria:{mode:"expanded"}}),bB.config({others:{sandbox:function(n){return MB(t,n,{onOpen:function(){return pw.on(n)},onClose:function(){return pw.off(n)}})}}}),Dx.config({mode:"special",onSpace:s,onEnter:s,onDown:function(t,n){if(PB.isOpen(t)){var e=bB.getCoupled(t,"sandbox");u(e)}else PB.open(t);return V.some(!0)},onEscape:function(t,n){return PB.isOpen(t)?(PB.close(t),V.some(!0)):V.none()}}),Jx.config({})]),events:hw(V.some(a)),eventOrder:D(D({},t.eventOrder),(r={},r[na()]=["disabling","toggling","alloy.base.behaviour"],r)),apis:c,domModification:{attributes:D(D({"aria-haspopup":"true"},t.role.fold((function(){return{}}),(function(t){return{role:t}}))),"button"===t.dom.tag?{type:i("type").getOr("button")}:{})}}},PB=mh({name:"Dropdown",configFields:IB(),partFields:RB(),factory:VB,apis:{open:function(t,n){return t.open(n)},expand:function(t,n){return t.expand(n)},close:function(t,n){return t.close(n)},isOpen:function(t,n){return t.isOpen(n)},repositionMenus:function(t,n){return t.repositionMenus(n)}}}),HB=function(){return Bc({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})},zB=function(){return Ea([Da(qu(),T)])},NB=Object.freeze({__proto__:null,events:zB,exhibit:HB}),LB=pl({fields:[],name:"unselecting",active:NB}),WB=function(t,n){return PB.sketch({dom:t.dom,components:t.components,toggleClass:"mce-active",dropdownBehaviours:ml([m_.button(n.providers.isDisabled),c_(),LB.config({}),yD.config({})]),layouts:t.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:n.getSink,fetch:function(e){return tB.nu((function(n){return t.fetch(n)})).map((function(o){return V.from(AE(Sr(eE(rc("menu-value"),o,(function(n){t.onItemAction(e,n)}),t.columns,t.presets,Uk.CLOSE_ON_EXECUTE,_,n.providers),{movement:rE(t.columns,t.presets)})))}))},parts:{menu:vC(!1,1,t.presets)}})},UB=rc("color-input-change"),jB=rc("color-swatch-change"),GB=rc("color-picker-cancel"),XB=function(t,n,e){var o=pD.parts.field({factory:WD,inputClasses:["tox-textfield"],onSetValue:function(t){return dB.run(t).get(v)},inputBehaviours:ml([Ph.config({disabled:n.providers.isDisabled}),c_(),yD.config({}),dB.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return he(t.element)},notify:{onValid:function(t){var n=tv.getValue(t);ka(t,UB,{color:n})}},validator:{validateOnLoad:!1,validate:function(t){var n=tv.getValue(t);if(0===n.length)return tB.pure(rr.value(!0));var e=nn.fromTag("span");qe(e,"background-color",n);var o=Ze(e,"background-color").fold((function(){return rr.error("blah")}),(function(t){return rr.value(n)}));return tB.pure(o)}}})]),selectOnFocus:!1}),r=t.label.map((function(t){return _D(t,n.providers)})),i=function(t,n){ka(t,jB,{value:n})},u=function(t,n){a.getOpt(t).each((function(t){"custom"===n?e.colorPicker((function(n){n.fold((function(){return Sa(t,GB)}),(function(n){i(t,n),zT(n)}))}),"#ffffff"):i(t,"remove"===n?"":n)}))},a=CS(WB({dom:{tag:"span",attributes:{"aria-label":n.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[Uf,Wf,Yf]},onLtr:function(){return[Wf,Uf,Yf]}},components:[],fetch:JT(e.getColors(),e.hasCustomColors()),columns:e.getColorCols(),presets:"color",onItemAction:u},n));return pD.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:r.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[o,a.asSpec()]}]),fieldBehaviours:ml([Lx("form-field-events",[Aa(UB,(function(n,e){a.getOpt(n).each((function(t){qe(t.element,"background-color",e.event.color)})),ka(n,TD,{name:t.name})})),Aa(jB,(function(t,n){pD.getField(t).each((function(e){tv.setValue(e,n.event.value),bh.getCurrent(t).each(Jx.focus)}))})),Aa(GB,(function(t,n){pD.getField(t).each((function(n){bh.getCurrent(t).each(Jx.focus)}))}))])])})},YB=Rv({schema:[Di("dom")],name:"label"}),qB=function(t){return Rv({name:t+"-edge",overrides:function(n){var e=n.model.manager.edgeActions[t];return e.fold((function(){return{}}),(function(t){return{events:Ea([Fa(Du(),(function(n,e,o){return t(n,o)}),[n]),Fa(Fu(),(function(n,e,o){return t(n,o)}),[n]),Fa(Iu(),(function(n,e,o){o.mouseIsDown.get()&&t(n,o)}),[n])])}}))}})},KB=qB("top-left"),JB=qB("top"),$B=qB("top-right"),QB=qB("right"),ZB=qB("bottom-right"),tM=qB("bottom"),nM=qB("bottom-left"),eM=qB("left"),oM=Fv({name:"thumb",defaults:x({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:Ea([Pa(Du(),t,"spectrum"),Pa(Bu(),t,"spectrum"),Pa(Mu(),t,"spectrum"),Pa(Fu(),t,"spectrum"),Pa(Iu(),t,"spectrum"),Pa(Vu(),t,"spectrum")])}}}),rM=Fv({schema:[Ti("mouseIsDown",(function(){return ru(!1)}))],name:"spectrum",overrides:function(t){var n=t.model,e=n.manager,o=function(n,o){return e.getValueFromEvent(o).map((function(o){return e.setValueFrom(n,t,o)}))};return{behaviours:ml([Dx.config({mode:"special",onLeft:function(n){return e.onLeft(n,t)},onRight:function(n){return e.onRight(n,t)},onUp:function(n){return e.onUp(n,t)},onDown:function(n){return e.onDown(n,t)}}),Jx.config({})]),events:Ea([Aa(Du(),o),Aa(Bu(),o),Aa(Fu(),o),Aa(Iu(),(function(n,e){t.mouseIsDown.get()&&o(n,e)}))])}}}),iM=[YB,eM,QB,JB,tM,KB,$B,nM,ZB,oM,rM],uM="slider.change.value",aM=x(uM),cM=function(t){return-1!==t.type.indexOf("touch")},sM=function(t){var n=t.event.raw;if(cM(n)){var e=n;return void 0!==e.touches&&1===e.touches.length?V.some(e.touches[0]).map((function(t){return fo(t.clientX,t.clientY)})):V.none()}var o=n;return void 0!==o.clientX?V.some(o).map((function(t){return fo(t.clientX,t.clientY)})):V.none()},fM="top",lM="right",dM="bottom",mM="left",gM=function(t){return t.model.minX},pM=function(t){return t.model.minY},vM=function(t){return t.model.minX-1},hM=function(t){return t.model.minY-1},bM=function(t){return t.model.maxX},yM=function(t){return t.model.maxY},xM=function(t){return t.model.maxX+1},wM=function(t){return t.model.maxY+1},SM=function(t,n,e){return n(t)-e(t)},kM=function(t){return SM(t,bM,gM)},CM=function(t){return SM(t,yM,pM)},OM=function(t){return kM(t)/2},_M=function(t){return CM(t)/2},TM=function(t){return t.stepSize},EM=function(t){return t.snapToGrid},DM=function(t){return t.snapStart},BM=function(t){return t.rounded},MM=function(t,n){return void 0!==t[n+"-edge"]},AM=function(t){return MM(t,mM)},FM=function(t){return MM(t,lM)},IM=function(t){return MM(t,fM)},RM=function(t){return MM(t,dM)},VM=function(t){return t.model.value.get()},PM=function(t){return{x:t}},HM=function(t){return{y:t}},zM=function(t,n){return{x:t,y:n}},NM=function(t,n){ka(t,aM(),{value:n})},LM=function(t,n){NM(t,zM(vM(n),hM(n)))},WM=function(t,n){NM(t,HM(hM(n)))},UM=function(t,n){NM(t,zM(OM(n),hM(n)))},jM=function(t,n){NM(t,zM(xM(n),hM(n)))},GM=function(t,n){NM(t,PM(xM(n)))},XM=function(t,n){NM(t,zM(xM(n),_M(n)))},YM=function(t,n){NM(t,zM(xM(n),wM(n)))},qM=function(t,n){NM(t,HM(wM(n)))},KM=function(t,n){NM(t,zM(OM(n),wM(n)))},JM=function(t,n){NM(t,zM(vM(n),wM(n)))},$M=function(t,n){NM(t,PM(vM(n)))},QM=function(t,n){NM(t,zM(vM(n),_M(n)))},ZM=function(t,n,e,o){return t<n?t:t>e?e:t===n?n-1:Math.max(n,t-o)},tA=function(t,n,e,o){return t>e?t:t<n?n:t===e?e+1:Math.min(e,t+o)},nA=function(t,n,e){return Math.max(n,Math.min(e,t))},eA=function(t,n,e,o,r){return r.fold((function(){var r=t-n,i=Math.round(r/o)*o;return nA(n+i,n-1,e+1)}),(function(n){var r=(t-n)%o,i=Math.round(r/o),u=Math.floor((t-n)/o),a=Math.floor((e-n)/o),c=Math.min(a,u+i),s=n+c*o;return Math.max(n,s)}))},oA=function(t,n,e){return Math.min(e,Math.max(t,n))-n},rA=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.step,u=t.snap,a=t.snapStart,c=t.rounded,s=t.hasMinEdge,f=t.hasMaxEdge,l=t.minBound,d=t.maxBound,m=t.screenRange,g=s?n-1:n,p=f?e+1:e;if(r<l)return g;if(r>d)return p;var v=oA(r,l,d),h=nA(v/m*o+n,g,p);return u&&h>=n&&h<=e?eA(h,n,e,i,a):c?Math.round(h):h},iA=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,f=t.centerMaxEdge;return r<n?i?0:s:r>e?u?a:f:(r-n)/o*c},uA="top",aA="right",cA="bottom",sA="left",fA="width",lA="height",dA=function(t){return t.element.dom.getBoundingClientRect()},mA=function(t,n){return t[n]},gA=function(t){var n=dA(t);return mA(n,sA)},pA=function(t){var n=dA(t);return mA(n,aA)},vA=function(t){var n=dA(t);return mA(n,uA)},hA=function(t){var n=dA(t);return mA(n,cA)},bA=function(t){var n=dA(t);return mA(n,fA)},yA=function(t){var n=dA(t);return mA(n,lA)},xA=function(t,n,e){return(t+n)/2-e},wA=function(t,n){var e=dA(t),o=dA(n),r=mA(e,sA),i=mA(e,aA),u=mA(o,sA);return xA(r,i,u)},SA=function(t,n){var e=dA(t),o=dA(n),r=mA(e,uA),i=mA(e,cA),u=mA(o,uA);return xA(r,i,u)},kA=function(t,n){ka(t,aM(),{value:n})},CA=function(t){return{x:t}},OA=function(t,n,e){var o={min:gM(n),max:bM(n),range:kM(n),value:e,step:TM(n),snap:EM(n),snapStart:DM(n),rounded:BM(n),hasMinEdge:AM(n),hasMaxEdge:FM(n),minBound:gA(t),maxBound:pA(t),screenRange:bA(t)};return rA(o)},_A=function(t,n,e){var o=OA(t,n,e),r=CA(o);return kA(t,r),o},TA=function(t,n){var e=gM(n);kA(t,CA(e))},EA=function(t,n){var e=bM(n);kA(t,CA(e))},DA=function(t,n,e){var o=t>0?tA:ZM,r=o(VM(e).x,gM(e),bM(e),TM(e));return kA(n,CA(r)),V.some(r)},BA=function(t){return function(n,e){return DA(t,n,e).map(T)}},MA=function(t){var n=sM(t);return n.map((function(t){return t.left}))},AA=function(t,n,e,o,r){var i=0,u=bA(t),a=o.bind((function(n){return V.some(wA(n,t))})).getOr(i),c=r.bind((function(n){return V.some(wA(n,t))})).getOr(u),s={min:gM(n),max:bM(n),range:kM(n),value:e,hasMinEdge:AM(n),hasMaxEdge:FM(n),minBound:gA(t),minOffset:i,maxBound:pA(t),maxOffset:u,centerMinEdge:a,centerMaxEdge:c};return iA(s)},FA=function(t,n,e,o,r,i){var u=AA(n,i,e,o,r);return gA(n)-gA(t)+u},IA=function(t,n,e,o){var r=VM(e),i=FA(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=bo(n.element)/2;qe(n.element,"left",i-u+"px")},RA=BA(-1),VA=BA(1),PA=V.none,HA=V.none,zA={"top-left":V.none(),top:V.none(),"top-right":V.none(),right:V.some(GM),"bottom-right":V.none(),bottom:V.none(),"bottom-left":V.none(),left:V.some($M)},NA=Object.freeze({__proto__:null,setValueFrom:_A,setToMin:TA,setToMax:EA,findValueOfOffset:OA,getValueFromEvent:MA,findPositionOfValue:FA,setPositionFromValue:IA,onLeft:RA,onRight:VA,onUp:PA,onDown:HA,edgeActions:zA}),LA=function(t,n){ka(t,aM(),{value:n})},WA=function(t){return{y:t}},UA=function(t,n,e){var o={min:pM(n),max:yM(n),range:CM(n),value:e,step:TM(n),snap:EM(n),snapStart:DM(n),rounded:BM(n),hasMinEdge:IM(n),hasMaxEdge:RM(n),minBound:vA(t),maxBound:hA(t),screenRange:yA(t)};return rA(o)},jA=function(t,n,e){var o=UA(t,n,e),r=WA(o);return LA(t,r),o},GA=function(t,n){var e=pM(n);LA(t,WA(e))},XA=function(t,n){var e=yM(n);LA(t,WA(e))},YA=function(t,n,e){var o=t>0?tA:ZM,r=o(VM(e).y,pM(e),yM(e),TM(e));return LA(n,WA(r)),V.some(r)},qA=function(t){return function(n,e){return YA(t,n,e).map(T)}},KA=function(t){var n=sM(t);return n.map((function(t){return t.top}))},JA=function(t,n,e,o,r){var i=0,u=yA(t),a=o.bind((function(n){return V.some(SA(n,t))})).getOr(i),c=r.bind((function(n){return V.some(SA(n,t))})).getOr(u),s={min:pM(n),max:yM(n),range:CM(n),value:e,hasMinEdge:IM(n),hasMaxEdge:RM(n),minBound:vA(t),minOffset:i,maxBound:hA(t),maxOffset:u,centerMinEdge:a,centerMaxEdge:c};return iA(s)},$A=function(t,n,e,o,r,i){var u=JA(n,i,e,o,r);return vA(n)-vA(t)+u},QA=function(t,n,e,o){var r=VM(e),i=$A(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),u=uo(n.element)/2;qe(n.element,"top",i-u+"px")},ZA=V.none,tF=V.none,nF=qA(-1),eF=qA(1),oF={"top-left":V.none(),top:V.some(WM),"top-right":V.none(),right:V.none(),"bottom-right":V.none(),bottom:V.some(qM),"bottom-left":V.none(),left:V.none()},rF=Object.freeze({__proto__:null,setValueFrom:jA,setToMin:GA,setToMax:XA,findValueOfOffset:UA,getValueFromEvent:KA,findPositionOfValue:$A,setPositionFromValue:QA,onLeft:ZA,onRight:tF,onUp:nF,onDown:eF,edgeActions:oF}),iF=function(t,n){ka(t,aM(),{value:n})},uF=function(t,n){return{x:t,y:n}},aF=function(t,n,e){var o=OA(t,n,e.left),r=UA(t,n,e.top),i=uF(o,r);return iF(t,i),i},cF=function(t,n,e,o){var r=t>0?tA:ZM,i=n?VM(o).x:r(VM(o).x,gM(o),bM(o),TM(o)),u=n?r(VM(o).y,pM(o),yM(o),TM(o)):VM(o).y;return iF(e,uF(i,u)),V.some(i)},sF=function(t,n){return function(e,o){return cF(t,n,e,o).map(T)}},fF=function(t,n){var e=gM(n),o=pM(n);iF(t,uF(e,o))},lF=function(t,n){var e=bM(n),o=yM(n);iF(t,uF(e,o))},dF=function(t){return sM(t)},mF=function(t,n,e,o){var r=VM(e),i=FA(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=$A(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),a=bo(n.element)/2,c=uo(n.element)/2;qe(n.element,"left",i-a+"px"),qe(n.element,"top",u-c+"px")},gF=sF(-1,!1),pF=sF(1,!1),vF=sF(-1,!0),hF=sF(1,!0),bF={"top-left":V.some(LM),top:V.some(UM),"top-right":V.some(jM),right:V.some(XM),"bottom-right":V.some(YM),bottom:V.some(KM),"bottom-left":V.some(JM),left:V.some(QM)},yF=Object.freeze({__proto__:null,setValueFrom:aF,setToMin:fF,setToMax:lF,getValueFromEvent:dF,setPositionFromValue:mF,onLeft:gF,onRight:pF,onUp:vF,onDown:hF,edgeActions:bF}),xF=[qi("stepSize",1),qi("onChange",v),qi("onChoose",v),qi("onInit",v),qi("onDragStart",v),qi("onDragEnd",v),qi("snapToGrid",!1),qi("rounded",!0),Ni("snapStart"),Bi("model",Ci("mode",{x:[qi("minX",0),qi("maxX",100),Ti("value",(function(t){return ru(t.mode.minX)})),Di("getInitialValue"),df("manager",NA)],y:[qi("minY",0),qi("maxY",100),Ti("value",(function(t){return ru(t.mode.minY)})),Di("getInitialValue"),df("manager",rF)],xy:[qi("minX",0),qi("maxX",100),qi("minY",0),qi("maxY",100),Ti("value",(function(t){return ru({x:t.mode.minX,y:t.mode.minY})})),Di("getInitialValue"),df("manager",yF)]})),nv("sliderBehaviours",[Dx,tv]),Ti("mouseIsDown",(function(){return ru(!1)}))],wF=function(t,n,e,o){var r,i=function(n){return Kv(n,t,"thumb")},u=function(n){return Kv(n,t,"spectrum")},a=function(n){return qv(n,t,"left-edge")},c=function(n){return qv(n,t,"right-edge")},s=function(n){return qv(n,t,"top-edge")},f=function(n){return qv(n,t,"bottom-edge")},l=t.model,d=l.manager,m=function(n,e){d.setPositionFromValue(n,e,t,{getLeftEdge:a,getRightEdge:c,getTopEdge:s,getBottomEdge:f,getSpectrum:u})},g=function(t,n){l.value.set(n);var e=i(t);m(t,e)},p=function(n,e){g(n,e);var o=i(n);return t.onChange(n,o,e),V.some(!0)},v=function(n){d.setToMin(n,t)},h=function(n){d.setToMax(n,t)},b=function(n){var e=function(){qv(n,t,"thumb").each((function(e){var o=l.value.get();t.onChoose(n,e,o)}))},o=t.mouseIsDown.get();t.mouseIsDown.set(!1),o&&e()},y=function(n,e){e.stop(),t.mouseIsDown.set(!0),t.onDragStart(n,i(n))},x=function(n,e){e.stop(),t.onDragEnd(n,i(n)),b(n)};return{uid:t.uid,dom:t.dom,components:n,behaviours:ov(t.sliderBehaviours,[Dx.config({mode:"special",focusIn:function(n){return qv(n,t,"spectrum").map(Dx.focusIn).map(T)}}),tv.config({store:{mode:"manual",getValue:function(t){return l.value.get()}}}),yl.config({channels:(r={},r[wp()]={onReceive:b},r)})]),events:Ea([Aa(aM(),(function(t,n){p(t,n.event.value)})),Wa((function(n,e){var o=l.getInitialValue();l.value.set(o);var r=i(n);m(n,r);var a=u(n);t.onInit(n,r,a,l.value.get())})),Aa(Du(),y),Aa(Mu(),x),Aa(Fu(),y),Aa(Vu(),x)]),apis:{resetToMin:v,resetToMax:h,setValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},SF=mh({name:"Slider",configFields:xF,partFields:iM,factory:wF,apis:{setValue:function(t,n,e){t.setValue(n,e)},resetToMin:function(t,n){t.resetToMin(n)},resetToMax:function(t,n){t.resetToMax(n)},refresh:function(t,n){t.refresh(n)}}}),kF=rc("rgb-hex-update"),CF=rc("slider-update"),OF=rc("palette-update"),_F=function(t,n){var e=SF.parts.spectrum({dom:{tag:"div",classes:[n("hue-slider-spectrum")],attributes:{role:"presentation"}}}),o=SF.parts.thumb({dom:{tag:"div",classes:[n("hue-slider-thumb")],attributes:{role:"presentation"}}});return SF.sketch({dom:{tag:"div",classes:[n("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:x({y:0})},components:[e,o],sliderBehaviours:ml([Jx.config({})]),onChange:function(t,n,e){ka(t,CF,{value:e})}})},TF="form",EF=[nv("formBehaviours",[tv])],DF=function(t){return"<alloy.field."+t+">"},BF=function(t){var n=function(){var t=[],n=function(n,e){return t.push(n),Uv(TF,DF(n),e)};return{field:n,record:x(t)}}(),e=t(n),o=n.record(),r=X(o,(function(t){return Fv({name:t,pname:DF(t)})}));return uh(TF,EF,r,AF,e)},MF=function(t,n){return t.fold((function(){return rr.error(n)}),rr.value)},AF=function(t,n){return{uid:t.uid,dom:t.dom,components:n,behaviours:ov(t.formBehaviours,[tv.config({store:{mode:"manual",getValue:function(n){var e=$v(n,t);return bt(e,(function(t,n){return t().bind((function(t){var e=bh.getCurrent(t);return MF(e,new Error("Cannot find a current component to extract the value from for form part '"+n+"': "+Za(t.element)))})).map(tv.getValue)}))},setValue:function(n,e){ht(e,(function(e,o){qv(n,t,o).each((function(t){bh.getCurrent(t).each((function(t){tv.setValue(t,e)}))}))}))}}})]),apis:{getField:function(n,e){return qv(n,t,e).bind(bh.getCurrent)}}}},FF={getField:kc((function(t,n,e){return t.getField(n,e)})),sketch:BF},IF=rc("valid-input"),RF=rc("invalid-input"),VF=rc("validating-input"),PF="colorcustom.rgb.",HF=function(t,n,e,o){var r=function(e,o){return dB.config({invalidClass:n("invalid"),notify:{onValidate:function(t){ka(t,VF,{type:e})},onValid:function(t){ka(t,IF,{type:e,value:tv.getValue(t)})},onInvalid:function(t){ka(t,RF,{type:e,value:tv.getValue(t)})}},validator:{validate:function(n){var e=tv.getValue(n),r=o(e)?rr.value(!0):rr.error(t("aria.input.invalid"));return tB.pure(r)},validateOnLoad:!1}})},i=function(e,o,i,u,a){var c=t(PF+"range"),s=pD.parts.label({dom:{tag:"label",innerHtml:i,attributes:{"aria-label":u}}}),f=pD.parts.field({data:a,factory:WD,inputAttributes:D({type:"text"},"hex"===o?{"aria-live":"polite"}:{}),inputClasses:[n("textfield")],inputBehaviours:ml([r(o,e),yD.config({})]),onSetValue:function(t){if(dB.isInvalid(t)){var n=dB.run(t);n.get(v)}}}),l=[s,f],d="hex"!==o?[pD.parts["aria-descriptor"]({text:c})]:[],m=l.concat(d);return{dom:{tag:"div",attributes:{role:"presentation"}},components:m}},u=function(t,n){var e=nT(n);return FF.getField(t,"hex").each((function(n){Jx.isFocused(n)||tv.setValue(t,{hex:e.value})})),e},a=function(t,n){var e=n.red,o=n.green,r=n.blue;tv.setValue(t,{red:e,green:o,blue:r})},c=CS({dom:{tag:"div",classes:[n("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),s=function(t,n){c.getOpt(t).each((function(t){qe(t.element,"background-color","#"+n.value)}))},f=function(){var r={red:ru(V.some(255)),green:ru(V.some(255)),blue:ru(V.some(255)),hex:ru(V.some("ffffff"))},f=function(t,n){var e=fT(n);a(t,e),g(e)},l=function(t){return r[t].get()},d=function(t,n){r[t].set(n)},m=function(){return l("red").bind((function(t){return l("green").bind((function(n){return l("blue").map((function(e){return aT(t,n,e,1)}))}))}))},g=function(t){var n=t.red,e=t.green,o=t.blue;d("red",V.some(n)),d("green",V.some(e)),d("blue",V.some(o))},p=function(t,n){var e=n.event;"hex"!==e.type?d(e.type,V.none()):o(t)},v=function(t,n){e(t);var o=X_(n);d("hex",V.some(n));var r=fT(o);a(t,r),g(r),ka(t,kF,{hex:o}),s(t,o)},h=function(t,n,e){var o=parseInt(e,10);d(n,V.some(o)),m().each((function(n){var e=u(t,n);ka(t,kF,{hex:e}),s(t,e)}))},b=function(t){return"hex"===t.type},y=function(t,n){var e=n.event;b(e)?v(t,e.value):h(t,e.type,e.value)},x=function(n){return{label:t(PF+n+".label"),description:t(PF+n+".description")}},w=x("red"),S=x("green"),k=x("blue"),C=x("hex");return Sr(FF.sketch((function(e){return{dom:{tag:"form",classes:[n("rgb-form")],attributes:{"aria-label":t("aria.color.picker")}},components:[e.field("red",pD.sketch(i(cT,"red",w.label,w.description,255))),e.field("green",pD.sketch(i(cT,"green",S.label,S.description,255))),e.field("blue",pD.sketch(i(cT,"blue",k.label,k.description,255))),e.field("hex",pD.sketch(i(K_,"hex",C.label,C.description,"ffffff"))),c.asSpec()],formBehaviours:ml([dB.config({invalidClass:n("form-invalid")}),Lx("rgb-form-events",[Aa(IF,y),Aa(RF,p),Aa(VF,p)])])}})),{apis:{updateHex:function(t,n){tv.setValue(t,{hex:n.value}),f(t,n),s(t,n)}}})},l=dh({factory:f,name:"RgbForm",configFields:[],apis:{updateHex:function(t,n,e){t.updateHex(n,e)}},extraApis:{}});return l},zF=function(t,n){var e=SF.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[n("sv-palette-spectrum")]}}),o=SF.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette-thumb")],innerHtml:"<div class="+n("sv-palette-inner-thumb")+' role="presentation"></div>'}}),r=function(t,n){var e=t.width,o=t.height,r=t.getContext("2d");if(null!==r){r.fillStyle=n,r.fillRect(0,0,e,o);var i=r.createLinearGradient(0,0,e,0);i.addColorStop(0,"rgba(255,255,255,1)"),i.addColorStop(1,"rgba(255,255,255,0)"),r.fillStyle=i,r.fillRect(0,0,e,o);var u=r.createLinearGradient(0,0,0,o);u.addColorStop(0,"rgba(0,0,0,0)"),u.addColorStop(1,"rgba(0,0,0,1)"),r.fillStyle=u,r.fillRect(0,0,e,o)}},i=function(t,n){var e=t.components()[0].element.dom,o=wT(n,100,100),i=sT(o);r(e,mT(i))},u=function(t,n){var e=ST(fT(n));SF.setValue(t,{x:e.saturation,y:100-e.value})},a=function(t){var i=x({x:0,y:0}),u=function(t,n,e){ka(t,OF,{value:e})},a=function(t,n,e,o){r(e.element.dom,mT(gT))},c=ml([bh.config({find:V.some}),Jx.config({})]);return SF.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette")]},model:{mode:"xy",getInitialValue:i},rounded:!1,components:[e,o],onChange:u,onInit:a,sliderBehaviours:c})},c=dh({factory:a,name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:function(t,n,e){i(n,e)},setThumb:function(t,n,e){u(n,e)}},extraApis:{}});return c},NF=function(t,n){var e=function(e){var o=HF(t,n,e.onValidHex,e.onInvalidHex),r=zF(t,n),i=function(t){return(100-t)/100*360},u=function(t){return 100-t/360*100},a={paletteRgba:ru(gT),paletteHue:ru(0)},c=CS(_F(t,n)),s=CS(r.sketch({})),f=CS(o.sketch({})),l=function(t,n,e){s.getOpt(t).each((function(t){r.setHue(t,e)}))},d=function(t,n){f.getOpt(t).each((function(t){o.updateHex(t,n)}))},m=function(t,n,e){c.getOpt(t).each((function(t){SF.setValue(t,{y:u(e)})}))},g=function(t,n){s.getOpt(t).each((function(t){r.setThumb(t,n)}))},p=function(t,n){var e=fT(t);a.paletteRgba.set(e),a.paletteHue.set(n)},v=function(t,n,e,o){p(n,e),Y(o,(function(o){o(t,n,e)}))},h=function(){var t=[d];return function(n,e){var o=e.event.value,r=a.paletteHue.get(),i=wT(r,o.x,100-o.y),u=CT(i);v(n,u,r,t)}},b=function(){var t=[l,d];return function(n,e){var o=i(e.event.value.y),r=a.paletteRgba.get(),u=ST(r),c=wT(o,u.saturation,u.value),s=CT(c);v(n,s,o,t)}},y=function(){var t=[l,m,g];return function(n,e){var o=e.event.hex,r=kT(o);v(n,o,r.hue,t)}};return{uid:e.uid,dom:e.dom,components:[s.asSpec(),c.asSpec(),f.asSpec()],behaviours:ml([Lx("colour-picker-events",[Aa(kF,y()),Aa(OF,h()),Aa(CF,b())]),bh.config({find:function(t){return f.getOpt(t)}}),Dx.config({mode:"acyclic"})])}},o=dh({name:"ColourPicker",configFields:[Di("dom"),qi("onValidHex",v),qi("onInvalidHex",v)],factory:e});return o},LF=function(){return bh.config({find:V.some})},WF=function(t){return bh.config({find:t.getOpt})},UF=function(t){return bh.config({find:function(n){return Se(n.element,t).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))}})},jF={self:LF,memento:WF,childAt:UF},GF={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},XF=function(t){return GF[t]},YF=function(t){return XF(t)},qF=function(t){var n=function(t){return"tox-"+t},e=NF(YF,n),o=function(t){ka(t,BD,{name:"hex-valid",value:!0})},r=function(t){ka(t,BD,{name:"hex-valid",value:!1})},i=CS(e.sketch({dom:{tag:"div",classes:[n("color-picker-container")],attributes:{role:"presentation"}},onValidHex:o,onInvalidHex:r}));return{dom:{tag:"div"},components:[i.asSpec()],behaviours:ml([tv.config({store:{mode:"manual",getValue:function(t){var n=i.get(t),e=bh.getCurrent(n),o=e.bind((function(t){var n=tv.getValue(t);return n.hex}));return o.map((function(t){return"#"+t})).getOr("")},setValue:function(t,n){var e=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/,o=e.exec(n),r=i.get(t),u=bh.getCurrent(r);u.fold((function(){console.log("Can not find form")}),(function(t){tv.setValue(t,{hex:V.from(o[1]).getOr("")}),FF.getField(t,"hex").each((function(t){Sa(t,Wu())}))}))}}}),jF.self()])}},KF=tinymce.util.Tools.resolve("tinymce.Resource"),JF=function(t){return Tt(t,"init")},$F=function(t){var n=rd(),e=CS({dom:{tag:t.tag}}),o=rd();return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:ml([Lx("custom-editor-events",[Wa((function(r){e.getOpt(r).each((function(e){(JF(t)?t.init(e.element.dom):KF.load(t.scriptId,t.scriptUrl).then((function(n){return n(e.element.dom,t.settings)}))).then((function(t){o.on((function(n){t.setValue(n)})),o.clear(),n.set(t)}))}))}))]),tv.config({store:{mode:"manual",getValue:function(){return n.get().fold((function(){return o.get().getOr("")}),(function(t){return t.getValue()}))},setValue:function(t,e){n.get().fold((function(){o.set(e)}),(function(t){return t.setValue(e)}))}}}),jF.self()]),components:[e.asSpec()]}},QF=tinymce.util.Tools.resolve("tinymce.util.Tools"),ZF=ti([qi("preprocess",w),qi("postprocess",w)]),tI=function(t,n){var e=Si("RepresentingConfigs.memento processors",ZF,n);return tv.config({store:{mode:"manual",getValue:function(n){var o=t.get(n),r=tv.getValue(o);return e.postprocess(r)},setValue:function(n,o){var r=e.preprocess(o),i=t.get(n);tv.setValue(i,r)}}})},nI=function(t,n,e){return tv.config(Sr({store:{mode:"manual",getValue:n,setValue:e}},t.map((function(t){return{store:{initialValue:t}}})).getOr({})))},eI=function(t,n,e){return nI(t,(function(t){return n(t.element)}),(function(t,n){return e(t.element,n)}))},oI=function(t){return eI(t,ds,ms)},rI=function(t){return eI(t,Ya,qa)},iI=function(t){return tv.config({store:{mode:"memory",initialValue:t}})},uI={memento:tI,withElement:eI,withComp:nI,domValue:oI,domHtml:rI,memory:iI},aI="jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp",cI=function(t,n){var e=QF.explode(n.getSetting("images_file_types",aI,"string")),o=function(t){return U(e,(function(n){return jt(t.name.toLowerCase(),"."+n.toLowerCase())}))};return J(mt(t),o)},sI=function(t,n){var e=function(t,n){n.stop()},o=function(t){return function(n,e){Y(t,(function(t){t(n,e)}))}},r=function(t,n){if(!Ph.isDisabled(t)){var e=n.event.raw;u(t,e.dataTransfer.files)}},i=function(t,n){var e=n.event.raw.target;u(t,e.files)},u=function(e,o){tv.setValue(e,cI(o,n)),ka(e,TD,{name:t.name})},a=CS({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:ml([Lx("input-file-events",[za(ju()),za(oa())])])}),c=function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:ml([uI.memory([]),jF.self(),Ph.config({}),pw.config({toggleClass:"dragenter",toggleOnExecute:!1}),Lx("dropzone-events",[Aa("dragenter",o([e,pw.toggle])),Aa("dragleave",o([e,pw.toggle])),Aa("dragover",e),Aa("drop",o([e,r])),Aa(Uu(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:n.translate("Drop an image here")}},kS.sketch({dom:{tag:"button",innerHtml:n.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(t){var n=a.get(t);n.element.dom.click()},buttonBehaviours:ml([yD.config({}),m_.button(n.isDisabled),c_()])})]}]}},s=t.label.map((function(t){return _D(t,n)})),f=pD.parts.field({factory:{sketch:c}});return wD(s,f,["tox-form__group--stretched"],[])},fI=function(t,n){return{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+t.columns+"col"]},components:X(t.items,n.interpreter)}},lI=rc("alloy-fake-before-tabstop"),dI=rc("alloy-fake-after-tabstop"),mI=function(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:ml([Jx.config({ignore:!0}),yD.config({})])}},gI=function(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[mI([lI]),t,mI([dI])],behaviours:ml([jF.childAt(1)])}},pI=function(t,n){ka(t,Nu(),{raw:{which:9,shiftKey:n}})},vI=function(t,n){var e=n.element;cs(e,lI)?pI(t,!0):cs(e,dI)&&pI(t,!1)},hI=function(t){return VE(t,["."+lI,"."+dI].join(","),_)},bI=!(ee().browser.isIE()||ee().browser.isEdge()),yI=function(t){var n=ru("");return{getValue:function(t){return n.get()},setValue:function(e,o){if(t)Ne(e.element,"srcdoc",o);else{Ne(e.element,"src","javascript:''");var r=e.element.dom.contentWindow.document;r.open(),r.write(o),r.close()}n.set(o)}}},xI=function(t,n){var e=bI&&t.sandboxed,o=D(D({},t.label.map((function(t){return{title:t}})).getOr({})),e?{sandbox:"allow-scripts allow-same-origin"}:{}),r=yI(e),i=t.label.map((function(t){return _D(t,n)})),u=function(t){return gI({uid:t.uid,dom:{tag:"iframe",attributes:o},behaviours:ml([yD.config({}),Jx.config({}),uI.withComp(V.none(),r.getValue,r.setValue)])})},a=pD.parts.field({factory:{sketch:u}});return wD(i,a,["tox-form__group--stretched"],[])},wI=function(t,n){return CI(document.createElement("canvas"),t,n)},SI=function(t){var n=wI(t.width,t.height),e=kI(n);return e.drawImage(t,0,0),n},kI=function(t){return t.getContext("2d")},CI=function(t,n,e){return t.width=n,t.height=e,t},OI=function(t){return t.naturalWidth||t.width},_I=function(t){return t.naturalHeight||t.height},TI=function(t){return new XD((function(n,e){var o=URL.createObjectURL(t),r=new Image,i=function(){r.removeEventListener("load",u),r.removeEventListener("error",a)},u=function(){i(),n(r)},a=function(){i(),e("Unable to load data of type "+t.type+": "+o)};r.addEventListener("load",u),r.addEventListener("error",a),r.src=o,r.complete&&setTimeout(u,0)}))},EI=function(t){var n=t.split(","),e=/data:([^;]+)/.exec(n[0]);if(!e)return V.none();for(var o=e[1],r=n[1],i=1024,u=atob(r),a=u.length,c=Math.ceil(a/i),s=new Array(c),f=0;f<c;++f){for(var l=f*i,d=Math.min(l+i,a),m=new Array(d-l),g=l,p=0;g<d;++p,++g)m[p]=u[g].charCodeAt(0);s[f]=new Uint8Array(m)}return V.some(new Blob(s,{type:o}))},DI=function(t){return new XD((function(n,e){EI(t).fold((function(){e("uri is not base64: "+t)}),n)}))},BI=function(t,n,e){return n=n||"image/png",m(HTMLCanvasElement.prototype.toBlob)?new XD((function(o,r){t.toBlob((function(t){t?o(t):r()}),n,e)})):DI(t.toDataURL(n,e))},MI=function(t,n,e){return n=n||"image/png",t.toDataURL(n,e)},AI=function(t){return TI(t).then((function(t){II(t);var n=wI(OI(t),_I(t)),e=kI(n);return e.drawImage(t,0,0),n}))},FI=function(t){return new XD((function(n){var e=new FileReader;e.onloadend=function(){n(e.result)},e.readAsDataURL(t)}))},II=function(t){URL.revokeObjectURL(t.src)},RI=function(t,n,e){var o=n.type,r=x(o),i=function(){return XD.resolve(n)},u=x(e),a=function(){return e.split(",")[1]},c=function(n,e){return t.then((function(t){return BI(t,n,e)}))},s=function(n,e){return t.then((function(t){return MI(t,n,e)}))},f=function(t,n){return s(t,n).then((function(t){return t.split(",")[1]}))},l=function(){return t.then(SI)};return{getType:r,toBlob:i,toDataURL:u,toBase64:a,toAdjustedBlob:c,toAdjustedDataURL:s,toAdjustedBase64:f,toCanvas:l}},VI=function(t){return FI(t).then((function(n){return RI(AI(t),t,n)}))},PI=function(t,n){return BI(t,n).then((function(n){return RI(XD.resolve(t),n,t.toDataURL())}))},HI=function(t){return VI(t)},zI=function(t,n,e){var o="string"===typeof t?parseFloat(t):t;return o>e?o=e:o<n&&(o=n),o},NI=function(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]},LI=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],WI=function(t,n){for(var e,o=[],r=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)o[u]=n[u+5*i];for(u=0;u<5;u++){e=0;for(var a=0;a<5;a++)e+=t[u+5*a]*o[a];r[u+5*i]=e}}return r},UI=function(t,n){var e;return n=zI(n,-1,1),n*=100,n<0?e=127+n/100*127:(e=n%1,e=0===e?LI[n]:LI[Math.floor(n)]*(1-e)+LI[Math.floor(n)+1]*e,e=127*e+127),WI(t,[e/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])},jI=function(t,n){return n=zI(255*n,-255,255),WI(t,[1,0,0,0,n,0,1,0,0,n,0,0,1,0,n,0,0,0,1,0,0,0,0,0,1])},GI=function(t,n,e,o){return n=zI(n,0,2),e=zI(e,0,2),o=zI(o,0,2),WI(t,[n,0,0,0,0,0,e,0,0,0,0,0,o,0,0,0,0,0,1,0,0,0,0,0,1])},XI=function(t,n){return t.toCanvas().then((function(e){return YI(e,t.getType(),n)}))},YI=function(t,n,e){var o=kI(t),r=function(t,n){for(var e,o,r,i,u=t.data,a=n[0],c=n[1],s=n[2],f=n[3],l=n[4],d=n[5],m=n[6],g=n[7],p=n[8],v=n[9],h=n[10],b=n[11],y=n[12],x=n[13],w=n[14],S=n[15],k=n[16],C=n[17],O=n[18],_=n[19],T=0;T<u.length;T+=4)e=u[T],o=u[T+1],r=u[T+2],i=u[T+3],u[T]=e*a+o*c+r*s+i*f+l,u[T+1]=e*d+o*m+r*g+i*p+v,u[T+2]=e*h+o*b+r*y+i*x+w,u[T+3]=e*S+o*k+r*C+i*O+_;return t},i=r(o.getImageData(0,0,t.width,t.height),e);return o.putImageData(i,0,0),PI(t,n)},qI=function(t,n){return t.toCanvas().then((function(e){return KI(e,t.getType(),n)}))},KI=function(t,n,e){var o=kI(t),r=function(t,n,e){for(var o=function(t,n,e){return t>e?t=e:t<n&&(t=n),t},r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=t.data,a=n.data,c=t.width,s=t.height,f=0;f<s;f++)for(var l=0;l<c;l++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var v=0;v<r;v++){var h=o(l+v-i,0,c-1),b=o(f+p-i,0,s-1),y=4*(b*c+h),x=e[p*r+v];d+=u[y]*x,m+=u[y+1]*x,g+=u[y+2]*x}var w=4*(f*c+l);a[w]=o(d,0,255),a[w+1]=o(m,0,255),a[w+2]=o(g,0,255)}return n},i=o.getImageData(0,0,t.width,t.height),u=o.getImageData(0,0,t.width,t.height);return u=r(i,u,e),o.putImageData(u,0,0),PI(t,n)},JI=function(t){var n=function(n,e,o){for(var r=kI(n),i=new Array(256),u=function(t,n){for(var e=t.data,o=0;o<e.length;o+=4)e[o]=n[e[o]],e[o+1]=n[e[o+1]],e[o+2]=n[e[o+2]];return t},a=0;a<i.length;a++)i[a]=t(a,o);var c=u(r.getImageData(0,0,n.width,n.height),i);return r.putImageData(c,0,0),PI(n,e)};return function(t,e){return t.toCanvas().then((function(o){return n(o,t.getType(),e)}))}},$I=function(t){return function(n,e){return XI(n,t(NI(),e))}},QI=function(t){return function(n){return XI(n,t)}},ZI=function(t){return function(n){return qI(n,t)}},tR=QI([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1]),nR=$I(jI),eR=$I(UI),oR=function(t,n,e,o){return XI(t,GI(NI(),n,e,o))},rR=ZI([0,-1,0,-1,5,-1,0,-1,0]),iR=JI((function(t,n){return 255*Math.pow(t/255,1-n)})),uR=function(t,n,e){var o=OI(t),r=_I(t),i=n/o,u=e/r,a=!1;(i<.5||i>2)&&(i=i<.5?.5:2,a=!0),(u<.5||u>2)&&(u=u<.5?.5:2,a=!0);var c=aR(t,i,u);return a?c.then((function(t){return uR(t,n,e)})):c},aR=function(t,n,e){return new XD((function(o){var r=OI(t),i=_I(t),u=Math.floor(r*n),a=Math.floor(i*e),c=wI(u,a),s=kI(c);s.drawImage(t,0,0,r,i,0,0,u,a),o(c)}))},cR=function(t,n){void 0===n&&(n=2);var e=Math.pow(10,n),o=Math.round(t*e);return Math.ceil(o/e)},sR=function(t,n){return t.toCanvas().then((function(e){return fR(e,t.getType(),n)}))},fR=function(t,n,e){var o=e<0?360+e:e,r=o*Math.PI/180,i=t.width,u=t.height,a=Math.sin(r),c=Math.cos(r),s=cR(Math.abs(i*c)+Math.abs(u*a)),f=cR(Math.abs(i*a)+Math.abs(u*c)),l=wI(s,f),d=kI(l);return d.translate(s/2,f/2),d.rotate(r),d.drawImage(t,-i/2,-u/2),PI(l,n)},lR=function(t,n){return t.toCanvas().then((function(e){return dR(e,t.getType(),n)}))},dR=function(t,n,e){var o=wI(t.width,t.height),r=kI(o);return"v"===e?(r.scale(1,-1),r.drawImage(t,0,-o.height)):(r.scale(-1,1),r.drawImage(t,-o.width,0)),PI(o,n)},mR=function(t,n,e,o,r){return t.toCanvas().then((function(i){return gR(i,t.getType(),n,e,o,r)}))},gR=function(t,n,e,o,r,i){var u=wI(r,i),a=kI(u);return a.drawImage(t,-e,-o),PI(u,n)},pR=function(t,n,e){return t.toCanvas().then((function(o){return uR(o,n,e).then((function(n){return PI(n,t.getType())}))}))},vR=function(t){return tR(t)},hR=function(t){return rR(t)},bR=function(t,n){return iR(t,n)},yR=function(t,n,e,o){return oR(t,n,e,o)},xR=function(t,n){return nR(t,n)},wR=function(t,n){return eR(t,n)},SR=function(t,n){return lR(t,n)},kR=function(t,n,e,o,r){return mR(t,n,e,o,r)},CR=function(t,n,e){return pR(t,n,e)},OR=function(t,n){return sR(t,n)},_R=function(t,n,e){return VS(t,{tag:"span",classes:["tox-icon","tox-tbtn__icon-wrap"],behaviours:e},n)},TR=function(t,n){return _R(t,n,[])},ER=function(t,n){return _R(t,n,[zx.config({})])},DR=function(t,n,e){return{dom:{tag:"span",innerHtml:e.translate(t),classes:[n+"__select-label"]},behaviours:ml([zx.config({})])}},BR=rc("toolbar.button.execute"),MR=function(t){return Ga((function(n,e){g_(t,n)((function(e){ka(n,BR,{buttonApi:e}),t.onAction(e)}))}))},AR=(wB={},wB[na()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],wB),FR=rc("update-menu-text"),IR=rc("update-menu-icon"),RR=function(t,n,e){var o=ru(v),r=t.text.map((function(t){return CS(DR(t,n,e.providers))})),i=t.icon.map((function(t){return CS(ER(t,e.providers.icons))})),u=function(t,n){var e=tv.getValue(t);return Jx.focus(e),ka(e,"keydown",{raw:n.event.raw}),PB.close(e),V.some(!0)},a=t.role.fold((function(){return{}}),(function(t){return{role:t}})),c=t.tooltip.fold((function(){return{}}),(function(t){var n=e.providers.translate(t);return{title:n,"aria-label":n}})),s=VS("chevron-down",{tag:"div",classes:[n+"__select-chevron"]},e.providers.icons),f=CS(PB.sketch(D(D(D({},t.uid?{uid:t.uid}:{}),a),{dom:{tag:"button",classes:[n,n+"--select"].concat(X(t.classes,(function(t){return n+"--"+t}))),attributes:D({},c)},components:y_([i.map((function(t){return t.asSpec()})),r.map((function(t){return t.asSpec()})),V.some(s)]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:ml(M(M([],t.dropdownBehaviours,!0),[m_.button((function(){return t.disabled||e.providers.isDisabled()})),c_(),LB.config({}),zx.config({}),Lx("dropdown-events",[p_(t,o),v_(t,o)]),Lx("menubutton-update-display-text",[Aa(FR,(function(t,n){r.bind((function(n){return n.getOpt(t)})).each((function(t){zx.set(t,[ks(e.providers.translate(n.event.text))])}))})),Aa(IR,(function(t,n){i.bind((function(n){return n.getOpt(t)})).each((function(t){zx.set(t,[ER(n.event.icon,e.providers.icons)])}))}))])],!1)),eventOrder:Sr(AR,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:ml([Dx.config({mode:"special",onLeft:u,onRight:u})]),lazySink:e.getSink,toggleClass:n+"--active",parts:{menu:vC(!1,t.columns,t.presets)},fetch:function(n){return tB.nu(k(t.fetch,n))}})));return f.asSpec()},VR=function(t){return i(t)},PR=function(t){return"separator"===t.type},HR=function(t){return Tt(t,"getSubmenuItems")},zR={type:"separator"},NR=function(t,n){var e=Q(t,(function(t,e){return VR(e)?""===e?t:"|"===e?t.length>0&&!PR(t[t.length-1])?t.concat([zR]):t:Tt(n,e.toLowerCase())?t.concat([n[e.toLowerCase()]]):t:t.concat([e])}),[]);return e.length>0&&PR(e[e.length-1])&&e.pop(),e},LR=function(t,n){var e=t.getSubmenuItems(),o=jR(e,n),r=Sr(o.menus,mu(t.value,o.items)),i=Sr(o.expansions,mu(t.value,t.value));return{item:t,menus:r,expansions:i}},WR=function(t,n){return HR(t)?LR(t,n):{item:t,menus:{},expansions:{}}},UR=function(t){if(PR(t))return t;var n=_t(t,"value").getOrThunk((function(){return rc("generated-menu-item")}));return Sr({value:n},t)},jR=function(t,n){var e=NR(i(t)?t.split(" "):t,n);return $(e,(function(t,e){var o=UR(e),r=WR(o,n);return{menus:Sr(t.menus,r.menus),items:[r.item].concat(t.items),expansions:Sr(t.expansions,r.expansions)}}),{menus:{},expansions:{},items:[]})},GR=function(t,n,e,o){var r=rc("primary-menu"),i=jR(t,e.shared.providers.menuItems());if(0===i.items.length)return V.none();var u=ME(r,i.items,n,e,o),a=bt(i.menus,(function(t,o){return ME(o,t,n,e,!1)})),c=Sr(a,mu(r,u));return V.from(Qw.tieredData(r,c,i.expansions))},XR=function(t){return{isDisabled:function(){return Ph.isDisabled(t)},setDisabled:function(n){return Ph.set(t,n)},setActive:function(n){var e=t.element;n?(is(e,"tox-tbtn--enabled"),Ne(e,"aria-pressed",!0)):(as(e,"tox-tbtn--enabled"),Ge(e,"aria-pressed"))},isActive:function(){return cs(t.element,"tox-tbtn--enabled")}}},YR=function(t,n,e,o){return RR({text:t.text,icon:t.icon,tooltip:t.tooltip,role:o,fetch:function(n,o){t.fetch((function(t){o(GR(t,Uk.CLOSE_ON_EXECUTE,e,!1))}))},onSetup:t.onSetup,getApi:XR,columns:1,presets:"normal",classes:[],dropdownBehaviours:[yD.config({})]},n,e.shared)},qR=function(t,n,e){var o=function(t){return function(o){var r=!o.isActive();o.setActive(r),t.storage.set(r),e.shared.getSink().each((function(e){n().getOpt(e).each((function(n){kl(n.element),ka(n,BD,{name:t.name,value:t.storage.get()})}))}))}},r=function(t){return function(n){n.setActive(t.storage.get())}};return function(n){n(X(t,(function(t){var n=t.text.fold((function(){return{}}),(function(t){return{text:t}}));return D(D({type:t.type,active:!1},n),{onAction:o(t),onSetup:r(t)})})))}},KR=function(t,n,e,o,r,i){void 0===e&&(e=[]);var u=n.fold((function(){return{}}),(function(t){return{action:t}})),a=D({buttonBehaviours:ml([m_.button((function(){return t.disabled||i.isDisabled()})),c_(),yD.config({}),Lx("button press",[Ma("click"),Ma("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},u),c=Sr(a,{dom:o});return Sr(c,{components:r})},JR=function(t,n,e,o){void 0===o&&(o=[]);var r=t.tooltip.map((function(t){return{"aria-label":e.translate(t),title:e.translate(t)}})).getOr({}),i={tag:"button",classes:["tox-tbtn"],attributes:r},u=t.icon.map((function(t){return TR(t,e.icons)})),a=y_([u]);return KR(t,n,o,i,a,e)},$R=function(t,n,e,o){void 0===o&&(o=[]);var r=JR(t,V.some(n),e,o);return kS.sketch(r)},QR=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=e.translate(t.text),u=t.icon?t.icon.map((function(t){return TR(t,e.icons)})):V.none(),a=u.isSome()?y_([u]):[],c=u.isSome()?{}:{innerHtml:i},s=M(M(M(M([],t.primary||t.borderless?["tox-button"]:["tox-button","tox-button--secondary"],!0),u.isSome()?["tox-button--icon"]:[],!0),t.borderless?["tox-button--naked"]:[],!0),r,!0),f=D(D({tag:"button",classes:s},c),{attributes:{title:i}});return KR(t,n,o,f,a,e)},ZR=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=QR(t,V.some(n),e,o,r);return kS.sketch(i)},tV=function(t,n){return function(e){"custom"===n?ka(e,BD,{name:t,value:{}}):"submit"===n?Sa(e,MD):"cancel"===n?Sa(e,DD):console.error("Unknown button type: ",n)}},nV=function(t,n){return"menu"===n},eV=function(t,n){return"custom"===n||"cancel"===n||"submit"===n},oV=function(t,n,e){if(nV(t,n)){var o=function(){return u},r=t,i=D(D({},t),{onSetup:function(n){return n.setDisabled(t.disabled),v},fetch:qR(r.items,o,e)}),u=CS(YR(i,"tox-tbtn",e,V.none()));return u.asSpec()}if(eV(t,n)){var a=tV(t.name,n),c=D(D({},t),{borderless:!1});return ZR(c,a,e.shared.providers,[])}console.error("Unknown footer button type: ",n)},rV=function(t,n){var e=tV(t.name,"custom");return SD(V.none(),pD.parts.field(D({factory:kS},QR(t,V.some(e),n,[uI.memory(""),jF.self()]))))},iV=x([qi("field1Name","field1"),qi("field2Name","field2"),ff("onLockedChange"),uf(["lockClass"]),qi("locked",!1),rv.field("coupledFieldBehaviours",[bh,tv])]),uV=function(t,n,e){return qv(t,n,e).bind(bh.getCurrent)},aV=function(t,n){return Fv({factory:pD,name:t,overrides:function(t){return{fieldBehaviours:ml([Lx("coupled-input-behaviour",[Aa(Wu(),(function(e){uV(e,t,n).each((function(n){qv(e,t,"lock").each((function(o){pw.isOn(o)&&t.onLockedChange(e,n,o)}))}))}))])])}}})},cV=x([aV("field1","field2"),aV("field2","field1"),Fv({factory:kS,schema:[Di("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:ml([pw.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),sV=function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:rv.augment(t.coupledFieldBehaviours,[bh.config({find:V.some}),tv.config({store:{mode:"manual",getValue:function(n){var e,o=Zv(n,t,["field1","field2"]);return e={},e[t.field1Name]=tv.getValue(o.field1()),e[t.field2Name]=tv.getValue(o.field2()),e},setValue:function(n,e){var o=Zv(n,t,["field1","field2"]);Et(e,t.field1Name)&&tv.setValue(o.field1(),e[t.field1Name]),Et(e,t.field2Name)&&tv.setValue(o.field2(),e[t.field2Name])}}})]),apis:{getField1:function(n){return qv(n,t,"field1")},getField2:function(n){return qv(n,t,"field2")},getLock:function(n){return qv(n,t,"lock")}}}},fV=mh({name:"FormCoupledInputs",configFields:iV(),partFields:cV(),factory:sV,apis:{getField1:function(t,n){return t.getField1(n)},getField2:function(t,n){return t.getField2(n)},getLock:function(t,n){return t.getLock(n)}}}),lV=function(t){var n={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},e=function(t){return t in n?n[t]:1},o=t.value.toFixed(e(t.unit));return-1!==o.indexOf(".")&&(o=o.replace(/\.?0*$/,"")),o+t.unit},dV=function(t){var n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/,e=n.exec(t);if(null!==e){var o=parseFloat(e[1]),r=e[2];return rr.value({value:o,unit:r})}return rr.error(t)},mV=function(t,n){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},o=function(t){return Tt(e,t)};return t.unit===n?V.some(t.value):o(t.unit)&&o(n)?e[t.unit]===e[n]?V.some(t.value):V.some(t.value/e[t.unit]*e[n]):V.none()},gV=function(t){return V.none()},pV=function(t,n){return function(e){return mV(e,n).map((function(e){return{value:e*t,unit:n}}))}},vV=function(t,n){var e=dV(t).toOptional(),o=dV(n).toOptional();return Ft(e,o,(function(t,n){return mV(t,n.unit).map((function(t){return n.value/t})).map((function(t){return pV(t,n.unit)})).getOr(gV)})).getOr(gV)},hV=function(t,n){var e=gV,o=rc("ratio-event"),r=function(t){return VS(t,{tag:"span",classes:["tox-icon","tox-lock-icon__"+t]},n.icons)},i=fV.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:n.translate(t.label.getOr("Constrain proportions"))}},components:[r("lock"),r("unlock")],buttonBehaviours:ml([Ph.config({disabled:function(){return t.disabled||n.isDisabled()}}),c_(),yD.config({})])}),u=function(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}},a=function(e){return pD.parts.field({factory:WD,inputClasses:["tox-textfield"],inputBehaviours:ml([Ph.config({disabled:function(){return t.disabled||n.isDisabled()}}),c_(),yD.config({}),Lx("size-input-events",[Aa(Hu(),(function(t,n){ka(t,o,{isField1:e})})),Aa(Uu(),(function(n,e){ka(n,TD,{name:t.name})}))])]),selectOnFocus:!1})},c=function(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}},s=fV.parts.field1(u([pD.parts.label(c("Width")),a(!0)])),f=fV.parts.field2(u([pD.parts.label(c("Height")),a(!1)]));return fV.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[s,f,u([c("&nbsp;"),i])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,n,o){dV(tv.getValue(t)).each((function(t){e(t).each((function(t){tv.setValue(n,lV(t))}))}))},coupledFieldBehaviours:ml([Ph.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){fV.getField1(t).bind(pD.getField).each(Ph.disable),fV.getField2(t).bind(pD.getField).each(Ph.disable),fV.getLock(t).each(Ph.disable)},onEnabled:function(t){fV.getField1(t).bind(pD.getField).each(Ph.enable),fV.getField2(t).bind(pD.getField).each(Ph.enable),fV.getLock(t).each(Ph.enable)}}),c_(),Lx("size-input-events2",[Aa(o,(function(t,n){var o=n.event.isField1,r=o?fV.getField1(t):fV.getField2(t),i=o?fV.getField2(t):fV.getField1(t),u=r.map(tv.getValue).getOr(""),a=i.map(tv.getValue).getOr("");e=vV(u,a)}))])])})},bV=x(rc("undo")),yV=x(rc("redo")),xV=x(rc("zoom")),wV=x(rc("back")),SV=x(rc("apply")),kV=x(rc("swap")),CV=x(rc("transform")),OV=x(rc("temp-transform")),_V=x(rc("transform-apply")),TV={undo:bV,redo:yV,zoom:xV,back:wV,apply:SV,swap:kV,transform:CV,tempTransform:OV,transformApply:_V},EV=x("save-state"),DV=x("disable"),BV=x("enable"),MV={formActionEvent:BD,saveState:EV,disable:DV,enable:BV},AV=function(t,n){var e=function(t,e,o,r){return CS(ZR({name:t,text:t,disabled:o,primary:r,icon:V.none(),borderless:!1},e,n))},o=function(t,e,o,r){return CS($R({name:t,icon:V.some(t),tooltip:V.some(e),disabled:r,primary:!1,borderless:!1},o,n))},r=function(t,n){t.map((function(t){var e=t.get(n);e.hasConfigured(Ph)&&Ph.disable(e)}))},i=function(t,n){t.map((function(t){var e=t.get(n);e.hasConfigured(Ph)&&Ph.enable(e)}))},u={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},a=v,c=function(t,n,e){ka(t,n,e)},s=function(t){return Sa(t,MV.disable())},f=function(t){return Sa(t,MV.enable())},l=function(t,n){s(t),c(t,TV.transform(),{transform:n}),f(t)},d=function(t,n){s(t),c(t,TV.tempTransform(),{transform:n}),f(t)},m=function(t){return function(){ut.getOpt(t).each((function(t){zx.set(t,[rt])}))}},g=function(t,n){s(t),c(t,TV.transformApply(),{transform:n,swap:m(t)}),f(t)},p=function(){return e("Back",(function(t){return c(t,TV.back(),{swap:m(t)})}),!1,!1)},h=function(){return CS({dom:{tag:"div",classes:["tox-spacer"]},behaviours:ml([Ph.config({})])})},b=function(){return e("Apply",(function(t){return c(t,TV.apply(),{swap:m(t)})}),!0,!0)},y=function(){return function(n){var e=t.getRect();return kR(n,e.x,e.y,e.w,e.h)}},w=[p(),h(),e("Apply",(function(n){var e=y();g(n,e),t.hideCrop()}),!1,!0)],S=sD.sketch({dom:u,components:w.map((function(t){return t.asSpec()})),containerBehaviours:ml([Lx("image-tools-crop-buttons-events",[Aa(MV.disable(),(function(t,n){r(w,t)})),Aa(MV.enable(),(function(t,n){i(w,t)}))])])}),k=CS(hV({name:"size",label:V.none(),constrain:!0,disabled:!1},n)),C=function(t,n){return function(e){return CR(e,t,n)}},O=[p(),h(),k,h(),e("Apply",(function(t){k.getOpt(t).each((function(n){var e=tv.getValue(n),o=parseInt(e.width,10),r=parseInt(e.height,10),i=C(o,r);g(t,i)}))}),!1,!0)],_=sD.sketch({dom:u,components:O.map((function(t){return t.asSpec()})),containerBehaviours:ml([Lx("image-tools-resize-buttons-events",[Aa(MV.disable(),(function(t,n){r(O,t)})),Aa(MV.enable(),(function(t,n){i(O,t)}))])])}),T=function(t,n){return function(e){return t(e,n)}},E=T(SR,"h"),D=T(SR,"v"),B=T(OR,-90),M=T(OR,90),A=function(t,n){d(t,n)},F=[p(),h(),o("flip-horizontally","Flip horizontally",(function(t){A(t,E)}),!1),o("flip-vertically","Flip vertically",(function(t){A(t,D)}),!1),o("rotate-left","Rotate counterclockwise",(function(t){A(t,B)}),!1),o("rotate-right","Rotate clockwise",(function(t){A(t,M)}),!1),h(),b()],I=sD.sketch({dom:u,components:F.map((function(t){return t.asSpec()})),containerBehaviours:ml([Lx("image-tools-fliprotate-buttons-events",[Aa(MV.disable(),(function(t,n){r(F,t)})),Aa(MV.enable(),(function(t,n){i(F,t)}))])])}),R=function(t,e,o,r,i){var u=SF.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}),a=SF.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),c=SF.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return CS(SF.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:o,maxX:i,getInitialValue:x({x:r})},components:[u,a,c],sliderBehaviours:ml([Jx.config({})]),onChoose:e}))},P=function(t,n,e,o,r){var i=function(t,e,o){var r=T(n,o.x/100);l(t,r)};return R(t,i,e,o,r)},H=function(t,n,e,o,r){return[p(),P(t,n,e,o,r),b()]},z=function(t,n,e,o,a){var c=H(t,n,e,o,a);return sD.sketch({dom:u,components:c.map((function(t){return t.asSpec()})),containerBehaviours:ml([Lx("image-tools-filter-panel-buttons-events",[Aa(MV.disable(),(function(t,n){r(c,t)})),Aa(MV.enable(),(function(t,n){i(c,t)}))])])})},N=[p(),h(),b()],L=sD.sketch({dom:u,components:N.map((function(t){return t.asSpec()}))}),W=z("Brightness",xR,-100,0,100),U=z("Contrast",wR,-100,0,100),j=z("Gamma",bR,-100,0,100),G=function(t,n,e){return function(o){return yR(o,t,n,e)}},X=function(t){var n=function(t,n,e){var o=Y.getOpt(t),r=K.getOpt(t),i=q.getOpt(t);o.each((function(n){r.each((function(e){i.each((function(o){var r=tv.getValue(n).x/100,i=tv.getValue(o).x/100,u=tv.getValue(e).x/100,a=G(r,i,u);l(t,a)}))}))}))};return R(t,n,0,100,200)},Y=X("R"),q=X("G"),K=X("B"),J=[p(),Y,q,K,b()],$=sD.sketch({dom:u,components:J.map((function(t){return t.asSpec()}))}),Q=function(t,n,e){return function(o){var r=function(){ut.getOpt(o).each((function(n){zx.set(n,[t]),e(n)}))};c(o,TV.swap(),{transform:n,swap:r})}},Z=function(n){t.showCrop()},tt=function(n){k.getOpt(n).each((function(n){var e=t.getMeasurements(),o=e.width,r=e.height;tv.setValue(n,{width:o,height:r})}))},nt=V.some(hR),et=V.some(vR),ot=[o("crop","Crop",Q(S,V.none(),Z),!1),o("resize","Resize",Q(_,V.none(),tt),!1),o("orientation","Orientation",Q(I,V.none(),a),!1),o("brightness","Brightness",Q(W,V.none(),a),!1),o("sharpen","Sharpen",Q(L,nt,a),!1),o("contrast","Contrast",Q(U,V.none(),a),!1),o("color-levels","Color levels",Q($,V.none(),a),!1),o("gamma","Gamma",Q(j,V.none(),a),!1),o("invert","Invert",Q(L,et,a),!1)],rt=sD.sketch({dom:u,components:ot.map((function(t){return t.asSpec()}))}),it=sD.sketch({dom:{tag:"div"},components:[rt],containerBehaviours:ml([zx.config({})])}),ut=CS(it),at=function(t){return ut.getOpt(t).map((function(t){var n=t.components()[0];return n.components()[n.components().length-1]}))};return{memContainer:ut,getApplyButton:at}},FV=tinymce.util.Tools.resolve("tinymce.geom.Rect"),IV=tinymce.util.Tools.resolve("tinymce.util.Observable"),RV=tinymce.util.Tools.resolve("tinymce.util.VK"),VV=function(t){var n=Math.max,e=t.documentElement,o=t.body,r=n(e.scrollWidth,o.scrollWidth),i=n(e.clientWidth,o.clientWidth),u=n(e.offsetWidth,o.offsetWidth),a=n(e.scrollHeight,o.scrollHeight),c=n(e.clientHeight,o.clientHeight),s=n(e.offsetHeight,o.offsetHeight);return{width:r<u?i:r,height:a<s?c:a}},PV=function(t){return d(t.changedTouches)},HV=function(t){if(PV(t))for(var n="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<n.length;e++)t[n[e]]=t.changedTouches[0][n[e]]};function zV(t,n){var e,o,r,i,u,a,c,s=[],f=[],l=null!==(e=n.document)&&void 0!==e?e:document,m=null!==(o=n.root)&&void 0!==o?o:l,g=nn.fromDom(l),p=nn.fromDom(m.getElementById(null!==(r=n.handle)&&void 0!==r?r:t)),v=function(t){var e=t.raw,o=VV(l);HV(e),t.prevent(),u=e.button,a=e.screenX,c=e.screenY;var r=$e(p,"cursor");i=nn.fromTag("div",l),Ke(i,{position:"absolute",top:"0",left:"0",width:o.width+"px",height:o.height+"px","z-index":"2147483647",opacity:"0.0001",cursor:r}),Mo(He(g),i),f.push(ud(g,"mousemove",h),ud(g,"touchmove",h),ud(g,"mouseup",b),ud(g,"touchend",b)),n.start(e)},h=function(t){var e=t.raw;if(HV(e),e.button!==u)return b(t);e.deltaX=e.screenX-a,e.deltaY=e.screenY-c,t.prevent(),n.drag(e)},b=function(t){HV(t.raw),Y(f,(function(t){return t.unbind()})),f=[],Vo(i),n.stop&&n.stop(t.raw)},y=function(){Y(f.concat(s),(function(t){return t.unbind()})),f=[],s=[],d(i)&&Vo(i)};return s.push(ud(p,"mousedown",v),ud(p,"touchstart",v)),{destroy:y}}var NV=0,LV=function(t,n,e,o,r){var i,u=[],a="tox-",c=a+"crid-"+NV++,s=nn.fromDom(o),f=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],l=["top","right","bottom","left"],d=function(t,n){return{x:n.x+t.x,y:n.y+t.y,w:n.w,h:n.h}},m=function(t,n){return{x:n.x-t.x,y:n.y-t.y,w:n.w,h:n.h}},g=function(){return m(e,t)},p=function(n,o,r,i){var u=o.x+r*n.deltaX,a=o.y+i*n.deltaY,c=Math.max(20,o.w+r*n.deltaW),s=Math.max(20,o.h+i*n.deltaH),f=t=FV.clamp({x:u,y:a,w:c,h:s},e,"move"===n.name);f=m(e,f),C.fire("updateRect",{rect:f}),w(f)},v=function(){var n=function(n){var e;return zV(c,{document:o.ownerDocument,root:De(s).dom,handle:c+"-"+n.name,start:function(){e=t},drag:function(t){p(n,e,t.deltaX,t.deltaY)}})},e=nn.fromTag("div");Le(e,{id:c,class:a+"croprect-container",role:"grid","aria-dropeffect":"execute"}),Mo(s,e),Y(l,(function(t){Hs(s,"#"+c).each((function(n){var e=nn.fromTag("div");Le(e,{id:c+"-"+t,class:a+"croprect-block","data-mce-bogus":"all"}),qe(e,"display","none"),Mo(n,e)}))})),Y(f,(function(t){Hs(s,"#"+c).each((function(n){var e=nn.fromTag("div");Le(e,{id:c+"-"+t.name,"aria-label":t.label,"aria-grabbed":"false","data-mce-bogus":"all",role:"gridcell",tabindex:"-1",title:t.label}),ss(e,[a+"croprect-handle",a+"croprect-handle-"+t.name]),qe(e,"display","none"),Mo(n,e)}))})),i=X(f,n),b(t);var d=function(t){Ne(t.target,"aria-grabbed","focus"===t.raw.type?"true":"false")},m=function(n){var e;Y(f,(function(t){if(We(n.target,"id")===c+"-"+t.name)return e=t,!1}));var o=function(t,n,o,r,i){t.stopPropagation(),t.preventDefault(),p(e,o,r,i)};switch(n.raw.keyCode){case RV.LEFT:o(n,e,t,-10,0);break;case RV.RIGHT:o(n,e,t,10,0);break;case RV.UP:o(n,e,t,0,-10);break;case RV.DOWN:o(n,e,t,0,10);break;case RV.ENTER:case RV.SPACEBAR:n.prevent(),r();break}};u.push(ud(s,"focusin",d),ud(s,"focusout",d),ud(s,"keydown",m))},h=function(t){var n=M(M([],X(f,(function(t){return"#"+c+"-"+t.name})),!0),X(l,(function(t){return"#"+c+"-"+t})),!0).join(","),e=Km(s,n);Y(e,t?function(t){return eo(t,"display")}:function(t){return qe(t,"display","none")})},b=function(t){var e=function(t,n){Hs(s,"#"+c+"-"+t).each((function(t){Ke(t,{left:n.x+"px",top:n.y+"px",width:Math.max(0,n.w)+"px",height:Math.max(0,n.h)+"px"})}))};Y(f,(function(n){Hs(s,"#"+c+"-"+n.name).each((function(e){Ke(e,{left:t.w*n.xMul+t.x+"px",top:t.h*n.yMul+t.y+"px"})}))})),e("top",{x:n.x,y:n.y,w:n.w,h:t.y-n.y}),e("right",{x:t.x+t.w,y:t.y,w:n.w-t.x-t.w+n.x,h:t.h}),e("bottom",{x:n.x,y:t.y+t.h,w:n.w,h:n.h-t.y-t.h+n.y}),e("left",{x:n.x,y:t.y,w:t.x-n.x,h:t.h}),e("move",t)},y=function(n){t=n,b(t)},x=function(e){n=e,b(t)},w=function(t){y(d(e,t))},S=function(n){e=n,b(t)},k=function(){Y(i,(function(t){return t.destroy()})),i=[],Y(u,(function(t){return t.unbind()})),u=[]};v();var C=D(D({},IV),{toggleVisibility:h,setClampRect:S,setRect:y,getInnerRect:g,setInnerRect:w,setViewPortRect:x,destroy:k});return C},WV={create:LV},UV=function(t){return new uk((function(n){var e=function(){t.removeEventListener("load",e),n(t)};t.complete?n(t):t.addEventListener("load",e)}))},jV=function(t){var n=CS({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),e=ru(1),o=od(),r=ru({x:0,y:0,w:1,h:1}),i=ru({x:0,y:0,w:1,h:1}),u=function(t,i){g.getOpt(t).each((function(t){var u=e.get(),a=bo(t.element),c=uo(t.element),s=i.dom.naturalWidth*u,f=i.dom.naturalHeight*u,l=Math.max(0,a/2-s/2),d=Math.max(0,c/2-f/2),m={left:l.toString()+"px",top:d.toString()+"px",width:s.toString()+"px",height:f.toString()+"px",position:"absolute"};Ke(i,m),n.getOpt(t).each((function(t){Ke(t.element,m)})),o.run((function(t){var n=r.get();t.setRect({x:n.x*u+l,y:n.y*u+d,w:n.w*u,h:n.h*u}),t.setClampRect({x:l,y:d,w:s,h:f}),t.setViewPortRect({x:0,y:0,w:a,h:c})}))}))},a=function(t,n){g.getOpt(t).each((function(t){var o=bo(t.element),r=uo(t.element),i=n.dom.naturalWidth,u=n.dom.naturalHeight,a=Math.min(o/i,r/u);a>=1?e.set(1):e.set(a)}))},c=function(t,n){var e=nn.fromTag("img");return Ne(e,"src",n),UV(e.dom).then((function(){t.getSystem().isConnected()&&g.getOpt(t).map((function(t){var n=Cs({element:e});zx.replaceAt(t,1,V.some(n));var o=i.get(),c={x:0,y:0,w:e.dom.naturalWidth,h:e.dom.naturalHeight};i.set(c);var s=FV.inflate(c,-20,-20);r.set(s),o.w===c.w&&o.h===c.h||a(t,e),u(t,e)}))}))},s=function(t,n){var o=e.get(),r=n>0?Math.min(2,o+.1):Math.max(.1,o-.1);e.set(r),g.getOpt(t).each((function(t){var n=t.components()[1].element;u(t,n)}))},f=function(){o.run((function(t){t.toggleVisibility(!0)}))},l=function(){o.run((function(t){t.toggleVisibility(!1)}))},d=function(){return r.get()},m=sD.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[n.asSpec(),{dom:{tag:"img",attributes:{src:t}}},{dom:{tag:"div"},behaviours:ml([Lx("image-panel-crop-events",[Wa((function(t){g.getOpt(t).each((function(t){var n=t.element.dom,i=WV.create({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},n,v);i.toggleVisibility(!1),i.on("updateRect",(function(t){var n=t.rect,o=e.get(),i={x:Math.round(n.x/o),y:Math.round(n.y/o),w:Math.round(n.w/o),h:Math.round(n.h/o)};r.set(i)})),o.set(i)}))})),Ua((function(){o.clear()}))])])}],containerBehaviours:ml([zx.config({}),Lx("image-panel-events",[Wa((function(n){c(n,t)}))])])}),g=CS(m),p=function(){var t=i.get();return{width:t.w,height:t.h}};return{memContainer:g,updateSrc:c,zoom:s,showCrop:f,hideCrop:l,getRect:d,getMeasurements:p}},GV=function(t,n,e,o,r){return $R({name:t,icon:V.some(n),disabled:e,tooltip:V.some(t),primary:!1,borderless:!1},o,r)},XV=function(t,n){n?Ph.enable(t):Ph.disable(t)},YV=function(t){var n=function(t,n,r){e.getOpt(t).each((function(t){XV(t,n)})),o.getOpt(t).each((function(t){XV(t,r)}))},e=CS(GV("Undo","undo",!0,(function(t){ka(t,TV.undo(),{direction:1})}),t)),o=CS(GV("Redo","redo",!0,(function(t){ka(t,TV.redo(),{direction:1})}),t)),r=sD.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[e.asSpec(),o.asSpec(),GV("Zoom in","zoom-in",!1,(function(t){ka(t,TV.zoom(),{direction:1})}),t),GV("Zoom out","zoom-out",!1,(function(t){ka(t,TV.zoom(),{direction:-1})}),t)]});return{container:r,updateButtonUndoStates:n}};function qV(){var t=[],n=-1,e=function(e){var o=t.splice(++n);return t.push(e),{state:e,removed:o}},o=function(){if(i())return t[--n]},r=function(){if(u())return t[++n]},i=function(){return n>0},u=function(){return-1!==n&&n<t.length-1};return{data:t,add:e,undo:o,redo:r,canUndo:i,canRedo:u}}var KV,JV=function(t){var n=ru(t),e=rd(),o=qV();o.add(t);var r=function(){return n.get()},i=function(t){n.set(t)},u=function(){return e.get().getOrThunk(n.get)},a=function(t){var n=c(t);return l(),e.set(n),n.url},c=function(t){return{blob:t,url:URL.createObjectURL(t)}},s=function(t){URL.revokeObjectURL(t.url)},f=function(t){QF.each(t,s)},l=function(){e.on(s),e.clear()},d=function(t){var n=c(t);i(n);var e=o.add(n).removed;return f(e),n.url},m=function(t){var n=c(t);return e.set(n),n.url},g=function(t){return e.get().fold(v,(function(n){d(n.blob),t()}))},p=function(){var t=o.undo();return i(t),t.url},h=function(){var t=o.redo();return i(t),t.url},b=function(){var t=o.canUndo(),n=o.canRedo();return{undoEnabled:t,redoEnabled:n}};return{getBlobState:r,setBlobState:i,addBlobState:d,getTempState:u,updateTempState:a,addTempState:m,applyTempState:g,destroyTempState:l,undo:p,redo:h,getHistoryStates:b}},$V=function(t,n){var e=JV(t.currentState),o=function(t,n){var e=n.event.direction;C.zoom(t,e)},r=function(t){var n=e.getHistoryStates();O.updateButtonUndoStates(t,n.undoEnabled,n.redoEnabled),ka(t,MV.formActionEvent,{name:MV.saveState(),value:n.undoEnabled})},i=function(t){O.updateButtonUndoStates(t,!1,!1)},u=function(t,n){var o=e.undo();l(t,o).then((function(n){f(t),r(t)}))},a=function(t,n){var o=e.redo();l(t,o).then((function(n){f(t),r(t)}))},c=function(t){return t.toBlob()},s=function(t){ka(t,MV.formActionEvent,{name:MV.disable(),value:{}})},f=function(t){_.getApplyButton(t).each((function(t){Ph.enable(t)})),ka(t,MV.formActionEvent,{name:MV.enable(),value:{}})},l=function(t,n){return s(t),C.updateSrc(t,n)},d=function(t,n,e,o,i){s(t),HI(n).then(e).then(c).then(o).then((function(n){return l(t,n)})).then((function(){r(t),i(),f(t)})).catch((function(n){console.log(n),t.getSystem().isConnected()&&f(t)}))},m=function(t,n,o){var r=e.getBlobState().blob,i=function(t){return e.updateTempState(t)};d(t,r,n,i,o)},g=function(t,n){var o=e.getTempState().blob,r=function(t){return e.addTempState(t)};d(t,o,n,r,v)},p=function(t,n,o){var r=e.getBlobState().blob,i=function(n){var o=e.addBlobState(n);return b(t),o};d(t,r,n,i,o)},h=function(t,n){var o=function(){b(t);var e=n.event.swap;e()};e.applyTempState(o)},b=function(t){var n=e.getBlobState().url;return e.destroyTempState(),r(t),n},y=function(t){var n=b(t);l(t,n).then((function(n){f(t)}))},x=function(t,n){y(t);var e=n.event.swap;e(),C.hideCrop()},w=function(t,n){return m(t,n.event.transform,v)},S=function(t,n){return g(t,n.event.transform)},k=function(t,n){return p(t,n.event.transform,n.event.swap)},C=jV(t.currentState.url),O=YV(n),_=AV(C,n),T=function(t,n){i(t);var e=n.event.transform,o=n.event.swap;e.fold((function(){o()}),(function(n){m(t,n,o)}))};return{dom:{tag:"div",attributes:{role:"presentation"}},components:[_.memContainer.asSpec(),C.memContainer.asSpec(),O.container],behaviours:ml([tv.config({store:{mode:"manual",getValue:function(){return e.getBlobState()}}}),Lx("image-tools-events",[Aa(TV.undo(),u),Aa(TV.redo(),a),Aa(TV.zoom(),o),Aa(TV.back(),x),Aa(TV.apply(),h),Aa(TV.transform(),w),Aa(TV.tempTransform(),S),Aa(TV.transformApply(),k),Aa(TV.swap(),T)]),jF.self()])}},QV=function(t,n){var e={dom:{tag:"label",innerHtml:n.providers.translate(t.label),classes:["tox-label"]}},o=X(t.items,n.interpreter);return{dom:{tag:"div",classes:["tox-form__group"]},components:[e].concat(o),behaviours:ml([jF.self(),zx.config({}),uI.domHtml(V.none()),Dx.config({mode:"acyclic"})])}},ZV=function(t){return!Tt(t,"items")},tP="data-value",nP=function(t,n,e,o){return X(e,(function(e){return ZV(e)?{type:"togglemenuitem",text:e.text,value:e.value,active:e.value===o,onAction:function(){tv.setValue(t,e.value),ka(t,TD,{name:n}),Jx.focus(t)}}:{type:"nestedmenuitem",text:e.text,getSubmenuItems:function(){return nP(t,n,e.items,o)}}}))},eP=function(t,n){return gt(t,(function(t){return ZV(t)?Vt(t.value===n,t):eP(t.items,n)}))},oP=function(t,n){var e=n.shared.providers,o=lt(t.items).filter(ZV),r=t.label.map((function(t){return _D(t,e)})),i=pD.parts.field({dom:{},factory:{sketch:function(e){return RR({uid:e.uid,text:o.map((function(t){return t.text})),icon:V.none(),tooltip:t.label,role:V.none(),fetch:function(e,o){var r=nP(e,t.name,t.items,tv.getValue(e));o(GR(r,Uk.CLOSE_ON_EXECUTE,n,!1))},onSetup:x(v),getApi:x({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[yD.config({}),tv.config({store:{mode:"manual",initialValue:o.map((function(t){return t.value})).getOr(""),getValue:function(t){return We(t.element,tP)},setValue:function(n,e){eP(t.items,e).each((function(t){Ne(n.element,tP,t.value),ka(n,FR,{text:t.text})}))}}})]},"tox-listbox",n.shared)}}}),u={dom:{tag:"div",classes:["tox-listboxfield"]},components:[i]};return pD.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:et([r.toArray(),[u]]),fieldBehaviours:ml([Ph.config({disabled:x(t.disabled),onDisabled:function(t){pD.getField(t).each(Ph.disable)},onEnabled:function(t){pD.getField(t).each(Ph.enable)}})])})},rP=function(t,n){return{dom:{tag:"div",classes:t.classes},components:X(t.items,n.shared.interpreter)}},iP=function(t,n){var e=X(t.options,(function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}})),o=t.data.map((function(t){return mu("initialValue",t)})).getOr({});return{uid:t.uid,dom:{tag:"select",classes:t.selectClasses,attributes:t.selectAttributes},components:e,behaviours:ov(t.selectBehaviours,[Jx.config({}),tv.config({store:D({mode:"manual",getValue:function(t){return ds(t.element)},setValue:function(n,e){var o=tt(t.options,(function(t){return t.value===e}));o.isSome()&&ms(n.element,e)}},o)})])}},uP=dh({name:"HtmlSelect",configFields:[Di("options"),nv("selectBehaviours",[Jx,tv]),qi("selectClasses",[]),qi("selectAttributes",{}),Ni("data")],factory:iP}),aP=function(t,n){var e=X(t.items,(function(t){return{text:n.translate(t.text),value:t.value}})),o=t.label.map((function(t){return _D(t,n)})),r=pD.parts.field({dom:{},selectAttributes:{size:t.size},options:e,factory:uP,selectBehaviours:ml([Ph.config({disabled:function(){return t.disabled||n.isDisabled()}}),yD.config({}),Lx("selectbox-change",[Aa(Uu(),(function(n,e){ka(n,TD,{name:t.name})}))])])}),i=t.size>1?V.none():V.some(VS("chevron-down",{tag:"div",classes:["tox-selectfield__icon-js"]},n.icons)),u={dom:{tag:"div",classes:["tox-selectfield"]},components:et([[r],i.toArray()])};return pD.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:et([o.toArray(),[u]]),fieldBehaviours:ml([Ph.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){pD.getField(t).each(Ph.disable)},onEnabled:function(t){pD.getField(t).each(Ph.enable)}}),c_()])})},cP=function(t,n){var e=function(t){return{dom:{tag:"th",innerHtml:n.translate(t)}}},o=function(t){return{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:X(t,e)}]}},r=function(t){return{dom:{tag:"td",innerHtml:n.translate(t)}}},i=function(t){return{dom:{tag:"tr"},components:X(t,r)}},u=function(t){return{dom:{tag:"tbody"},components:X(t,i)}};return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[o(t.header),u(t.cells)],behaviours:ml([yD.config({}),Jx.config({})])}},sP=function(t,n){var e=t.label.map((function(t){return _D(t,n)})),o=[Ph.config({disabled:function(){return t.disabled||n.isDisabled()}}),c_(),Dx.config({mode:"execution",useEnter:!0!==t.multiline,useControlEnter:!0===t.multiline,execute:function(t){return Sa(t,MD),V.some(!0)}}),Lx("textfield-change",[Aa(Wu(),(function(n,e){ka(n,TD,{name:t.name})})),Aa(Zu(),(function(n,e){ka(n,TD,{name:t.name})}))]),yD.config({})],r=t.validation.map((function(t){return dB.config({getRoot:function(t){return he(t.element)},invalidClass:"tox-invalid",validator:{validate:function(n){var e=tv.getValue(n),o=t.validator(e);return tB.pure(!0===o?rr.value(e):rr.error(o))},validateOnLoad:t.validateOnLoad}})})).toArray(),i=t.placeholder.fold(x({}),(function(t){return{placeholder:n.translate(t)}})),u=t.inputMode.fold(x({}),(function(t){return{inputmode:t}})),a=D(D({},i),u),c=pD.parts.field({tag:!0===t.multiline?"textarea":"input",inputAttributes:a,inputClasses:[t.classname],inputBehaviours:ml(et([o,r])),selectOnFocus:!1,factory:WD}),s=t.flex?["tox-form__group--stretched"]:[],f=s.concat(t.maximized?["tox-form-group--maximize"]:[]),l=[Ph.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){pD.getField(t).each(Ph.disable)},onEnabled:function(t){pD.getField(t).each(Ph.enable)}}),c_()];return wD(e,c,f,l)},fP=function(t,n){return sP({name:t.name,multiline:!1,label:t.label,inputMode:t.inputMode,placeholder:t.placeholder,flex:!1,disabled:t.disabled,classname:"tox-textfield",validation:V.none(),maximized:t.maximized},n)},lP=function(t,n){return sP({name:t.name,multiline:!0,label:t.label,inputMode:V.none(),placeholder:t.placeholder,flex:!0,disabled:t.disabled,classname:"tox-textarea",validation:V.none(),maximized:t.maximized},n)},dP=function(t,n){var e=t.stream.streams,o=e.setup(t,n);return Ea([Aa(t.event,o),Ua((function(){return n.cancel()}))].concat(t.cancelEvent.map((function(t){return[Aa(t,(function(){return n.cancel()}))]})).getOr([])))},mP=Object.freeze({__proto__:null,events:dP}),gP=function(t){var n=ru(null),e=function(){return{timer:null!==n.get()?"set":"unset"}},o=function(t){n.set(t)},r=function(){var t=n.get();null!==t&&t.cancel()};return Oc({readState:e,setTimer:o,cancel:r})},pP=function(t){return t.stream.streams.state(t)},vP=Object.freeze({__proto__:null,throttle:gP,init:pP}),hP=function(t,n){var e=t.stream,o=jS(t.onStream,e.delay);return n.setTimer(o),function(t,n){o.throttle(t,n),e.stopEvent&&n.stop()}},bP=[Bi("stream",Ci("mode",{throttle:[Di("delay"),qi("stopEvent",!0),df("streams",{setup:hP,state:gP})]})),qi("event","input"),Ni("cancelEvent"),ff("onStream")],yP=pl({fields:bP,name:"streaming",active:mP,state:vP}),xP=function(t,n,e){var o=tv.getValue(e);tv.setValue(n,o),SP(n)},wP=function(t,n){var e=t.element,o=ds(e),r=e.dom;"number"!==We(e,"type")&&n(r,o)},SP=function(t){wP(t,(function(t,n){return t.setSelectionRange(n.length,n.length)}))},kP=function(t,n){wP(t,(function(t,e){return t.setSelectionRange(n,e.length)}))},CP=function(t,n,e){if(t.selectsOver){var o=tv.getValue(n),r=t.getDisplayText(o),i=tv.getValue(e),u=t.getDisplayText(i);return 0===u.indexOf(r)?V.some((function(){xP(t,n,e),kP(n,r.length)})):V.none()}return V.none()},OP=x("alloy.typeahead.itemexecute"),_P=function(t,n,e,o){var r=function(n,e,r){t.previewing.set(!1);var i=bB.getCoupled(n,"sandbox");if(bp.isOpen(i))bh.getCurrent(i).each((function(t){ob.getHighlighted(t).fold((function(){r(t)}),(function(){Ta(i,t.element,"keydown",e)}))}));else{var a=function(t){bh.getCurrent(t).each(r)};OB(t,u(n),n,i,o,a,GD.HighlightFirst).get(v)}},i=HD(t),u=function(t){return function(n){return n.map((function(n){var e=Ot(n.menus),o=ot(e,(function(t){return J(t.items,(function(t){return"item"===t.type}))})),r=tv.getState(t);return r.update(X(o,(function(t){return t.data}))),n}))}},a=[Jx.config({}),tv.config({onSetValue:t.onSetValue,store:D({mode:"dataset",getDataKey:function(t){return ds(t.element)},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(n,e){ms(n.element,t.model.getDisplayText(e))}},t.initialData.map((function(t){return mu("initialValue",t)})).getOr({}))}),yP.config({stream:{mode:"throttle",delay:t.responseTime,stopEvent:!1},onStream:function(n,e){var r=bB.getCoupled(n,"sandbox"),i=Jx.isFocused(n);if(i&&ds(n.element).length>=t.minChars){var a=bh.getCurrent(r).bind((function(t){return ob.getHighlighted(t).map(tv.getValue)}));t.previewing.set(!0);var c=function(n){bh.getCurrent(r).each((function(n){a.fold((function(){t.model.selectsOver&&ob.highlightFirst(n)}),(function(t){ob.highlightBy(n,(function(n){var e=tv.getValue(n);return e.value===t.value})),ob.getHighlighted(n).orThunk((function(){return ob.highlightFirst(n),V.none()}))}))}))};OB(t,u(n),n,r,o,c,GD.HighlightFirst).get(v)}},cancelEvent:ua()}),Dx.config({mode:"special",onDown:function(t,n){return r(t,n,ob.highlightFirst),V.some(!0)},onEscape:function(t){var n=bB.getCoupled(t,"sandbox");return bp.isOpen(n)?(bp.close(n),V.some(!0)):V.none()},onUp:function(t,n){return r(t,n,ob.highlightLast),V.some(!0)},onEnter:function(n){var e=bB.getCoupled(n,"sandbox"),o=bp.isOpen(e);if(o&&!t.previewing.get())return bh.getCurrent(e).bind((function(t){return ob.getHighlighted(t)})).map((function(t){return ka(n,OP(),{item:t}),!0}));var r=tv.getValue(n);return Sa(n,ua()),t.onExecute(e,n,r),o&&bp.close(e),V.some(!0)}}),pw.config({toggleClass:t.markers.openClass,aria:{mode:"expanded"}}),bB.config({others:{sandbox:function(n){return MB(t,n,{onOpen:function(){return pw.on(n)},onClose:function(){return pw.off(n)}})}}}),Lx("typeaheadevents",[Ga((function(n){var e=v;TB(t,u(n),n,o,e,GD.HighlightFirst).get(v)})),Aa(OP(),(function(n,e){var o=bB.getCoupled(n,"sandbox");xP(t.model,n,e.event.item),Sa(n,ua()),t.onItemExecute(n,o,e.event.item,tv.getValue(n)),bp.close(o),SP(n)}))].concat(t.dismissOnBlur?[Aa(Qu(),(function(t){var n=bB.getCoupled(t,"sandbox");Tl(n.element).isNone()&&bp.close(n)}))]:[]))];return{uid:t.uid,dom:ND(Sr(t,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:D(D({},i),ov(t.typeaheadBehaviours,a)),eventOrder:t.eventOrder}},TP=x([Ni("lazySink"),Di("fetch"),qi("minChars",5),qi("responseTime",1e3),cf("onOpen"),qi("getHotspot",V.some),qi("getAnchorOverrides",x({})),qi("layouts",V.none()),qi("eventOrder",{}),ou("model",{},[qi("getDisplayText",(function(t){return void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.value})),qi("selectsOver",!0),qi("populateFromBrowse",!0)]),cf("onSetValue"),sf("onExecute"),cf("onItemExecute"),qi("inputClasses",[]),qi("inputAttributes",{}),qi("inputStyles",{}),qi("matchWidth",!0),qi("useMinWidth",!1),qi("dismissOnBlur",!0),uf(["openClass"]),Ni("initialData"),nv("typeaheadBehaviours",[Jx,tv,yP,Dx,pw,bB]),Ti("previewing",(function(){return ru(!0)}))].concat(PD()).concat(FB())),EP=x([Iv({schema:[rf()],name:"menu",overrides:function(t){return{fakeFocus:!0,onHighlight:function(n,e){t.previewing.get()?n.getSystem().getByUid(t.uid).each((function(o){CP(t.model,o,e).fold((function(){return ob.dehighlight(n,e)}),(function(t){return t()}))})):n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&xP(t.model,n,e)})),t.previewing.set(!1)},onExecute:function(n,e){return n.getSystem().getByUid(t.uid).toOptional().map((function(t){return ka(t,OP(),{item:e}),!0}))},onHover:function(n,e){t.previewing.set(!1),n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&xP(t.model,n,e)}))}}}})]),DP=mh({name:"Typeahead",configFields:TP(),partFields:EP(),factory:_P}),BP=function(t){var n=function(){return BP(t.toCached())},e=function(n){return BP(t.bind((function(t){return t.fold((function(t){return tB.pure(rr.error(t))}),(function(t){return n(t)}))})))},o=function(n){return BP(t.map((function(t){return t.bind(n)})))},r=function(n){return BP(t.map((function(t){return t.map(n)})))},i=function(n){return BP(t.map((function(t){return t.mapError(n)})))},u=function(n,e){return t.map((function(t){return t.fold(n,e)}))},a=function(n,e){return BP(tB.nu((function(o){var r=!1,i=setTimeout((function(){r=!0,o(rr.error(e()))}),n);t.get((function(t){r||(clearTimeout(i),o(t))}))})))};return D(D({},t),{toCached:n,bindFuture:e,bindResult:o,mapResult:r,mapError:i,foldResult:u,withTimeout:a})},MP=function(t){return BP(tB.nu(t))},AP=function(t){return BP(tB.pure(rr.value(t)))},FP=function(t){return BP(tB.pure(rr.error(t)))},IP=function(t){return BP(tB.pure(t))},RP=function(t){return BP(t.map(rr.value))},VP=function(t){return MP((function(n){t.then((function(t){n(rr.value(t))}),(function(t){n(rr.error(t))}))}))},PP={nu:MP,wrap:BP,pure:AP,value:AP,error:FP,fromResult:IP,fromFuture:RP,fromPromise:VP},HP={type:"separator"},zP=function(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:v}},NP=function(t,n){return{type:"menuitem",value:n,text:t,meta:{attach:void 0},onAction:v}},LP=function(t){return X(t,zP)},WP=function(t,n){return J(n,(function(n){return n.type===t}))},UP=function(t,n){return LP(WP(t,n))},jP=function(t){return UP("header",t.targets)},GP=function(t){return UP("anchor",t.targets)},XP=function(t){return V.from(t.anchorTop).map((function(t){return NP("<top>",t)})).toArray()},YP=function(t){return V.from(t.anchorBottom).map((function(t){return NP("<bottom>",t)})).toArray()},qP=function(t){return X(t,(function(t){return NP(t,t)}))},KP=function(t){return Q(t,(function(t,n){var e=0===t.length||0===n.length;return e?t.concat(n):t.concat(HP,n)}),[])},JP=function(t,n){var e=t.toLowerCase();return J(n,(function(t){var n=void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.text;return Wt(n.toLowerCase(),e)||Wt(t.value.toLowerCase(),e)}))},$P=function(t,n,e){var o=tv.getValue(n),r=void 0!==o.meta.text?o.meta.text:o.value,i=e.getLinkInformation();return i.fold((function(){return[]}),(function(n){var o=JP(r,qP(e.getHistory(t)));return"file"===t?KP([o,JP(r,jP(n)),JP(r,et([XP(n),GP(n),YP(n)]))]):o}))},QP=rc("aria-invalid"),ZP=function(t,n,e){var o,r=n.shared.providers,i=function(n){var o=tv.getValue(n);e.addToHistory(o.value,t.filetype)},u=pD.parts.field({factory:DP,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":QP,type:"url"},minChars:0,responseTime:0,fetch:function(o){var r=$P(t.filetype,o,e),i=GR(r,Uk.BUBBLE_TO_SANDBOX,n,!1);return tB.pure(i)},getHotspot:function(t){return m.getOpt(t)},onSetValue:function(t,n){t.hasConfigured(dB)&&dB.run(t).get(v)},typeaheadBehaviours:ml(et([e.getValidationHandler().map((function(n){return dB.config({getRoot:function(t){return he(t.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(t,n){s.getOpt(t).each((function(t){Ne(t.element,"title",r.translate(n))}))}},validator:{validate:function(e){var o=tv.getValue(e);return PP.nu((function(e){n({type:t.filetype,url:o.value},(function(t){if("invalid"===t.status){var n=rr.error(t.message);e(n)}else{var o=rr.value(t.message);e(o)}}))}))},validateOnLoad:!1}})})).toArray(),[Ph.config({disabled:function(){return t.disabled||r.isDisabled()}}),yD.config({}),Lx("urlinput-events",et(["file"===t.filetype?[Aa(Wu(),(function(n){ka(n,TD,{name:t.name})}))]:[],[Aa(Uu(),(function(n){ka(n,TD,{name:t.name}),i(n)})),Aa(Zu(),(function(n){ka(n,TD,{name:t.name}),i(n)}))]]))]])),eventOrder:(o={},o[Wu()]=["streaming","urlinput-events","invalidating"],o),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:n.shared.getSink,parts:{menu:vC(!1,1,"normal")},onExecute:function(t,n,e){ka(n,MD,{})},onItemExecute:function(n,e,o,r){i(n),ka(n,TD,{name:t.name})}}),a=t.label.map((function(t){return _D(t,r)})),c=function(t,n,e,o){return void 0===e&&(e=t),void 0===o&&(o=t),VS(e,{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+t],attributes:D({title:r.translate(o),"aria-live":"polite"},n.fold((function(){return{}}),(function(t){return{id:t}})))},r.icons)},s=CS(c("invalid",V.some(QP),"warning")),f=CS({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[s.asSpec()]}),l=e.getUrlPicker(t.filetype),d=rc("browser.url.event"),m=CS({dom:{tag:"div",classes:["tox-control-wrap"]},components:[u,f.asSpec()],behaviours:ml([Ph.config({disabled:function(){return t.disabled||r.isDisabled()}})])}),g=CS(ZR({name:t.name,icon:V.some("browse"),text:t.label.getOr(""),disabled:t.disabled,primary:!1,borderless:!0},(function(t){return Sa(t,d)}),r,[],["tox-browse-url"])),p=function(){return{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:et([[m.asSpec()],l.map((function(){return g.asSpec()})).toArray()])}},h=function(n){bh.getCurrent(n).each((function(e){var o=tv.getValue(e),r=D({fieldname:t.name},o);l.each((function(o){o(r).get((function(o){tv.setValue(e,o),ka(n,TD,{name:t.name})}))}))}))};return pD.sketch({dom:CD(),components:a.toArray().concat([p()]),fieldBehaviours:ml([Ph.config({disabled:function(){return t.disabled||r.isDisabled()},onDisabled:function(t){pD.getField(t).each(Ph.disable),g.getOpt(t).each(Ph.disable)},onEnabled:function(t){pD.getField(t).each(Ph.enable),g.getOpt(t).each(Ph.enable)}}),c_(),Lx("url-input-events",[Aa(d,h)])])})},tH=function(t,n){return sD.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+t.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[kS.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:MS(t.icon,n.icons),attributes:{title:n.translate(t.iconTooltip)}},action:function(n){ka(n,BD,{name:"alert-banner",value:t.url})},buttonBehaviours:ml([IS()])})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:n.translate(t.text)}}]})},nH=function(t,n){var e=tv.config({store:{mode:"manual",getValue:function(t){var n=t.element.dom;return n.checked},setValue:function(t,n){var e=t.element.dom;e.checked=n}}}),o=function(t){return t.element.dom.click(),V.some(!0)},r=pD.parts.field({factory:{sketch:w},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:ml([jF.self(),Ph.config({disabled:function(){return t.disabled||n.isDisabled()}}),yD.config({}),Jx.config({}),e,Dx.config({mode:"special",onEnter:o,onSpace:o,stopSpaceKeyup:!0}),Lx("checkbox-events",[Aa(Uu(),(function(n,e){ka(n,TD,{name:t.name})}))])])}),i=pD.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:n.translate(t.label)},behaviours:ml([LB.config({})])}),u=function(t){var e="checked"===t?"selected":"unselected";return VS(e,{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t]},n.icons)},a=CS({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[u("checked"),u("unchecked")]});return pD.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[r,a.asSpec(),i],fieldBehaviours:ml([Ph.config({disabled:function(){return t.disabled||n.isDisabled()},disableClass:"tox-checkbox--disabled",onDisabled:function(t){pD.getField(t).each(Ph.disable)},onEnabled:function(t){pD.getField(t).each(Ph.enable)}}),c_()])})},eH=function(t){return"presentation"===t.presets?sD.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):sD.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:ml([yD.config({}),Jx.config({})])})},oH=function(t){return function(n,e,o){return _t(e,"name").fold((function(){return t(e,o)}),(function(r){return n.field(r,t(e,o))}))}},rH=function(t){return function(n,e,o){var r=Sr(e,{source:"dynamic"});return oH(t)(n,r,o)}},iH={bar:oH((function(t,n){return lD(t,n.shared)})),collection:oH((function(t,n){return VD(t,n.shared.providers)})),alertbanner:oH((function(t,n){return tH(t,n.shared.providers)})),input:oH((function(t,n){return fP(t,n.shared.providers)})),textarea:oH((function(t,n){return lP(t,n.shared.providers)})),label:oH((function(t,n){return QV(t,n.shared)})),iframe:rH((function(t,n){return xI(t,n.shared.providers)})),button:oH((function(t,n){return rV(t,n.shared.providers)})),checkbox:oH((function(t,n){return nH(t,n.shared.providers)})),colorinput:oH((function(t,n){return XB(t,n.shared,n.colorinput)})),colorpicker:oH(qF),dropzone:oH((function(t,n){return sI(t,n.shared.providers)})),grid:oH((function(t,n){return fI(t,n.shared)})),listbox:oH((function(t,n){return oP(t,n)})),selectbox:oH((function(t,n){return aP(t,n.shared.providers)})),sizeinput:oH((function(t,n){return hV(t,n.shared.providers)})),urlinput:oH((function(t,n){return ZP(t,n,n.urlinput)})),customeditor:oH($F),htmlpanel:oH(eH),imagetools:oH((function(t,n){return $V(t,n.shared.providers)})),table:oH((function(t,n){return cP(t,n.shared.providers)})),panel:oH((function(t,n){return rP(t,n)}))},uH={field:function(t,n){return n}},aH=function(t,n,e){var o=Sr(e,{shared:{interpreter:function(n){return cH(t,n,o)}}});return cH(t,n,o)},cH=function(t,n,e){return _t(iH,n.type).fold((function(){return console.error('Unknown factory type "'+n.type+'", defaulting to container: ',n),n}),(function(o){return o(t,n,e)}))},sH=function(t,n){var e=uH;return cH(e,t,n)},fH={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},lH=function(t,n,e){var o=12,r={maxHeightFunction:Td()},i=function(){return{type:"node",root:Be(t()),node:V.from(t()),bubble:Ad(o,o,fH),layouts:{onRtl:function(){return[dS]},onLtr:function(){return[lS]}},overrides:r}},u=function(){return{type:"hotspot",hotspot:n(),bubble:Ad(-o,o,fH),layouts:{onRtl:function(){return[Wf]},onLtr:function(){return[Uf]}},overrides:r}};return function(){return e()?i():u()}},dH=function(t,n,e){var o=function(){return{type:"node",root:Be(t()),node:V.from(t()),layouts:{onRtl:function(){return[mS]},onLtr:function(){return[mS]}}}},r=function(){return{type:"hotspot",hotspot:n(),layouts:{onRtl:function(){return[Yf]},onLtr:function(){return[Yf]}}}};return function(){return e()?o():r()}},mH=function(t,n){return function(){return{type:"selection",root:n(),getSelection:function(){var n=t.selection.getRng();return V.some(Cm.range(nn.fromDom(n.startContainer),n.startOffset,nn.fromDom(n.endContainer),n.endOffset))}}}},gH=function(t){return function(n){return{type:"node",root:t(),node:n}}},pH=function(t,n,e){var o=WO(t),r=function(){return nn.fromDom(t.getBody())},i=function(){return nn.fromDom(t.getContentAreaContainer())},u=function(){return o||!e()};return{inlineDialog:lH(i,n,u),banner:dH(i,n,u),cursor:mH(t,r),node:gH(r)}},vH=function(t){return function(n,e){var o=tE(t);o(n,e)}},hH=function(t){return function(){return RT(t)}},bH=function(t){return function(){return PT(t)}},yH=function(t){return function(){return XT(t)}},xH=function(t){return{colorPicker:vH(t),hasCustomColors:hH(t),getColors:bH(t),getColorCols:yH(t)}},wH=function(t){return function(){return YO(t)}},SH=function(t){return{isDraggableModal:wH(t)}},kH=function(t){var n=ru(PO(t)?"bottom":"top");return{isPositionedAtTop:function(){return"top"===n.get()},getDockingMode:n.get,setDockingMode:n.set}},CH=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],OH=function(t){return Tt(t,"items")},_H=function(t){return Tt(t,"block")},TH=function(t){return Tt(t,"inline")},EH=function(t){return Tt(t,"selector")},DH=function(t){return Q(t,(function(t,n){if(OH(n)){var e=DH(n.items);return{customFormats:t.customFormats.concat(e.customFormats),formats:t.formats.concat([{title:n.title,items:e.formats}])}}if(TH(n)||_H(n)||EH(n)){var o=i(n.name)?n.name:n.title.toLowerCase(),r="custom-"+o;return{customFormats:t.customFormats.concat([{name:r,format:n}]),formats:t.formats.concat([{title:n.title,format:r,icon:n.icon}])}}return D(D({},t),{formats:t.formats.concat(n)})}),{customFormats:[],formats:[]})},BH=function(t,n){var e=DH(n),o=function(n){Y(n,(function(n){t.formatter.has(n.name)||t.formatter.register(n.name,n.format)}))};return t.formatter?o(e.customFormats):t.on("init",(function(){o(e.customFormats)})),e.formats},MH=function(t){return kO(t).map((function(n){var e=BH(t,n);return CO(t)?CH.concat(e):e})).getOr(CH)},AH=function(t,n,e){var o={type:"formatter",isSelected:n(t.format),getStylePreview:e(t.format)};return Sr(t,o)},FH=function(t,n,e,o){var r=function(t){return AH(t,e,o)},u=function(t){var n={type:"submenu"};return Sr(t,n)},a=function(n){var r=i(n.name)?n.name:rc(n.title),u="custom-"+r,a={type:"formatter",format:u,isSelected:e(u),getStylePreview:o(u)},c=Sr(n,a);return t.formatter.register(r,c),c},c=function(t){return X(t,(function(t){var n=pt(t);if(Et(t,"items")){var e=c(t.items);return Sr(u(t),{getStyleItems:x(e)})}return Et(t,"format")?r(t):1===n.length&&W(n,"title")?Sr(t,{type:"separator"}):a(t)}))};return c(n)},IH=function(t){var n=function(n){return function(){return t.formatter.match(n)}},e=function(n){return function(){var e=t.formatter.get(n);return void 0!==e?V.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):V.none()}},o=function(t){var n=t.items;return void 0!==n&&n.length>0?ot(n,o):[t.format]},r=ru([]),i=ru([]),u=ru([]),a=ru([]),c=ru(!1);t.on("PreInit",(function(u){var a=MH(t),c=FH(t,a,n,e);r.set(c),i.set(ot(c,o))})),t.on("addStyleModifications",(function(r){var i=FH(t,r.items,n,e);u.set(i),c.set(r.replace),a.set(ot(i,o))}));var s=function(){var t=c.get()?[]:r.get(),n=u.get();return t.concat(n)},f=function(){var t=c.get()?[]:i.get(),n=a.get();return t.concat(n)};return{getData:s,getFlattenedKeys:f}},RH=function(t){return d(t)&&1===t.nodeType},VH=QF.trim,PH=function(t){return function(n){if(RH(n)){if(n.contentEditable===t)return!0;if(n.getAttribute("data-mce-contenteditable")===t)return!0}return!1}},HH=PH("true"),zH=PH("false"),NH=function(t,n,e,o,r){return{type:t,title:n,url:e,level:o,attach:r}},LH=function(t){while(t=t.parentNode){var n=t.contentEditable;if(n&&"inherit"!==n)return HH(t)}return!1},WH=function(t,n){return X(Km(nn.fromDom(n),t),(function(t){return t.dom}))},UH=function(t){return t.innerText||t.textContent},jH=function(t){return t.id?t.id:rc("h")},GH=function(t){return t&&"A"===t.nodeName&&void 0!==(t.id||t.name)},XH=function(t){return GH(t)&&qH(t)},YH=function(t){return t&&/^(H[1-6])$/.test(t.nodeName)},qH=function(t){return LH(t)&&!zH(t)},KH=function(t){return YH(t)&&qH(t)},JH=function(t){return YH(t)?parseInt(t.nodeName.substr(1),10):0},$H=function(t){var n=jH(t),e=function(){t.id=n};return NH("header",UH(t),"#"+n,JH(t),e)},QH=function(t){var n=t.id||t.name,e=UH(t);return NH("anchor",e||"#"+n,"#"+n,0,v)},ZH=function(t){return X(J(t,KH),$H)},tz=function(t){return X(J(t,XH),QH)},nz=function(t){var n=WH("h1,h2,h3,h4,h5,h6,a:not([href])",t);return n},ez=function(t){return VH(t.title).length>0},oz=function(t){var n=nz(t);return J(ZH(n).concat(tz(n)),ez)},rz={find:oz},iz="tinymce-url-history",uz=5,az=function(t){return i(t)&&/^https?/.test(t)},cz=function(t){return a(t)&&t.length<=uz&&rt(t,az)},sz=function(t){return u(t)&&Ct(t,(function(t){return!cz(t)})).isNone()},fz=function(){var t,n=_T.getItem(iz);if(null===n)return{};try{t=JSON.parse(n)}catch(e){if(e instanceof SyntaxError)return console.log("Local storage "+iz+" was not valid JSON",e),{};throw e}return sz(t)?t:(console.log("Local storage "+iz+" was not valid format",t),{})},lz=function(t){if(!sz(t))throw new Error("Bad format for history:\n"+JSON.stringify(t));_T.setItem(iz,JSON.stringify(t))},dz=function(t){var n=fz();return _t(n,t).getOr([])},mz=function(t,n){if(az(t)){var e=fz(),o=_t(e,n).getOr([]),r=J(o,(function(n){return n!==t}));e[n]=[t].concat(r).slice(0,uz),lz(e)}},gz=function(t){return!!t},pz=function(t){return bt(QF.makeMap(t,/[, ]/),gz)},vz=function(t){return V.from($O(t)).filter(m)},hz=function(t){var n=V.some(QO(t)).filter(gz),e=V.some(ZO(t)).filter(gz),o=n.or(e).map(pz);return vz(t).fold(_,(function(t){return o.fold(T,(function(t){return pt(t).length>0&&t}))}))},bz=function(t,n){var e=hz(t);return s(e)?e?vz(t):V.none():e[n]?vz(t):V.none()},yz=function(t,n){return bz(t,n).map((function(e){return function(o){return tB.nu((function(r){var a=function(t,n){if(!i(t))throw new Error("Expected value to be string");if(void 0!==n&&!u(n))throw new Error("Expected meta to be a object");var e={value:t,meta:n};r(e)},c=D({filetype:n,fieldname:o.fieldname},V.from(o.meta).getOr({}));e.call(t,a,o.value,c)}))}}))},xz=function(t){return V.from(t).filter(i).getOrUndefined()},wz=function(t){return t_(t)?V.none():V.some({targets:rz.find(t.getBody()),anchorTop:xz(n_(t)),anchorBottom:xz(e_(t))})},Sz=function(t){return V.from(o_(t))},kz=function(t){return{getHistory:dz,addToHistory:mz,getLinkInformation:function(){return wz(t)},getValidationHandler:function(){return Sz(t)},getUrlPicker:function(n){return yz(t,n)}}},Cz=function(t,n,e){var o=ru(!1),r=kH(n),i={shared:{providers:{icons:function(){return n.ui.registry.getAll().icons},menuItems:function(){return n.ui.registry.getAll().menuItems},translate:OS.translate,isDisabled:function(){return n.mode.isReadOnly()||n.ui.isDisabled()},getSetting:n.getParam.bind(n)},interpreter:function(t){return sH(t,i)},anchors:pH(n,e,r.isPositionedAtTop),header:r,getSink:function(){return rr.value(t)}},urlinput:kz(n),styleselect:IH(n),colorinput:xH(n),dialog:SH(n),isContextMenuOpen:function(){return o.get()},setContextMenuState:function(t){return o.set(t)}};return i},Oz=function(t,n,e){var o=function(t,o){Y([n,e],(function(n){n.broadcastEvent(t,o)}))},r=function(t,o){Y([n,e],(function(n){n.broadcastOn([t],o)}))},i=function(t){return r(yp(),{target:t.target})},u=Sl(),a=ud(u,"touchstart",i),c=ud(u,"touchmove",(function(t){return o(ca(),t)})),s=ud(u,"touchend",(function(t){return o(sa(),t)})),f=ud(u,"mousedown",i),l=ud(u,"mouseup",(function(t){0===t.raw.button&&r(wp(),{target:t.target})})),d=function(t){return r(yp(),{target:nn.fromDom(t.target)})},m=function(t){0===t.button&&r(wp(),{target:nn.fromDom(t.target)})},g=function(){Y(t.editorManager.get(),(function(n){t!==n&&n.fire("DismissPopups",{relatedTarget:t})}))},p=function(t){return o(fa(),cd(t))},v=function(t){r(xp(),{}),o(la(),cd(t))},h=function(){return r(xp(),{})},b=function(n){n.state&&r(yp(),{target:nn.fromDom(t.getContainer())})},y=function(t){r(yp(),{target:nn.fromDom(t.relatedTarget.getContainer())})};t.on("PostRender",(function(){t.on("click",d),t.on("tap",d),t.on("mouseup",m),t.on("mousedown",g),t.on("ScrollWindow",p),t.on("ResizeWindow",v),t.on("ResizeEditor",h),t.on("AfterProgressState",b),t.on("DismissPopups",y)})),t.on("remove",(function(){t.off("click",d),t.off("tap",d),t.off("mouseup",m),t.off("mousedown",g),t.off("ScrollWindow",p),t.off("ResizeWindow",v),t.off("ResizeEditor",h),t.off("AfterProgressState",b),t.off("DismissPopups",y),f.unbind(),a.unbind(),c.unbind(),s.unbind(),l.unbind()})),t.on("detach",(function(){Qg(n),Qg(e),n.destroy(),e.destroy()}))},_z=eh,Tz=Hv,Ez=x([qi("shell",!1),Di("makeItem"),qi("setupItem",v),rv.field("listBehaviours",[zx])]),Dz=function(){return{behaviours:ml([zx.config({})])}},Bz=Rv({name:"items",overrides:Dz}),Mz=x([Bz]),Az=x("CustomList"),Fz=function(t,n,e,o){var r=function(n,e){u(n).fold((function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")}),(function(o){var r=zx.contents(o),i=e.length,u=i-r.length,a=u>0?j(u,(function(){return t.makeItem()})):[],c=r.slice(i);Y(c,(function(t){return zx.remove(o,t)})),Y(a,(function(t){return zx.append(o,t)}));var s=zx.contents(o);Y(s,(function(o,r){t.setupItem(n,o,e[r],r)}))}))},i=t.shell?{behaviours:[zx.config({})],components:[]}:{behaviours:[],components:n},u=function(n){return t.shell?V.some(n):qv(n,t,"items")};return{uid:t.uid,dom:t.dom,components:i.components,behaviours:ov(t.listBehaviours,i.behaviours),apis:{setItems:r}}},Iz=mh({name:Az(),configFields:Ez(),partFields:Mz(),factory:Fz,apis:{setItems:function(t,n,e){t.setItems(n,e)}}}),Rz=x([Di("dom"),qi("shell",!0),nv("toolbarBehaviours",[zx])]),Vz=function(){return{behaviours:ml([zx.config({})])}},Pz=x([Rv({name:"groups",overrides:Vz})]),Hz=function(t,n,e,o){var r=function(t,n){i(t).fold((function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(t){zx.set(t,n)}))},i=function(n){return t.shell?V.some(n):qv(n,t,"groups")},u=t.shell?{behaviours:[zx.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:u.components,behaviours:ov(t.toolbarBehaviours,u.behaviours),apis:{setGroups:r},domModification:{attributes:{role:"group"}}}},zz=mh({name:"Toolbar",configFields:Rz(),partFields:Pz(),factory:Hz,apis:{setGroups:function(t,n,e){t.setGroups(n,e)}}}),Nz=v,Lz=_,Wz=x([]),Uz=Object.freeze({__proto__:null,setup:Nz,isDocked:Lz,getBehaviours:Wz}),jz=function(t){var n=Dt(Ze(t,"position"),"fixed"),e=n?V.none():ye(t);return e.orThunk((function(){var n=nn.fromTag("span");return he(t).bind((function(t){Mo(t,n);var e=ye(n);return Vo(n),e}))}))},Gz=function(t){return jz(t).map(go).getOrThunk((function(){return fo(0,0)}))},Xz=uu.generate([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),Yz=function(t,n){var e=t.element;is(e,n.transitionClass),as(e,n.fadeOutClass),is(e,n.fadeInClass),n.onShow(t)},qz=function(t,n){var e=t.element;is(e,n.transitionClass),as(e,n.fadeInClass),is(e,n.fadeOutClass),n.onHide(t)},Kz=function(t,n){return t.y<n.bottom&&t.bottom>n.y},Jz=function(t,n){return t.y>=n.y},$z=function(t,n){return t.bottom<=n.bottom},Qz=function(t,n,e){return rt(t,(function(t){switch(t){case"bottom":return $z(n,e);case"top":return Jz(n,e)}}))},Zz=function(t,n){return n.getInitialPos().map((function(n){return $o(n.bounds.x,n.bounds.y,bo(t),uo(t))}))},tN=function(t,n,e){e.setInitialPos({style:to(t),position:$e(t,"position")||"static",bounds:n})},nN=function(t,n,e){return e.getInitialPos().bind((function(o){switch(e.clearInitialPos(),o.position){case"static":return V.some(Xz.static());case"absolute":var r=jz(t).map(Qo).getOrThunk((function(){return Qo(Pe())}));return V.some(Xz.absolute(Dl("absolute",_t(o.style,"left").map((function(t){return n.x-r.x})),_t(o.style,"top").map((function(t){return n.y-r.y})),_t(o.style,"right").map((function(t){return r.right-n.right})),_t(o.style,"bottom").map((function(t){return r.bottom-n.bottom})))));default:return V.none()}}))},eN=function(t,n,e){return Zz(t,e).filter((function(t){return Qz(e.getModes(),t,n)})).bind((function(n){return nN(t,n,e)}))},oN=function(t,n,e){var o=Qo(t);if(Qz(e.getModes(),o,n))return V.none();tN(t,o,e);var r=tr(),i=o.x-r.x,u=n.y-r.y,a=r.bottom-n.bottom,c=o.y<=n.y;return V.some(Xz.fixed(Dl("fixed",V.some(i),c?V.some(u):V.none(),V.none(),c?V.none():V.some(a))))},rN=function(t,n,e){var o=t.element,r=Dt(Ze(o,"position"),"fixed");return r?eN(o,n,e):oN(o,n,e)},iN=function(t,n){var e=t.element;return Zz(e,n).bind((function(t){return nN(e,t,n)}))},uN=function(t,n,e){e.setDocked(!1),Y(["left","right","top","bottom","position"],(function(n){return eo(t.element,n)})),n.onUndocked(t)},aN=function(t,n,e,o){var r="fixed"===o.position;e.setDocked(r),Ml(t.element,o);var i=r?n.onDocked:n.onUndocked;i(t)},cN=function(t,n,e,o,r){void 0===r&&(r=!1),n.contextual.each((function(n){n.lazyContext(t).each((function(i){var u=Kz(i,o);if(u!==e.isVisible())if(e.setVisible(u),r&&!u)ss(t.element,[n.fadeOutClass]),n.onHide(t);else{var a=u?Yz:qz;a(t,n)}}))}))},sN=function(t,n,e){var o=n.lazyViewport(t),r=e.isDocked();r&&cN(t,n,e,o),rN(t,o,e).each((function(r){r.fold((function(){return uN(t,n,e)}),(function(o){return aN(t,n,e,o)}),(function(r){cN(t,n,e,o,!0),aN(t,n,e,r)}))}))},fN=function(t,n,e){var o=t.element;e.setDocked(!1),iN(t,e).each((function(o){o.fold((function(){return uN(t,n,e)}),(function(o){return aN(t,n,e,o)}),v)})),e.setVisible(!0),n.contextual.each((function(n){fs(o,[n.fadeInClass,n.fadeOutClass,n.transitionClass]),n.onShow(t)})),lN(t,n,e)},lN=function(t,n,e){t.getSystem().isConnected()&&sN(t,n,e)},dN=function(t,n,e){e.isDocked()&&fN(t,n,e)},mN=function(t,n,e){return e.isDocked()},gN=function(t,n,e,o){return e.setModes(o)},pN=function(t,n,e){return e.getModes()},vN=Object.freeze({__proto__:null,refresh:lN,reset:dN,isDocked:mN,getModes:pN,setModes:gN}),hN=function(t,n){return Ea([La(Xu(),(function(e,o){t.contextual.each((function(t){if(cs(e.element,t.transitionClass)){fs(e.element,[t.transitionClass,t.fadeInClass]);var r=n.isVisible()?t.onShown:t.onHidden;r(e)}o.stop()}))})),Aa(fa(),(function(e,o){lN(e,t,n)})),Aa(la(),(function(e,o){dN(e,t,n)}))])},bN=Object.freeze({__proto__:null,events:hN}),yN=[Xi("contextual",[Ai("fadeInClass"),Ai("fadeOutClass"),Ai("transitionClass"),Ri("lazyContext"),cf("onShow"),cf("onShown"),cf("onHide"),cf("onHidden")]),tu("lazyViewport",tr),eu("modes",["top","bottom"],si),cf("onDocked"),cf("onUndocked")],xN=function(t){var n=ru(!1),e=ru(!0),o=rd(),r=ru(t.modes),i=function(){return"docked:  "+n.get()+", visible: "+e.get()+", modes: "+r.get().join(",")};return Oc({isDocked:n.get,setDocked:n.set,getInitialPos:o.get,setInitialPos:o.set,clearInitialPos:o.clear,isVisible:e.get,setVisible:e.set,getModes:r.get,setModes:r.set,readState:i})},wN=Object.freeze({__proto__:null,init:xN}),SN=pl({fields:yN,name:"docking",active:bN,apis:vN,state:wN}),kN=x(rc("toolbar-height-change")),CN={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},ON="tox-tinymce--toolbar-sticky-on",_N="tox-tinymce--toolbar-sticky-off",TN=function(t,n){var e=me(n),o=e.dom.defaultView.innerHeight,r=Ho(e),i=nn.fromDom(t.elm),u=Zo(i),a=uo(i),c=u.y,s=c+a,f=go(n),l=uo(n),d=f.top,m=d+l,g=Math.abs(d-r.top)<2,p=Math.abs(m-(r.top+o))<2;if(g&&c<m)zo(r.left,c-l,e);else if(p&&s>d){var v=c-o+a+l;zo(r.left,v,e)}},EN=function(t,n){return W(SN.getModes(t),n)},DN=function(t){var n=function(t){return ao(t)+(parseInt($e(t,"margin-top"),10)||0)+(parseInt($e(t,"margin-bottom"),10)||0)},e=t.element;he(e).each((function(o){var r="padding-"+SN.getModes(t)[0];if(SN.isDocked(t)){var i=bo(o);qe(e,"width",i+"px"),qe(o,r,n(e)+"px")}else eo(e,"width"),eo(o,r)}))},BN=function(t,n){n?(as(t,CN.fadeOutClass),ss(t,[CN.transitionClass,CN.fadeInClass])):(as(t,CN.fadeInClass),ss(t,[CN.fadeOutClass,CN.transitionClass]))},MN=function(t,n){var e=nn.fromDom(t.getContainer());n?(is(e,ON),as(e,_N)):(is(e,_N),as(e,ON))},AN=function(t,n){var e=me(n);_l(e).filter((function(t){return!se(n,t)})).filter((function(n){return se(n,nn.fromDom(e.dom.body))||de(t,n)})).each((function(){return kl(n)}))},FN=function(t,n){return Tl(t).orThunk((function(){return n().toOptional().bind((function(t){return Tl(t.element)}))}))},IN=function(t,n,e){t.inline||(n.header.isPositionedAtTop()||t.on("ResizeEditor",(function(){e().each(SN.reset)})),t.on("ResizeWindow ResizeEditor",(function(){e().each(DN)})),t.on("SkinLoaded",(function(){e().each((function(t){SN.isDocked(t)?SN.reset(t):SN.refresh(t)}))})),t.on("FullscreenStateChanged",(function(){e().each(SN.reset)}))),t.on("AfterScrollIntoView",(function(t){e().each((function(n){SN.refresh(n);var e=n.element;$b(e)&&TN(t,e)}))})),t.on("PostRender",(function(){MN(t,!1)}))},RN=function(t){return t().map(SN.isDocked).getOr(!1)},VN=function(){var t;return[yl.config({channels:(t={},t[kN()]={onReceive:DN},t)})]},PN=function(t,n){var e=rd(),o=n.getSink,r=function(t){o().each((function(n){return t(n.element)}))},i=function(n){t.inline||DN(n),MN(t,SN.isDocked(n)),n.getSystem().broadcastOn([xp()],{}),o().each((function(t){return t.getSystem().broadcastOn([xp()],{})}))},u=t.inline?[]:VN();return M([Jx.config({}),SN.config({contextual:D({lazyContext:function(n){var e=ao(n.element),o=t.inline?t.getContentAreaContainer():t.getContainer(),r=Qo(nn.fromDom(o)),i=r.height-e,u=r.y+(EN(n,"top")?0:e);return V.some($o(r.x,u,r.width,i))},onShow:function(){r((function(t){return BN(t,!0)}))},onShown:function(t){r((function(t){return fs(t,[CN.transitionClass,CN.fadeInClass])})),e.get().each((function(n){AN(t.element,n),e.clear()}))},onHide:function(t){FN(t.element,o).fold(e.clear,e.set),r((function(t){return BN(t,!1)}))},onHidden:function(){r((function(t){return fs(t,[CN.transitionClass])}))}},CN),lazyViewport:function(n){var e=tr(),o=XO(t),r=e.y+(EN(n,"top")?o:0),i=e.height-(EN(n,"bottom")?o:0);return $o(e.x,r,e.width,i)},modes:[n.header.getDockingMode()],onDocked:i,onUndocked:i})],u,!0)},HN=Object.freeze({__proto__:null,setup:IN,isDocked:RN,getBehaviours:PN}),zN=function(t){var n=t.editor,e=t.sticky?PN:Wz;return{uid:t.uid,dom:t.dom,components:t.components,behaviours:ml(e(n,t.sharedBackstage))}},NN=ti([Ai("type"),Bi("items",ei([ii([Ai("name"),zi("items",si)]),si]))].concat(Ck)),LN=function(t){return xi("GroupToolbarButton",NN,t)},WN=[Ui("text"),Ui("tooltip"),Ui("icon"),Ri("fetch"),tu("onSetup",(function(){return v}))],UN=ti(M([Ai("type")],WN,!0)),jN=function(t){return xi("menubutton",UN,t)},GN=ti([Ai("type"),Ui("tooltip"),Ui("icon"),Ui("text"),ji("select"),Ri("fetch"),tu("onSetup",(function(){return v})),Qi("presets","normal",["normal","color","listpreview"]),qi("columns",1),Ri("onAction"),Ri("onItemAction")]),XN=function(t){return xi("SplitButton",GN,t)},YN=function(t,n){var e=function(t,e){var o=X(e,(function(t){var e={type:"menubutton",text:t.text,fetch:function(n){n(t.getItems())}},o=jN(e).mapError((function(t){return ki(t)})).getOrDie();return YR(o,"tox-mbtn",n.backstage,V.some("menuitem"))}));zx.set(t,o)},o={focus:Dx.focusIn,setMenus:e};return{uid:t.uid,dom:t.dom,components:[],behaviours:ml([zx.config({}),Lx("menubar-events",[Wa((function(n){t.onSetup(n)})),Aa(Pu(),(function(t,n){Hs(t.element,".tox-mbtn--active").each((function(e){zs(n.event.target,".tox-mbtn").each((function(n){se(e,n)||t.getSystem().getByDom(e).each((function(e){t.getSystem().getByDom(n).each((function(t){PB.expand(t),PB.close(e),Jx.focus(t)}))}))}))}))})),Aa(va(),(function(t,n){n.event.prevFocus.bind((function(n){return t.getSystem().getByDom(n).toOptional()})).each((function(e){n.event.newFocus.bind((function(n){return t.getSystem().getByDom(n).toOptional()})).each((function(t){PB.isOpen(e)&&(PB.expand(t),PB.close(e))}))}))}))]),Dx.config({mode:"flow",selector:".tox-mbtn",onEscape:function(n){return t.onEscape(n),V.some(!0)}}),yD.config({})]),apis:o,domModification:{attributes:{role:"menubar"}}}},qN=dh({factory:YN,name:"silver.Menubar",configFields:[Di("dom"),Di("uid"),Di("onEscape"),Di("backstage"),qi("onSetup",v)],apis:{focus:function(t,n){t.focus(n)},setMenus:function(t,n,e){t.setMenus(n,e)}}}),KN=function(t,n){return n.getAnimationRoot.fold((function(){return t.element}),(function(n){return n(t)}))},JN=function(t){return t.dimension.property},$N=function(t,n){return t.dimension.getDimension(n)},QN=function(t,n){var e=KN(t,n);fs(e,[n.shrinkingClass,n.growingClass])},ZN=function(t,n){as(t.element,n.openClass),is(t.element,n.closedClass),qe(t.element,JN(n),"0px"),oo(t.element)},tL=function(t,n){as(t.element,n.closedClass),is(t.element,n.openClass),eo(t.element,JN(n))},nL=function(t,n,e,o){e.setCollapsed(),qe(t.element,JN(n),$N(n,t.element)),oo(t.element),QN(t,n),ZN(t,n),n.onStartShrink(t),n.onShrunk(t)},eL=function(t,n,e,o){var r=o.getOrThunk((function(){return $N(n,t.element)}));e.setCollapsed(),qe(t.element,JN(n),r),oo(t.element);var i=KN(t,n);as(i,n.growingClass),is(i,n.shrinkingClass),ZN(t,n),n.onStartShrink(t)},oL=function(t,n,e){var o=$N(n,t.element),r="0px"===o?nL:eL;r(t,n,e,V.some(o))},rL=function(t,n,e){var o=KN(t,n),r=cs(o,n.shrinkingClass),i=$N(n,t.element);tL(t,n);var u=$N(n,t.element),a=function(){qe(t.element,JN(n),i),oo(t.element)},c=function(){ZN(t,n)},s=r?a:c;s(),as(o,n.shrinkingClass),is(o,n.growingClass),tL(t,n),qe(t.element,JN(n),u),e.setExpanded(),n.onStartGrow(t)},iL=function(t,n,e){if(e.isExpanded()){eo(t.element,JN(n));var o=$N(n,t.element);qe(t.element,JN(n),o)}},uL=function(t,n,e){e.isExpanded()||rL(t,n,e)},aL=function(t,n,e){e.isExpanded()&&oL(t,n,e)},cL=function(t,n,e){e.isExpanded()&&nL(t,n,e)},sL=function(t,n,e){return e.isExpanded()},fL=function(t,n,e){return e.isCollapsed()},lL=function(t,n,e){var o=KN(t,n);return!0===cs(o,n.growingClass)},dL=function(t,n,e){var o=KN(t,n);return!0===cs(o,n.shrinkingClass)},mL=function(t,n,e){return lL(t,n)||dL(t,n)},gL=function(t,n,e){var o=e.isExpanded()?oL:rL;o(t,n,e)},pL=Object.freeze({__proto__:null,refresh:iL,grow:uL,shrink:aL,immediateShrink:cL,hasGrown:sL,hasShrunk:fL,isGrowing:lL,isShrinking:dL,isTransitioning:mL,toggleGrow:gL,disableTransitions:QN}),vL=function(t,n,e){var o=n.expanded;return Bc(o?{classes:[n.openClass],styles:{}}:{classes:[n.closedClass],styles:mu(n.dimension.property,"0px")})},hL=function(t,n){return Ea([La(Xu(),(function(e,o){var r=o.event.raw;if(r.propertyName===t.dimension.property){QN(e,t),n.isExpanded()&&eo(e.element,t.dimension.property);var i=n.isExpanded()?t.onGrown:t.onShrunk;i(e)}}))])},bL=Object.freeze({__proto__:null,exhibit:vL,events:hL}),yL=[Di("closedClass"),Di("openClass"),Di("shrinkingClass"),Di("growingClass"),Ni("getAnimationRoot"),cf("onShrunk"),cf("onStartShrink"),cf("onGrown"),cf("onStartGrow"),qi("expanded",!1),Bi("dimension",Ci("property",{width:[df("property","width"),df("getDimension",(function(t){return bo(t)+"px"}))],height:[df("property","height"),df("getDimension",(function(t){return uo(t)+"px"}))]}))],xL=function(t){var n=ru(t.expanded),e=function(){return"expanded: "+n.get()};return Oc({isExpanded:function(){return!0===n.get()},isCollapsed:function(){return!1===n.get()},setCollapsed:k(n.set,!1),setExpanded:k(n.set,!0),readState:e})},wL=Object.freeze({__proto__:null,init:xL}),SL=pl({fields:yL,name:"sliding",active:bL,apis:pL,state:wL}),kL="container",CL=[nv("slotBehaviours",[])],OL=function(t){return"<alloy.field."+t+">"},_L=function(t){var n=function(){var t=[],n=function(n,e){return t.push(n),Uv(kL,OL(n),e)};return{slot:n,record:x(t)}}(),e=t(n),o=n.record(),r=X(o,(function(t){return Fv({name:t,pname:OL(t)})}));return uh(kL,CL,r,TL,e)},TL=function(t,n){var e=function(n){return Qv(t)},o=function(n,e){return qv(n,t,e)},r=function(n,e){return function(o,r){return qv(o,t,r).map((function(t){return n(t,r)})).getOr(e)}},i=function(t){return function(n,e){Y(e,(function(e){return t(n,e)}))}},u=function(t,n){return"true"!==We(t.element,"aria-hidden")},a=function(t,n){if(!u(t)){var e=t.element;eo(e,"display"),Ge(e,"aria-hidden"),ka(t,ha(),{name:n,visible:!0})}},c=function(t,n){if(u(t)){var e=t.element;qe(e,"display","none"),Ne(e,"aria-hidden","true"),ka(t,ha(),{name:n,visible:!1})}},s=r(u,!1),f=r(c),l=i(f),d=function(t){return l(t,e())},m=r(a),g={getSlotNames:e,getSlot:o,isShowing:s,hideSlot:f,hideAllSlots:d,showSlot:m};return{uid:t.uid,dom:t.dom,components:n,behaviours:ev(t.slotBehaviours),apis:g}},EL=bt({getSlotNames:function(t,n){return t.getSlotNames(n)},getSlot:function(t,n,e){return t.getSlot(n,e)},isShowing:function(t,n,e){return t.isShowing(n,e)},hideSlot:function(t,n,e){return t.hideSlot(n,e)},hideAllSlots:function(t,n){return t.hideAllSlots(n)},showSlot:function(t,n,e){return t.showSlot(n,e)}},(function(t){return kc(t)})),DL=D(D({},EL),{sketch:_L}),BL=ti([Ui("icon"),Ui("tooltip"),tu("onShow",v),tu("onHide",v),tu("onSetup",(function(){return v}))]),ML=function(t){return xi("sidebar",BL,t)},AL=function(t){var n=t.ui.registry.getAll().sidebars;Y(pt(n),(function(e){var o=n[e],r=function(){return Dt(V.from(t.queryCommandValue("ToggleSidebar")),e)};t.ui.registry.addToggleButton(e,{icon:o.icon,tooltip:o.tooltip,onAction:function(n){t.execCommand("ToggleSidebar",!1,e),n.setActive(r())},onSetup:function(n){var e=function(){return n.setActive(r())};return t.on("ToggleSidebar",e),function(){t.off("ToggleSidebar",e)}}})}))},FL=function(t){return{element:function(){return t.element.dom}}},IL=function(t,n){var e=X(pt(n),(function(t){var e=n[t],o=wi(ML(e));return{name:t,getApi:FL,onSetup:o.onSetup,onShow:o.onShow,onHide:o.onHide}}));return X(e,(function(n){var o=ru(v);return t.slot(n.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:QC.unnamedEvents([p_(n,o),v_(n,o),Aa(ha(),(function(t,n){var o=n.event,r=tt(e,(function(t){return t.name===o.name}));r.each((function(n){var e=o.visible?n.onShow:n.onHide;e(n.getApi(t))}))}))])})}))},RL=function(t){return DL.sketch((function(n){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:IL(n,t),slotBehaviours:QC.unnamedEvents([Wa((function(t){return DL.hideAllSlots(t)}))])}}))},VL=function(t,n){var e=bh.getCurrent(t);e.each((function(t){return zx.set(t,[RL(n)])}))},PL=function(t,n){var e=bh.getCurrent(t);e.each((function(t){var e=bh.getCurrent(t);e.each((function(e){SL.hasGrown(t)?DL.isShowing(e,n)?SL.shrink(t):(DL.hideAllSlots(e),DL.showSlot(e,n)):(DL.hideAllSlots(e),DL.showSlot(e,n),SL.grow(t))}))}))},HL=function(t){var n=bh.getCurrent(t);return n.bind((function(t){var n=SL.isGrowing(t)||SL.hasGrown(t);if(n){var e=bh.getCurrent(t);return e.bind((function(t){return tt(DL.getSlotNames(t),(function(n){return DL.isShowing(t,n)}))}))}return V.none()}))},zL=rc("FixSizeEvent"),NL=rc("AutoSizeEvent"),LL=function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:ml([yD.config({}),Jx.config({}),SL.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){var n=bh.getCurrent(t);n.each(DL.hideAllSlots),Sa(t,NL)},onGrown:function(t){Sa(t,NL)},onStartGrow:function(t){ka(t,zL,{width:Ze(t.element,"width").getOr("")})},onStartShrink:function(t){ka(t,zL,{width:bo(t.element)+"px"})}}),zx.config({}),bh.config({find:function(t){var n=zx.contents(t);return lt(n)}})])}],behaviours:ml([jF.childAt(0),Lx("sidebar-sliding-events",[Aa(zL,(function(t,n){qe(t.element,"width",n.event.width)})),Aa(NL,(function(t,n){eo(t.element,"width")}))])])}},WL=function(t,n,e,o){Ne(t.element,"aria-busy",!0);var r=n.getRoot(t).getOr(t),i=ml([Dx.config({mode:"special",onTab:function(){return V.some(!0)},onShiftTab:function(){return V.some(!0)}}),Jx.config({})]),u=o(r,i),a=r.getSystem().build(u);zx.append(r,Es(a)),a.hasConfigured(Dx)&&n.focus&&Dx.focusIn(a),e.isBlocked()||n.onBlock(t),e.blockWith((function(){return zx.remove(r,a)}))},UL=function(t,n,e){Ge(t.element,"aria-busy"),e.isBlocked()&&n.onUnblock(t),e.clear()},jL=Object.freeze({__proto__:null,block:WL,unblock:UL}),GL=[tu("getRoot",V.none),Zi("focus",!0),cf("onBlock"),cf("onUnblock")],XL=function(){var t=nd(),n=function(n){t.set({destroy:n})};return Oc({readState:t.isSet,blockWith:n,clear:t.clear,isBlocked:t.isSet})},YL=Object.freeze({__proto__:null,init:XL}),qL=pl({fields:GL,name:"blocking",apis:jL,state:YL}),KL=function(t){var n=void 0!==t.dom.attributes?t.dom.attributes:[];return Q(n,(function(t,n){var e;return"class"===n.name?t:D(D({},t),(e={},e[n.name]=n.value,e))}),{})},JL=function(t){return Array.prototype.slice.call(t.dom.classList,0)},$L=function(t){var n=nn.fromHtml(t),e=we(n),o=KL(n),r=JL(n),i=0===e.length?{}:{innerHtml:Ya(n)};return D({tag:cn(n),classes:r,attributes:o},i)},QL=function(t){return function(n,e){return{dom:{tag:"div",attributes:{"aria-label":t.translate("Loading..."),tabindex:"0"},classes:["tox-throbber__busy-spinner"]},components:[{dom:$L('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}}},ZL=function(t){return bh.getCurrent(t).each((function(t){return kl(t.element)}))},tW=function(t,n){var e="tabindex",o="data-mce-"+e;V.from(t.iframeElement).map(nn.fromDom).each((function(t){n?(Ue(t,e).each((function(n){return Ne(t,o,n)})),Ne(t,e,-1)):(Ge(t,e),Ue(t,o).each((function(n){Ne(t,e,n),Ge(t,o)})))}))},nW=function(t,n,e,o){var r=n.element;if(tW(t,e),e)qL.block(n,QL(o)),eo(r,"display"),Ge(r,"aria-hidden"),t.hasFocus()&&ZL(n);else{var i=bh.getCurrent(n).exists((function(t){return Ol(t.element)}));qL.unblock(n),qe(r,"display","none"),Ne(r,"aria-hidden","true"),i&&t.focus()}},eW=function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:ml([zx.config({}),qL.config({focus:!1}),bh.config({find:function(t){return lt(t.components())}})]),components:[]}},oW=function(t){return"focusin"===t.type},rW=function(t){if(oW(t)){var n=t.composed?lt(t.composedPath()):V.from(t.target);return n.map(nn.fromDom).filter(ln).exists((function(t){return cs(t,"mce-pastebin")}))}return!1},iW=function(t,n,e){var o=ru(!1),r=rd(),i=function(e){o.get()&&!rW(e)&&(e.preventDefault(),ZL(n()),t.editorManager.setActive(t))};t.inline||t.on("PreInit",(function(){t.dom.bind(t.getWin(),"focusin",i),t.on("BeforeExecCommand",(function(t){"mcefocus"===t.command.toLowerCase()&&!0!==t.value&&i(t)}))}));var u=function(r){r!==o.get()&&(o.set(r),nW(t,n(),r,e.providers),t.fire("AfterProgressState",{state:r}))};t.on("ProgressState",(function(n){if(r.on(wS.clearTimeout),g(n.time)){var e=wS.setEditorTimeout(t,(function(){return u(n.state)}),n.time);r.set(e)}else u(n.state),r.clear()}))},uW=function(t,n){var e={len:0,list:[]},o=Q(t,(function(t,e){var o=n(e,t.len);return o.fold(x(t),(function(n){return{len:n.finish,list:t.list.concat([n])}}))}),e);return o.list},aW=function(t,n,e){return{within:t,extra:n,withinWidth:e}},cW=function(t,n,e){var o=uW(t,(function(t,n){var o=e(t);return V.some({element:t,start:n,finish:n+o,width:o})})),r=J(o,(function(t){return t.finish<=n})),i=$(r,(function(t,n){return t+n.width}),0),u=o.slice(r.length);return{within:r,extra:u,withinWidth:i}},sW=function(t){return X(t,(function(t){return t.element}))},fW=function(t,n,e){var o=sW(t.concat(n));return aW(o,[],e)},lW=function(t,n,e,o){var r=sW(t).concat([e]);return aW(r,sW(n),o)},dW=function(t,n,e){return aW(sW(t),[],e)},mW=function(t,n,e){var o=cW(n,t,e);return 0===o.extra.length?V.some(o):V.none()},gW=function(t,n,e,o){var r=mW(t,n,e).getOrThunk((function(){return cW(n,t-e(o),e)})),i=r.within,u=r.extra,a=r.withinWidth;return 1===u.length&&u[0].width<=e(o)?fW(i,u,a):u.length>=1?lW(i,u,o,a):dW(i,u,a)},pW=function(t,n){var e=X(n,(function(t){return Es(t)}));zz.setGroups(t,e)},vW=function(t){return gt(t,(function(t){return Tl(t.element).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))}))},hW=function(t,n,e){var o=n.builtGroups.get();if(0!==o.length){var r=Kv(t,n,"primary"),i=bB.getCoupled(t,"overflowGroup");qe(r.element,"visibility","hidden");var u=o.concat([i]),a=vW(u);e([]),pW(r,u);var c=bo(r.element),s=gW(c,n.builtGroups.get(),(function(t){return bo(t.element)}),i);0===s.extra.length?(zx.remove(r,i),e([])):(pW(r,s.within),e(s.extra)),eo(r.element,"visibility"),oo(r.element),a.each(Jx.focus)}},bW=x([nv("splitToolbarBehaviours",[bB]),Ti("builtGroups",(function(){return ru([])}))]),yW=x([uf(["overflowToggledClass"]),ji("getOverflowBounds"),Di("lazySink"),Ti("overflowGroups",(function(){return ru([])}))].concat(bW())),xW=x([Fv({factory:zz,schema:Rz(),name:"primary"}),Iv({schema:Rz(),name:"overflow"}),Iv({name:"overflow-button"}),Iv({name:"overflow-group"})]),wW=x((function(t,n){xo(t,Math.floor(n))})),SW=x([uf(["toggledClass"]),Di("lazySink"),Ri("fetch"),ji("getBounds"),Xi("fireDismissalEventInstead",[qi("event",ga())]),zd()]),kW=x([Iv({name:"button",overrides:function(t){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:ml([pw.config({toggleClass:t.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),Iv({factory:zz,schema:Rz(),name:"toolbar",overrides:function(t){return{toolbarBehaviours:ml([Dx.config({mode:"cyclic",onEscape:function(n){return qv(n,t,"button").each(Jx.focus),V.none()}})])}}})]),CW=function(t,n){var e=bB.getCoupled(t,"toolbarSandbox");bp.isOpen(e)?bp.close(e):bp.open(e,n.toolbar())},OW=function(t,n,e,o){var r=e.getBounds.map((function(t){return t()})),i=e.lazySink(t).getOrDie();Hg.positionWithinBounds(i,n,{anchor:{type:"hotspot",hotspot:t,layouts:o,overrides:{maxWidthFunction:wW()}}},r)},_W=function(t,n,e,o,r){zz.setGroups(n,r),OW(t,n,e,o),pw.on(t)},TW=function(t,n,e){var o=Ls(),r=function(r,i){e.fetch().get((function(r){_W(t,i,e,n.layouts,r),o.link(t.element),Dx.focusIn(i)}))},i=function(){pw.off(t),Jx.focus(t),o.unlink(t.element)};return{dom:{tag:"div",attributes:{id:o.id}},behaviours:ml([Dx.config({mode:"special",onEscape:function(t){return bp.close(t),V.some(!0)}}),bp.config({onOpen:r,onClose:i,isPartOf:function(n,e,o){return Us(e,o)||Us(t,o)},getAttachPoint:function(){return e.lazySink(t).getOrDie()}}),yl.config({channels:D(D({},kp(D({isExtraPart:_},e.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))),Op({doReposition:function(){bp.getState(bB.getCoupled(t,"toolbarSandbox")).each((function(o){OW(t,o,e,n.layouts)}))}}))})])}},EW=function(t,n,e,o){return D(D({},kS.sketch(D(D({},o.button()),{action:function(t){CW(t,o)},buttonBehaviours:rv.augment({dump:o.button().buttonBehaviours},[bB.config({others:{toolbarSandbox:function(n){return TW(n,e,t)}}})])}))),{apis:{setGroups:function(n,o){bp.getState(bB.getCoupled(n,"toolbarSandbox")).each((function(r){_W(n,r,t,e.layouts,o)}))},reposition:function(n){bp.getState(bB.getCoupled(n,"toolbarSandbox")).each((function(o){OW(n,o,t,e.layouts)}))},toggle:function(t){CW(t,o)},getToolbar:function(t){return bp.getState(bB.getCoupled(t,"toolbarSandbox"))},isOpen:function(t){return bp.isOpen(bB.getCoupled(t,"toolbarSandbox"))}}})},DW=mh({name:"FloatingToolbarButton",factory:EW,configFields:SW(),partFields:kW(),apis:{setGroups:function(t,n,e){t.setGroups(n,e)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},getToolbar:function(t,n){return t.getToolbar(n)},isOpen:function(t,n){return t.isOpen(n)}}}),BW=x([Di("items"),uf(["itemSelector"]),nv("tgroupBehaviours",[Dx])]),MW=x([Vv({name:"items",unit:"item"})]),AW=function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:ov(t.tgroupBehaviours,[Dx.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}},FW=mh({name:"ToolbarGroup",configFields:BW(),partFields:MW(),factory:AW}),IW=function(t){return X(t,(function(t){return Es(t)}))},RW=function(t,n,e){hW(t,e,(function(o){e.overflowGroups.set(o),n.getOpt(t).each((function(t){DW.setGroups(t,IW(o))}))}))},VW=function(t,n,e,o){var r=CS(DW.sketch({fetch:function(){return tB.nu((function(n){n(IW(t.overflowGroups.get()))}))},layouts:{onLtr:function(){return[Uf,Wf]},onRtl:function(){return[Wf,Uf]},onBottomLtr:function(){return[Gf,jf]},onBottomRtl:function(){return[jf,Gf]}},getBounds:e.getOverflowBounds,lazySink:t.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:t.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}));return{uid:t.uid,dom:t.dom,components:n,behaviours:ov(t.splitToolbarBehaviours,[bB.config({others:{overflowGroup:function(){return FW.sketch(D(D({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(n,e){t.builtGroups.set(X(e,n.getSystem().build)),RW(n,r,t)},refresh:function(n){return RW(n,r,t)},toggle:function(t){r.getOpt(t).each((function(t){DW.toggle(t)}))},isOpen:function(t){return r.getOpt(t).map(DW.isOpen).getOr(!1)},reposition:function(t){r.getOpt(t).each((function(t){DW.reposition(t)}))},getOverflow:function(t){return r.getOpt(t).bind(DW.getToolbar)}},domModification:{attributes:{role:"group"}}}},PW=mh({name:"SplitFloatingToolbar",configFields:yW(),partFields:xW(),factory:VW,apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)},getOverflow:function(t,n){return t.getOverflow(n)}}}),HW=x([uf(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),cf("onOpened"),cf("onClosed")].concat(bW())),zW=x([Fv({factory:zz,schema:Rz(),name:"primary"}),Fv({factory:zz,schema:Rz(),name:"overflow",overrides:function(t){return{toolbarBehaviours:ml([SL.config({dimension:{property:"height"},closedClass:t.markers.closedClass,openClass:t.markers.openClass,shrinkingClass:t.markers.shrinkingClass,growingClass:t.markers.growingClass,onShrunk:function(n){qv(n,t,"overflow-button").each((function(t){pw.off(t),Jx.focus(t)})),t.onClosed(n)},onGrown:function(n){Dx.focusIn(n),t.onOpened(n)},onStartGrow:function(n){qv(n,t,"overflow-button").each(pw.on)}}),Dx.config({mode:"acyclic",onEscape:function(n){return qv(n,t,"overflow-button").each(Jx.focus),V.some(!0)}})])}}}),Iv({name:"overflow-button",overrides:function(t){return{buttonBehaviours:ml([pw.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),Iv({name:"overflow-group"})]),NW=function(t,n){return qv(t,n,"overflow").map(SL.hasGrown).getOr(!1)},LW=function(t,n){qv(t,n,"overflow-button").bind((function(){return qv(t,n,"overflow")})).each((function(e){WW(t,n),SL.toggleGrow(e)}))},WW=function(t,n){qv(t,n,"overflow").each((function(e){hW(t,n,(function(t){var n=X(t,(function(t){return Es(t)}));zz.setGroups(e,n)})),qv(t,n,"overflow-button").each((function(t){SL.hasGrown(e)&&pw.on(t)})),SL.refresh(e)}))},UW=function(t,n,e,o){var r="alloy.toolbar.toggle",i=function(n,e){var o=X(e,n.getSystem().build);t.builtGroups.set(o)};return{uid:t.uid,dom:t.dom,components:n,behaviours:ov(t.splitToolbarBehaviours,[bB.config({others:{overflowGroup:function(t){return FW.sketch(D(D({},o["overflow-group"]()),{items:[kS.sketch(D(D({},o["overflow-button"]()),{action:function(n){Sa(t,r)}}))]}))}}}),Lx("toolbar-toggle-events",[Aa(r,(function(n){LW(n,t)}))])]),apis:{setGroups:function(n,e){i(n,e),WW(n,t)},refresh:function(n){return WW(n,t)},toggle:function(n){return LW(n,t)},isOpen:function(n){return NW(n,t)}},domModification:{attributes:{role:"group"}}}},jW=mh({name:"SplitSlidingToolbar",configFields:HW(),partFields:zW(),factory:UW,apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)}}}),GW=function(t){var n=t.title.fold((function(){return{}}),(function(t){return{attributes:{title:t}}}));return{dom:D({tag:"div",classes:["tox-toolbar__group"]},n),components:[FW.parts.items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:ml([yD.config({}),Jx.config({})])}},XW=function(t){return FW.sketch(GW(t))},YW=function(t,n){var e=Wa((function(n){var e=X(t.initGroups,XW);zz.setGroups(n,e)}));return ml([m_.toolbarButton(t.providers.isDisabled),c_(),Dx.config({mode:n,onEscape:t.onEscape,selector:".tox-toolbar__group"}),Lx("toolbar-events",[e])])},qW=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":GW({title:V.none(),items:[]}),"overflow-button":JR({name:"more",icon:V.some("more-drawer"),disabled:!1,tooltip:V.some("More..."),primary:!1,borderless:!1},V.none(),t.providers)},splitToolbarBehaviours:YW(t,n)}},KW=function(t){var n=qW(t),e=4,o=PW.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return PW.sketch(D(D({},n),{lazySink:t.getSink,getOverflowBounds:function(){var n=t.moreDrawerData.lazyHeader().element,o=Zo(n),r=pe(n),i=Zo(r),u=Math.max(r.dom.scrollHeight,i.height);return $o(o.x+e,i.y,o.width-2*e,u)},parts:D(D({},n.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:t.attributes}}}),components:[o],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},JW=function(t){var n=jW.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=jW.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),o=qW(t);return jW.sketch(D(D({},o),{components:[n,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(t){t.getSystem().broadcastOn([kN()],{type:"opened"})},onClosed:function(t){t.getSystem().broadcastOn([kN()],{type:"closed"})}}))},$W=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return zz.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(t.type===Wk.scrolling?["tox-toolbar--scrolling"]:[])},components:[zz.parts.groups({})],toolbarBehaviours:YW(t,n)})},QW=function(t,n,e){var o={getSocket:function(n){return _z.getPart(n,t,"socket")},setSidebar:function(n,e){_z.getPart(n,t,"sidebar").each((function(t){return VL(t,e)}))},toggleSidebar:function(n,e){_z.getPart(n,t,"sidebar").each((function(t){return PL(t,e)}))},whichSidebar:function(n){return _z.getPart(n,t,"sidebar").bind(HL).getOrNull()},getHeader:function(n){return _z.getPart(n,t,"header")},getToolbar:function(n){return _z.getPart(n,t,"toolbar")},setToolbar:function(n,e){_z.getPart(n,t,"toolbar").each((function(t){t.getApis().setGroups(t,e)}))},setToolbars:function(n,e){_z.getPart(n,t,"multiple-toolbar").each((function(t){Iz.setItems(t,e)}))},refreshToolbar:function(n){var e=_z.getPart(n,t,"toolbar");e.each((function(t){return t.getApis().refresh(t)}))},toggleToolbarDrawer:function(n){_z.getPart(n,t,"toolbar").each((function(t){Rt(t.getApis().toggle,(function(n){return n(t)}))}))},isToolbarDrawerToggled:function(n){return _z.getPart(n,t,"toolbar").bind((function(t){return V.from(t.getApis().isOpen).map((function(n){return n(t)}))})).getOr(!1)},getThrobber:function(n){return _z.getPart(n,t,"throbber")},focusToolbar:function(n){var e=_z.getPart(n,t,"toolbar").orThunk((function(){return _z.getPart(n,t,"multiple-toolbar")}));e.each((function(t){Dx.focusIn(t)}))},setMenubar:function(n,e){_z.getPart(n,t,"menubar").each((function(t){qN.setMenus(t,e)}))},focusMenubar:function(n){_z.getPart(n,t,"menubar").each((function(t){qN.focus(t)}))}};return{uid:t.uid,dom:t.dom,components:n,apis:o,behaviours:t.behaviours}},ZW=Tz.optional({factory:qN,name:"menubar",schema:[Di("backstage")]}),tU=function(t){return t.type===Wk.sliding?JW:t.type===Wk.floating?KW:$W},nU=Tz.optional({factory:{sketch:function(t){return Iz.sketch({uid:t.uid,dom:t.dom,listBehaviours:ml([Dx.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return $W({type:t.type,uid:rc("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:t.providers,onEscape:function(){return t.onEscape(),V.some(!0)}})},setupItem:function(t,n,e,o){zz.setGroups(n,e)},shell:!0})}},name:"multiple-toolbar",schema:[Di("dom"),Di("onEscape")]}),eU=Tz.optional({factory:{sketch:function(t){var n=tU(t),e={type:t.type,uid:t.uid,onEscape:function(){return t.onEscape(),V.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,providers:t.providers,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton,lazyHeader:t.lazyHeader},attributes:t.attributes};return n(e)}},name:"toolbar",schema:[Di("dom"),Di("onEscape"),Di("getSink")]}),oU=Tz.optional({factory:{sketch:zN},name:"header",schema:[Di("dom")]}),rU=Tz.optional({name:"socket",schema:[Di("dom")]}),iU=Tz.optional({factory:{sketch:LL},name:"sidebar",schema:[Di("dom")]}),uU=Tz.optional({factory:{sketch:eW},name:"throbber",schema:[Di("dom")]}),aU=mh({name:"OuterContainer",factory:QW,configFields:[Di("dom"),Di("behaviours")],partFields:[oU,ZW,eU,nU,rU,iU,uU],apis:{getSocket:function(t,n){return t.getSocket(n)},setSidebar:function(t,n,e){t.setSidebar(n,e)},toggleSidebar:function(t,n,e){t.toggleSidebar(n,e)},whichSidebar:function(t,n){return t.whichSidebar(n)},getHeader:function(t,n){return t.getHeader(n)},getToolbar:function(t,n){return t.getToolbar(n)},setToolbar:function(t,n,e){var o=X(e,(function(t){return XW(t)}));t.setToolbar(n,o)},setToolbars:function(t,n,e){var o=X(e,(function(t){return X(t,XW)}));t.setToolbars(n,o)},refreshToolbar:function(t,n){return t.refreshToolbar(n)},toggleToolbarDrawer:function(t,n){t.toggleToolbarDrawer(n)},isToolbarDrawerToggled:function(t,n){return t.isToolbarDrawerToggled(n)},getThrobber:function(t,n){return t.getThrobber(n)},setMenubar:function(t,n,e){t.setMenubar(n,e)},focusMenubar:function(t,n){t.focusMenubar(n)},focusToolbar:function(t,n){t.focusToolbar(n)}}}),cU="file edit view insert format tools table help",sU={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},fU=function(t,n,e){var o=TO(e).split(/[ ,]/);return{text:t.title,getItems:function(){return ot(t.items,(function(t){var e=t.toLowerCase();return 0===e.trim().length||U(o,(function(t){return t===e}))?[]:"separator"===e||"|"===e?[{type:"separator"}]:n.menuItems[e]?[n.menuItems[e]]:[]}))}}},lU=function(t){return"string"===typeof t?t.split(" "):t},dU=function(t,n){var e=D(D({},sU),n.menus),o=pt(n.menus).length>0,r=void 0===n.menubar||!0===n.menubar?lU(cU):lU(!1===n.menubar?"":n.menubar),i=J(r,(function(t){var e=Tt(sU,t);return o?e||_t(n.menus,t).exists((function(t){return Tt(t,"items")})):e})),u=X(i,(function(o){var r=e[o];return fU({title:r.title,items:lU(r.items)},n,t)}));return J(u,(function(t){var n=function(t){return"separator"!==t.type};return t.getItems().length>0&&U(t.getItems(),n)}))},mU=function(t){var n=function(){t._skinLoaded=!0,pT(t)};return function(){t.initialized?n():t.on("init",n)}},gU=function(t,n){return function(){return vT(t,{message:n})}},pU=function(t,n,e){return new uk((function(o,r){e.load(n,o,r),t.on("remove",(function(){return e.unload(n)}))}))},vU=function(t,n){var e=n+"/skin.min.css";return pU(t,e,t.ui.styleSheetLoader)},hU=function(t,n){var e=Me(nn.fromDom(t.getElement()));if(e){var o=n+"/skin.shadowdom.min.css";return pU(t,o,dO.DOM.styleSheetLoader)}return uk.resolve()},bU=function(t,n){var e=gO(n);e&&n.contentCSS.push(e+(t?"/content.inline":"/content")+".min.css"),!1===vO(n)&&i(e)?uk.all([vU(n,e),hU(n,e)]).then(mU(n),gU(n,"Skin could not be loaded")):mU(n)()},yU=k(bU,!1),xU=k(bU,!0),wU=function(t,n){return function(e){var o=ed(),r=function(){e.setActive(t.formatter.match(n));var r=t.formatter.formatChanged(n,e.setActive);o.set(r)};return t.initialized?r():t.once("init",r),function(){t.off("init",r),o.clear()}}},SU=function(t,n,e){return function(o){var r=function(){return e(o)},i=function(){e(o),t.on(n,r)};return t.initialized?i():t.once("init",i),function(){t.off("init",i),t.off(n,r)}}},kU=function(t){return function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("mceToggleFormat",!1,n.format)}))}}},CU=function(t,n){return function(){return t.execCommand(n)}},OU=function(t,n,e){var o=function(t,o,i,u){var a=n.shared.providers.translate(t.title);if("separator"===t.type)return V.some({type:"separator",text:a});if("submenu"===t.type){var c=ot(t.getStyleItems(),(function(t){return r(t,o,u)}));return 0===o&&c.length<=0?V.none():V.some({type:"nestedmenuitem",text:a,disabled:c.length<=0,getSubmenuItems:function(){return ot(t.getStyleItems(),(function(t){return r(t,o,u)}))}})}return V.some(D({type:"togglemenuitem",text:a,icon:t.icon,active:t.isSelected(u),disabled:i,onAction:e.onAction(t)},t.getStylePreview().fold((function(){return{}}),(function(t){return{meta:{style:t}}}))))},r=function(t,n,r){var i="formatter"===t.type&&e.isInvalid(t);return 0===n?i?[]:o(t,n,!1,r).toArray():o(t,n,i,r).toArray()},i=function(t){var n=e.getCurrentValue(),o=e.shouldHide?0:1;return ot(t,(function(t){return r(t,o,n)}))},u=function(t,n){return function(e,o){var r=n(),u=i(r),a=GR(u,Uk.CLOSE_ON_EXECUTE,t,!1);o(a)}};return{validateItems:i,getFetch:u}},_U=function(t,n,e){var o=e.dataset,r="basic"===o.type?function(){return X(o.data,(function(t){return AH(t,e.isSelectedFor,e.getPreviewFor)}))}:o.getData;return{items:OU(t,n,e),getStyleItems:r}},TU=function(t,n,e){var o=_U(t,n,e),r=o.items,i=o.getStyleItems,u=function(t){return{getComponent:x(t)}},a=SU(t,"NodeChange",(function(t){var n=t.getComponent();e.updateText(n)}));return RR({text:e.icon.isSome()?V.none():e.text,icon:e.icon,tooltip:V.from(e.tooltip),role:V.none(),fetch:r.getFetch(n,i),onSetup:a,getApi:u,columns:1,presets:"normal",classes:e.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",n.shared)},EU=function(t){return X(t,(function(t){var n=t,e=t,o=t.split("=");return o.length>1&&(n=o[0],e=o[1]),{title:n,format:e}}))},DU=function(t){return{type:"basic",data:t}};(function(t){t[t["SemiColon"]=0]="SemiColon",t[t["Space"]=1]="Space"})(KV||(KV={}));var BU,MU=function(t,n){return n===KV.SemiColon?t.replace(/;$/,"").split(";"):t.split(" ")},AU=function(t,n,e,o){var r=t.getParam(n,e,"string"),i=EU(MU(r,o));return{type:"basic",data:i}},FU=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],IU=function(t){var n=function(){return tt(FU,(function(n){return t.formatter.match(n.format)}))},e=function(n){return function(){return t.formatter.match(n)}},o=function(t){return V.none},r=function(t){var e=n(),o=e.fold(x("left"),(function(t){return t.title.toLowerCase()}));ka(t,IR,{icon:"align-"+o})},i=DU(FU),u=function(n){return function(){return tt(FU,(function(t){return t.format===n.format})).each((function(n){return t.execCommand(n.command)}))}};return{tooltip:"Align",text:V.none(),icon:V.some("align-left"),isSelectedFor:e,getCurrentValue:V.none,getPreviewFor:o,onAction:u,updateText:r,dataset:i,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},RU=function(t,n){return TU(t,n,IU(t))},VU=function(t,n){var e=_U(t,n,IU(t));t.ui.registry.addNestedMenuItem("align",{text:n.shared.providers.translate("Align"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},PU="Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",HU=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],zU=function(t){var n=t.split(/\s*,\s*/);return X(n,(function(t){return t.replace(/^['"]+|['"]+$/g,"")}))},NU=function(t){var n=function(){var n=zU(t.toLowerCase());return rt(HU,(function(t){return n.indexOf(t.toLowerCase())>-1}))};return 0===t.indexOf("-apple-system")&&n()},LU=function(t){var n="System Font",e=function(){var e=function(t){return t?zU(t)[0]:""},o=t.queryCommandValue("FontName"),r=c.data,i=o?o.toLowerCase():"",u=tt(r,(function(t){var n=t.format;return n.toLowerCase()===i||e(n).toLowerCase()===e(i).toLowerCase()})).orThunk((function(){return Vt(NU(i),{title:n,format:i})}));return{matchOpt:u,font:o}},o=function(t){return function(n){return n.exists((function(n){return n.format===t}))}},r=function(){var t=e().matchOpt;return t},i=function(t){return function(){return V.some({tag:"div",styles:-1===t.indexOf("dings")?{"font-family":t}:{}})}},u=function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontName",!1,n.format)}))}},a=function(t){var n=e(),o=n.matchOpt,r=n.font,i=o.fold(x(r),(function(t){return t.title}));ka(t,FR,{text:i})},c=AU(t,"font_formats",PU,KV.SemiColon);return{tooltip:"Fonts",text:V.some(n),icon:V.none(),isSelectedFor:o,getCurrentValue:r,getPreviewFor:i,onAction:u,updateText:a,dataset:c,shouldHide:!1,isInvalid:_}},WU=function(t,n){return TU(t,n,LU(t))},UU=function(t,n){var e=_U(t,n,LU(t));t.ui.registry.addNestedMenuItem("fontformats",{text:n.shared.providers.translate("Fonts"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},jU="8pt 10pt 12pt 14pt 18pt 24pt 36pt",GU={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},XU={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},YU=function(t,n){var e=Math.pow(10,n);return Math.round(t*e)/e},qU=function(t,n){return/[0-9.]+px$/.test(t)?YU(72*parseInt(t,10)/96,n||0)+"pt":_t(XU,t).getOr(t)},KU=function(t){return _t(GU,t).getOr("")},JU=function(t){var n=function(){var n=V.none(),e=a.data,o=t.queryCommandValue("FontSize");if(o)for(var r=function(t){var r=qU(o,t),i=KU(r);n=tt(e,(function(t){return t.format===o||t.format===r||t.format===i}))},i=3;n.isNone()&&i>=0;i--)r(i);return{matchOpt:n,size:o}},e=function(t){return function(n){return n.exists((function(n){return n.format===t}))}},o=function(){var t=n().matchOpt;return t},r=x(V.none),i=function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontSize",!1,n.format)}))}},u=function(t){var e=n(),o=e.matchOpt,r=e.size,i=o.fold(x(r),(function(t){return t.title}));ka(t,FR,{text:i})},a=AU(t,"fontsize_formats",jU,KV.Space);return{tooltip:"Font sizes",text:V.some("12pt"),icon:V.none(),isSelectedFor:e,getPreviewFor:r,getCurrentValue:o,onAction:i,updateText:u,dataset:a,shouldHide:!1,isInvalid:_}},$U=function(t,n){return TU(t,n,JU(t))},QU=function(t,n){var e=_U(t,n,JU(t));t.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},ZU=function(t,n){var e=n(),o=X(e,(function(t){return t.format}));return V.from(t.formatter.closest(o)).bind((function(t){return tt(e,(function(n){return n.format===t}))})).orThunk((function(){return Vt(t.formatter.match("p"),{title:"Paragraph",format:"p"})}))},tj="Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",nj=function(t){var n="Paragraph",e=function(n){return function(){return t.formatter.match(n)}},o=function(n){return function(){var e=t.formatter.get(n);return V.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))})}},r=function(e){var o=ZU(t,(function(){return i.data})),r=o.fold(x(n),(function(t){return t.title}));ka(e,FR,{text:r})},i=AU(t,"block_formats",tj,KV.SemiColon);return{tooltip:"Blocks",text:V.some(n),icon:V.none(),isSelectedFor:e,getCurrentValue:V.none,getPreviewFor:o,onAction:kU(t),updateText:r,dataset:i,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},ej=function(t,n){return TU(t,n,nj(t))},oj=function(t,n){var e=_U(t,n,nj(t));t.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},rj=function(t,n){var e="Paragraph",o=function(n){return function(){return t.formatter.match(n)}},r=function(n){return function(){var e=t.formatter.get(n);return void 0!==e?V.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):V.none()}},i=function(n){var o=function(t){var n=t.items;return void 0!==n&&n.length>0?ot(n,o):[{title:t.title,format:t.format}]},r=ot(MH(t),o),i=ZU(t,x(r)),u=i.fold(x(e),(function(t){return t.title}));ka(n,FR,{text:u})};return{tooltip:"Formats",text:V.some(e),icon:V.none(),isSelectedFor:o,getCurrentValue:V.none,getPreviewFor:r,onAction:kU(t),updateText:i,shouldHide:t.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(n){return!t.formatter.canApply(n.format)},dataset:n}},ij=function(t,n){var e=D({type:"advanced"},n.styleselect);return TU(t,n,rj(t,e))},uj=function(t,n){var e=D({type:"advanced"},n.styleselect),o=_U(t,n,rj(t,e));t.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return o.items.validateItems(o.getStyleItems())}})},aj=function(t,n){var e=function(e,o){t.updateState.each((function(t){var r=t(e,o);n.set(r)})),t.renderComponents.each((function(t){var r=t(o,n.get()),i=X(r,e.getSystem().build);Ug(e,i)}))};return Ea([Aa(ta(),(function(n,o){var r=o;if(!r.universal){var i=t.channel;W(r.channels,i)&&e(n,r.data)}})),Wa((function(n,o){t.initialData.each((function(t){e(n,t)}))}))])},cj=Object.freeze({__proto__:null,events:aj}),sj=function(t,n,e){return e},fj=Object.freeze({__proto__:null,getState:sj}),lj=[Di("channel"),Ni("renderComponents"),Ni("updateState"),Ni("initialData")],dj=function(){var t=ru(V.none()),n=function(){return t.set(V.none())},e=function(){return t.get().getOr("none")};return{readState:e,get:t.get,set:t.set,clear:n}},mj=Object.freeze({__proto__:null,init:dj}),gj=pl({fields:lj,name:"reflecting",active:cj,apis:fj,state:mj}),pj=x([Di("toggleClass"),Di("fetch"),ff("onExecute"),qi("getHotspot",V.some),qi("getAnchorOverrides",x({})),zd(),ff("onItemExecute"),Ni("lazySink"),Di("dom"),cf("onOpen"),nv("splitDropdownBehaviours",[bB,Dx,Jx]),qi("matchWidth",!1),qi("useMinWidth",!1),qi("eventOrder",{}),Ni("role")].concat(FB())),vj=Fv({factory:kS,schema:[Di("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:ml([Jx.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each(Ca)},buttonBehaviours:ml([pw.config({toggleOnExecute:!1,toggleClass:t.toggleClass})])}}}),hj=Fv({factory:kS,schema:[Di("dom")],name:"button",defaults:function(){return{buttonBehaviours:ml([Jx.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each((function(e){t.onExecute(e,n)}))}}}}),bj=x([vj,hj,Rv({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Di("text")],name:"aria-descriptor"}),Iv({schema:[rf()],name:"menu",defaults:function(t){return{onExecute:function(n,e){n.getSystem().getByUid(t.uid).each((function(o){t.onItemExecute(o,n,e)}))}}}}),xB()]),yj=function(t,n,e,o){var r,i=function(t){bh.getCurrent(t).each((function(t){ob.highlightFirst(t),Dx.focusIn(t)}))},u=function(n){var e=i;TB(t,w,n,o,e,GD.HighlightFirst).get(v)},a=function(t){return u(t),V.some(!0)},c=function(n){var e=Kv(n,t,"button");return Ca(e),V.some(!0)},s=D(D({},Ea([Wa((function(n,e){var o=qv(n,t,"aria-descriptor");o.each((function(t){var e=rc("aria");Ne(t.element,"id",e),Ne(n.element,"aria-describedby",e)}))}))])),hw(V.some(u))),f={repositionMenus:function(t){pw.isOn(t)&&AB(t)}};return{uid:t.uid,dom:t.dom,components:n,apis:f,eventOrder:D(D({},t.eventOrder),(r={},r[na()]=["disabling","toggling","alloy.base.behaviour"],r)),events:s,behaviours:ov(t.splitDropdownBehaviours,[bB.config({others:{sandbox:function(n){var e=Kv(n,t,"arrow"),o={onOpen:function(){pw.on(e),pw.on(n)},onClose:function(){pw.off(e),pw.off(n)}};return MB(t,n,o)}}}),Dx.config({mode:"special",onSpace:c,onEnter:c,onDown:a}),Jx.config({}),pw.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:t.role.getOr("button"),"aria-haspopup":!0}}}},xj=mh({name:"SplitDropdown",configFields:pj(),partFields:bj(),factory:yj,apis:{repositionMenus:function(t,n){return t.repositionMenus(n)}}}),wj=function(t){return{isDisabled:function(){return Ph.isDisabled(t)},setDisabled:function(n){return Ph.set(t,n)}}},Sj=function(t){return{setActive:function(n){pw.set(t,n)},isActive:function(){return pw.isOn(t)},isDisabled:function(){return Ph.isDisabled(t)},setDisabled:function(n){return Ph.set(t,n)}}},kj=function(t,n){return t.map((function(t){return{"aria-label":n.translate(t),title:n.translate(t)}})).getOr({})},Cj=rc("focus-button"),Oj=function(t,n,e,o,r,i){var u;return{dom:{tag:"button",classes:["tox-tbtn"].concat(n.isSome()?["tox-tbtn--select"]:[]),attributes:kj(e,i)},components:y_([t.map((function(t){return TR(t,i.icons)})),n.map((function(t){return DR(t,"tox-tbtn",i)}))]),eventOrder:(u={},u[Fu()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:ml([m_.toolbarButton(i.isDisabled),c_(),Lx("common-button-display-events",[Aa(Fu(),(function(t,n){n.event.prevent(),Sa(t,Cj)}))])].concat(o.map((function(e){return gj.config({channel:e,initialData:{icon:t,text:n},renderComponents:function(t,n){return y_([t.icon.map((function(t){return TR(t,i.icons)})),t.text.map((function(t){return DR(t,"tox-tbtn",i)}))])}})})).toArray()).concat(r.getOr([])))}},_j=function(t,n,e,o){var r=n.shared;return DW.sketch({lazySink:r.getSink,fetch:function(){return tB.nu((function(n){n(X(e(t.items),XW))}))},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:Oj(t.icon,t.text,t.tooltip,V.none(),V.none(),r.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o}}}})},Tj=function(t,n,e){var o=ru(v),r=Oj(t.icon,t.text,t.tooltip,V.none(),V.none(),e);return kS.sketch({dom:r.dom,components:r.components,eventOrder:AR,buttonBehaviours:ml([Lx("toolbar-button-events",[MR({onAction:t.onAction,getApi:n.getApi}),p_(n,o),v_(n,o)]),m_.toolbarButton((function(){return t.disabled||e.isDisabled()})),c_()].concat(n.toolbarButtonBehaviours))})},Ej=function(t,n){return Dj(t,n,[])},Dj=function(t,n,e){return Tj(t,{toolbarButtonBehaviours:[].concat(e.length>0?[Lx("toolbarButtonWith",e)]:[]),getApi:wj,onSetup:t.onSetup},n)},Bj=function(t,n){return Mj(t,n,[])},Mj=function(t,n,e){return Sr(Tj(t,{toolbarButtonBehaviours:[zx.config({}),pw.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(e.length>0?[Lx("toolbarToggleButtonWith",e)]:[]),getApi:Sj,onSetup:t.onSetup},n))},Aj=function(t,n,e){return function(o){return tB.nu((function(t){return n.fetch(t)})).map((function(r){return V.from(AE(Sr(eE(rc("menu-value"),r,(function(e){n.onItemAction(t(o),e)}),n.columns,n.presets,Uk.CLOSE_ON_EXECUTE,n.select.getOr(_),e),{movement:rE(n.columns,n.presets),menuBehaviours:QC.unnamedEvents("auto"!==n.columns?[]:[Wa((function(t,e){KC(t,4,fC(n.presets)).each((function(n){var e=n.numRows,o=n.numColumns;Dx.setGridSize(t,e,o)}))}))])})))}))}},Fj=function(t,n){var e,o=rc("channel-update-split-dropdown-display"),r=function(t){return{isDisabled:function(){return Ph.isDisabled(t)},setDisabled:function(n){return Ph.set(t,n)},setIconFill:function(n,e){Hs(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){Ne(t,"fill",e)}))},setIconStroke:function(n,e){Hs(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){Ne(t,"stroke",e)}))},setActive:function(n){Ne(t.element,"aria-pressed",n),Hs(t.element,"span").each((function(e){t.getSystem().getByDom(e).each((function(t){return pw.set(t,n)}))}))},isActive:function(){return Hs(t.element,"span").exists((function(n){return t.getSystem().getByDom(n).exists(pw.isOn)}))}}},i=ru(v),u={getApi:r,onSetup:t.onSetup};return xj.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:D({"aria-pressed":!1},kj(t.tooltip,n.providers))},onExecute:function(n){t.onAction(r(n))},onItemExecute:function(t,n,e){},splitDropdownBehaviours:ml([m_.splitButton(n.providers.isDisabled),c_(),Lx("split-dropdown-events",[Aa(Cj,Jx.focus),p_(u,i),v_(u,i)]),LB.config({})]),eventOrder:(e={},e[da()]=["alloy.base.behaviour","split-dropdown-events"],e),toggleClass:"tox-tbtn--enabled",lazySink:n.getSink,fetch:Aj(r,t,n.providers),parts:{menu:vC(!1,t.columns,t.presets)},components:[xj.parts.button(Oj(t.icon,t.text,V.none(),V.some(o),V.some([pw.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),n.providers)),xj.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:MS("chevron-down",n.providers.icons)},buttonBehaviours:ml([m_.splitButton(n.providers.isDisabled),c_(),IS()])}),xj.parts["aria-descriptor"]({text:n.providers.translate("To open the popup, press Shift+Enter")})]})},Ij=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],Rj=function(t,n){return function(e,o,r){var i=t(e).mapError((function(t){return ki(t)})).getOrDie();return n(i,o,r)}},Vj={button:Rj(_k,(function(t,n){return Ej(t,n.backstage.shared.providers)})),togglebutton:Rj(Dk,(function(t,n){return Bj(t,n.backstage.shared.providers)})),menubutton:Rj(jN,(function(t,n){return YR(t,"tox-tbtn",n.backstage,V.none())})),splitbutton:Rj(XN,(function(t,n){return Fj(t,n.backstage.shared)})),grouptoolbarbutton:Rj(LN,(function(t,n,e){var o,r=e.ui.registry.getAll().buttons,i=function(t){return jj(e,{buttons:r,toolbar:t,allowToolbarGroups:!1},n,V.none())},u=(o={},o[Pd]=n.backstage.shared.header.isPositionedAtTop()?zl.TopToBottom:zl.BottomToTop,o);switch(FO(e)){case Wk.floating:return _j(t,n.backstage,i,u);default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}})),styleSelectButton:function(t,n){return ij(t,n.backstage)},fontsizeSelectButton:function(t,n){return $U(t,n.backstage)},fontSelectButton:function(t,n){return WU(t,n.backstage)},formatButton:function(t,n){return ej(t,n.backstage)},alignMenuButton:function(t,n){return RU(t,n.backstage)}},Pj=function(t,n,e){return _t(Vj,t.type).fold((function(){return console.error("skipping button defined by",t),V.none()}),(function(o){return V.some(o(t,n,e))}))},Hj={styleselect:Vj.styleSelectButton,fontsizeselect:Vj.fontsizeSelectButton,fontselect:Vj.fontSelectButton,formatselect:Vj.formatButton,align:Vj.alignMenuButton},zj=function(t){var n=X(Ij,(function(n){var e=J(n.items,(function(n){return Tt(t,n)||Tt(Hj,n)}));return{name:n.name,items:e}}));return J(n,(function(t){return t.items.length>0}))},Nj=function(t){var n=t.split("|");return X(n,(function(t){return{items:t.trim().split(" ")}}))},Lj=function(t){return p(t,(function(t){return Tt(t,"name")&&Tt(t,"items")}))},Wj=function(t){var n=t.toolbar,e=t.buttons;return!1===n?[]:void 0===n||!0===n?zj(e):i(n)?Nj(n):Lj(n)?n:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},Uj=function(t,n,e,o,r,i){return _t(n,e.toLowerCase()).orThunk((function(){return i.bind((function(t){return gt(t,(function(t){return _t(n,t+e.toLowerCase())}))}))})).fold((function(){return _t(Hj,e.toLowerCase()).map((function(n){return n(t,r)})).orThunk((function(){return V.none()}))}),(function(n){return"grouptoolbarbutton"!==n.type||o?Pj(n,r,t):(console.warn("Ignoring the '"+e+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),V.none())}))},jj=function(t,n,e,o){var r=Wj(n),i=X(r,(function(r){var i=ot(r.items,(function(r){return 0===r.trim().length?[]:Uj(t,n.buttons,r,n.allowToolbarGroups,e,o).toArray()}));return{title:V.from(t.translate(r.name)),items:i}}));return J(i,(function(t){return t.items.length>0}))},Gj=function(t,n,e,o){var r=n.outerContainer,u=e.toolbar,a=e.buttons;if(p(u,i)){var c=u.map((function(n){var r={toolbar:n,buttons:a,allowToolbarGroups:e.allowToolbarGroups};return jj(t,r,{backstage:o},V.none())}));aU.setToolbars(r,c)}else aU.setToolbar(r,jj(t,e,{backstage:o},V.none()))},Xj=ee(),Yj=Xj.os.isiOS()&&Xj.os.version.major<=12,qj=function(t,n){var e=t.dom,o=t.getWin(),r=t.getDoc().documentElement,i=ru(fo(o.innerWidth,o.innerHeight)),u=ru(fo(r.offsetWidth,r.offsetHeight)),a=function(){var n=i.get();n.left===o.innerWidth&&n.top===o.innerHeight||(i.set(fo(o.innerWidth,o.innerHeight)),bT(t))},c=function(){var n=t.getDoc().documentElement,e=u.get();e.left===n.offsetWidth&&e.top===n.offsetHeight||(u.set(fo(n.offsetWidth,n.offsetHeight)),bT(t))},s=function(n){return yT(t,n)};e.bind(o,"resize",a),e.bind(o,"scroll",s);var f=ad(nn.fromDom(t.getBody()),"load",c),l=n.uiMothership.element;t.on("hide",(function(){qe(l,"display","none")})),t.on("show",(function(){eo(l,"display")})),t.on("NodeChange",c),t.on("remove",(function(){f.unbind(),e.unbind(o,"resize",a),e.unbind(o,"scroll",s),o=null}))},Kj=function(t,n,e,o,r){var i=ru(0),u=n.outerContainer;yU(t);var a=nn.fromDom(r.targetNode),c=Be(De(a));Jg(a,n.mothership),Kg(c,n.uiMothership),t.on("PostRender",(function(){Gj(t,n,e,o),i.set(t.getWin().innerWidth),aU.setMenubar(u,dU(t,e)),aU.setSidebar(u,e.sidebar),qj(t,n)}));var s=aU.getSocket(u).getOrDie("Could not find expected socket element");if(Yj){Ke(s.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"});var f=US((function(){t.fire("ScrollContent")}),20),l=ud(s.element,"scroll",f.throttle);t.on("remove",l.unbind)}a_(t,n),t.addCommand("ToggleSidebar",(function(n,e){aU.toggleSidebar(u,e),t.fire("ToggleSidebar")})),t.addQueryValueHandler("ToggleSidebar",(function(){return aU.whichSidebar(u)}));var d=FO(t),m=function(){aU.refreshToolbar(n.outerContainer)};d!==Wk.sliding&&d!==Wk.floating||t.on("ResizeWindow ResizeEditor ResizeContent",(function(){var n=t.getWin().innerWidth;n!==i.get()&&(m(),i.set(n))}));var g={enable:function(){u_(n,!1)},disable:function(){u_(n,!0)},isDisabled:function(){return Ph.isDisabled(u)}};return{iframeContainer:s.element.dom,editorContainer:u.element.dom,api:g}},Jj=Object.freeze({__proto__:null,render:Kj}),$j=function(t){var n=/^[0-9\.]+(|px)$/i;return n.test(""+t)?V.some(parseInt(""+t,10)):V.none()},Qj=function(t){return g(t)?t+"px":t},Zj=function(t,n,e){var o=n.filter((function(n){return t<n})),r=e.filter((function(n){return t>n}));return o.or(r).getOr(t)},tG=function(t){var n=hO(t),e=xO(t),o=SO(t);return $j(n).map((function(t){return Zj(t,e,o)}))},nG=function(t){var n=tG(t);return n.getOr(hO(t))},eG=function(t){var n=bO(t),e=yO(t),o=wO(t);return $j(n).map((function(t){return Zj(t,e,o)}))},oG=function(t){var n=eG(t);return n.getOr(bO(t))},rG=function(t,n,e,o,r){var i=e.uiMothership,u=e.outerContainer,a=dO.DOM,c=WO(t),s=GO(t),f=wO(t).or(eG(t)),l=o.shared.header,d=l.isPositionedAtTop,m=FO(t),g=m===Wk.sliding||m===Wk.floating,p=ru(!1),v=function(){return p.get()&&!t.removed},h=function(t){return g?t.fold(x(0),(function(t){return t.components().length>1?uo(t.components()[1].element):0})):0},b=function(e){switch(VO(t)){case AO.auto:var o=aU.getToolbar(u),r=h(o),i=uo(e.element)-r,a=Qo(n),c=a.y>i;if(c)return"top";var s=pe(n),f=Math.max(s.dom.scrollHeight,uo(s)),l=a.bottom<f-i;if(l)return"bottom";var d=tr(),m=d.bottom<a.bottom-i;return m?"bottom":"top";case AO.bottom:return"bottom";case AO.top:default:return"top"}},y=function(t){var n=r.get();SN.setModes(n,[t]),l.setDockingMode(t);var e=d()?zl.TopToBottom:zl.BottomToTop;Ne(n.element,Pd,e)},w=function(){var t=f.getOrThunk((function(){var t=$j($e(Pe(),"margin-left")).getOr(0);return bo(Pe())-go(n).left+t}));qe(r.get().element,"max-width",t+"px")},S=function(){var t=aU.getToolbar(u),e=h(t),o=Qo(n),i=d()?Math.max(o.y-uo(r.get().element)+e,0):o.bottom;Ke(u.element,{position:"absolute",top:Math.round(i)+"px",left:Math.round(o.x)+"px"})},k=function(){i.broadcastOn([xp()],{})},C=function(t){if(void 0===t&&(t=!1),v()){if(c||w(),g&&aU.refreshToolbar(u),c||S(),s){var n=r.get();t?SN.reset(n):SN.refresh(n)}k()}},O=function(t){if(void 0===t&&(t=!0),!c&&s&&v()){var n=l.getDockingMode(),e=b(r.get());e!==n&&(y(e),t&&C(!0))}},_=function(){p.set(!0),qe(u.element,"display","flex"),a.addClass(t.getBody(),"mce-edit-focus"),eo(i.element,"display"),O(!1),C()},T=function(){p.set(!1),e.outerContainer&&(qe(u.element,"display","none"),a.removeClass(t.getBody(),"mce-edit-focus")),qe(i.element,"display","none")};return{isVisible:v,isPositionedAtTop:d,show:_,hide:T,update:C,updateMode:O,repositionPopups:k}},iG=function(t,n){var e=Qo(t);return{pos:n?e.y:e.bottom,bounds:e}},uG=function(t,n,e,o){var r=ru(iG(n,e.isPositionedAtTop())),i=function(o){var i=iG(n,e.isPositionedAtTop()),u=i.pos,a=i.bounds,c=r.get(),s=c.pos,f=c.bounds,l=a.height!==f.height||a.width!==f.width;r.set({pos:u,bounds:a}),l&&bT(t,o),e.isVisible()&&(s!==u?e.update(!0):l&&(e.updateMode(),e.repositionPopups()))};o||(t.on("activate",e.show),t.on("deactivate",e.hide)),t.on("SkinLoaded ResizeWindow",(function(){return e.update(!0)})),t.on("NodeChange keydown",(function(t){wS.requestAnimationFrame((function(){return i(t)}))})),t.on("ScrollWindow",(function(){return e.updateMode()}));var u=ed();u.set(ad(nn.fromDom(t.getBody()),"load",i)),t.on("remove",(function(){u.clear()}))},aG=function(t,n,e,o,r){var i=n.mothership,u=n.uiMothership,a=n.outerContainer,c=ru(null),s=nn.fromDom(r.targetNode),f=rG(t,s,n,o,c),l=NO(t);xU(t);var d=function(){if(c.get())f.show();else{c.set(aU.getHeader(a).getOrDie());var r=UO(t);Kg(r,i),Kg(r,u),Gj(t,n,e,o),aU.setMenubar(a,dU(t,e)),f.show(),uG(t,s,f,l),t.nodeChanged()}};t.on("show",d),t.on("hide",f.hide),l||(t.on("focus",d),t.on("blur",f.hide)),t.on("init",(function(){(t.hasFocus()||l)&&d()})),a_(t,n);var m={show:function(){f.show()},hide:function(){f.hide()},enable:function(){u_(n,!1)},disable:function(){u_(n,!0)},isDisabled:function(){return Ph.isDisabled(a)}};return{editorContainer:a.element.dom,api:m}},cG=Object.freeze({__proto__:null,render:aG}),sG="contexttoolbar-show",fG="contexttoolbar-hide",lG=function(t){return{hide:function(){return Sa(t,ia())},getValue:function(){return tv.getValue(t)}}},dG=function(t,n){return Aa(BR,(function(e,o){var r=t.get(e),i=lG(r);n.onAction(i,o.event.buttonApi)}))},mG=function(t,n,e){var o=n.original;o.primary;var r=B(o,["primary"]),i=wi(_k(D(D({},r),{type:"button",onAction:v})));return Dj(i,e.backstage.shared.providers,[dG(t,n)])},gG=function(t,n,e){var o=n.original;o.primary;var r=B(o,["primary"]),i=wi(Dk(D(D({},r),{type:"togglebutton",onAction:v})));return Mj(i,e.backstage.shared.providers,[dG(t,n)])},pG=function(t,n,e){var o={backstage:{shared:{providers:e}}};return"contextformtogglebutton"===n.type?gG(t,n,o):mG(t,n,o)},vG=function(t,n,e){var o=X(n,(function(n){return CS(pG(t,n,e))})),r=function(){return X(o,(function(t){return t.asSpec()}))},i=function(t){return gt(n,(function(n,e){return n.primary?V.from(o[e]).bind((function(n){return n.getOpt(t)})).filter(C(Ph.isDisabled)):V.none()}))};return{asSpecs:r,findPrimary:i}},hG=function(t,n){var e=t.label.fold((function(){return{}}),(function(t){return{"aria-label":t}})),o=CS(WD.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:e,selectOnFocus:!0,inputBehaviours:ml([Dx.config({mode:"special",onEnter:function(t){return r.findPrimary(t).map((function(t){return Ca(t),!0}))},onLeft:function(t,n){return n.cut(),V.none()},onRight:function(t,n){return n.cut(),V.none()}})])})),r=vG(o,t.commands,n);return[{title:V.none(),items:[o.asSpec()]},{title:V.none(),items:r.asSpecs()}]},bG=function(t,n,e){return $W({type:t,uid:rc("context-toolbar"),initGroups:hG(n,e),onEscape:V.none,cyclicKeying:!0,providers:e})},yG={renderContextForm:bG,buildInitGroups:hG},xG=function(t,n,e){return void 0===e&&(e=.01),n.bottom-t.y>=e&&t.bottom-n.y>=e},wG=function(t){var n=t.getBoundingClientRect();if(n.height<=0&&n.width<=0){var e=Oe(nn.fromDom(t.startContainer),t.startOffset).element,o=dn(e)?he(e):V.some(e);return o.filter(ln).map((function(t){return t.dom.getBoundingClientRect()})).getOr(n)}return n},SG=function(t){var n=t.selection.getRng(),e=wG(n);if(t.inline){var o=Ho();return $o(o.left+e.left,o.top+e.top,e.width,e.height)}var r=Zo(nn.fromDom(t.getBody()));return $o(r.x+e.left,r.y+e.top,e.width,e.height)},kG=function(t,n){return n.filter(Ve).map(Zo).getOrThunk((function(){return SG(t)}))},CG=function(t,n,e){var o=Math.max(t.x+e,n.x),r=Math.min(t.right-e,n.right);return{x:o,width:r-o}},OG=function(t,n,e,o,r,i){var u=nn.fromDom(t.getContainer()),a=Hs(u,".tox-editor-header").getOr(u),c=Qo(a),s=c.y>=n.bottom,f=o&&!s;if(t.inline&&f)return{y:Math.max(c.bottom+i,e.y),bottom:e.bottom};if(t.inline&&!f)return{y:e.y,bottom:Math.min(c.y-i,e.bottom)};var l="line"===r?Qo(u):n;return f?{y:Math.max(c.bottom+i,e.y),bottom:Math.min(l.bottom-i,e.bottom)}:{y:Math.max(l.y+i,e.y),bottom:Math.min(c.y-i,e.bottom)}},_G=function(t,n,e,o){void 0===o&&(o=0);var r=Wo(window),i=Qo(nn.fromDom(t.getContentAreaContainer())),u=EO(t)||DO(t)||MO(t),a=CG(i,r,o),c=a.x,s=a.width;if(t.inline&&!u)return $o(c,r.y,s,r.height);var f=n.header.isPositionedAtTop(),l=OG(t,i,r,f,e,o),d=l.y,m=l.bottom;return $o(c,d,s,m-d)},TG=12,EG={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"],inset:["tox-pop--inset"]},DG={maxHeightFunction:Td(),maxWidthFunction:wW()},BG=function(t,n){var e=t.selection.getRng(),o=Oe(nn.fromDom(e.startContainer),e.startOffset);return e.startContainer===e.endContainer&&e.startOffset===e.endOffset-1&&se(o.element,n)},MG=function(t,n,e){var o=Ze(t,"position");qe(t,"position",n);var r=e(t);return o.each((function(n){return qe(t,"position",n)})),r},AG=function(t){return"node"===t},FG=function(t,n,e,o,r){var i=SG(t),u=o.lastElement().exists((function(t){return se(e,t)}));if(BG(t,e))return u?bS:mS;if(u)return MG(n,o.getMode(),(function(){var t=xG(i,Qo(n));return t&&!o.isReposition()?xS:bS}));var a="fixed"===o.getMode()?r.y+Ho().top:r.y,c=uo(n)+TG;return a+c<=i.y?mS:gS},IG=function(t,n,e,o){var r=function(n){return function(o,r,i,u,a){var c=FG(t,u,n,e,a),s=D(D({},o),{y:a.y,height:a.height});return D(D({},c(s,r,i,u,a)),{alwaysFit:!0})}},i=function(t){return AG(o)?[r(t)]:[]},u={onLtr:function(t){return[Xf,Yf,jf,Wf,Gf,Uf].concat(i(t))},onRtl:function(t){return[Xf,Yf,Gf,Uf,jf,Wf].concat(i(t))}},a={onLtr:function(t){return[Yf,Wf,Uf,jf,Gf,Xf].concat(i(t))},onRtl:function(t){return[Yf,Uf,Wf,Gf,jf,Xf].concat(i(t))}};return n?a:u},RG=function(t,n,e,o){return"line"===n?{bubble:Ad(TG,0,EG),layouts:{onLtr:function(){return[qf]},onRtl:function(){return[Kf]}},overrides:DG}:{bubble:Ad(0,TG,EG,1/TG),layouts:IG(t,e,o,n),overrides:DG}},VG=function(t,n){var e=J(n,(function(n){return n.predicate(t.dom)})),o=K(e,(function(t){return"contexttoolbar"===t.type})),r=o.pass,i=o.fail;return{contextToolbars:r,contextForms:i}},PG=function(t){if(t.length<=1)return t;var n=function(n){return U(t,(function(t){return t.position===n}))},e=function(n){return J(t,(function(t){return t.position===n}))},o=n("selection"),r=n("node");if(o||r){if(r&&o){var i=e("node"),u=X(e("selection"),(function(t){return D(D({},t),{position:"node"})}));return i.concat(u)}return e(o?"selection":"node")}return e("line")},HG=function(t){if(t.length<=1)return t;var n=function(n){return tt(t,(function(t){return t.position===n}))},e=n("selection").orThunk((function(){return n("node")})).orThunk((function(){return n("line")})).map((function(t){return t.position}));return e.fold((function(){return[]}),(function(n){return J(t,(function(t){return t.position===n}))}))},zG=function(t,n,e){var o=VG(t,n);if(o.contextForms.length>0)return V.some({elem:t,toolbars:[o.contextForms[0]]});var r=VG(t,e);if(r.contextForms.length>0)return V.some({elem:t,toolbars:[r.contextForms[0]]});if(o.contextToolbars.length>0||r.contextToolbars.length>0){var i=PG(o.contextToolbars.concat(r.contextToolbars));return V.some({elem:t,toolbars:i})}return V.none()},NG=function(t,n,e){return t(n)?V.none():yu(n,(function(t){if(ln(t)){var n=VG(t,e.inNodeScope),o=n.contextToolbars,r=n.contextForms,i=r.length>0?r:HG(o);return i.length>0?V.some({elem:t,toolbars:i}):V.none()}return V.none()}),t)},LG=function(t,n){var e=nn.fromDom(n.getBody()),o=function(t){return se(t,e)},r=function(t){return!o(t)&&!de(e,t)},i=nn.fromDom(n.selection.getNode());return r(i)?V.none():zG(i,t.inNodeScope,t.inEditorScope).orThunk((function(){return NG(o,i,t)}))},WG=function(t,n){var e={},o=[],r=[],i={},u={},a=function(t,a){var c=wi(Pk(a));e[t]=c,c.launch.map((function(e){i["form:"+t]=D(D({},a.launch),{type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:function(){n(c)}})})),"editor"===c.scope?r.push(c):o.push(c),u[t]=c},c=function(t,n){zk(n).each((function(e){"editor"===n.scope?r.push(e):o.push(e),u[t]=e}))},s=pt(t);return Y(s,(function(n){var e=t[n];"contextform"===e.type?a(n,e):"contexttoolbar"===e.type&&c(n,e)})),{forms:e,inNodeScope:o,inEditorScope:r,lookupTable:u,formNavigators:i}},UG=rc("forward-slide"),jG=rc("backward-slide"),GG=rc("change-slide-event"),XG="tox-pop--resizing",YG=function(t){var n=ru([]);return nS.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){n.set([]),nS.getContent(t).each((function(t){eo(t.element,"visibility")})),as(t.element,XG),eo(t.element,"width")},inlineBehaviours:ml([Lx("context-toolbar-events",[La(Xu(),(function(t,n){"width"===n.event.raw.propertyName&&(as(t.element,XG),eo(t.element,"width"))})),Aa(GG,(function(t,n){var e=t.element;eo(e,"width");var o=bo(e);nS.setContent(t,n.event.contents),is(e,XG);var r=bo(e);qe(e,"width",o+"px"),nS.getContent(t).each((function(t){n.event.focus.bind((function(t){return kl(t),Tl(e)})).orThunk((function(){return Dx.focusIn(t),_l(De(e))}))})),wS.setTimeout((function(){qe(t.element,"width",r+"px")}),0)})),Aa(UG,(function(t,e){nS.getContent(t).each((function(e){n.set(n.get().concat([{bar:e,focus:_l(De(t.element))}]))})),ka(t,GG,{contents:e.event.forwardContents,focus:V.none()})})),Aa(jG,(function(t,e){dt(n.get()).each((function(e){n.set(n.get().slice(0,n.get().length-1)),ka(t,GG,{contents:Es(e.bar),focus:e.focus})}))}))]),Dx.config({mode:"special",onEscape:function(e){return dt(n.get()).fold((function(){return t.onEscape()}),(function(t){return Sa(e,jG),V.some(!0)}))}})]),lazySink:function(){return rr.value(t.sink)}})},qG="tox-pop--transition",KG=function(t,n,e,o){var r=o.backstage,i=r.shared,u=ee().deviceType.isTouch,a=rd(),c=rd(),s=rd(),f=Ts(YG({sink:e,onEscape:function(){return t.focus(),V.some(!0)}})),l=function(){var n=s.get().getOr("node"),e=AG(n)?1:0;return _G(t,i,n,e)},d=function(){return!t.removed&&!(u()&&r.isContextMenuOpen())},m=function(t){return Dt(Ft(t,a.get(),se),!0)},g=function(){if(d()){var n=l(),e=Dt(s.get(),"node")?kG(t,a.get()):SG(t);return n.height<=0||!xG(e,n)}return!0},p=function(){a.clear(),c.clear(),s.clear(),nS.hide(f)},h=function(){if(nS.isOpen(f)){var t=f.element;eo(t,"display"),g()?qe(t,"display","none"):(c.set(0),nS.reposition(f))}},b=function(n){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[n],behaviours:ml([Dx.config({mode:"acyclic"}),Lx("pop-dialog-wrap-events",[Wa((function(n){t.shortcuts.add("ctrl+F9","focus statusbar",(function(){return Dx.focusIn(n)}))})),Ua((function(n){t.shortcuts.remove("ctrl+F9")}))])])}},y=pn((function(){return WG(n,(function(t){var n=S([t]);ka(f,UG,{forwardContents:b(n)})}))})),x=function(n,e){return jj(t,{buttons:n,toolbar:e.items,allowToolbarGroups:!1},o,V.some(["form:"]))},w=function(t,n){return yG.buildInitGroups(t,n)},S=function(n){var e=t.ui.registry.getAll().buttons,o=y(),r=D(D({},e),o.formNavigators),u=FO(t)===Wk.scrolling?Wk.scrolling:Wk.default,a=et(X(n,(function(t){return"contexttoolbar"===t.type?x(r,t):w(t,i.providers)})));return $W({type:u,uid:rc("context-toolbar"),initGroups:a,onEscape:V.none,cyclicKeying:!0,providers:i.providers})},k=function(n,o){var r="node"===n?i.anchors.node(o):i.anchors.cursor(),s=RG(t,n,u(),{lastElement:a.get,isReposition:function(){return Dt(c.get(),0)},getMode:function(){return Hg.getMode(e)}});return Sr(r,s)},C=function(t,n){if(O.cancel(),d()){var o=S(t),r=t[0].position,i=k(r,n);s.set(r),c.set(1);var u=f.element;eo(u,"display"),m(n)||(as(u,qG),Hg.reset(e,f)),nS.showWithinBounds(f,b(o),{anchor:i,transition:{classes:[qG],mode:"placement"}},(function(){return V.some(l())})),n.fold(a.clear,a.set),g()&&qe(u,"display","none")}},O=jS((function(){if(t.hasFocus()&&!t.removed)if(cs(f.element,qG))O.throttle();else{var n=y();LG(n,t).fold(p,(function(t){C(t.toolbars,V.some(t.elem))}))}}),17);t.on("init",(function(){t.on("remove",p),t.on("ScrollContent ScrollWindow ObjectResized ResizeEditor longpress",h),t.on("click keyup focus SetContent",O.throttle),t.on(fG,p),t.on(sG,(function(n){var e=y();_t(e.lookupTable,n.toolbarKey).each((function(e){C([e],Vt(n.target!==t,n.target)),nS.getContent(f).each(Dx.focusIn)}))})),t.on("focusout",(function(n){wS.setEditorTimeout(t,(function(){Tl(e.element).isNone()&&Tl(f.element).isNone()&&p()}),0)})),t.on("SwitchMode",(function(){t.mode.isReadOnly()&&p()})),t.on("AfterProgressState",(function(n){n.state?p():t.hasFocus()&&O.throttle()})),t.on("NodeChange",(function(t){Tl(f.element).fold(O.throttle,v)}))}))},JG=function(t){var n=[{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}];Y(n,(function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onAction:CU(t,n.cmd),onSetup:wU(t,n.name)})})),t.ui.registry.addButton("alignnone",{tooltip:"No alignment",icon:"align-none",onAction:CU(t,"JustifyNone")})},$G={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},QG=function(){var t="[0-9]+",n="[+-]?"+t,e="[eE]"+n,o="\\.",r=function(t){return"(?:"+t+")?"},i=["Infinity",t+o+r(t)+r(e),o+t+r(e),t+r(e)].join("|"),u="[+-]?(?:"+i+")";return new RegExp("^("+u+")(.*)$")}(),ZG=function(t,n){return U(n,(function(n){return U($G[n],(function(n){return t===n}))}))},tX=function(t,n){var e=V.from(QG.exec(t));return e.bind((function(t){var e=Number(t[1]),o=t[2];return ZG(o,n)?V.some({value:e,unit:o}):V.none()}))},nX=function(t,n){return tX(t,n).map((function(t){var n=t.value,e=t.unit;return n+e}))},eX=function(t,n){var e=function(){var e=n.getOptions(t),o=n.getCurrent(t).map(n.hash),r=rd();return X(e,(function(e){return{type:"togglemenuitem",text:n.display(e),onSetup:function(i){var u=function(t){t&&(r.on((function(t){return t.setActive(!1)})),r.set(i)),i.setActive(t)};u(Dt(o,n.hash(e)));var a=n.watcher(t,e,u);return function(){r.clear(),a()}},onAction:function(){return n.setCurrent(t,e)}}}))};t.ui.registry.addMenuButton(n.name,{tooltip:n.text,icon:n.icon,fetch:function(t){return t(e())},onSetup:n.onToolbarSetup}),t.ui.registry.addNestedMenuItem(n.name,{type:"nestedmenuitem",text:n.text,getSubmenuItems:e,onSetup:n.onMenuSetup})},oX={name:"lineheight",text:"Line height",icon:"line-height",getOptions:OO,hash:function(t){return nX(t,["fixed","relative","empty"]).getOr(t)},display:w,watcher:function(t,n,e){return t.formatter.formatChanged("lineheight",e,!1,{value:n}).unbind},getCurrent:function(t){return V.from(t.queryCommandValue("LineHeight"))},setCurrent:function(t,n){return t.execCommand("LineHeight",!1,n)}},rX=function(t){var n=V.from(_O(t));return n.map((function(n){return{name:"language",text:"Language",icon:"language",getOptions:x(n),hash:function(t){return f(t.customCode)?t.code:t.code+"/"+t.customCode},display:function(t){return t.title},watcher:function(t,n,e){return t.formatter.formatChanged("lang",e,!1,{value:n.code,customValue:n.customCode}).unbind},getCurrent:function(t){var n=nn.fromDom(t.selection.getNode());return xu(n,(function(t){return V.some(t).filter(ln).bind((function(t){var n=Ue(t,"lang");return n.map((function(n){var e=Ue(t,"data-mce-lang").getOrUndefined();return{code:n,customCode:e,title:""}}))}))}))},setCurrent:function(t,n){return t.execCommand("Lang",!1,n)},onToolbarSetup:function(n){var e=ed();return n.setActive(t.formatter.match("lang",{},void 0,!0)),e.set(t.formatter.formatChanged("lang",n.setActive,!0)),e.clear}}}))},iX=function(t){eX(t,oX),rX(t).each((function(n){return eX(t,n)}))},uX=function(t,n){VU(t,n),UU(t,n),uj(t,n),oj(t,n),QU(t,n)},aX=function(t){return SU(t,"NodeChange",(function(n){n.setDisabled(!t.queryCommandState("outdent"))}))},cX=function(t){t.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:aX(t),onAction:CU(t,"outdent")}),t.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:CU(t,"indent")})},sX=function(t){cX(t)},fX=function(t,n){return function(){t.execCommand("mceToggleFormat",!1,n)}},lX=function(t){QF.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(function(n,e){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onSetup:wU(t,n.name),onAction:fX(t,n.name)})}));for(var n=1;n<=6;n++){var e="h"+n;t.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+n,onSetup:wU(t,e),onAction:fX(t,e)})}},dX=function(t){QF.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],(function(n){t.ui.registry.addButton(n.name,{tooltip:n.text,icon:n.icon,onAction:CU(t,n.action)})}))},mX=function(t){QF.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],(function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onAction:CU(t,n.action),onSetup:wU(t,n.name)})}))},gX=function(t){lX(t),dX(t),mX(t)},pX=function(t){QF.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],(function(n){t.ui.registry.addMenuItem(n.name,{text:n.text,icon:n.icon,shortcut:n.shortcut,onAction:CU(t,n.action)})})),t.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:fX(t,"code")})},vX=function(t){gX(t),pX(t)},hX=function(t,n){return SU(t,"Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",(function(e){e.setDisabled(t.mode.isReadOnly()||!t.undoManager[n]())}))},bX=function(t){t.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:hX(t,"hasUndo"),onAction:CU(t,"undo")}),t.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:hX(t,"hasRedo"),onAction:CU(t,"redo")})},yX=function(t){t.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",disabled:!0,onSetup:hX(t,"hasUndo"),onAction:CU(t,"undo")}),t.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",disabled:!0,onSetup:hX(t,"hasRedo"),onAction:CU(t,"redo")})},xX=function(t){bX(t),yX(t)},wX=function(t){return SU(t,"VisualAid",(function(n){n.setActive(t.hasVisual)}))},SX=function(t){t.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:wX(t),onAction:CU(t,"mceToggleVisualAid")})},kX=function(t){t.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:CU(t,"mceToggleVisualAid")})},CX=function(t){kX(t),SX(t)},OX=function(t,n){JG(t),vX(t),uX(t,n),xX(t),nE(t),CX(t),sX(t),iX(t)},_X=function(t,n){return{type:"makeshift",x:t,y:n}},TX=function(t,n,e){return _X(t.x+n,t.y+e)},EX=function(t){return"longpress"===t.type||0===t.type.indexOf("touch")},DX=function(t){if(EX(t)){var n=t.touches[0];return _X(n.pageX,n.pageY)}return _X(t.pageX,t.pageY)},BX=function(t){if(EX(t)){var n=t.touches[0];return _X(n.clientX,n.clientY)}return _X(t.clientX,t.clientY)},MX=function(t,n){var e=dO.DOM.getPos(t);return TX(n,e.x,e.y)},AX=function(t,n){return"contextmenu"===n.type||"longpress"===n.type?t.inline?DX(n):MX(t.getContentAreaContainer(),BX(n)):FX(t)},FX=function(t){return{type:"selection",root:nn.fromDom(t.selection.getNode())}},IX=function(t){return{type:"node",node:V.some(nn.fromDom(t.selection.getNode())),root:nn.fromDom(t.getBody())}},RX=function(t,n,e){switch(e){case"node":return IX(t);case"point":return AX(t,n);case"selection":return FX(t)}},VX=function(t,n,e,o,r,i){var u=e(),a=RX(t,n,i);GR(u,Uk.CLOSE_ON_EXECUTE,o,!1).map((function(t){n.preventDefault(),nS.showMenuAt(r,{anchor:a},{menu:{markers:mC("normal")},data:t})}))},PX={onLtr:function(){return[Yf,Wf,Uf,jf,Gf,Xf,mS,gS,dS,fS,lS,sS]},onRtl:function(){return[Yf,Uf,Wf,Gf,jf,Xf,mS,gS,lS,sS,dS,fS]}},HX=12,zX={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},NX=function(t,n){var e=t.selection;if(e.isCollapsed()||n.touches.length<1)return!1;var o=n.touches[0],r=e.getRng(),i=eg(t.getWin(),Cm.domRange(r));return i.exists((function(t){return t.left<=o.clientX&&t.right>=o.clientX&&t.top<=o.clientY&&t.bottom>=o.clientY}))},LX=function(t){var n=t.selection.getRng(),e=function(){wS.setEditorTimeout(t,(function(){t.selection.setRng(n)}),10),i()};t.once("touchend",e);var o=function(t){t.preventDefault(),t.stopImmediatePropagation()};t.on("mousedown",o,!0);var r=function(){return i()};t.once("longpresscancel",r);var i=function(){t.off("touchend",e),t.off("longpresscancel",r),t.off("mousedown",o)}},WX=function(t,n,e){var o=RX(t,n,e),r="point"===e?HX:0;return D({bubble:Ad(0,r,zX),layouts:PX,overrides:{maxWidthFunction:wW(),maxHeightFunction:Td()}},o)},UX=function(t,n,e,o,r,i,u){var a=WX(t,n,i);GR(e,Uk.CLOSE_ON_EXECUTE,o,!0).map((function(e){n.preventDefault(),nS.showMenuWithinBounds(r,{anchor:a},{menu:{markers:mC("normal"),highlightImmediately:u},data:e,type:"horizontal"},(function(){return V.some(_G(t,o.shared,"node"===i?"node":"selection"))})),t.fire(fG)}))},jX=function(t,n,e,o,r,i){var u=ee(),a=u.os.isiOS(),c=u.os.isOSX(),s=u.os.isAndroid(),f=u.deviceType.isTouch(),l=function(){return!(s||a||c&&f)},d=function(){var u=e();UX(t,n,u,o,r,i,l())};if((c||a)&&"node"!==i){var m=function(){LX(t),d()};NX(t,n)?m():(t.once("selectionchange",m),t.once("touchend",(function(){return t.off("selectionchange",m)})))}else d()},GX=function(t){return"string"===typeof t?t.split(/[ ,]/):t},XX=function(t){return t.getParam("contextmenu_never_use_native",!1,"boolean")},YX=function(t,n,e){var o=t.ui.registry.getAll().contextMenus;return V.from(t.getParam(n)).map(GX).getOrThunk((function(){return J(GX(e),(function(t){return Tt(o,t)}))}))},qX=function(t){return!1===t.getParam("contextmenu")},KX=function(t){return YX(t,"contextmenu","link linkchecker image imagetools table spellchecker configurepermanentpen")},JX=function(t){return t.getParam("contextmenu_avoid_overlap","","string")},$X=function(t){return i(t)?"|"===t:"separator"===t.type},QX={type:"separator"},ZX=function(t){var n=function(t){return{text:t.text,icon:t.icon,disabled:t.disabled,shortcut:t.shortcut}};if(i(t))return t;switch(t.type){case"separator":return QX;case"submenu":return D(D({type:"nestedmenuitem"},n(t)),{getSubmenuItems:function(){var n=t.getSubmenuItems();return i(n)?n:X(n,ZX)}});default:return D(D({type:"menuitem"},n(t)),{onAction:h(t.onAction)})}},tY=function(t,n){if(0===n.length)return t;var e=dt(t).filter((function(t){return!$X(t)})),o=e.fold((function(){return[]}),(function(t){return[QX]}));return t.concat(o).concat(n).concat([QX])},nY=function(t,n,e){var o=Q(n,(function(n,o){return _t(t,o.toLowerCase()).map((function(t){var o=t.update(e);if(i(o))return tY(n,o.split(" "));if(o.length>0){var r=X(o,ZX);return tY(n,r)}return n})).getOrThunk((function(){return n.concat([o])}))}),[]);return o.length>0&&$X(o[o.length-1])&&o.pop(),o},eY=function(t,n){return n.ctrlKey&&!XX(t)},oY=function(t,n){return"longpress"!==n.type&&(2!==n.button||n.target===t.getBody()&&""===n.pointerType)},rY=function(t,n){return oY(t,n)?t.selection.getStart(!0):n.target},iY=function(t,n){var e=JX(t),o=oY(t,n)?"selection":"point";if(Yt(e)){var r=rY(t,n),i=VE(nn.fromDom(r),e);return i?"node":o}return o},uY=function(t,n,e){var o=ee(),r=o.deviceType.isTouch,i=Ts(nS.sketch({dom:{tag:"div"},lazySink:n,onEscape:function(){return t.focus()},onShow:function(){return e.setContextMenuState(!0)},onHide:function(){return e.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:ml([Lx("dismissContextMenu",[Aa(ga(),(function(n,e){bp.close(n),t.focus()}))])])})),u=function(t){return nS.hide(i)},a=function(n){if(XX(t)&&n.preventDefault(),!eY(t,n)&&!qX(t)){var o=iY(t,n),u=function(){var e=rY(t,n),o=t.ui.registry.getAll(),r=KX(t);return nY(o.contextMenus,r,e)},a=r()?jX:VX;a(t,n,u,e,i,o)}};t.on("init",(function(){var n="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(r()?"":" ResizeWindow");t.on(n,u),t.on("longpress contextmenu",a)}))},aY=uu.generate([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),cY=function(t){return function(n){return n.translate(-t.left,-t.top)}},sY=function(t){return function(n){return n.translate(t.left,t.top)}},fY=function(t){return function(n,e){return Q(t,(function(t,n){return n(t)}),fo(n,e))}},lY=function(t,n,e){return t.fold(fY([sY(e),cY(n)]),fY([cY(n)]),fY([]))},dY=function(t,n,e){return t.fold(fY([sY(e)]),fY([]),fY([sY(n)]))},mY=function(t,n,e){return t.fold(fY([]),fY([cY(e)]),fY([sY(n),cY(e)]))},gY=function(t,n,e,o,r,i){var u=dY(t,r,i),a=dY(n,r,i);return Math.abs(u.left-a.left)<=e&&Math.abs(u.top-a.top)<=o},pY=function(t,n,e,o,r,i){var u=dY(t,r,i),a=dY(n,r,i),c=Math.abs(u.left-a.left),s=Math.abs(u.top-a.top);return fo(c,s)},vY=function(t,n,e){var o=t.fold((function(t,n){return{position:V.some("absolute"),left:V.some(t+"px"),top:V.some(n+"px")}}),(function(t,n){return{position:V.some("absolute"),left:V.some(t-e.left+"px"),top:V.some(n-e.top+"px")}}),(function(t,n){return{position:V.some("fixed"),left:V.some(t+"px"),top:V.some(n+"px")}}));return D({right:V.none(),bottom:V.none()},o)},hY=function(t,n,e){return t.fold((function(t,o){return yY(t+n,o+e)}),(function(t,o){return xY(t+n,o+e)}),(function(t,o){return wY(t+n,o+e)}))},bY=function(t,n,e,o){var r=function(t,r){return function(i,u){var a=t(n,e,o);return r(i.getOr(a.left),u.getOr(a.top))}};return t.fold(r(mY,yY),r(dY,xY),r(lY,wY))},yY=aY.offset,xY=aY.absolute,wY=aY.fixed,SY=function(t,n){var e=We(t,n);return f(e)?NaN:parseInt(e,10)},kY=function(t,n){var e=t.element,o=SY(e,n.leftAttr),r=SY(e,n.topAttr);return isNaN(o)||isNaN(r)?V.none():V.some(fo(o,r))},CY=function(t,n,e){var o=t.element;Ne(o,n.leftAttr,e.left+"px"),Ne(o,n.topAttr,e.top+"px")},OY=function(t,n){var e=t.element;Ge(e,n.leftAttr),Ge(e,n.topAttr)},_Y=function(t,n,e,o){return kY(t,n).fold((function(){return e}),(function(t){return wY(t.left+o.left,t.top+o.top)}))},TY=function(t,n,e,o,r,i){var u=_Y(t,n,e,o),a=n.mustSnap?BY(t,n,u,r,i):MY(t,n,u,r,i),c=lY(u,r,i);return CY(t,n,c),a.fold((function(){return{coord:wY(c.left,c.top),extra:V.none()}}),(function(t){return{coord:t.output,extra:t.extra}}))},EY=function(t,n){OY(t,n)},DY=function(t,n,e,o){return gt(t,(function(t){var r=t.sensor,i=gY(n,r,t.range.left,t.range.top,e,o);return i?V.some({output:bY(t.output,n,e,o),extra:t.extra}):V.none()}))},BY=function(t,n,e,o,r){var i=n.getSnapPoints(t),u=DY(i,e,o,r);return u.orThunk((function(){var t=Q(i,(function(t,n){var i=n.sensor,u=pY(e,i,n.range.left,n.range.top,o,r);return t.deltas.fold((function(){return{deltas:V.some(u),snap:V.some(n)}}),(function(e){var o=(u.left+u.top)/2,r=(e.left+e.top)/2;return o<=r?{deltas:V.some(u),snap:V.some(n)}:t}))}),{deltas:V.none(),snap:V.none()});return t.snap.map((function(t){return{output:bY(t.output,e,o,r),extra:t.extra}}))}))},MY=function(t,n,e,o,r){var i=n.getSnapPoints(t);return DY(i,e,o,r)},AY=function(t,n,e){return{coord:bY(t.output,t.output,n,e),extra:t.extra}},FY=function(t,n,e,o){var r=n.getTarget(t.element);if(n.repositionTarget){var i=me(t.element),u=Ho(i),a=Gz(r),c=AY(o,u,a),s=vY(c.coord,u,a);Je(r,s)}},IY=Object.freeze({__proto__:null,snapTo:FY}),RY="data-initial-z-index",VY=function(t){he(t.element).filter(ln).each((function(t){Ue(t,RY).fold((function(){return eo(t,"z-index")}),(function(n){return qe(t,"z-index",n)})),Ge(t,RY)}))},PY=function(t){he(t.element).filter(ln).each((function(n){Ze(n,"z-index").each((function(t){Ne(n,RY,t)})),qe(n,"z-index",$e(t.element,"z-index"))}))},HY=function(t,n){t.getSystem().addToGui(n),PY(n)},zY=function(t){VY(t),t.getSystem().removeFromGui(t)},NY=function(t,n,e){return t.getSystem().build(sD.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[n]},events:e}))},LY=Xi("snaps",[Di("getSnapPoints"),cf("onSensor"),Di("leftAttr"),Di("topAttr"),qi("lazyViewport",tr),qi("mustSnap",!1)]),WY=[qi("useFixed",_),Di("blockerClass"),qi("getTarget",w),qi("onDrag",v),qi("repositionTarget",!0),qi("onDrop",v),tu("getBounds",tr),LY],UY=function(t){return It(Ze(t,"left"),Ze(t,"top"),Ze(t,"position"),(function(t,n,e){var o="fixed"===e?wY:yY;return o(parseInt(t,10),parseInt(n,10))})).getOrThunk((function(){var n=go(t);return xY(n.left,n.top)}))},jY=function(t,n,e,o,r){var i=r.bounds,u=dY(n,e,o),a=Df(u.left,i.x,i.x+i.width-r.width),c=Df(u.top,i.y,i.y+i.height-r.height),s=xY(a,c);return n.fold((function(){var t=mY(s,e,o);return yY(t.left,t.top)}),x(s),(function(){var t=lY(s,e,o);return wY(t.left,t.top)}))},GY=function(t,n,e,o,r,i,u){var a=n.fold((function(){var t=hY(e,i.left,i.top),n=lY(t,o,r);return wY(n.left,n.top)}),(function(n){var u=TY(t,n,e,i,o,r);return u.extra.each((function(e){n.onSensor(t,e)})),u.coord}));return jY(t,a,o,r,u)},XY=function(t,n,e,o){var r=n.getTarget(t.element);if(n.repositionTarget){var i=me(t.element),u=Ho(i),a=Gz(r),c=UY(r),s=GY(t,n.snaps,c,u,a,o,e),f=vY(s,u,a);Je(r,f)}n.onDrag(t,r,o)},YY=function(t,n){return{bounds:t.getBounds(),height:ao(n.element),width:yo(n.element)}},qY=function(t,n,e,o,r){var i=e.update(o,r),u=e.getStartData().getOrThunk((function(){return YY(n,t)}));i.each((function(e){XY(t,n,u,e)}))},KY=function(t,n,e,o){n.each(zY),e.snaps.each((function(n){EY(t,n)}));var r=e.getTarget(t.element);o.reset(),e.onDrop(t,r)},JY=function(t){return function(n,e){var o=function(t){e.setStartData(YY(n,t))};return Ea(M([Aa(fa(),(function(t){e.getStartData().each((function(){return o(t)}))}))],t(n,e,o),!0))}},$Y=function(t){return Ea([Aa(Fu(),t.forceDrop),Aa(Vu(),t.drop),Aa(Iu(),(function(n,e){t.move(e.event)})),Aa(Ru(),t.delayDrop)])},QY=function(t){return V.from(fo(t.x,t.y))},ZY=function(t,n){return fo(n.left-t.left,n.top-t.top)},tq=Object.freeze({__proto__:null,getData:QY,getDelta:ZY}),nq=function(t,n,e){return[Aa(Fu(),(function(o,r){var i=r.event.raw;if(0===i.button){r.stop();var u=function(){return KY(o,V.some(s),t,n)},a=PE(u,200),c={drop:u,delayDrop:a.schedule,forceDrop:u,move:function(e){a.cancel(),qY(o,t,n,tq,e)}},s=NY(o,t.blockerClass,$Y(c)),f=function(){e(o),HY(o,s)};f()}}))]},eq=M(M([],WY,!0),[df("dragger",{handlers:JY(nq)})],!1),oq=function(t){return Ea([Aa(Du(),t.forceDrop),Aa(Mu(),t.drop),Aa(Au(),t.drop),Aa(Bu(),(function(n,e){t.move(e.event)}))])},rq=function(t){var n=t[0];return V.some(fo(n.clientX,n.clientY))},iq=function(t){var n=t.raw,e=n.touches;return 1===e.length?rq(e):V.none()},uq=function(t,n){return fo(n.left-t.left,n.top-t.top)},aq=Object.freeze({__proto__:null,getData:iq,getDelta:uq}),cq=function(t,n,e){var o=rd(),r=function(e){KY(e,o.get(),t,n),o.clear()};return[Aa(Du(),(function(i,u){u.stop();var a=function(){return r(i)},c={drop:a,delayDrop:v,forceDrop:a,move:function(e){qY(i,t,n,aq,e)}},s=NY(i,t.blockerClass,oq(c));o.set(s);var f=function(){e(i),HY(i,s)};f()})),Aa(Bu(),(function(e,o){o.stop(),qY(e,t,n,aq,o.event)})),Aa(Mu(),(function(t,n){n.stop(),r(t)})),Aa(Au(),r)]},sq=M(M([],WY,!0),[df("dragger",{handlers:JY(cq)})],!1),fq=function(t,n,e){return M(M([],nq(t,n,e),!0),cq(t,n,e),!0)},lq=M(M([],WY,!0),[df("dragger",{handlers:JY(fq)})],!1),dq=eq,mq=sq,gq=lq,pq=Object.freeze({__proto__:null,mouse:dq,touch:mq,mouseOrTouch:gq}),vq=function(){var t=V.none(),n=V.none(),e=function(){t=V.none(),n=V.none()},o=function(n,e){var o=t.map((function(t){return n.getDelta(t,e)}));return t=V.some(e),o},r=function(t,n){return t.getData(n).bind((function(n){return o(t,n)}))},i=function(t){n=V.some(t)},u=function(){return n},a=x({});return Oc({readState:a,reset:e,update:r,getStartData:u,setStartData:i})},hq=Object.freeze({__proto__:null,init:vq}),bq=hl({branchKey:"mode",branches:pq,name:"dragging",active:{events:function(t,n){var e=t.dragger;return e.handlers(t,n)}},extra:{snap:function(t){return{sensor:t.sensor,range:t.range,output:t.output,extra:V.from(t.extra)}}},state:hq,apis:IY}),yq=40,xq=yq/2,wq=function(t,n,e,o,r,i){return t.fold((function(){return bq.snap({sensor:xY(e-xq,o-xq),range:fo(r,i),output:xY(V.some(e),V.some(o)),extra:{td:n}})}),(function(t){var r=e-xq,i=o-xq,u=yq,a=yq,c=t.element.dom.getBoundingClientRect();return bq.snap({sensor:xY(r,i),range:fo(u,a),output:xY(V.some(e-c.width/2),V.some(o-c.height/2)),extra:{td:n}})}))},Sq=function(t,n,e){var o=function(t,n){return t.exists((function(t){return se(t,n)}))};return{getSnapPoints:t,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(t,r){var i=r.td;o(n.get(),i)||(n.set(i),e(i))},mustSnap:!0}},kq=function(t){return CS(kS.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:ml([bq.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:t}),LB.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},Cq=function(t,n){var e=ru([]),o=ru([]),r=ru(!1),i=rd(),u=rd(),a=function(t){var e=Zo(t);return wq(m.getOpt(n),t,e.x,e.y,e.width,e.height)},c=function(){return X(e.get(),(function(t){return a(t)}))},s=function(t){var e=Zo(t);return wq(g.getOpt(n),t,e.right,e.bottom,e.width,e.height)},f=function(){return X(o.get(),(function(t){return s(t)}))},l=Sq(c,i,(function(n){u.get().each((function(e){t.fire("TableSelectorChange",{start:n,finish:e})}))})),d=Sq(f,u,(function(n){i.get().each((function(e){t.fire("TableSelectorChange",{start:e,finish:n})}))})),m=kq(l),g=kq(d),p=Ts(m.asSpec()),v=Ts(g.asSpec()),h=function(n,e,o,r){var i=e.dom.getBoundingClientRect();eo(n.element,"display");var u=ve(nn.fromDom(t.getBody())).dom.innerHeight,a=o(i),c=r(i,u);(a||c)&&qe(n.element,"display","none")},b=function(t,n,e,o){var r=e(n);bq.snapTo(t,r);var i=function(t){return t[o]<0},u=function(t,n){return t[o]>n};h(t,n,i,u)},y=function(t){return b(p,t,a,"top")},x=function(){return i.get().each(y)},w=function(t){return b(v,t,s,"bottom")},S=function(){return u.get().each(w)};ee().deviceType.isTouch()&&(t.on("TableSelectionChange",(function(t){r.get()||(jg(n,p),jg(n,v),r.set(!0)),i.set(t.start),u.set(t.finish),t.otherCells.each((function(n){e.set(n.upOrLeftCells),o.set(n.downOrRightCells),y(t.start),w(t.finish)}))})),t.on("ResizeEditor ResizeWindow ScrollContent",(function(){x(),S()})),t.on("TableSelectionClear",(function(){r.get()&&(Yg(p),Yg(v),r.set(!1)),i.clear(),u.clear()})))},Oq=function(t){if(1===t.nodeType){if("BR"===t.nodeName||t.getAttribute("data-mce-bogus"))return!0;if("bookmark"===t.getAttribute("data-mce-type"))return!0}return!1},_q=function(t,n,e){n.delimiter||(n.delimiter="»");var o=function(o){var r=o||[],i=X(r,(function(n,o){return kS.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":o,"tab-index":-1,"aria-level":o+1},innerHtml:n.name},action:function(e){t.focus(),t.selection.select(n.element),t.nodeChanged()},buttonBehaviours:ml([m_.button(e.isDisabled),c_()])})})),u={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+n.delimiter+" "}};return Q(i.slice(1),(function(t,n){var e=t;return e.push(u),e.push(n),e}),[i[0]])},r=function(n){var e=[],o=n.length;while(o-- >0){var r=n[o];if(1===r.nodeType&&!Oq(r)){var i=t.fire("ResolveName",{name:r.nodeName.toLowerCase(),target:r});if(i.isDefaultPrevented()||e.push({name:i.name,element:r}),i.isPropagationStopped())break}}return e};return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:ml([Dx.config({mode:"flow",selector:"div[role=button]"}),Ph.config({disabled:e.isDisabled}),c_(),yD.config({}),zx.config({}),Lx("elementPathEvents",[Wa((function(n,e){t.shortcuts.add("alt+F11","focus statusbar elementpath",(function(){return Dx.focusIn(n)})),t.on("NodeChange",(function(t){var e=r(t.parents);e.length>0?zx.set(n,o(e)):zx.set(n,[])}))}))])]),components:[]}};(function(t){t[t["None"]=0]="None",t[t["Both"]=1]="Both",t[t["Vertical"]=2]="Vertical"})(BU||(BU={}));var Tq=function(t,n,e,o,r){var i={};return i.height=Zj(o+n.top,xO(t),SO(t)),e===BU.Both&&(i.width=Zj(r+n.left,yO(t),wO(t))),i},Eq=function(t,n,e){var o=nn.fromDom(t.getContainer()),r=Tq(t,n,e,uo(o),bo(o));ht(r,(function(t,n){return qe(o,n,Qj(t))})),hT(t)},Dq=function(t){var n=!t.hasPlugin("autoresize"),e=t.getParam("resize",n);return!1===e?BU.None:"both"===e?BU.Both:BU.Vertical},Bq=function(t,n,e,o){var r=20,i=fo(e*r,o*r);return Eq(t,i,n),V.some(!0)},Mq=function(t,n){var e=Dq(t);return e===BU.None?V.none():V.some(VS("resize-handle",{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:n.translate("Resize")},behaviours:[bq.config({mode:"mouse",repositionTarget:!1,onDrag:function(n,o,r){return Eq(t,r,e)},blockerClass:"tox-blocker"}),Dx.config({mode:"special",onLeft:function(){return Bq(t,e,-1,0)},onRight:function(){return Bq(t,e,1,0)},onUp:function(){return Bq(t,e,0,-1)},onDown:function(){return Bq(t,e,0,1)}}),yD.config({}),Jx.config({})]},n.icons))},Aq=function(t,n){var e,o=function(t,e,o){return zx.set(t,[ks(n.translate(["{0} "+o,e[o]]))])};return kS.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:ml([m_.button(n.isDisabled),c_(),yD.config({}),zx.config({}),tv.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),Lx("wordcount-events",[Ga((function(t){var n=tv.getValue(t),e="words"===n.mode?"characters":"words";tv.setValue(t,{mode:e,count:n.count}),o(t,n.count,e)})),Wa((function(n){t.on("wordCountUpdate",(function(t){var e=tv.getValue(n).mode;tv.setValue(n,{mode:e,count:t.wordCount}),o(n,t.wordCount,e)}))}))])]),eventOrder:(e={},e[na()]=["disabling","alloy.base.behaviour","wordcount-events"],e)})},Fq=function(t,n){var e=function(){var t=OS.translate(["Powered by {0}","Tiny"]),n='<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+t+'">'+t+"</a>";return{dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:n}}},o=function(){var o=[];return t.getParam("elementpath",!0,"boolean")&&o.push(_q(t,{},n)),t.hasPlugin("wordcount")&&o.push(Aq(t,n)),t.getParam("branding",!0,"boolean")&&o.push(e()),o.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:o}]:[]},r=function(){var e=o(),r=Mq(t,n);return e.concat(r.toArray())};return{dom:{tag:"div",classes:["tox-statusbar"]},components:r()}},Iq=function(t){var n,e=t.inline,o=e?cG:Jj,r=GO(t)?HN:Uz,i=V.none(),u=ee(),a=u.browser.isIE(),c=a?["tox-platform-ie"]:[],s=u.deviceType.isTouch(),f="tox-platform-touch",l=s?[f]:[],d=PO(t),m=UO(t),g=OS.isRtl()?{attributes:{dir:"rtl"}}:{},p={attributes:(n={},n[Pd]=d?zl.BottomToTop:zl.TopToBottom,n)},h=function(){return i.bind(aU.getHeader)},b=function(){return r.isDocked(h)},y=function(){qe(Q.element,"width",document.body.clientWidth+"px")},x=function(){var t=se(Pe(),m)&&"grid"===$e(m,"display"),n={dom:D({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(c).concat(l)},g),behaviours:ml([Hg.config({useFixed:function(){return b()}})])},e={dom:{styles:{width:document.body.clientWidth+"px"}},events:Ea([Aa(la(),y)])};return Sr(n,t?e:{})},w=Ts(x()),S=function(){return rr.value(w)},k=CS({dom:{tag:"div",classes:["tox-anchorbar"]}}),C=function(){return i.bind((function(t){return k.getOpt(t)})).getOrDie("Could not find a anchor bar element")},O=function(){return i.bind((function(t){return aU.getToolbar(t)})).getOrDie("Could not find more toolbar element")},_=function(){return i.bind((function(t){return aU.getThrobber(t)})).getOrDie("Could not find throbber element")},T=Cz(w,t,C),E=aU.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:T,onEscape:function(){t.focus()}}),B=FO(t),M=aU.parts.toolbar(D({dom:{tag:"div",classes:["tox-toolbar"]},getSink:S,providers:T.shared.providers,onEscape:function(){t.focus()},type:B,lazyToolbar:O,lazyHeader:function(){return h().getOrDie("Could not find header element")}},p)),A=aU.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:T.shared.providers,onEscape:function(){t.focus()},type:B}),F=aU.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),I=aU.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),R=aU.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:T}),P=t.getParam("statusbar",!0,"boolean"),H=P&&!e?V.some(Fq(t,T.shared.providers)):V.none(),z={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[F,I]},N=MO(t),L=DO(t),W=EO(t),U=function(){return N?[A]:L?[M]:[]},j=aU.parts.header({dom:D({tag:"div",classes:["tox-editor-header"]},p),components:et([W?[E]:[],U(),WO(t)?[]:[k.asSpec()]]),sticky:GO(t),editor:t,sharedBackstage:T.shared}),G=et([d?[]:[j],e?[]:[z],d?[j]:[]]),X={dom:{tag:"div",classes:["tox-editor-container"]},components:G},Y=et([[X],e?[]:H.toArray(),[R]]),q=jO(t),K=D(D({role:"application"},OS.isRtl()?{dir:"rtl"}:{}),q?{"aria-hidden":"true"}:{}),J=Ts(aU.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(e?["tox-tinymce-inline"]:[]).concat(d?["tox-tinymce--toolbar-bottom"]:[]).concat(l).concat(c),styles:D({visibility:"hidden"},q?{opacity:"0",border:"0"}:{}),attributes:K},components:Y,behaviours:ml([c_(),Ph.config({disableClass:"tox-tinymce--disabled"}),Dx.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])}));i=V.some(J),t.shortcuts.add("alt+F9","focus menubar",(function(){aU.focusMenubar(J)})),t.shortcuts.add("alt+F10","focus toolbar",(function(){aU.focusToolbar(J)})),t.addCommand("ToggleToolbarDrawer",(function(){aU.toggleToolbarDrawer(J)})),t.addQueryStateHandler("ToggleToolbarDrawer",(function(){return aU.isToolbarDrawerToggled(J)}));var $=fD(J),Q=fD(w);Oz(t,$,Q);var Z=function(){var t={broadcastAll:Q.broadcast,broadcastOn:Q.broadcastOn,register:v};return{channels:t}},tt=function(){var n=Qj(nG(t)),e=Qj(oG(t));return t.inline||(no("div","width",e)&&qe(J.element,"width",e),no("div","height",n)?qe(J.element,"height",n):qe(J.element,"height","200px")),n},nt=function(){r.setup(t,T.shared,h),OX(t,T),uY(t,S,T),AL(t),iW(t,_,T.shared),bt(RO(t),(function(n,e){t.ui.registry.addGroupToolbarButton(e,n)}));var n=t.ui.registry.getAll(),e=n.buttons,i=n.menuItems,u=n.contextToolbars,a=n.sidebars,c=BO(t),s={menuItems:i,menus:qO(t),menubar:KO(t),toolbar:c.getOrThunk((function(){return JO(t)})),allowToolbarGroups:B===Wk.floating,buttons:e,sidebar:a};KG(t,u,w,{backstage:T}),Cq(t,w);var f=t.getElement(),l=tt(),d={mothership:$,uiMothership:Q,outerContainer:J},m={targetNode:f,height:l};return o.render(t,d,s,T,m)};return{mothership:$,uiMothership:Q,backstage:T,renderUI:nt,getUi:Z}},Rq=function(t,n){var e=V.from(We(t,"id")).fold((function(){var t=rc("dialog-describe");return Ne(n,"id",t),t}),w);Ne(t,"aria-describedby",e)},Vq=function(t,n){var e=Ue(t,"id").fold((function(){var t=rc("dialog-label");return Ne(n,"id",t),t}),w);Ne(t,"aria-labelledby",e)},Pq=x([Di("lazySink"),Ni("dragBlockClass"),tu("getBounds",tr),qi("useTabstopAt",T),qi("eventOrder",{}),nv("modalBehaviours",[Dx]),sf("onExecute"),lf("onEscape")]),Hq={sketch:w},zq=x([Rv({name:"draghandle",overrides:function(t,n){return{behaviours:ml([bq.config({mode:"mouse",getTarget:function(t){return Vs(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(n,null,2)).message),getBounds:t.getDragBounds})])}}}),Fv({schema:[Di("dom")],name:"title"}),Fv({factory:Hq,schema:[Di("dom")],name:"close"}),Fv({factory:Hq,schema:[Di("dom")],name:"body"}),Rv({factory:Hq,schema:[Di("dom")],name:"footer"}),Iv({factory:{sketch:function(t,n){return D(D({},t),{dom:n.dom,components:n.components})}},schema:[qi("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),qi("components",[])],name:"blocker"})]),Nq=function(t,n,e,o){var r,i=rd(),u=function(n){i.set(n);var e=t.lazySink(n).getOrDie(),r=o.blocker(),u=e.getSystem().build(D(D({},r),{components:r.components.concat([Es(n)]),behaviours:ml([Jx.config({}),Lx("dialog-blocker-events",[La(Hu(),(function(){Dx.focusIn(n)}))])])}));jg(e,u),Dx.focusIn(n)},a=function(t){i.clear(),he(t.element).each((function(n){t.getSystem().getByDom(n).each((function(t){Yg(t)}))}))},c=function(n){return Kv(n,t,"body")},s=function(n){return Kv(n,t,"footer")},f=function(t,n){qL.block(t,n)},l=function(t){qL.unblock(t)},d=rc("modal-events"),m=D(D({},t.eventOrder),(r={},r[da()]=[d].concat(t.eventOrder["alloy.system.attached"]||[]),r));return{uid:t.uid,dom:t.dom,components:n,apis:{show:u,hide:a,getBody:c,getFooter:s,setIdle:l,setBusy:f},eventOrder:m,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:ov(t.modalBehaviours,[zx.config({}),Dx.config({mode:"cyclic",onEnter:t.onExecute,onEscape:t.onEscape,useTabstopAt:t.useTabstopAt}),qL.config({getRoot:i.get}),Lx(d,[Wa((function(n){Vq(n.element,Kv(n,t,"title").element),Rq(n.element,Kv(n,t,"body").element)}))])])}},Lq=mh({name:"ModalDialog",configFields:Pq(),partFields:zq(),factory:Nq,apis:{show:function(t,n){t.show(n)},hide:function(t,n){t.hide(n)},getBody:function(t,n){return t.getBody(n)},getFooter:function(t,n){return t.getFooter(n)},setBusy:function(t,n,e){t.setBusy(n,e)},setIdle:function(t,n){t.setIdle(n)}}}),Wq=ti([Ai("type"),Ai("name")].concat(FC)),Uq=fi,jq=[_i("name","name",Or((function(){return rc("button-name")})),si),Ui("icon"),Qi("align","end",["start","end"]),Zi("primary",!1),Zi("disabled",!1)],Gq=M(M([],jq,!0),[Ai("text")],!1),Xq=M([Fi("type",["submit","cancel","custom"])],Gq,!0),Yq=M([Fi("type",["menu"]),Ui("text"),Ui("tooltip"),Ui("icon"),zi("items",Wq)],jq,!0),qq=Ci("type",{submit:Xq,cancel:Xq,custom:Xq,menu:Yq}),Kq=[Ai("type"),Ai("text"),Fi("level",["info","warn","error","success"]),Ai("icon"),qi("url","")],Jq=ti(Kq),$q=function(t){return[Ai("type"),t]},Qq=[Ai("type"),Ai("text"),Zi("disabled",!1),Zi("primary",!1),_i("name","name",Or((function(){return rc("button-name")})),si),Ui("icon"),Zi("borderless",!1)],Zq=ti(Qq),tK=[Ai("type"),Ai("name"),Ai("label"),Zi("disabled",!1)],nK=ti(tK),eK=fi,oK=[Ai("type"),Ai("name")],rK=oK.concat([Ui("label")]),iK=rK.concat([qi("columns","auto")]),uK=ti(iK),aK=ii([Ai("value"),Ai("text"),Ai("icon")]),cK=rK,sK=ti(cK),fK=si,lK=rK,dK=ti(lK),mK=si,gK=oK.concat([$i("tag","textarea"),Ai("scriptId"),Ai("scriptUrl"),nu("settings",void 0)]),pK=oK.concat([$i("tag","textarea"),Ri("init")]),vK=hi((function(t){return xi("customeditor.old",Zr(pK),t).orThunk((function(){return xi("customeditor.new",Zr(gK),t)}))})),hK=si,bK=rK,yK=ti(bK),xK=vi(),wK=function(t){return[Ai("type"),Mi("columns"),t]},SK=[Ai("type"),Ai("html"),Qi("presets","presentation",["presentation","document"])],kK=ti(SK),CK=rK.concat([Zi("sandboxed",!0)]),OK=ti(CK),_K=si,TK=rK.concat([Bi("currentState",ti([Di("blob"),Ai("url")]))]),EK=ti(TK),DK=rK.concat([Ui("inputMode"),Ui("placeholder"),Zi("maximized",!1),Zi("disabled",!1)]),BK=ti(DK),MK=si,AK=function(t){return[Ai("type"),Ai("label"),t]},FK=[Ai("text"),Ai("value")],IK=[Ai("text"),zi("items",Oi("items",(function(){return RK})))],RK=ei([ti(FK),ti(IK)]),VK=rK.concat([zi("items",RK),Zi("disabled",!1)]),PK=ti(VK),HK=si,zK=rK.concat([Hi("items",[Ai("text"),Ai("value")]),Ji("size",1),Zi("disabled",!1)]),NK=ti(zK),LK=si,WK=rK.concat([Zi("constrain",!0),Zi("disabled",!1)]),UK=ti(WK),jK=ti([Ai("width"),Ai("height")]),GK=[Ai("type"),zi("header",si),zi("cells",ni(si))],XK=ti(GK),YK=rK.concat([Ui("placeholder"),Zi("maximized",!1),Zi("disabled",!1)]),qK=ti(YK),KK=si,JK=rK.concat([Qi("filetype","file",["image","media","file"]),qi("disabled",!1)]),$K=ti(JK),QK=ti([Ai("value"),qi("meta",{})]),ZK=function(t){return _i("items","items",Cr(),ni(hi((function(n){return xi("Checking item of "+t,tJ,n).fold((function(t){return rr.error(ki(t))}),(function(t){return rr.value(t)}))}))))},tJ=$r((function(){return pi("type",{alertbanner:Jq,bar:ti($q(ZK("bar"))),button:Zq,checkbox:nK,colorinput:sK,colorpicker:dK,dropzone:yK,grid:ti(wK(ZK("grid"))),iframe:OK,input:BK,listbox:PK,selectbox:NK,sizeinput:UK,textarea:qK,urlinput:$K,customeditor:vK,htmlpanel:kK,imagetools:EK,collection:uK,label:ti(AK(ZK("label"))),table:XK,panel:eJ})})),nJ=[Ai("type"),qi("classes",[]),zi("items",tJ)],eJ=ti(nJ),oJ=[_i("name","name",Or((function(){return rc("tab-name")})),si),Ai("title"),zi("items",tJ)],rJ=[Ai("type"),Hi("tabs",oJ)],iJ=ti(rJ),uJ=Gq,aJ=qq,cJ=ti([Ai("title"),Bi("body",pi("type",{panel:eJ,tabpanel:iJ})),$i("size","normal"),zi("buttons",aJ),qi("initialData",{}),tu("onAction",v),tu("onChange",v),tu("onSubmit",v),tu("onClose",v),tu("onCancel",v),qi("onTabChange",v)]),sJ=function(t){return xi("dialog",cJ,t)},fJ=ti(M([Fi("type",["cancel","custom"])],uJ,!0)),lJ=ti([Ai("title"),Ai("url"),Wi("height"),Wi("width"),Gi("buttons",fJ),tu("onAction",v),tu("onCancel",v),tu("onClose",v),tu("onMessage",v)]),dJ=function(t){return xi("dialog",lJ,t)},mJ=function(t){return u(t)?[t].concat(ot(Ot(t),mJ)):a(t)?ot(t,mJ):[]},gJ=function(t){return i(t.type)&&i(t.name)},pJ={checkbox:eK,colorinput:fK,colorpicker:mK,dropzone:xK,input:MK,iframe:_K,sizeinput:jK,selectbox:LK,listbox:HK,size:jK,textarea:KK,urlinput:QK,customeditor:hK,collection:aK,togglemenuitem:Uq},vJ=function(t){return V.from(pJ[t.type])},hJ=function(t){return J(mJ(t),gJ)},bJ=function(t){var n=hJ(t),e=ot(n,(function(t){return vJ(t).fold((function(){return[]}),(function(n){return[Bi(t.name,n)]}))}));return ti(e)},yJ=function(t){var n=wi(sJ(t)),e=bJ(t),o=t.initialData;return{internalDialog:n,dataValidator:e,initialData:o}},xJ={open:function(t,n){var e=yJ(n);return t(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(t,n){var e=wi(dJ(n));return t(e)},redial:function(t){return yJ(t)}},wJ=function(t){var n=[],e={};return ht(t,(function(t,o){t.fold((function(){n.push(o)}),(function(t){e[o]=t}))})),n.length>0?rr.error(n):rr.value(e)},SJ=function(t,n){var e=CS(FF.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"].concat(t.classes)},components:X(t.items,(function(t){return aH(e,t,n)}))}})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[e.asSpec()]}],behaviours:ml([Dx.config({mode:"acyclic",useTabstopAt:C(hI)}),jF.memento(e),uI.memento(e,{postprocess:function(t){return wJ(t).fold((function(t){return console.error(t),{}}),w)}})])}},kJ=function(t,n){return{uid:t.uid,dom:t.dom,components:t.components,events:hw(t.action),behaviours:ov(t.tabButtonBehaviours,[Jx.config({}),Dx.config({mode:"execution",useSpace:!0,useEnter:!0}),tv.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}},CJ=dh({name:"TabButton",configFields:[qi("uid",void 0),Di("value"),_i("dom","dom",Er((function(){return{attributes:{role:"tab",id:rc("aria"),"aria-selected":"false"}}})),ui()),Ni("action"),qi("domModification",{}),nv("tabButtonBehaviours",[Jx,Dx,tv]),Di("view")],factory:kJ}),OJ=x([Di("tabs"),Di("dom"),qi("clickToDismiss",!1),nv("tabbarBehaviours",[ob,Dx]),uf(["tabClass","selectedClass"])]),_J=Vv({factory:CJ,name:"tabs",unit:"tab",overrides:function(t){var n=function(t,n){ob.dehighlight(t,n),ka(t,ya(),{tabbar:t,button:n})},e=function(t,n){ob.highlight(t,n),ka(t,ba(),{tabbar:t,button:n})};return{action:function(o){var r=o.getSystem().getByUid(t.uid).getOrDie(),i=ob.isHighlighted(r,o),u=function(){return i&&t.clickToDismiss?n:i?v:e}();u(r,o)},domModification:{classes:[t.markers.tabClass]}}}}),TJ=x([_J]),EJ=function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:ov(t.tabbarBehaviours,[ob.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,n){Ne(n.element,"aria-selected","true")},onDehighlight:function(t,n){Ne(n.element,"aria-selected","false")}}),Dx.config({mode:"flow",getInitial:function(t){return ob.getHighlighted(t).map((function(t){return t.element}))},selector:"."+t.markers.tabClass,executeOnMove:!0})])}},DJ=mh({name:"Tabbar",configFields:OJ(),partFields:TJ(),factory:EJ}),BJ=function(t,n){return{uid:t.uid,dom:t.dom,behaviours:ov(t.tabviewBehaviours,[zx.config({})]),domModification:{attributes:{role:"tabpanel"}}}},MJ=dh({name:"Tabview",configFields:[nv("tabviewBehaviours",[zx])],factory:BJ}),AJ=x([qi("selectFirst",!0),cf("onChangeTab"),cf("onDismissTab"),qi("tabs",[]),nv("tabSectionBehaviours",[])]),FJ=Fv({factory:DJ,schema:[Di("dom"),Pi("markers",[Di("tabClass"),Di("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),IJ=Fv({factory:MJ,name:"tabview"}),RJ=x([FJ,IJ]),VJ=function(t,n,e,o){var r=function(n){var e=tv.getValue(n);qv(n,t,"tabview").each((function(o){var r=tt(t.tabs,(function(t){return t.value===e}));r.each((function(e){var r=e.view();Ue(n.element,"id").each((function(t){Ne(o.element,"aria-labelledby",t)})),zx.set(o,r),t.onChangeTab(o,n,r)}))}))},i=function(n,e){qv(n,t,"tabbar").each((function(t){e(t).each(Ca)}))};return{uid:t.uid,dom:t.dom,components:n,behaviours:ev(t.tabSectionBehaviours),events:Ea(et([t.selectFirst?[Wa((function(t,n){i(t,ob.getFirst)}))]:[],[Aa(ba(),(function(t,n){var e=n.event.button;r(e)})),Aa(ya(),(function(n,e){var o=e.event.button;t.onDismissTab(n,o)}))]])),apis:{getViewItems:function(n){return qv(n,t,"tabview").map((function(t){return zx.contents(t)})).getOr([])},showTab:function(t,n){var e=function(t){var e=ob.getCandidates(t),o=tt(e,(function(t){return tv.getValue(t)===n}));return o.filter((function(n){return!ob.isHighlighted(t,n)}))};i(t,e)}}}},PJ=mh({name:"TabSection",configFields:AJ(),partFields:RJ(),factory:VJ,apis:{getViewItems:function(t,n){return t.getViewItems(n)},showTab:function(t,n,e){t.showTab(n,e)}}}),HJ=function(t,n,e){return X(t,(function(o,r){zx.set(e,t[r].view());var i=n.dom.getBoundingClientRect();return zx.set(e,[]),i.height}))},zJ=function(t){return lt(st(t,(function(t,n){return t>n?-1:t<n?1:0})))},NJ=function(t,n,e){var o,r=pe(t).dom,i=Vs(t,".tox-dialog-wrap").getOr(t),u="fixed"===$e(i,"position");o=u?Math.max(r.clientHeight,window.innerHeight):Math.max(r.offsetHeight,r.scrollHeight);var a=uo(n),c=n.dom.offsetLeft>=e.dom.offsetLeft+bo(e),s=c?Math.max(uo(e),a):a,f=parseInt($e(t,"margin-top"),10)||0,l=parseInt($e(t,"margin-bottom"),10)||0,d=uo(t)+f+l,m=d-s;return o-m},LJ=function(t,n){lt(t).each((function(t){return PJ.showTab(n,t.value)}))},WJ=function(t,n){qe(t,"height",n+"px"),ee().browser.isIE()?eo(t,"flex-basis"):qe(t,"flex-basis",n+"px")},UJ=function(t,n,e){Vs(t,'[role="dialog"]').each((function(t){Hs(t,'[role="tablist"]').each((function(o){e.get().map((function(e){return qe(n,"height","0"),qe(n,"flex-basis","0"),Math.min(e,NJ(t,n,o))})).each((function(t){WJ(n,t)}))}))}))},jJ=function(t){return Hs(t,'[role="tabpanel"]')},GJ=function(t){var n=function(){var n=rd(),e=[Wa((function(e){var o=e.element;jJ(o).each((function(r){qe(r,"visibility","hidden"),e.getSystem().getByDom(r).toOptional().each((function(e){var o=HJ(t,r,e),i=zJ(o);i.fold(n.clear,n.set)})),UJ(o,r,n),eo(r,"visibility"),LJ(t,e),wS.requestAnimationFrame((function(){UJ(o,r,n)}))}))})),Aa(la(),(function(t){var e=t.element;jJ(e).each((function(t){UJ(e,t,n)}))})),Aa(RD,(function(t,e){var o=t.element;jJ(o).each((function(t){var e=_l(De(t));qe(t,"visibility","hidden");var r=Ze(t,"height").map((function(t){return parseInt(t,10)}));eo(t,"height"),eo(t,"flex-basis");var i=t.dom.getBoundingClientRect().height,u=r.forall((function(t){return i>t}));u?(n.set(i),UJ(o,t,n)):r.each((function(n){WJ(t,n)})),eo(t,"visibility"),e.each(kl)}))}))],o=!1;return{extraEvents:e,selectFirst:o}}(),e=function(){var t=[],n=!0;return{extraEvents:t,selectFirst:n}}();return{smartTabHeight:n,naiveTabHeight:e}},XJ="send-data-to-section",YJ="send-data-to-view",qJ=function(t,n){var e=ru({}),o=function(t){var n=tv.getValue(t),o=wJ(n).getOr({}),r=e.get(),i=Sr(r,o);e.set(i)},r=function(t){var n=e.get();tv.setValue(t,n)},i=ru(null),u=X(t.tabs,(function(t){return{value:t.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:n.shared.providers.translate(t.title)},view:function(){return[FF.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"]},components:X(t.items,(function(t){return aH(e,t,n)})),formBehaviours:ml([Dx.config({mode:"acyclic",useTabstopAt:C(hI)}),Lx("TabView.form.events",[Wa(r),Ua(o)]),yl.config({channels:gu([{key:XJ,value:{onReceive:o}},{key:YJ,value:{onReceive:r}}])})])}}))]}}})),a=GJ(u).smartTabHeight;return PJ.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,n,e){var o=tv.getValue(n);ka(t,ID,{name:o,oldName:i.get()}),i.set(o)},tabs:u,components:[PJ.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[DJ.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:ml([yD.config({})])}),PJ.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:a.selectFirst,tabSectionBehaviours:ml([Lx("tabpanel",a.extraEvents),Dx.config({mode:"acyclic"}),bh.config({find:function(t){return lt(PJ.getViewItems(t))}}),tv.config({store:{mode:"manual",getValue:function(t){return t.getSystem().broadcastOn([XJ],{}),e.get()},setValue:function(t,n){e.set(n),t.getSystem().broadcastOn([YJ],{})}}})])})},KJ=rc("update-dialog"),JJ=rc("update-title"),$J=rc("update-body"),QJ=rc("update-footer"),ZJ=rc("body-send-message"),t$=function(t,n,e,o){var r=function(t){switch(t.body.type){case"tabpanel":return[qJ(t.body,e)];default:return[SJ(t.body,e)]}},i=function(t,n){return V.some({isTabPanel:function(){return"tabpanel"===n.body.type}})},u={"aria-live":"polite"};return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:D(D({},n.map((function(t){return{id:t}})).getOr({})),o?u:{})},components:[],behaviours:ml([jF.childAt(0),gj.config({channel:$J,updateState:i,renderComponents:r,initialData:t})])}},n$=function(t,n,e,o){return t$(t,V.some(n),e,o)},e$=function(t,n){var e=t$(t,V.none(),n,!1);return Lq.parts.body(e)},o$=function(t){var n={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[gI({dom:{tag:"iframe",attributes:{src:t.url}},behaviours:ml([yD.config({}),Jx.config({})])})]}],behaviours:ml([Dx.config({mode:"acyclic",useTabstopAt:C(hI)})])};return Lq.parts.body(n)},r$=S_.deviceType.isTouch(),i$=function(t,n){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[t,n]}},u$=function(t,n){return Lq.parts.close(kS.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close")}},action:t,buttonBehaviours:ml([yD.config({})])}))},a$=function(){return Lq.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},c$=function(t,n){return Lq.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:$L("<p>"+n.translate(t)+"</p>")}]}]})},s$=function(t){return Lq.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})},f$=function(t,n){return[sD.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),sD.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:n})]},l$=function(t){var n,e="tox-dialog",o=e+"-wrap",r=o+"__backdrop",i=e+"__disable-scroll";return Lq.sketch({lazySink:t.lazySink,onEscape:function(n){return t.onEscape(n),V.some(!0)},useTabstopAt:function(t){return!hI(t)},dom:{tag:"div",classes:[e].concat(t.extraClasses),styles:D({position:"relative"},t.extraStyles)},components:M([t.header,t.body],t.footer.toArray(),!0),parts:{blocker:{dom:$L('<div class="'+o+'"></div>'),components:[{dom:{tag:"div",classes:r$?[r,r+"--opaque"]:[r]}}]}},dragBlockClass:o,modalBehaviours:ml(M([Jx.config({}),Lx("dialog-events",t.dialogEvents.concat([La(Hu(),(function(t,n){Dx.focusIn(t)}))])),Lx("scroll-lock",[Wa((function(){is(Pe(),i)})),Ua((function(){as(Pe(),i)}))])],t.extraBehaviours,!0)),eventOrder:D((n={},n[na()]=["dialog-events"],n[da()]=["scroll-lock","dialog-events","alloy.base.behaviour"],n[ma()]=["alloy.base.behaviour","dialog-events","scroll-lock"],n),t.eventOrder)})},d$=function(t){return kS.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[VS("close",{tag:"div",classes:["tox-icon"]},t.icons)],action:function(t){Sa(t,DD)}})},m$=function(t,n,e){var o=function(t){return[ks(e.translate(t.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:D({},n.map((function(t){return{id:t}})).getOr({}))},components:o(t),behaviours:ml([gj.config({channel:JJ,renderComponents:o})])}},g$=function(){return{dom:$L('<div class="tox-dialog__draghandle"></div>')}},p$=function(t,n,e){return sD.sketch({dom:$L('<div class="tox-dialog__header"></div>'),components:[m$(t,V.some(n),e),g$(),d$(e)],containerBehaviours:ml([bq.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return zs(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])})},v$=function(t,n){var e=Lq.parts.title(m$(t,V.none(),n)),o=Lq.parts.draghandle(g$()),r=Lq.parts.close(d$(n)),i=[e].concat(t.draggable?[o]:[]).concat([r]);return sD.sketch({dom:$L('<div class="tox-dialog__header"></div>'),components:i})},h$=function(t,n){return v$({title:n.shared.providers.translate(t),draggable:n.dialog.isDraggableModal()},n.shared.providers)},b$=function(t,n,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":e.translate(t)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:n,components:[{dom:$L('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}},y$=function(t,n,e){return{onClose:function(){return e.closeWindow()},onBlock:function(e){Lq.setBusy(t(),(function(t,o){return b$(e.message,o,n)}))},onUnblock:function(){Lq.setIdle(t())}}},x$=function(t,n,e,o){var r,i=function(t,n){return V.some(n)};return Ts(l$(D(D({},t),{lazySink:o.shared.getSink,extraBehaviours:M([gj.config({channel:KJ,updateState:i,initialData:n}),uI.memory({})],t.extraBehaviours,!0),onEscape:function(t){Sa(t,DD)},dialogEvents:e,eventOrder:(r={},r[ta()]=[gj.name(),yl.name()],r[da()]=["scroll-lock",gj.name(),"messages","dialog-events","alloy.base.behaviour"],r[ma()]=["alloy.base.behaviour","dialog-events","messages",gj.name(),"scroll-lock"],r)})))},w$=function(t){var n=function(t){var n=X(t.items,(function(t){var n=ru(!1);return D(D({},t),{storage:n})}));return D(D({},t),{items:n})};return X(t,(function(t){return"menu"===t.type?n(t):t}))},S$=function(t){return Q(t,(function(t,n){if("menu"===n.type){var e=n;return Q(e.items,(function(t,n){return t[n.name]=n.storage,t}),t)}return t}),{})},k$=function(t,n){return[Ha(Hu(),vI),t(ED,(function(t,e){n.onClose(),e.onClose()})),t(DD,(function(t,n,e,o){n.onCancel(t),Sa(o,ED)})),Aa(FD,(function(t,e){return n.onUnblock()})),Aa(AD,(function(t,e){return n.onBlock(e.event)}))]},C$=function(t,n){var e=function(n,e){return Aa(n,(function(n,r){o(n,(function(o,i){e(t(),o,r.event,n)}))}))},o=function(t,n){gj.getState(t).get().each((function(e){n(e,t)}))};return M(M([],k$(e,n),!0),[e(BD,(function(t,n,e){n.onAction(t,{name:e.name})}))],!1)},O$=function(t,n,e){var o=function(n,e){return Aa(n,(function(n,o){r(n,(function(r,i){e(t(),r,o.event,n)}))}))},r=function(t,n){gj.getState(t).get().each((function(e){n(e.internalDialog,t)}))};return M(M([],k$(o,n),!0),[o(MD,(function(t,n){return n.onSubmit(t)})),o(TD,(function(t,n,e){n.onChange(t,{name:e.name})})),o(BD,(function(t,n,o,r){var i=function(){return Dx.focusIn(r)},u=function(t){return je(t,"disabled")||Ue(t,"aria-disabled").exists((function(t){return"true"===t}))},a=De(r.element),c=_l(a);n.onAction(t,{name:o.name,value:o.value}),_l(a).fold(i,(function(t){u(t)||c.exists((function(n){return de(t,n)&&u(n)}))?i():e().toOptional().filter((function(n){return!de(n.element,t)})).each(i)}))})),o(ID,(function(t,n,e){n.onTabChange(t,{newTabName:e.name,oldTabName:e.oldName})})),Ua((function(n){var e=t();tv.setValue(n,e.getData())}))],!1)},_$={initUrlDialog:C$,initDialog:O$},T$=function(t,n){return oV(t,t.type,n)},E$=function(t,n,e){return tt(n,(function(t){return t.name===e})).bind((function(n){return n.memento.getOpt(t)}))},D$=function(t,n){var e=n.map((function(t){return t.footerButtons})).getOr([]),o=K(e,(function(t){return"start"===t.align})),r=function(t,n){return sD.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:X(n,(function(t){return t.memento.asSpec()}))})},i=r("start",o.pass),u=r("end",o.fail);return[i,u]},B$=function(t,n){var e=function(t,e){var o=X(e.buttons,(function(t){var e=CS(T$(t,n));return{name:t.name,align:t.align,memento:e}})),r=function(t,n){return E$(t,o,n)};return V.some({lookupByName:r,footerButtons:o})};return{dom:$L('<div class="tox-dialog__footer"></div>'),components:[],behaviours:ml([gj.config({channel:QJ,initialData:t,updateState:e,renderComponents:D$})])}},M$=function(t,n){return B$(t,n)},A$=function(t,n){return Lq.parts.footer(B$(t,n))},F$=function(t,n){var e=t.getRoot();if(e.getSystem().isConnected()){var o=bh.getCurrent(t.getFormWrapper()).getOr(t.getFormWrapper());return FF.getField(o,n).fold((function(){var e=t.getFooter(),r=gj.getState(e);return r.get().bind((function(t){return t.lookupByName(o,n)}))}),(function(t){return V.some(t)}))}return V.none()},I$=function(t,n){var e=t.getRoot();return gj.getState(e).get().map((function(t){return wi(xi("data",t.dataValidator,n))})).getOr(n)},R$=function(t,n,e){var o=function(n){var e=t.getRoot();e.getSystem().isConnected()&&n(e)},r=function(){var n=t.getRoot(),o=n.getSystem().isConnected()?t.getFormWrapper():n,r=tv.getValue(o),i=bt(e,(function(t){return t.get()}));return D(D({},r),i)},u=function(n){o((function(o){var r=p.getData(),i=D(D({},r),n),u=I$(t,i),a=t.getFormWrapper();tv.setValue(a,u),ht(e,(function(t,n){Tt(i,n)&&t.set(i[n])}))}))},a=function(n){F$(t,n).each(Ph.disable)},c=function(n){F$(t,n).each(Ph.enable)},s=function(n){F$(t,n).each(Jx.focus)},f=function(t){if(!i(t))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");o((function(n){ka(n,AD,{message:t})}))},l=function(){o((function(t){Sa(t,FD)}))},d=function(n){o((function(e){var o=t.getBody(),r=gj.getState(o);r.get().exists((function(t){return t.isTabPanel()}))&&bh.getCurrent(o).each((function(t){PJ.showTab(t,n)}))}))},m=function(t){o((function(e){var o=n(t);e.getSystem().broadcastOn([KJ],o),e.getSystem().broadcastOn([JJ],o.internalDialog),e.getSystem().broadcastOn([$J],o.internalDialog),e.getSystem().broadcastOn([QJ],o.internalDialog),p.setData(o.initialData)}))},g=function(){o((function(t){Sa(t,ED)}))},p={getData:r,setData:u,disable:a,enable:c,focus:s,block:f,unblock:l,showTab:d,redial:m,close:g};return p},V$=function(t){switch(t){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}},P$=function(t,n,e){var o=h$(t.internalDialog.title,e),r=e$({body:t.internalDialog.body},e),i=w$(t.internalDialog.buttons),u=S$(i),a=A$({buttons:i},e),c=_$.initDialog((function(){return m}),y$((function(){return l}),e.shared.providers,n),e.shared.getSink),s=V$(t.internalDialog.size),f={header:o,body:r,footer:V.some(a),extraClasses:s,extraBehaviours:[],extraStyles:{}},l=x$(f,t,c,e),d=function(){var t=function(){var t=Lq.getBody(l);return bh.getCurrent(t).getOr(t)};return{getRoot:x(l),getBody:function(){return Lq.getBody(l)},getFooter:function(){return Lq.getFooter(l)},getFormWrapper:t}}(),m=R$(d,n.redial,u);return{dialog:l,instanceApi:m}},H$=function(t,n,e,o){var r,i,u=rc("dialog-label"),a=rc("dialog-content"),c=function(t,n){return V.some(n)},s=CS(p$({title:t.internalDialog.title,draggable:!0},u,e.shared.providers)),f=CS(n$({body:t.internalDialog.body},a,e,o)),l=w$(t.internalDialog.buttons),d=S$(l),m=CS(M$({buttons:l},e)),g=_$.initDialog((function(){return v}),{onBlock:function(t){qL.block(p,(function(n,o){return b$(t.message,o,e.shared.providers)}))},onUnblock:function(){qL.unblock(p)},onClose:function(){return n.closeWindow()}},e.shared.getSink),p=Ts({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:(r={role:"dialog"},r["aria-labelledby"]=u,r["aria-describedby"]=a,r)},eventOrder:(i={},i[ta()]=[gj.name(),yl.name()],i[na()]=["execute-on-form"],i[da()]=["reflecting","execute-on-form"],i),behaviours:ml([Dx.config({mode:"cyclic",onEscape:function(t){return Sa(t,ED),V.some(!0)},useTabstopAt:function(t){return!hI(t)&&("button"!==cn(t)||"disabled"!==We(t,"disabled"))}}),gj.config({channel:KJ,updateState:c,initialData:t}),Jx.config({}),Lx("execute-on-form",g.concat([La(Hu(),(function(t,n){Dx.focusIn(t)}))])),qL.config({getRoot:function(){return V.some(p)}}),zx.config({}),uI.memory({})]),components:[s.asSpec(),f.asSpec(),m.asSpec()]}),v=R$({getRoot:x(p),getFooter:function(){return m.get(p)},getBody:function(){return f.get(p)},getFormWrapper:function(){var t=f.get(p);return bh.getCurrent(t).getOr(t)}},n.redial,d);return{dialog:p,instanceApi:v}},z$=tinymce.util.Tools.resolve("tinymce.util.URI"),N$=function(t){var n=function(n){t.getSystem().isConnected()&&n(t)},e=function(t){if(!i(t))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");n((function(n){ka(n,AD,{message:t})}))},o=function(){n((function(t){Sa(t,FD)}))},r=function(){n((function(t){Sa(t,ED)}))},u=function(t){n((function(n){n.getSystem().broadcastOn([ZJ],t)}))};return{block:e,unblock:o,close:r,sendMessage:u}},L$=["insertContent","setContent","execCommand","close","block","unblock"],W$=function(t){return u(t)&&-1!==L$.indexOf(t.mceAction)},U$=function(t){return!W$(t)&&u(t)&&Tt(t,"mceAction")},j$=function(t,n,e){switch(e.mceAction){case"insertContent":t.insertContent(e.content);break;case"setContent":t.setContent(e.content);break;case"execCommand":var o=!!s(e.ui)&&e.ui;t.execCommand(e.cmd,o,e.value);break;case"close":n.close();break;case"block":n.block(e.message);break;case"unblock":n.unblock();break}},G$=function(t,n,e,o){var r,i=h$(t.title,o),u=o$(t),a=t.buttons.bind((function(t){return 0===t.length?V.none():V.some(A$({buttons:t},o))})),c=_$.initUrlDialog((function(){return h}),y$((function(){return v}),o.shared.providers,n)),s=D(D({},t.height.fold((function(){return{}}),(function(t){return{height:t+"px","max-height":t+"px"}}))),t.width.fold((function(){return{}}),(function(t){return{width:t+"px","max-width":t+"px"}}))),f=t.width.isNone()&&t.height.isNone()?["tox-dialog--width-lg"]:[],l=new z$(t.url,{base_uri:new z$(window.location.href)}),d=l.protocol+"://"+l.host+(l.port?":"+l.port:""),m=ed(),g=[Lx("messages",[Wa((function(){var n=ud(nn.fromDom(window),"message",(function(n){if(l.isSameOrigin(new z$(n.raw.origin))){var o=n.raw.data;W$(o)?j$(e,h,o):U$(o)&&t.onMessage(h,o)}}));m.set(n)})),Ua(m.clear)]),yl.config({channels:(r={},r[ZJ]={onReceive:function(t,n){Hs(t.element,"iframe").each((function(t){var e=t.dom.contentWindow;e.postMessage(n,d)}))}},r)})],p={header:i,body:u,footer:a,extraClasses:f,extraBehaviours:g,extraStyles:s},v=x$(p,t,c,o),h=N$(v);return{dialog:v,instanceApi:h}},X$=function(t){var n=t.backstage.shared,e=function(e,o){var r=function(){Lq.hide(c),o()},i=CS(oV({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:V.none()},"cancel",t.backstage)),u=a$(),a=u$(r,n.providers),c=Ts(l$({lazySink:function(){return n.getSink()},header:i$(u,a),body:c$(e,n.providers),footer:V.some(s$(f$([],[i.asSpec()]))),onEscape:r,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Aa(DD,r)],eventOrder:{}}));Lq.show(c);var s=i.get(c);Jx.focus(s)};return{open:e}},Y$=function(t){var n=t.backstage.shared,e=function(e,o){var r=function(t){Lq.hide(s),o(t)},i=CS(oV({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:V.none()},"submit",t.backstage)),u=oV({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:V.none()},"cancel",t.backstage),a=a$(),c=u$((function(){return r(!1)}),n.providers),s=Ts(l$({lazySink:function(){return n.getSink()},header:i$(a,c),body:c$(e,n.providers),footer:V.some(s$(f$([],[u,i.asSpec()]))),onEscape:function(){return r(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Aa(DD,(function(){return r(!1)})),Aa(MD,(function(){return r(!0)}))],eventOrder:{}}));Lq.show(s);var f=i.get(s);Jx.focus(f)};return{open:e}},q$=function(t,n){return wi(xi("data",n,t))},K$=function(t){return VE(t,".tox-alert-dialog")||VE(t,".tox-confirm-dialog")},J$=function(t,n,e){return n&&e?[]:[SN.config({contextual:{lazyContext:function(){return V.some(Qo(nn.fromDom(t.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]},$$=function(t){var n=t.backstage,e=t.editor,o=GO(e),r=X$(t),i=Y$(t),u=function(t,e,o){return void 0!==e&&"toolbar"===e.inline?f(t,n.shared.anchors.inlineDialog(),o,e.ariaAttrs):void 0!==e&&"cursor"===e.inline?f(t,n.shared.anchors.cursor(),o,e.ariaAttrs):s(t,o)},a=function(t,n){return c(t,n)},c=function(t,o){var r=function(t){var r=G$(t,{closeWindow:function(){Lq.hide(r.dialog),o(r.instanceApi)}},e,n);return Lq.show(r.dialog),r.instanceApi};return xJ.openUrl(r,t)},s=function(t,e){var o=function(t,o,r){var i=o,u={dataValidator:r,initialData:i,internalDialog:t},a=P$(u,{redial:xJ.redial,closeWindow:function(){Lq.hide(a.dialog),e(a.instanceApi)}},n);return Lq.show(a.dialog),a.instanceApi.setData(i),a.instanceApi};return xJ.open(o,t)},f=function(t,r,i,u){var a=function(t,a,c){var s=q$(a,c),f=rd(),l=n.shared.header.isPositionedAtTop(),d={dataValidator:c,initialData:s,internalDialog:t},m=function(){return f.on((function(t){nS.reposition(t),SN.refresh(t)}))},g=H$(d,{redial:xJ.redial,closeWindow:function(){f.on(nS.hide),e.off("ResizeEditor",m),f.clear(),i(g.instanceApi)}},n,u),p=Ts(nS.sketch(D(D({lazySink:n.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},l?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:ml(M([Lx("window-manager-inline-events",[Aa(ga(),(function(t,n){Sa(g.dialog,DD)}))])],J$(e,o,l),!0)),isExtraPart:function(t,n){return K$(n)}})));return f.set(p),nS.showWithin(p,Es(g.dialog),{anchor:r},V.some(Pe())),o&&l||(SN.refresh(p),e.on("ResizeEditor",m)),g.instanceApi.setData(s),Dx.focusIn(g.dialog),g.instanceApi};return xJ.open(a,t)},l=function(t,n){i.open(t,(function(t){n(t)}))},d=function(t,n){r.open(t,(function(){n()}))},m=function(t){t.close()};return{open:u,openUrl:a,alert:d,close:m,confirm:l}};function Q$(){E.add("silver",(function(t){var n=Iq(t),e=n.uiMothership,o=n.backstage,r=n.renderUI,i=n.getUi;RE.register(t,o.shared);var u=$$({editor:t,backstage:o});return{renderUI:r,getWindowManagerImpl:x(u),getNotificationManagerImpl:function(){return LS(t,{backstage:o},e)},ui:i()}}))}Q$()})()}).call(this,e("c8ba"))}}]);